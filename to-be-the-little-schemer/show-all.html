---
---
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
  <head>
    <title>to-be-the-little-schemer.org</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <style type="text/css">
    <!--
      body {
        color: #f8f8f0;
        background-color: #1b1d1e;
      }
      .bold {
        /* bold */
        font-weight: bold;
      }
      .builtin {
        /* font-lock-builtin-face */
        color: #a6e22e;
      }
      .comment {
        /* font-lock-comment-face */
        color: #FF8888;
      }
      .comment-delimiter {
        /* font-lock-comment-delimiter-face */
        color: #FF8888;
      }
      .function-name {
        /* font-lock-function-name-face */
        color: #a6e22e;
      }
      .keyword {
        /* font-lock-keyword-face */
        color: #f92672;
        font-weight: bold;
      }
      .org-block-begin-line {
        /* org-block-begin-line */
        color: #FF8888;
      }
      .org-block-end-line {
        /* org-block-end-line */
        color: #FF8888;
      }
      .org-checkbox {
        /* org-checkbox */
        font-weight: bold;
      }
      .org-document-info {
        /* org-document-info */
        color: #afeeee;
      }
      .org-document-info-keyword {
        /* org-document-info-keyword */
        color: #b3b3b3;
      }
      .org-document-title {
        /* org-document-title */
        color: #afeeee;
        font-weight: bold;
      }
      .org-done {
        /* org-done */
        color: #98fb98;
        font-weight: bold;
      }
      .org-level-1 {
        /* org-level-1 */
        color: #a6e22e;
      }
      .org-level-2 {
        /* org-level-2 */
        color: #fd971f;
      }
      .org-level-3 {
        /* org-level-3 */
        color: #f92672;
        font-weight: bold;
      }
      .org-level-4 {
        /* org-level-4 */
        color: #FF8888;
      }
      .org-level-5 {
        /* org-level-5 */
        color: #66d9ef;
        font-weight: bold;
      }
      .org-link {
        /* org-link */
        color: #00ffff;
        text-decoration: underline;
      }
      .org-list-dt {
        /* org-list-dt */
        font-weight: bold;
      }
      .org-meta-line {
        /* org-meta-line */
        color: #FF8888;
      }
      .org-todo {
        /* org-todo */
        color: #ffc0cb;
        font-weight: bold;
      }
      .string {
        /* font-lock-string-face */
        color: #e6db74;
      }
      .type {
        /* font-lock-type-face */
        color: #66d9ef;
        font-weight: bold;
      }
      .variable-name {
        /* font-lock-variable-name-face */
        color: #fd971f;
      }

      a {
        color: inherit;
        background-color: inherit;
        font: inherit;
        text-decoration: inherit;
      }
      a:hover {
        text-decoration: underline;
      }
    -->
    </style>
{% include in-org-head.html %}
  </head>
  <body>
    {% include before-pre.html %}
<pre>
<span class="org-document-info-keyword">#+TITLE:</span>  <span class="org-document-title">to be the little schemer
</span><span class="org-document-info-keyword">#+AUTHOR:</span> <span class="org-document-info">&#35613;&#23431;&#24646; / XIE Yuheng
</span><span class="org-document-info-keyword">#+EMAIL:</span>  <span class="org-document-info">xyheme@gmail.com
</span>
<span class="org-level-1">* </span><span class="org-done">todo</span>
  * &#25972;&#29702;
<span class="org-level-1">* the teaching of dan</span>
  * &#32784;&#24515;
    &#24646;&#20037;&#30340;&#21162;&#21147;
    &#35469;&#30495;&#24324;&#28165;&#26368;&#31777;&#21934;&#30340;&#20363;&#23376;
    &#21220;&#22894;&#22320;&#32244;&#32722;
  * &#24555;&#36895;&#24418;&#25104;&#33258;&#24049;&#30340;&#27169;&#22411;[&#25976;&#23416;&#27169;&#22411;]&#20358;&#29702;&#35299;&#25152;&#35264;&#23519;&#21040;&#30340;&#20107;&#29289;
    &#32780;&#19981;&#26159;&#24613;&#30528;&#21435;&#30475;&#20182;&#20154;&#23565;&#36889;&#20123;&#20107;&#29289;&#30340;&#35498;&#26126;
    &#30070;&#24418;&#25104;&#20102;&#33258;&#24049;&#30340;&#29702;&#35299;&#20043;&#24460;&#22312;&#21435;&#30475;&#20182;&#20154;&#23565;&#36889;&#20123;&#20107;&#29289;&#30340;&#35498;&#26126;
    &#28982;&#24460;&#22312;&#36889;&#20013;&#20132;&#27969;&#30070;&#20013;&#35609;&#34395;&#32780;&#21191;&#25954;&#22320;&#25913;&#27491;&#33258;&#24049;&#30340;&#27169;&#22411;
<span class="org-level-1">* </span><span class="org-level-1"><span class="bold">*the little schemer*</span></span>
<span class="org-level-1">* </span><span class="org-todo">&gt;&lt;</span><span class="org-level-1"> recursion</span>
<span class="org-level-1">* 8 lambda the ultimate</span>
<span class="org-level-2">** rember-f</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">rember-f</span>
     (<span class="keyword">lambda</span> (test?)
       (<span class="keyword">lambda</span> (a l)
         (<span class="keyword">letrec</span>
             ([R (<span class="keyword">lambda</span> (l)
                   (<span class="keyword">cond</span> [(null? l) '()]
                         [(test? (car l) a)
                          (cdr l)]
                         [else
                          (cons (car l)
                                (R (cdr l)))]
                         ))])
           (R l)))))

   ((rember-f eq?)  1 '(11 1 1 1))


   (rember-f eq?)
   ==
   ((<span class="keyword">lambda</span> (test?)
      (<span class="keyword">lambda</span> (a l)
        (<span class="keyword">letrec</span>
            ([R (<span class="keyword">lambda</span> (l)
                  (<span class="keyword">cond</span> [(null? l) '()]
                        [(test? (car l) a)
                         (cdr l)]
                        [else
                         (cons (car l)
                               (R (cdr l)))]
                        ))])
          (R l))))
    eq?)
   ==
   (<span class="keyword">lambda</span> (a l)
     (<span class="keyword">letrec</span>
         ([R (<span class="keyword">lambda</span> (l)
               (<span class="keyword">cond</span> [(null? l) '()]
                     [(eq? (car l) a)
                      (cdr l)]
                     [else
                      (cons (car l)
                            (R (cdr l)))]
                     ))])
       (R l)))

   ((rember-f eq?) 1 '(11 1 1 1))
   ==
   ((<span class="keyword">lambda</span> (a l)
      (<span class="keyword">letrec</span>
          ([R (<span class="keyword">lambda</span> (l)
                (<span class="keyword">cond</span> [(null? l) '()]
                      [(eq? (car l) a)
                       (cdr l)]
                      [else
                       (cons (car l)
                             (R (cdr l)))]
                      ))])
        (R l)))
    1 '(2 1 3))
   ==
   list <span class="builtin">:==</span> '() |



   (<span class="keyword">letrec</span>
       ([R (<span class="keyword">lambda</span> (l)
             (<span class="keyword">cond</span> [(null? l) '()]
                   [(eq? (car l) a)
                    (cdr l)]
                   [else
                    (cons (car l)
                          (R (cdr l)))]
                   ))])
     (R l))


<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** insert-g</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">insert-g</span>
     (<span class="keyword">lambda</span> (test?)
       (<span class="keyword">lambda</span> (g)
         (<span class="keyword">lambda</span> (new old l)
           (<span class="keyword">letrec</span>
               ([I (<span class="keyword">lambda</span> (l)
                     (<span class="keyword">cond</span>
                      [(null? l) '()]
                      [(test? (car l) old)
                       (g new old (cdr l))]
                      [else
                       (cons (car l)
                             (I (cdr l)))]))])
             (I l))))))
   (<span class="keyword">define</span> <span class="function-name">seqL</span>
     (<span class="keyword">lambda</span> (new old l)
       (cons new (cons old l))))
   (<span class="keyword">define</span> <span class="function-name">seqR</span>
     (<span class="keyword">lambda</span> (new old l)
       (cons old (cons new l))))
   (<span class="keyword">define</span> <span class="function-name">seqS</span>
     (<span class="keyword">lambda</span> (new old l)
       (cons new l)))
   (<span class="keyword">define</span> <span class="function-name">seqrem</span>
     (<span class="keyword">lambda</span> (new old l)
       l))
   (((insert-g eq?) seqR) 'k 2 '(1 2 3))
   (((insert-g eq?) seqL) 'k 2 '(1 2 3))
   (((insert-g eq?) seqS) 'k 2 '(1 2 3))
   (((insert-g eq?) seqrem) 'k 2 '(1 2 3))
<span class="org-block-end-line">   #+end_src
</span>   abstract common patterns with a new function
<span class="org-level-2">** </span><span class="org-todo">&gt;&lt;</span><span class="org-level-2"> multirember&amp;co</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">multiinsertLR&amp;co</span>
     (<span class="keyword">lambda</span> (new oldL oldR lat col) <span class="comment-delimiter">;;</span><span class="comment">col denote collector
</span>       (<span class="keyword">cond</span> [(null? lat)
              (col '() 0 0)]
             [(eq? (car lat) oldL)
              (multiinsertLR&amp;co new oldL oldR
                                (cdr lat)
                                (<span class="keyword">lambda</span> (newlat L R)
                                  (col (cons new (cons oldL newlat))
                                       (add1 L)
                                       R)))]
             [(eq? (car lat) oldR)
              (multiinsertLR&amp;co new oldL oldR
                                (cdr lat)
                                (<span class="keyword">lambda</span> (newlat L R)
                                  (col (cons oldR (cons new newlat))
                                       L
                                       (add1 R))))]
             [else
              (multiinsertLR&amp;co new oldL oldR
                                (cdr lat)
                                (<span class="keyword">lambda</span> (newlat L R)
                                  (col (cons (car lat) newlat)
                                       L
                                       R)))]
             )))


   <span class="comment-delimiter">;; </span><span class="comment">test:
</span>   (multiinsertLR&amp;co 'k '&lt;l 'r&gt; '(&lt;l r&gt; &lt;l r&gt;)
                     (<span class="keyword">lambda</span> (newlat L R)
                       newlat))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* 9 ... and again, and again, and again, ... (Ycombinator)</span>
<span class="org-level-2">** partial function</span>
   &#25351;&#36889;&#27171;&#30340;&#36958;&#27512;&#20989;&#25976;&#65288;&#32771;&#24942;&#36958;&#27512;&#20989;&#25976;&#30340;&#24037;&#20316;&#26041;&#24335;&#65289;
   &#23565;&#19968;&#37096;&#20998;&#36664;&#20837;&#20540;&#23427;&#26371;&#22312;&#26377;&#38480;&#27425;&#23652;&#23637;&#38283;&#24460;&#20572;&#27490;
   &#32780;&#23565;&#20854;&#20182;&#37096;&#20998;&#30340;&#36664;&#20837;&#20540; &#36958;&#27512;&#20989;&#25976;&#23601;&#36889;&#20123;&#20540;&#32780;&#23637;&#38283;&#26178; &#19981;&#26371;&#20572;&#27490;
   &#65288;&#30456;&#21453;&#30340;&#34899;&#35486;&#26159;&#65306;total function&#65289;
   + &#22312;&#26126;&#30906;&#22320;&#23450;&#32681;&#25299;&#25778;&#32080;&#27083;&#20043;&#21069;
     &#20760;&#37327;&#36991;&#20813;&#20351;&#29992;&#25299;&#25778;&#23416;&#34899;&#35486; &#21435;&#35342;&#35542;&#39006;&#20284;&#25910;&#25986;&#24615;&#30340;&#24615;&#36074;
   ``the recursion step gives the value in terms of
   the value of the procedure applied to a different argument
   in order for the recursion to terminate
   the different argument must be
   closer to the base argument in some way''
   --kent dybvig

   &#24819;&#29992;&#36958;&#27512;&#30340;&#26041;&#24335;&#20358;&#23526;&#29694;&#26576;&#20491;&#20989;&#25976;(procedure)
   &#22914;&#26524;&#33021;&#25214;&#21040;&#26576;&#20491;&#23565;&#36664;&#20837;&#20540;&#30340;&#26576;&#19968;&#26041;&#38754;&#30340;&#24230;&#37327;&#65288;&#29992;&#33258;&#28982;&#25976;&#65289;
   &#20351;&#36889;&#19968;&#24230;&#37327;&#38568;&#30528;&#36958;&#27512;&#20989;&#25976;&#23637;&#38283;&#30340;&#23652;&#27425;&#30340;&#28145;&#20837;&#32780;&#22196;&#26684;&#36958;&#28187;
   &#37027;&#40636;&#23601;&#33021;&#20445;&#35657;&#36889;&#20491;&#36958;&#27512;&#20989;&#25976;&#26159;&#19968;&#20491;total function
<span class="org-level-2">** inperfectness, bad and eternity</span>
   &#20551;&#35373;&#26377;&#19968;&#20491;&#25506;&#31350;&#20989;&#25976;&#24615;&#36074;&#30340;&#35586;&#35422;&#21517;&#21483;will-stop?
   &#23427;&#33021;&#21028;&#26039;&#19968;&#20491;&#20989;&#25976;&#26159;&#21542;&#26159;total&#30340;
   &#24448;&#35657;&#36889;&#27171;&#30340;&#35586;&#35422;&#30340;&#23384;&#22312;&#24615;&#23559;&#23566;&#20986;&#30683;&#30462;
   &#39318;&#20808;&#20316;&#31777;&#21270; &#19981;&#22952;&#20551;&#35373;&#23427;&#21028;&#26039;&#30340;&#26159;&#20316;&#29992;&#26044;'()&#30340;&#20989;&#25976;
   &#32771;&#24942;&#23427;&#20316;&#29992;&#26044;&#20989;&#25976;bad&#30340;&#20540; &#21363;&#32771;&#24942;bad&#20316;&#29992;&#26044;'()&#26159;&#21542;&#26371;&#20572;&#27490;
   &#23601;&#23637;&#31034;&#20102;&#19981;&#21332;&#35519;&#24615; &#21363;&#30683;&#30462;
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">bad</span>
     (<span class="keyword">lambda</span> (x)
       (<span class="keyword">and</span> (will-stop? bad)
            (eternity x))))
   (<span class="keyword">define</span> <span class="function-name">eternity</span>
     (<span class="keyword">lambda</span> (x)
       (eternity x)))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** Y</span>
<span class="org-level-3">*** lambda&#34920;&#36948;&#24335;&#30340;&#20316;&#29992;&#65306;</span>
    &#36890;&#24120;&#21482;&#26377;&#30070;&#25105;&#21629;&#21517;&#19968;&#20491;&#38750;&#36958;&#27512;&#20989;&#25976;&#24460;
    &#25105;&#25165;&#33021;&#21628;&#21914;&#23427;&#35731;&#23427;&#20316;&#29992;&#26044;&#33258;&#35722;&#37327;
    &#32780;lambda&#34920;&#36948;&#24335;&#20351;&#24471;&#25105;&#21487;&#20197;&#25563;&#30452;&#25509;&#23531;&#20986;&#19968;&#20491;&#38750;&#36958;&#27512;&#20989;&#25976;
    &#28982;&#24460;&#25351;&#31034;&#23427;&#35731;&#23427;&#20316;&#29992;&#26044;&#33258;&#35722;&#37327; &#32780;&#19981;&#29992;&#32102;&#20989;&#25976;&#21629;&#21517;
<span class="org-level-3">*** Ycombinator&#30340;&#20316;&#29992;&#65306;</span>
    &#21487;&#26159;&#20195;&#30908;&#23565;&#26044;&#36958;&#27512;&#20989;&#25976;&#30340;&#25551;&#36848;&#26159;&#34920;&#38754;&#19978;&#30340;&#24490;&#29872;&#23450;&#32681;
    &#38656;&#35201;&#21629;&#21517;&#20989;&#25976;&#24460;&#25165;&#33021;&#22312;&#23450;&#32681;&#20013;&#24490;&#29872;&#21628;&#21914;&#23427;
    &#29234;&#20102;&#19981;&#32102;&#20989;&#25976;&#21629;&#21517;&#32780;&#21487;&#20197;&#30452;&#25509;&#20351;&#29992;&#23427; &#20154;&#20497;&#24517;&#38920;&#21478;&#24819;&#36774;&#27861;
    &#36774;&#27861;&#20043;&#19968;&#23601;&#26159;&#20351;&#29992;Ycombinator
    &#19968;&#20491;&#21487;&#20197;&#25551;&#36848;&#36958;&#27512;&#20989;&#25976;&#20316;&#29992;&#30340;&#955;-term
<span class="org-level-3">*** &#19979;&#38754;&#36889;&#19968;&#27573;&#32317;&#32080;&#33258;sicp&#65306;</span>
<span class="org-level-4">**** &#36958;&#27512;&#20989;&#25976;&#30340;&#30475;&#20284;&#24490;&#29872;&#30340;&#23450;&#32681; &#21487;&#20197;&#34987;&#30475;&#20316;&#30001;&#20989;&#25976;&#26041;&#31243;&#30906;&#23450;&#20989;&#25976;</span>
     &#36890;&#24120;&#20154;&#20497;&#35498;&#24490;&#29872;&#23450;&#32681;&#26159;&#37679;&#35492;&#30340;
     &#28982;&#32780;&#20854;&#23526;&#20154;&#20497;&#32147;&#24120;&#25226;&#19968;&#20491;&#26041;&#31243;&#35722;&#24418;&#29234;&#31561;&#20729;&#30340;&#36845;&#20195;&#26041;&#31243;
     &#36889;&#20491;&#36845;&#20195;&#26041;&#31243;&#23601;&#26159;&#24490;&#29872;&#23450;&#32681;&#30340; &#20294;&#23427;&#20006;&#19981;&#26159;&#37679;&#35492;&#30340; &#32780;&#26159;&#26377;&#31934;&#30906;&#35486;&#32681;&#30340;
     &#20154;&#20497;&#23565;&#26041;&#31243;&#20316;&#36889;&#27171;&#35722;&#24418; &#23601;&#26159;&#29234;&#20102;&#35299;&#21407;&#26041;&#31243; &#25110;&#32773;&#36817;&#20284;&#22320;&#35299;&#21407;&#26041;&#31243;
     sicp&#20013;&#36890;&#36942;&#21453;&#36942;&#20358;&#32771;&#24942;&#32780;&#25226;&#24490;&#29872;&#23450;&#32681;&#29702;&#35299;&#29234;&#26041;&#31243;
     &#20351;&#24471;&#19968;&#20491;&#20154;&#39318;&#20808;&#22312;&#35264;&#24565;&#19978;&#19981;&#20877;&#25490;&#26021;&#24490;&#29872;&#23450;&#32681;

     &#20219;&#24847;&#19968;&#20491;&#26041;&#31243;&#30340;&#19968;&#20491;&#26410;&#30693;&#20803;
     &#37117;&#21487;&#20197;&#30475;&#20316;&#19968;&#20491;&#32004;&#26463;&#35722;&#20803;
     &#32780;&#19968;&#20491;&#24931;&#20363;&#26159;&#29992;&#36889;&#20491;&#35722;&#20803;&#20358;&#21629;&#21517;&#26041;&#31243;&#30340;&#35299;

     &#22312;&#19968;&#20491;&#36958;&#27512;&#20989;&#25976;&#30340;&#23450;&#32681;&#65288;&#19968;&#20491;&#26041;&#31243;&#65289;&#20013; &#29992;define&#21629;&#21517;&#20989;&#25976;&#26178;&#20351;&#29992;&#30340;&#21517;&#31281;
     &#21487;&#20197;&#30475;&#20316;&#19968;&#20491;&#32004;&#26463;&#35722;&#20803;
     &#21482;&#19981;&#36942;&#20043;&#24460;&#25226;&#25152;&#27714;&#24471;&#30340;&#36958;&#27512;&#20989;&#25976;&#23384;&#20837;&#20102;&#36889;&#20491;&#21517;&#31281;&#25152;&#23565;&#25033;&#30340;&#23384;&#20786;&#31354;&#38291;
<span class="org-level-4">**** Ycombinator&#26159;&#20197;&#36958;&#27512;&#20989;&#25976;&#29234;&#19981;&#21205;&#40670;&#30340;&#31639;&#23376;</span>
     &gt;&lt; &#26377;&#20102;&#955;-cal&#30340;&#30693;&#35672;&#20043;&#24460;&#23601;&#30332;&#29694;&#25105;&#22312;&#36889;&#37096;&#20998;&#35498;&#30340;&#24456;&#22810;&#20839;&#23481;&#20006;&#19981;&#27491;&#30906;
     &gt;&lt; &#20294;&#26159;&#20316;&#29234;&#19968;&#20491;&#27714;&#35299;Y&#30340;heuristic &#36889;&#20123;&#25991;&#26412;&#36996;&#26159;&#26377;&#24456;&#22823;&#24847;&#32681;&#30340;
     &#21487;&#20197;&#35498;&#23427;&#25226;&#19978;&#38754;&#30340;&#20989;&#25976;&#26041;&#31243;&#35299;&#20102;&#20986;&#20358;
     &#21363;&#25226;&#20989;&#25976;&#26041;&#31243;&#30340;&#35299;&#29992;&#20989;&#25976;&#39023;&#24335;&#34920;&#31034;&#20986;&#20358;
     &#36889;&#20491;&#35299;&#29978;&#33267;&#21487;&#20197;&#22312;scheme&#30340;&#35299;&#37323;&#22120;&#20013;&#36914;&#34892;&#35336;&#31639;
     + &#36889;&#35023;&#39636;&#29694;&#20102;&#20154;&#20497;&#23565;&#20989;&#25976;&#30340;&#36861;&#27714; &#25110;&#32773;&#26356;&#26412;&#36074;&#22320;&#35498; &#26159;&#23565;&#35336;&#31639;&#30340;&#36861;&#27714;
       &#22240;&#29234;&#20760;&#31649;&#20989;&#25976;&#20006;&#19981;&#32317;&#26159;&#33021;&#29992;&#39023;&#24335;&#35336;&#31639;
       &#25110;&#26356;&#36914;&#19968;&#27493; &#39640;&#25928;&#22320;&#29992;&#39023;&#24335;&#35336;&#31639;
       &#20294;&#26159;&#19968;&#20491;&#38364;&#20418;&#26159;&#20989;&#25976;&#38364;&#20418;&#21487;&#33021;&#26263;&#31034;&#30528;&#36889;&#20491;&#38364;&#20418;&#30340;&#23452;&#35336;&#31639;&#24615;
     + &#36889;&#35023;&#8220;&#19981;&#21205;&#40670;&#8221;&#26159;&#19968;&#20491;&#25299;&#25778;&#23416;&#34899;&#35486; &#31934;&#30906;&#30340;&#35342;&#35542;&#38656;&#35201;&#26126;&#30906;&#19968;&#20491;&#25299;&#25778;&#32080;&#27083;
       &#20006;&#19988;&#32771;&#24942;&#31639;&#23376;&#30340;&#25910;&#25986;&#24615; &#19981;&#21205;&#40670;&#30340;&#23384;&#22312;&#24615;&#33287;&#21807;&#19968;&#24615; &#31561;&#31561;
     &#29992;&#20363;&#23376;&#20358;&#35299;&#37323;&#22914;&#19979;&#65306;
<span class="org-block-begin-line">     #+begin_src scheme
</span>     (<span class="keyword">define</span> <span class="function-name">^</span>
       (<span class="keyword">lambda</span> (x n)
         (<span class="keyword">cond</span> ((= n 0)
                1)
               (<span class="keyword">else</span>
                (* x (^ x (- n 1)))))))
     (<span class="keyword">define</span> <span class="function-name">F</span>
       (<span class="keyword">lambda</span> (g)
         (<span class="keyword">lambda</span> (x n)
           (<span class="keyword">cond</span> ((= n 0)
                  1)
                 (<span class="keyword">else</span>
                  (* x (g x (- n 1))))))))
<span class="org-block-end-line">     #+end_src
</span>     &#25226;^&#35722;&#29234;F
     &#32780;F&#21487;&#20197;&#34987;Y&#20316;&#29992;&#32780;&#24471;&#21040;^
     + &#21487;&#20197;&#36889;&#27171;&#20358;&#29702;&#35299;&#65306;
       F&#20013;g&#30340;&#31532;&#20108;&#27425;&#20986;&#29694;&#27161;&#20986;&#20102;^&#30340;&#20301;&#32622;
       &#32780;g&#30340;&#31532;&#19968;&#27425;&#20986;&#29694;&#34920;&#26126;&#36889;&#20491;&#20301;&#32622;&#23601;&#26159;&#34987;&#24490;&#29872;&#35519;&#29992;&#30340;&#20301;&#32622;
     &#26377;&#38480;&#27425;&#36845;&#20195;F&#23601;&#30332;&#29694;
     &#23565;&#26044;&#20219;&#24847;&#36215;&#22987;&#20989;&#25976;g
     F&#30340;N&#27425;&#36845;&#20195;&#23565;&#26044;&#25152;&#26377;x&#21644;&#23567;&#26044;N&#30340;n&#33287;^&#26377;&#30456;&#21516;&#30340;&#20540;
     &#25152;&#20197;&#22914;&#26524;&#29992;&#19968;&#20491;&#21487;&#20197;&#20316;&#28961;&#31406;&#24490;&#29872;&#30340;&#20989;&#25976;&#20358;&#36845;&#20195;F&#23601;&#21487;&#20197;&#29983;&#25104;^
     &#32771;&#24942;&#19979;&#38754;&#30340;&#29554;&#24471;&#28961;&#38480;&#24490;&#29872;&#30340;&#26041;&#24335;&#65306;
<span class="org-block-begin-line">     #+begin_src scheme
</span>     ((<span class="keyword">lambda</span> (x) (x x)) (<span class="keyword">lambda</span> (x) (x x)))
     (<span class="keyword">define</span> <span class="function-name">Y</span>
       (<span class="keyword">lambda</span> (f)
         ((<span class="keyword">lambda</span> (x) (f (x x)))
          (<span class="keyword">lambda</span> (x) (f (x x))))))
<span class="org-block-end-line">     #+end_src
</span>     (Y F)=(F (Y F))
     Y&#29234;&#20989;&#25976;&#31354;&#38291;&#20013;&#30340;&#31639;&#23376;
     &#20294;&#26159;&#36889;&#20491;&#20989;&#25976;&#27794;&#27861;&#34987;&#23526;&#38555;&#35519;&#29992; &#22240;&#29234;&#23427;&#30340;&#36958;&#27512;&#23652;&#27425;&#30340;&#21152;&#28145;&#19981;&#26371;&#20572;&#27490;
     &#35201;&#24819;&#23531;&#20986;&#21487;&#20197;&#34987;&#23526;&#38555;&#35519;&#29992;&#30340;Y&#23601;&#38656;&#35201;&#24456;&#22909;&#22320;&#29702;&#35299;&#35299;&#37323;&#22120;&#30340;&#35299;&#37323;&#26041;&#24335;
<span class="org-level-3">*** &#22238;&#21040;the little schemer</span>
    &#30446;&#30340;&#26159;&#23531;&#20986;&#19968;&#20491;&#21487;&#20197;&#22312;scheme&#20013;&#34987;&#23526;&#38555;&#35519;&#29992;&#30340;Ycombinator
    (&#39318;&#20808;&#35201;&#24324;&#28165;&#35299;&#37323;&#22120;&#30340;&#34892;&#29234;&#26041;&#24335;)
    &#19979;&#38754;&#29992;&#20841;&#20491;&#24179;&#34892;&#30340;&#20363;&#23376;&#20358;&#20316;&#35498;&#26126;
    &#20854;&#20013;&#31532;&#19968;&#20491;&#24456;&#23481;&#26131;&#22312;&#25105;&#23531;&#30340;&#35299;&#37323;&#22120;&#20013;&#34987;&#27714;&#20540;
    &#32780;&#35201;&#23565;&#31532;&#20108;&#20491;&#27714;&#20540;&#23601;&#38656;&#35201;&#20808;&#32102;&#25105;&#23531;&#30340;&#35299;&#37323;&#22120;&#22686;&#21152;&#38364;&#26044;&#25976;&#20540;&#35336;&#31639;&#30340;&#20839;&#24314;&#20989;&#25976;
<span class="org-level-4">**** &#29992;define&#23450;&#32681;&#19968;&#20491;&#36958;&#27512;&#20989;&#25976;&#65288;&#29992;set!&#23450;&#32681;&#30340;&#20063;&#26159;&#19968;&#27171;&#65289;</span>
<span class="org-block-begin-line">     #+begin_src scheme
</span>     (<span class="keyword">define</span> <span class="function-name">length</span>
       (<span class="keyword">lambda</span> (l)
         (<span class="keyword">cond</span> ((null? l)
                0)
               (<span class="keyword">else</span>
                (add1 (length (cdr l)))))))
     (<span class="keyword">define</span> <span class="function-name">^</span>
       (<span class="keyword">lambda</span> (x n)
         (<span class="keyword">cond</span> ((= n 0)
                1)
               (<span class="keyword">else</span>
                (* x (^ x (- n 1)))))))
<span class="org-block-end-line">     #+end_src
</span>     &#19979;&#38754;&#25105;&#20497;&#30340;&#30446;&#27161;&#23601;&#26159;&#19981;&#29992;define&#20358;&#23450;&#32681;&#36958;&#27512;&#20989;&#25976;
<span class="org-level-4">**** &#26377;&#38480;&#23652;&#36958;&#27512;&#20989;&#25976;</span>
     &#23565;&#26044;&#23567;&#30340;&#21443;&#25976;&#32102;&#20986;&#30340;&#32080;&#26524;&#33287;&#36958;&#27512;&#20989;&#25976;&#32102;&#20986;&#30340;&#32080;&#26524;&#30456;&#21516;
     <span class="bold">*&#27599;&#22686;&#21152;&#19968;&#23652;&#37117;&#35201;&#25226;&#20989;&#25976;&#30340;&#23450;&#32681;&#37325;&#26032;&#23531;&#19968;&#36941;*</span>
<span class="org-block-begin-line">     #+begin_src scheme
</span>     <span class="comment-delimiter">;</span><span class="comment">length0
</span>     (<span class="keyword">lambda</span> (l)
       (<span class="keyword">cond</span> ((null? l)
              0)
             (<span class="keyword">else</span>
              (add1 (eternity (cdr l))))))
     <span class="comment-delimiter">;</span><span class="comment">length1
</span>     (<span class="keyword">lambda</span> (l)
       (<span class="keyword">cond</span>
        ((null? l)
         0)
        (<span class="keyword">else</span>
         (add1 ((<span class="keyword">lambda</span> (l)
                  (<span class="keyword">cond</span>
                 ((null? l)
                  0)
                 (<span class="keyword">else</span>
                  (add1 (eternity (cdr l))))))
                (cdr l))))))
     <span class="comment-delimiter">;</span><span class="comment">length2
</span>     (<span class="keyword">lambda</span> (l)
       (<span class="keyword">cond</span>
        ((null? l)
         0)
        (<span class="keyword">else</span>
         (add1 ((<span class="keyword">lambda</span> (l)
                  (<span class="keyword">cond</span>
                   ((null? l)
                    0)
                   (<span class="keyword">else</span>
                    (add1 ((<span class="keyword">lambda</span> (l)
                             (<span class="keyword">cond</span>
                              ((null? l)
                               0)
                              (<span class="keyword">else</span>
                               (add1 (eternity (cdr l))))))
                           (cdr l))))))
                (cdr l))))))

     <span class="comment-delimiter">;</span><span class="comment">^0
</span>     (<span class="keyword">lambda</span> (x n)
       (<span class="keyword">cond</span> ((= n 0)
              1)
             (<span class="keyword">else</span>
              (* x (whatever x (- n 1))))))
     <span class="comment-delimiter">;</span><span class="comment">^1
</span>     (<span class="keyword">lambda</span> (x n)
       (<span class="keyword">cond</span> ((= n 0)
              1)
             (<span class="keyword">else</span>
              (* x ((<span class="keyword">lambda</span> (x n)
                      (<span class="keyword">cond</span> ((= n 0)
                             1)
                            (<span class="keyword">else</span>
                             (* x (whatever x (- n 1))))))
                    x (- n 1))))))
     <span class="comment-delimiter">;</span><span class="comment">^2
</span>     (<span class="keyword">lambda</span> (x n)
       (<span class="keyword">cond</span> ((= n 0)
              1)
             (<span class="keyword">else</span>
              (* x ((<span class="keyword">lambda</span> (x n)
                      (<span class="keyword">cond</span> ((= n 0)
                             1)
                            (<span class="keyword">else</span>
                             (* x ((<span class="keyword">lambda</span> (x n)
                                     (<span class="keyword">cond</span> ((= n 0)
                                            1)
                                           (<span class="keyword">else</span>
                                            (* x (whatever x (- n 1))))))
                                   x (- n 1))))))
                    x (- n 1))))))
<span class="org-block-end-line">     #+end_src
</span><span class="org-level-4">**** &#29992;&#31639;&#23376;L&#30340;&#36845;&#20195;&#20358;&#23531;&#26377;&#38480;&#23652;&#36958;&#27512;&#20989;&#25976;</span>
     &#31639;&#23376;&#25351; &#20197;procedure&#29234;&#21443;&#25976; &#20197;procedure&#29234;&#20540; &#30340;procedure
     <span class="bold">*&#27599;&#22686;&#21152;&#19968;&#23652;&#37117;&#35201;&#22810;&#23531;&#19968;&#20491;L*</span>
<span class="org-block-begin-line">     #+begin_src scheme
</span>     <span class="comment-delimiter">;</span><span class="comment">length0
</span>     ((<span class="keyword">lambda</span> (length)
        (<span class="keyword">lambda</span> (l)
          (<span class="keyword">cond</span> ((null? l)
                 0)
                (<span class="keyword">else</span>
                 (add1 (length (cdr l)))))))
      eternity)
     <span class="comment-delimiter">;</span><span class="comment">length1
</span>     ((<span class="keyword">lambda</span> (length)
        (<span class="keyword">lambda</span> (l)
          (<span class="keyword">cond</span> ((null? l)
                 0)
                (<span class="keyword">else</span>
                 (add1 (length (cdr l)))))))
      ((<span class="keyword">lambda</span> (length)
         (<span class="keyword">lambda</span> (l)
           (<span class="keyword">cond</span> ((null? l)
                  0)
                 (<span class="keyword">else</span>
                  (add1 (length (cdr l)))))))
       eternity))
     <span class="comment-delimiter">;</span><span class="comment">length2
</span>     ((<span class="keyword">lambda</span> (length)
        (<span class="keyword">lambda</span> (l)
          (<span class="keyword">cond</span> ((null? l)
                 0)
                (<span class="keyword">else</span>
                 (add1 (length (cdr l)))))))
      ((<span class="keyword">lambda</span> (length)
         (<span class="keyword">lambda</span> (l)
           (<span class="keyword">cond</span> ((null? l)
                  0)
                 (<span class="keyword">else</span>
                  (add1 (length (cdr l)))))))
       ((<span class="keyword">lambda</span> (length)
          (<span class="keyword">lambda</span> (l)
            (<span class="keyword">cond</span> ((null? l)
                   0)
                  (<span class="keyword">else</span>
                   (add1 (length (cdr l)))))))
        eternity)))

     <span class="comment-delimiter">;</span><span class="comment">^0
</span>     ((<span class="keyword">lambda</span> (g)
        (<span class="keyword">lambda</span> (x n)
          (<span class="keyword">cond</span> ((= n 0)
                 1)
                (<span class="keyword">else</span>
                 (* x (g x (- n 1)))))))
      eternity)
     <span class="comment-delimiter">;</span><span class="comment">^1
</span>     ((<span class="keyword">lambda</span> (g)
        (<span class="keyword">lambda</span> (x n)
          (<span class="keyword">cond</span> ((= n 0)
                 1)
                (<span class="keyword">else</span>
                 (* x (g x (- n 1)))))))
      ((<span class="keyword">lambda</span> (g)
        (<span class="keyword">lambda</span> (x n)
          (<span class="keyword">cond</span> ((= n 0)
                 1)
                (<span class="keyword">else</span>
                 (* x (g x (- n 1)))))))
       eternity))
     <span class="comment-delimiter">;</span><span class="comment">^2
</span>     ((<span class="keyword">lambda</span> (g)
        (<span class="keyword">lambda</span> (x n)
          (<span class="keyword">cond</span> ((= n 0)
                 1)
                (<span class="keyword">else</span>
                 (* x (g x (- n 1)))))))
      ((<span class="keyword">lambda</span> (g)
         (<span class="keyword">lambda</span> (x n)
          (<span class="keyword">cond</span> ((= n 0)
                 1)
                (<span class="keyword">else</span>
                 (* x (g x (- n 1)))))))
       ((<span class="keyword">lambda</span> (g)
          (<span class="keyword">lambda</span> (x n)
            (<span class="keyword">cond</span> ((= n 0)
                   1)
                  (<span class="keyword">else</span>
                   (* x (g x (- n 1)))))))
        eternity)))
<span class="org-block-end-line">     #+end_src
</span><span class="org-level-4">**** &#29992;&#20316;&#29992;&#26044;&#31639;&#23376;L&#30340;procedure &#20358;&#36845;&#20195;&#31639;&#23376;L &#20197;&#24471;&#21040;&#26377;&#38480;&#23652;&#36958;&#27512;&#20989;&#25976;</span>
     <span class="bold">*&#27599;&#22686;&#21152;&#19968;&#23652;&#37117;&#35201;&#37325;&#26032;&#23531;&#19968;&#20491;&#29992;&#20316;&#29992;&#26044;&#31639;&#23376;L&#30340;procedure*</span>
<span class="org-block-begin-line">     #+begin_src scheme
</span>     <span class="comment-delimiter">;</span><span class="comment">length0
</span>     ((<span class="keyword">lambda</span> (mk-length)
        (mk-length eternity))
      (<span class="keyword">lambda</span> (length)
        (<span class="keyword">lambda</span> (l)
          (<span class="keyword">cond</span> ((null? l)
                 0)
                (<span class="keyword">else</span>
                 (add1 (length (cdr l))))))))
     <span class="comment-delimiter">;</span><span class="comment">length1
</span>     ((<span class="keyword">lambda</span> (mk-length)
        (mk-length
         (mk-length eternity)))
      (<span class="keyword">lambda</span> (length)
        (<span class="keyword">lambda</span> (l)
          (<span class="keyword">cond</span> ((null? l)
                 0)
                (<span class="keyword">else</span>
                 (add1 (length (cdr l))))))))
     <span class="comment-delimiter">;</span><span class="comment">length2
</span>     ((<span class="keyword">lambda</span> (mk-length)
        (mk-length
         (mk-length
          (mk-length eternity))))
      (<span class="keyword">lambda</span> (length)
        (<span class="keyword">lambda</span> (l)
          (<span class="keyword">cond</span> ((null? l)
                 0)
                (<span class="keyword">else</span>
                 (add1 (length (cdr l))))))))
     <span class="comment-delimiter">;</span><span class="comment">^0
</span>     ((<span class="keyword">lambda</span> (mk^)
        (mk^ eternity))
      (<span class="keyword">lambda</span> (x n)
        (<span class="keyword">cond</span> ((= n 0)
               1)
              (<span class="keyword">else</span>
               (* x (g x (- n 1)))))))
     <span class="comment-delimiter">;</span><span class="comment">^1
</span>     ((<span class="keyword">lambda</span> (mk^)
        (mk^
         (mk^ eternity)))
      (<span class="keyword">lambda</span> (x n)
        (<span class="keyword">cond</span> ((= n 0)
               1)
              (<span class="keyword">else</span>
               (* x (g x (- n 1)))))))
     <span class="comment-delimiter">;</span><span class="comment">^2
</span>     ((<span class="keyword">lambda</span> (mk^)
        (mk^
         (mk^
          (mk^ eternity))))
      (<span class="keyword">lambda</span> (x n)
        (<span class="keyword">cond</span> ((= n 0)
               1)
              (<span class="keyword">else</span>
               (* x (g x (- n 1)))))))
<span class="org-block-end-line">     #+end_src
</span><span class="org-level-4">**** ``all names are equal, but some names are more equal than others.''</span>
     &#26356;&#25563;&#21629;&#21517;&#24460;
     &#19979;&#38754;&#36889;&#20491;&#36996;&#21487;&#20197;&#20316;&#29234;length0
<span class="org-block-begin-line">     #+begin_src scheme
</span>     ((<span class="keyword">lambda</span> (mk-length)
        (mk-length mk-length))
      (<span class="keyword">lambda</span> (mk-length)
        (<span class="keyword">lambda</span> (l)
          (<span class="keyword">cond</span> ((null? l)
                 0)
                (<span class="keyword">else</span>
                 (add1 (mk-length (cdr l))))))))
     (<span class="keyword">define</span> <span class="function-name">length0</span>
       ((<span class="keyword">lambda</span> (mk-length)
          (mk-length mk-length))
        (<span class="keyword">lambda</span> (mk-length)
          (<span class="keyword">lambda</span> (l)
            (<span class="keyword">cond</span> ((null? l)
                   0)
                  (<span class="keyword">else</span>
                   (add1 (mk-length (cdr l)))))))))
     (length0 '())
     (length0 '(1))
<span class="org-block-end-line">     #+end_src
</span>     &#19979;&#38754;&#36889;&#20491;&#20063;&#21487;&#20197;&#20316;&#29234;length1
     &#20006;&#19988;&#25105;&#20497;&#30693;&#36947;&#23565;&#26044;&#38263;&#24230;&#22823;&#26044;1&#30340;l
     (eternity eternity)&#26371;&#34987;&#27714;&#20540; &#28982;&#24460;&#20316;&#29992;&#26044;(cddr l) &#28982;&#24460;&#34987;add1&#20316;&#29992;
     &#25152;&#20197;&#25105;&#23601;&#21487;&#20197;&#20351;&#24471;(eternity eternity)&#34987;&#27714;&#20540;&#30340;&#26178;&#20505;&#36339;&#20986;&#20358;&#21644;&#25105;&#29609;
<span class="org-block-begin-line">     #+begin_src scheme
</span>     ((<span class="keyword">lambda</span> (mk-length)
        (mk-length mk-length))
      (<span class="keyword">lambda</span> (mk-length)
        (<span class="keyword">lambda</span> (l)
          (<span class="keyword">cond</span> ((null? l)
                 0)
                (<span class="keyword">else</span>
                 (add1 ((mk-length eternity) (cdr l))))))))
     (<span class="keyword">define</span> <span class="function-name">length1</span>
       ((<span class="keyword">lambda</span> (mk-length)
          (mk-length mk-length))
        (<span class="keyword">lambda</span> (mk-length)
          (<span class="keyword">lambda</span> (l)
            (<span class="keyword">cond</span> ((null? l)
                   0)
                  (<span class="keyword">else</span>
                   (add1 ((mk-length eternity) (cdr l)))))))))
     (<span class="keyword">define</span> <span class="function-name">eternity</span>)
     (<span class="keyword">define</span> <span class="function-name">i-want-to-play-with-length1</span>
       (<span class="keyword">lambda</span> ()
         ((<span class="keyword">lambda</span> (k)
            (<span class="keyword">cond</span> ((string? k)
                   (<span class="keyword">begin</span>
                     (display k)
                     (newline)))
                  ((procedure? k)
                   (<span class="keyword">begin</span> (display <span class="string">"&#31528;length1~~~"</span>)
                          (newline)
                          (display <span class="string">"&#30896;&#21040;&#20102;&#38263;&#24230;&#36229;&#36942;1&#30340;list&#20182;&#23601;&#34389;&#29702;&#19981;&#20102;&#20102;&#65281;"</span>)
                          (newline)))
                  (<span class="keyword">else</span>
                   (<span class="keyword">begin</span> (display <span class="string">"nothing-else"</span>)
                          (newline)))))
          (<span class="keyword">letcc</span> play-with-me
                 (<span class="keyword">set!</span> eternity play-with-me)
                 <span class="string">"ready to play with length1, haha."</span>))))
     (i-want-to-play-with-length1)
     (eternity '())
     (length1 '())
     (length1 '(1))
     (length1 '(1 2))
<span class="org-block-end-line">     #+end_src
</span><span class="org-level-4">**** ``all names are equal, but some names are more equal than others.''</span>
     <span class="bold">*&#26368;&#24460;&#32066;&#26044;&#24471;&#21040;&#20102;&#36958;&#27512;&#20989;&#25976;length*</span>
<span class="org-block-begin-line">     #+begin_src scheme
</span>     ((<span class="keyword">lambda</span> (mk-length)
        (mk-length mk-length))
      (<span class="keyword">lambda</span> (mk-length)
        (<span class="keyword">lambda</span> (l)
          (<span class="keyword">cond</span> ((null? l)
                 0)
                (<span class="keyword">else</span>
                 (add1 ((mk-length mk-length) (cdr l))))))))
     (<span class="keyword">define</span> <span class="function-name">length</span>
       ((<span class="keyword">lambda</span> (mk-length)
          (mk-length mk-length))
        (<span class="keyword">lambda</span> (mk-length)
          (<span class="keyword">lambda</span> (l)
            (<span class="keyword">cond</span> ((null? l)
                   0)
                  (<span class="keyword">else</span>
                   (add1 ((mk-length mk-length) (cdr l)))))))))
     (length '(1 2 3 4 5 6 7 8 9 10))
<span class="org-block-end-line">     #+end_src
</span>     &#36889;&#26159;
     L*&#26159;L&#30340;&#35722;&#24418; &#36889;&#20491;&#35722;&#24418;&#22312;&#26044;&#25226;L&#30340;recursion&#24478;L&#35722;&#29234;(L L)
     &#35352;&#36889;&#20491;&#35722;&#24418;&#30340;&#32080;&#26524;&#29234;L*
     L*&#23601;&#26159;&#25105;&#20497;&#25152;&#21521;&#24448;&#30340;&#26481;&#35199; &#23427;&#20316;&#29992;&#26044;&#33258;&#36523;&#23601;&#24471;&#21040;&#36958;&#27512;&#20989;&#25976;
     (L* L*)&#23601;&#26159;length
     (lambda (mk-length) (mk-length mk-length))&#21482;&#26159;&#31777;&#21934;&#22320;&#20316;&#29992;&#26044;L*&#32780;&#24471;&#21040;(L* L*)&#32780;&#24050;
     &#32780;(L* L*)&#26371;&#32102;&#20986;&#19968;&#20491;closure
     &#31281;&#29234;&lt;closure-of-length&gt;
     <span class="bold">*&#36889;&#20491;&#23601;&#26159;&#36958;&#27512;&#20989;&#25976;length*</span>
     &#30070;&#20659;&#20837;&#21443;&#25976;l&#30340;&#26159;&#38750;&#31354;list&#32780;&#38656;&#35201;&#36958;&#27512;&#26178;
     &#22312;recursion&#20301;&#32622; &#23601;&#26371;&#29992;(L* L*)&#20877;&#36896;&#20986;&#19968;&#20491;&lt;closure-of-length&gt;
     &#32780;&#20659;&#20837;&#36889;&#20491;&lt;closure-of-length&gt;&#30340;&#21443;&#25976;&#23601;&#26159;(car l)&#30340;&#20540;&#20102;
     + &#19979;&#19968;&#31680;&#24819;&#35201;&#25552;&#21462;&#20986;L&#26178;&#25152;&#29359;&#30340;&#37679;&#35492;&#24375;&#35519;&#20102;&#19979;&#38754;&#36889;&#19968;&#40670;&#65306;
       &#24517;&#38920;&#26159;&#30070;&#38656;&#35201;&#36958;&#27512;&#26178;&#25165;&#29992;(L* L*)&#36896;&#20986;&#19968;&#20491;&lt;closure-of-length&gt;
       &#36889;&#20491;&#29305;&#24615;&#26159;&#21487;&#20197;&#23526;&#29694;&#30340;
       &#24478;&#19979;&#38754;&#30340;&#34920;&#26684;&#20013;&#21487;&#20197;&#30475;&#21040;
       &#30070;&lt;closure-of-length&gt; action&#26178;
       &lt;body&gt;&#23601;&#22312;&#25844;&#23637;&#24460;&#30340;&lt;environment&gt;&#19979;&#29992;meaning&#21839;&#33258;&#24049;&#23384;&#22312;&#30340;&#24847;&#32681;&#26159;&#20160;&#40636;
       &#28982;&#24460;&#22914;&#26524;&#19981;&#38656;&#35201;&#36958;&#27512;
       &lt;closure-of-L*&gt;&#23601;&#23433;&#23433;&#38748;&#38748;&#30340;&#21574;&#22312;&#21517;&#23383;&lt;environment&gt;&#20013;mk-length&#30340;&#24460;&#38754;
<span class="org-block-begin-line">     #+begin_src scheme
</span>     ------------------------------------------------
     <span class="type">&lt;closure-of-length&gt;</span>
     ------------------------------------------------
     <span class="type">&lt;environment&gt;</span>
     (((mk-length) (<span class="type">&lt;closure-of-L*&gt;</span>))
      ...)
     <span class="type">&lt;formals&gt;</span>
     (l)
     <span class="type">&lt;body&gt;</span>
     (<span class="keyword">cond</span> ((null? l)
            0)
           (<span class="keyword">else</span>
            (add1 ((mk-length mk-length) (cdr l)))))
     -------------------------------------------------
     -------------------------------------------------
     <span class="type">&lt;closure-of-L*&gt;</span>
     -------------------------------------------------
     <span class="type">&lt;environment&gt;</span>
     (...)
     <span class="type">&lt;formals&gt;</span>
     (mk-length)
     <span class="type">&lt;body&gt;</span>
     (<span class="keyword">lambda</span> (l)
       (<span class="keyword">cond</span> ((null? l)
              0)
             (<span class="keyword">else</span>
              (add1 ((mk-length mk-length) (cdr l))))))
     --------------------------------------------------
<span class="org-block-end-line">     #+end_src
</span><span class="org-level-4">**** to extract a value and give it a name</span>
     for to get back the function that looks like length
<span class="org-level-5">***** &#21487;&#24597;&#30340;&#37679;&#35492;</span>
      &#29694;&#22312;&#26082;&#28982;&#24050;&#32147;&#30693;&#36947;&#35442;&#22914;&#20309;&#24471;&#21040;&#36958;&#27512;&#20989;&#25976;length&#20102;
      &#37027;&#40636;&#23601;&#35442;&#32771;&#24942;&#22914;&#20309;&#24471;&#21040;&#36889;&#20491;&#33021;&#24471;&#21040;&#36958;&#27512;&#20989;&#25976;length&#30340;&#34920;&#36948;&#24335;&#20102;
      &#21363; &#24819;&#35201;&#27714;&#19968;&#20491;procedure &#31281;&#29234;Y
      &#23427;&#20316;&#29992;&#26044;L&#26371;&#24471;&#21040;&#36958;&#27512;&#20989;&#25976;length
      &#20006;&#19988;&#36889;&#20491;L&#21487;&#20197;&#26159;&#20854;&#20182;&#39006;&#20284;&#26044;L&#30340;&#29992;&#20358;&#23450;&#32681;&#21934;&#35722;&#37327;&#36958;&#27512;&#20989;&#25976;&#30340;&#31639;&#23376;
      &#39318;&#20808;&#25033;&#35442;&#35731;&#19978;&#38754;&#30340;&#21487;&#20197;&#24471;&#21040;&#36958;&#27512;&#20989;&#25976;length&#30340;&#34920;&#36948;&#24335;&#20013;&#20986;&#29694;&#31639;&#23376;L
      &#25563;&#19968;&#31278;&#21839;&#27861;
      &#22914;&#20309;&#24478;L&#24471;&#21040;L*&#21602;&#65311;
      + &#27880;&#24847; &#22240;&#29234;&#26159;&#34987;(lambda (mk-length) (mk-length mk-length))&#20316;&#29992;
        &#25152;&#20197;&#19979;&#38754;L*&#30340;&#21443;&#25976;mk-length&#25152;&#25509;&#21463;&#30340;&#20540;&#23559;&#32317;&#26159;L*&#26412;&#36523;
      + &#21487;&#20197;&#30332;&#29694;&#38614;&#28982;let&#26159;&#35486;&#32681;&#28165;&#26224;&#30340;&#35486;&#27861;&#31958;
        &#20294;&#26159;&#21371;&#19981;&#33021;&#23436;&#25104;&#25226;L&#25552;&#21462;&#20986;&#20358;&#30340;&#20219;&#21209;
        &#25152;&#20197;&#36996;&#26159;&#24471;&#22238;&#21040;lambda&#34920;&#36948;&#24335;
      &#21482;&#35201;&#25226;L*&#20013;&#30340;(mk-length mk-length)&#37096;&#20998;
      &#30070;&#20316;&#26159;&#24478;L&#30340;recursion&#20301;&#32622;&#30340;length&#20195;&#25563;&#32780;&#20358;&#30340;&#23601;&#34892;&#20102;&#21966;&#65311;
      &#25226;(mk-length mk-length)&#30340;&#20540;&#20659;&#20837;L&#30340;&#21443;&#25976;&#23601;&#34892;&#20102;&#21966;&#65311;
      &#36889;&#23601;&#29359;&#20102;&#19968;&#20491;&#21487;&#24597;&#30340;&#35731;&#27231;&#22120;&#23849;&#28528;&#30340;&#37679;&#35492;&#65281;&#65281;&#65281;
      + &#22240;&#29234;(mk-length mk-length)&#30340;&#20540;&#24517;&#38920;&#35201;&#31561;&#21040;&#38656;&#35201;&#36958;&#27512;&#35519;&#29992;&#30340;&#26178;&#20505;&#20877;&#27714;&#25165;&#34892;
        &#21542;&#21063;&#23601;&#27794;&#23436;&#27794;&#20102;&#38519;&#20837;&#20102;&#24490;&#29872;
        &#22240;&#29234;&#22312;&#27714;&#20540;(mk-length mk-length)&#23565;l&#30340;&#20316;&#29992;&#30340;&#26178;&#20505;
        &#39318;&#20808;&#35201;&#27714;&#20540;(mk-length mk-length)
        &#32780;&#27714;&#20540;(mk-length mk-length)&#30340;&#26178;&#20505;
        &#39340;&#19978;&#23601;&#38656;&#35201;&#27714;&#20540;&#21516;&#27171;&#30340;(mk-length mk-length)
        &gt;&lt;&#36986;&#22833;&#30340;show&#20989;&#25976;&#26159;&#19981;&#26159;&#21487;&#20197;&#25506;&#28204;&#36889;&#31278;&#24490;&#29872;&#65311;
      <span class="bold">*&#21315;&#33836;&#19981;&#35201;&#22519;&#34892;&#19979;&#38754;&#30340;&#20195;&#30908;&#22602;&#20013;&#30340;&#20219;&#20309;&#34920;&#36948;&#24335;*</span>
      &gt;&lt; org-babel&#22914;&#20309;&#38480;&#21046;&#21487;&#22519;&#34892;&#24615;&#21602;&#65311;
<span class="org-block-begin-line">      #+begin_src scheme
</span>      (<span class="keyword">lambda</span> (mk-length)
         (<span class="keyword">lambda</span> (l)
           (<span class="keyword">cond</span> ((null? l)
                  0)
                 (<span class="keyword">else</span>
                  (add1 ((mk-length mk-length) (cdr l)))))))
      =/={&#36889;&#35023;&#19978;&#19979;&#20841;&#20491;&#34920;&#31034;&#26159;&#19981;&#30456;&#31561;&#30340; &#19978;&#38754;&#30340;&#26159;&#23565;&#30340; &#19979;&#38754;&#30340;&#26159;&#37679;&#30340;}
      (<span class="keyword">lambda</span> (mk-length)
       (<span class="keyword">let</span> ((length (mk-length mk-length)))
         (<span class="keyword">cond</span> ((null? l)
                0)
               (<span class="keyword">else</span>
                (add1 (length (cdr l)))))))
      ==
      (<span class="keyword">lambda</span> (mk-length)
        ((<span class="keyword">lambda</span> (length)
           (<span class="keyword">lambda</span> (l)
             (<span class="keyword">cond</span> ((null? l)
                    0)
                   (<span class="keyword">else</span>
                    (add1 (length (cdr l)))))))
         (mk-length mk-length)))

      &#37679;&#30340;length&#65306;
      ((<span class="keyword">lambda</span> (mk-length)
         (mk-length mk-length))
       (<span class="keyword">lambda</span> (mk-length)
         ((<span class="keyword">lambda</span> (length)
            (<span class="keyword">lambda</span> (l)
              (<span class="keyword">cond</span> ((null? l)
                     0)
                    (<span class="keyword">else</span>
                     (add1 (length (cdr l)))))))
          (mk-length mk-length))))

      &#37679;&#30340;length&#65306;
      ((<span class="keyword">lambda</span> (mk-length)
         (mk-length mk-length))
       (<span class="keyword">lambda</span> (mk-length)
         (L (mk-length mk-length))))
      (<span class="keyword">define</span> <span class="function-name">L</span>
        (<span class="keyword">lambda</span> (length)
          (<span class="keyword">lambda</span> (l)
            (<span class="keyword">cond</span> ((null? l)
                   0)
                  (<span class="keyword">else</span>
                   (add1 (length (cdr l))))))))

      &#36889;&#27171;&#23531;&#20986;&#20358;&#30340;&#37679;&#30340;Y&#22914;&#19979;&#65306;
      (<span class="keyword">define</span> <span class="function-name">Y</span>
        (<span class="keyword">lambda</span> (F)
          ((<span class="keyword">lambda</span> (f) (f f))
           (<span class="keyword">lambda</span> (f) (F (f f))))))
<span class="org-block-end-line">      #+end_src
</span><span class="org-level-5">***** &#27491;&#30906;&#30340;&#26481;&#35199;</span>
      &#37027;&#40636; &#22914;&#20309;&#27491;&#30906;&#22320;&#24478;L&#24471;&#21040;L*&#21602;&#65311;
      &#21482;&#35201;&#25226;(mk-length mk-length)&#25918;&#21040;lambda&#34920;&#36948;&#24335;&#20013;&#20445;&#35703;&#36215;&#20358;&#22914;&#19979;
      (lambda (x) ((mk-length mk-length) x))
      &#28982;&#24460;&#20877;&#20659;&#20837;L&#30340;&#21443;&#25976;length
      &#20659;&#20837;&#26178;lambda&#34920;&#36948;&#24335;&#26371;&#34987;&#27714;&#20540;&#25104;&#29234;closure
      &#36889;&#27171;((mk-length mk-length) x)&#20316;&#29234;closure&#30340;body&#21482;&#26377;&#34987;&#35519;&#29992;&#30340;&#26178;&#20505;&#32404;&#26371;&#34987;&#27714;&#20540;
      &#19979;&#38754;&#30340;&#20195;&#30908;&#22602;&#20013;
      &#31532;1&#20491;&#31561;&#34399;&#34920;&#31034;&#31561;&#34399;&#19979;&#38754;&#30340;&#26481;&#35199;&#33287;L*&#30340;&#25928;&#26524;&#30456;&#21516;&#65288;&#20173;&#28982;&#31281;&#20043;&#29234;L*&#65289;
      &#31532;2&#20491;&#31561;&#34399;&#34920;&#31034;&#31561;&#34399;&#19978;&#38754;&#30340;&#26481;&#35199;&#26159;&#31561;&#34399;&#19979;&#38754;&#30340;&#26481;&#35199;&#30340;&#35486;&#27861;&#31958;
      &#20043;&#24460;&#30340;&#26481;&#35199;&#23601;&#26159;&#25226;Y&#23531;&#20986;&#20358;&#30340;&#31777;&#21934;&#36942;&#31243;
      + &#38614;&#28982;&#25105;&#30340;&#30446;&#30340;&#22909;&#20687;&#26159;&#19981;&#20351;&#29992;define
        &#20294;&#26159;&#29234;&#20102;&#28165;&#26224;&#24615;&#25105;&#36996;&#26159;&#23450;&#32681;&#20986;L&#20358;
<span class="org-block-begin-line">      #+begin_src scheme
</span>      <span class="comment-delimiter">;</span><span class="comment">L*
</span>      (<span class="keyword">lambda</span> (mk-length)
        (<span class="keyword">lambda</span> (l)
          (<span class="keyword">cond</span> ((null? l)
                 0)
                (<span class="keyword">else</span>
                 (add1 ((mk-length mk-length) (cdr l)))))))
      <span class="comment-delimiter">;</span><span class="comment">==
</span>      (<span class="keyword">lambda</span> (mk-length)
        (<span class="keyword">let</span> ((length (<span class="keyword">lambda</span> (x) ((mk-length mk-length) x))))
          (<span class="keyword">lambda</span> (l)
            (<span class="keyword">cond</span> ((null? l)
                   0)
                  (<span class="keyword">else</span>
                   (add1 (length (cdr l))))))))
      <span class="comment-delimiter">;</span><span class="comment">==
</span>      (<span class="keyword">lambda</span> (mk-length)
        ((<span class="keyword">lambda</span> (length)
           (<span class="keyword">lambda</span> (l)
             (<span class="keyword">cond</span> ((null? l)
                    0)
                   (<span class="keyword">else</span>
                    (add1 (length (cdr l)))))))
         (<span class="keyword">lambda</span> (x) ((mk-length mk-length) x))))
      <span class="comment-delimiter">;</span><span class="comment">----------------------------------------------
</span>      <span class="comment-delimiter">;</span><span class="comment">this is length
</span>      ((<span class="keyword">lambda</span> (mk-length)
         (mk-length mk-length))
       (<span class="keyword">lambda</span> (mk-length)
         ((<span class="keyword">lambda</span> (length)
            (<span class="keyword">lambda</span> (l)
              (<span class="keyword">cond</span> ((null? l)
                     0)
                    (<span class="keyword">else</span>
                     (add1 (length (cdr l)))))))
          (<span class="keyword">lambda</span> (x) ((mk-length mk-length) x)))))
      <span class="comment-delimiter">;</span><span class="comment">----------------------------------------------
</span>      <span class="comment-delimiter">;</span><span class="comment">this is length
</span>      ((<span class="keyword">lambda</span> (mk-length)
         (<span class="keyword">lambda</span> (l)
           (<span class="keyword">cond</span> ((null? l)
                  0)
                 (<span class="keyword">else</span>
                  (add1 ((mk-length mk-length) (cdr l)))))))
       (<span class="keyword">lambda</span> (mk-length)
         (<span class="keyword">lambda</span> (l)
           (<span class="keyword">cond</span> ((null? l)
                  0)
                 (<span class="keyword">else</span>
                  (add1 ((mk-length mk-length) (cdr l))))))))
      <span class="comment-delimiter">;</span><span class="comment">don't believe me?
</span>      (((<span class="keyword">lambda</span> (mk-length)
          (<span class="keyword">lambda</span> (l)
            (<span class="keyword">cond</span> ((null? l)
                   0)
                  (<span class="keyword">else</span>
                   (add1 ((mk-length mk-length) (cdr l)))))))
        (<span class="keyword">lambda</span> (mk-length)
          (<span class="keyword">lambda</span> (l)
            (<span class="keyword">cond</span> ((null? l)
                   0)
                  (<span class="keyword">else</span>
                   (add1 ((mk-length mk-length) (cdr l))))))))
       '(1 2 3 4 5 6 7 8 9 10))
      <span class="comment-delimiter">;</span><span class="comment">----------------------------------------------
</span>      (<span class="keyword">define</span> <span class="function-name">L</span>
        (<span class="keyword">lambda</span> (length)
          (<span class="keyword">lambda</span> (l)
            (<span class="keyword">cond</span> ((null? l)
                   0)
                  (<span class="keyword">else</span>
                   (add1 (length (cdr l))))))))
      ((<span class="keyword">lambda</span> (mk-length)
         (mk-length mk-length))
       (<span class="keyword">lambda</span> (mk-length)
         (L
          (<span class="keyword">lambda</span> (x) ((mk-length mk-length) x)))))
      <span class="comment-delimiter">;</span><span class="comment">---------------------------------------------
</span>      <span class="comment-delimiter">;</span><span class="comment">most clear version
</span>      (<span class="keyword">define</span> <span class="function-name">Y</span>
        (<span class="keyword">lambda</span> (F)
          (<span class="keyword">let</span> ((F* (Y-help F)))
            (F* F*))))
      (<span class="keyword">define</span> <span class="function-name">Y-help</span>
        (<span class="keyword">lambda</span> (F)
          (<span class="keyword">lambda</span> (F*)
            (F (<span class="keyword">lambda</span> (x) ((F* F*) x))))))
      <span class="comment-delimiter">;</span><span class="comment">---------------------------------------------
</span>      (<span class="keyword">define</span> <span class="function-name">Y</span>
        (<span class="keyword">lambda</span> (F)
          ((<span class="keyword">lambda</span> (F*) (F (<span class="keyword">lambda</span> (x) ((F* F*) x))))
           (<span class="keyword">lambda</span> (F*) (F (<span class="keyword">lambda</span> (x) ((F* F*) x)))))))
      (<span class="keyword">define</span> <span class="function-name">Y</span>
        (<span class="keyword">lambda</span> (F)
          (<span class="keyword">let</span> ((F* (<span class="keyword">lambda</span> (F*) (F (<span class="keyword">lambda</span> (x) ((F* F*) x))))))
            (F* F*))))
      <span class="comment-delimiter">;</span><span class="comment">---------------------------------------------
</span>      <span class="comment-delimiter">;</span><span class="comment">most simple version
</span>      (<span class="keyword">define</span> <span class="function-name">Y</span>
        (<span class="keyword">lambda</span> (F)
          ((<span class="keyword">lambda</span> (F*) (F* F*))
           (<span class="keyword">lambda</span> (F*) (F (<span class="keyword">lambda</span> (x) ((F* F*) x)))))))
      <span class="comment-delimiter">;</span><span class="comment">---------------------------------------------
</span>      (<span class="keyword">define</span> <span class="function-name">length</span>

        (Y (<span class="keyword">lambda</span> (length)
             (<span class="keyword">lambda</span> (l)
               (<span class="keyword">cond</span> ((null? l)
                      0)
                     (<span class="keyword">else</span>
                      (add1 (length (cdr l))))))))


        )
      (length '(1 2 3 4 5 6 7 8 9 10))


      ((Y (<span class="keyword">lambda</span> (length)
            (<span class="keyword">lambda</span> (l)
              (<span class="keyword">cond</span> ((null? l)
                     0)
                    (<span class="keyword">else</span>
                     (add1 (length (cdr l))))))))

       '(1 2 3 4 5 6 7 8 9 10))
<span class="org-block-end-line">      #+end_src
</span><span class="org-level-1">* 10 what is the value of all this? (interpreter)</span>
<span class="org-level-2">** </span><span class="org-todo">note</span>
   &#24505;&#24213;&#24324;&#28165;&#26576;&#20123;&#26481;&#35199;&#30340;&#26368;&#22909;&#26041;&#27861;&#23601;&#26159;&#23526;&#29694;&#23427;&#20497;
   &#22240;&#29234;&#30070;&#19968;&#20491;&#20154;&#35299;&#37323;&#19968;&#20491;&#34987;&#20182;&#23526;&#29694;&#20102;&#30340;&#26481;&#35199; &#32780;&#19981;&#35498;&#26126;&#20182;&#26159;&#22914;&#20309;&#23526;&#29694;&#23427;&#30340;&#26178;&#20505;
   &#20182;&#26159;&#22312;&#33945;&#30528;&#20320;&#30340;&#30524;&#30555;&#32102;&#20320;&#25551;&#36848;&#19968;&#24133;&#30059;

   &#36889;&#35023;&#8220;&#23531;&#20986;&#19968;&#20491;scheme&#35299;&#37323;&#22120;&#8221;&#26159;&#25351;&#23531;&#20986;&#19968;&#20491;value&#20989;&#25976;
   &#22312;&#20803;&#35299;&#37323;&#22120;&#20013;&#20197;&#22914;&#19979;&#26041;&#24335;&#35519;&#29992;value&#20989;&#25976;&#65306;&#65288;&#21512;&#27861;&#36664;&#20837;&#35352;&#29234;&lt;sexp&gt;&#65289;
   &gt; (value '&lt;sexp&gt;)
   1. &#22240;&#29234;&#23565;&#26044;&#19981;&#21516;&lt;sexp&gt;&#20989;&#25976;value&#26377;&#19981;&#21516;&#30340;&#20316;&#29992;&#26041;&#24335;
      &#25152;&#20197;&#38656;&#35201;&#20998;&#39006; &#20877;&#25353;&#39006;&#22411;&#27714;&#20540;
      &#29702;&#24819;&#30340;&#34389;&#29702;&#26159;&#35731;&#20998;&#39006;&#26041;&#24335;&#28165;&#26224;&#22320;&#34920;&#36948;&#20986;&#36889;&#31278;&#20316;&#29992;&#26041;&#24335;&#19978;&#30340;&#19981;&#21516;
   2. &#35264;&#24565;&#19978; &#38656;&#35201;&#22196;&#26684;&#21312;&#20998;&#35299;&#37323;&#21069;&#30340;&lt;sexp&gt;&#33287;&#35299;&#37323;&#24460;&#30340;&lt;sexp&gt;
      &#21363;&#20316;&#29234;&#36664;&#20837;&#30340;&lt;sexp&gt;&#33287;&#20316;&#29234;&#36664;&#20986;&#30340;&lt;sexp&gt;
   3. &#29234;&#20102;&#33021;&#22816;&#22312;&#20803;&#35299;&#37323;&#22120;&#20013;&#36958;&#27512;&#22320;&#34389;&#29702;&lt;sexp&gt;
      &#39318;&#20808;&#38656;&#35201;&#20998;&#29234;&lt;atom&gt;&#33287;&lt;list&gt;&#20841;&#39006;
      + &#22240;&#29234;&#25105;&#30340;&#35299;&#37323;&#22120;&#20013;&#30340;&lt;sexp&gt;
        &#23565;&#20803;&#35299;&#37323;&#22120;&#20358;&#35498;&#26159;&lt;*sexp*&gt;
        &#36958;&#27512;&#22320;&#22312;&#20803;&#35299;&#37323;&#22120;&#20013;&#34389;&#29702;&lt;*sexp*&gt;&#35201;&#36981;&#24478;&#21069;&#38754;&#30340;&#35489;&#24459;
      &#20006;&#19988;&#35201;&#21312;&#20998;&lt;list&gt;&#26159;&#21542;&#26159;null
      &#36996;&#26377;&lt;list&gt;&#30340;car&#26159;&#21542;&#26159;&lt;atom&gt;
      &#21516;&#26178;&#36889;&#20123;&#20063;&#21312;&#20998;&#20102;value&#30340;&#20316;&#29992;&#26041;&#24335;
      &#32780;&#20043;&#24460;&#30340;&#26356;&#32048;&#30340;&#20998;&#39006;&#26356;&#26159;&#25353;value&#30340;&#20316;&#29992;&#26041;&#24335;&#30340;&#20998;&#39006;
      + &#22240;&#27492;&#36889;&#35023;&#30340;&lt;atom&gt;&#25351;&#20803;&#35299;&#37323;&#22120;&#20013;&#30340;&#35586;&#35422;``atom?''&#19979;&#30340;&#26481;&#35199;
        &#32780;&#25105;&#30340;&#35299;&#37323;&#22120;&#20013;&#30340;&#35586;&#35422;``atom?''
        &#38656;&#35201;&#29992;&#20803;&#35299;&#37323;&#22120;&#20013;&#30340;&#35586;&#35422;``:atom?''&#20358;&#29305;&#27530;&#34389;&#29702;
   ``it is necessary for a scheme implementation to distinguish
   between core forms and syntactic extensions
   a scheme implementation expands syntactic extensions into core forms
   as the first step of compilation or interpretation
   allowing the rest of the compiler or interpreter
   to focus only on the core forms''
   --kent dybvig
<span class="org-meta-line">   #+name: &lt;&lt;&#20998;&#39006;&gt;&gt;</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   <span class="type">&lt;sexp&gt;</span> <span class="builtin">::=</span> <span class="type">&lt;atom&gt;</span> | <span class="type">&lt;list&gt;</span>

     <span class="type">&lt;atom&gt;</span> <span class="builtin">::=</span> <span class="type">&lt;const&gt;</span> | <span class="type">&lt;identifer&gt;</span>
       <span class="type">&lt;const&gt;</span> <span class="builtin">::=</span> <span class="type">&lt;name-of-primitive-procedure&gt;</span> | <span class="type">&lt;*number*&gt;</span> | <span class="type">&lt;*bool*&gt;</span>

     <span class="type">&lt;list&gt;</span> <span class="builtin">::=</span> () | (<span class="type">&lt;head-sexp&gt;</span> <span class="type">&lt;sexp&gt;</span> ...)
       <span class="type">&lt;head-sexp&gt;</span> <span class="builtin">::=</span> <span class="type">&lt;atom-head-sexp&gt;</span> | <span class="type">&lt;list-head-sexp&gt;</span>
         <span class="type">&lt;list-head-sexp&gt;</span> <span class="builtin">::=</span> <span class="type">&lt;lambda-exp&gt;</span>
          <span class="builtin">:&#27492;&#26178;&#21407;list&#34987;&#35299;&#37323;&#29234;non-primitive-procedure&#30340;action</span>
         <span class="type">&lt;atom-head-sexp&gt;</span> <span class="builtin">::=</span> <span class="type">&lt;name-of-primitive-procedure&gt;</span>
                               <span class="builtin">:&#27492;&#26178;&#21407;list&#34987;&#35299;&#37323;&#29234;primitive-procedure&#30340;action</span>
                              | quote
                               <span class="builtin">:&#27492;&#26178;&#21407;list&#23660;&#26044;&#25976;&#25818;&#39006;&#22411;</span> <span class="type">&lt;*sexp*&gt;</span>
                              | lambda
                               <span class="builtin">:&#27492;&#26178;&#21407;list&#26159;&#19968;&#20491;lambda-exp</span>
                              | cond
                               <span class="builtin">:&#27492;&#26178;&#21407;list&#26159;&#19968;&#20491;&#25511;&#21046;&#32080;&#27083;</span>

   note:
   1. &#36889;&#20491;&#20195;&#30908;&#22602;&#30340;&#20351;&#29992;&#21482;&#26159;&#29234;&#20102;&#35486;&#27861;&#39640;&#20142;
   2. ``<span class="builtin">::=</span>''&#31526;&#34399;&#29992;&#20358;&#34920;&#31034;&#27512;&#32013;&#23450;&#32681;
   3. ``<span class="type">&lt;sexp&gt;</span> ...''&#30340;&#20986;&#29694;&#20195;&#34920;&#36889;&#35023;&#21487;&#20197;&#20986;&#29694;&#38646;&#20491;&#25110;&#19968;&#20491;&#25110;&#22810;&#20491;<span class="type">&lt;sexp&gt;</span>
   4. &#22312;&#20998;&#39006;&#30340;&#26411;&#31471;
      &#25105;&#29992;&#31526;&#34399;``:''&#20358;&#23565;&#35486;&#32681;&#20316;&#31777;&#21934;&#30340;&#35498;&#26126;
   5. &#22312;&#20998;&#39006;&#30340;&#26411;&#31471;
      &#25105;&#29992;&#31526;&#34399;<span class="type">&lt;*...*&gt;</span>&#20358;&#35352;&#37027;&#20123;&#22312;&#25105;&#30340;&#35299;&#37323;&#20013;&#20195;&#34920;&#19968;&#39006;&#29544;&#31435;&#30340;&#25976;&#25818;&#32080;&#27083;&#30340;&#26481;&#35199;
      &#23427;&#20497;&#26371;&#34987;&#25105;&#30340;&#35299;&#37323;&#22120;&#20013;&#30340;atom?&#21028;&#26039;&#29234;&#30495;
      &#23427;&#20497;&#30446;&#21069;&#26377;&#65306;
      <span class="type">&lt;*number*&gt;</span> <span class="type">&lt;*bool*&gt;</span> <span class="type">&lt;*sexp*&gt;</span>
      <span class="type">&lt;*procedure*&gt;</span> == <span class="type">&lt;*primitive*&gt;</span> | <span class="type">&lt;*non-primitive*&gt;</span>
      <span class="type">&lt;*non-primitive*&gt;</span> == <span class="type">&lt;*closure*&gt;</span>
      &#25976;&#25818;&#32080;&#27083;&#25351;&#33021;&#22816;&#20197;&#29305;&#23450;&#30340;&#26041;&#24335;&#23384;&#20786;&#22312;&#20839;&#23384;&#30340;&#26481;&#35199;
      &#30070;&#28982;&#23565;&#26044;&#25105;&#23531;&#30340;&#35299;&#37323;&#22120;&#20358;&#35498;&#20839;&#23384;&#26159;&#24819;&#35937;&#20986;&#20358;&#30340;
      <span class="type">&lt;var&gt;</span> &#33287; <span class="type">&lt;obj&gt;</span>&#30340;&#32129;&#23450;&#26159;&#22312;table&#20013;&#23526;&#29694;&#30340;
      &#32780;table&#26159;&#20803;&#35299;&#37323;&#22120;&#20013;&#30340;&#19968;&#20491;list
   6. &#34899;&#35486;``action''&#33287;``application''&#31561;&#21516;
      &#20294;&#26159;&#26356;&#25509;&#36817;&#25976;&#23416;
   7. &#26360;&#20013;&#21407;&#20358;&#30340;&#35299;&#37323;&#22120;&#19981;&#34389;&#29702;'()
      &#23565;'()&#30340;&#34389;&#29702;&#26159;&#25105;&#21152;&#30340;
      &#25105;&#24819;&#22312;&#35712;&#31532;18&#31456;&#30340;&#26178;&#20505;&#20154;&#20497;&#21487;&#20197;&#39636;&#26371;&#21040;&#26360;&#20013;&#19981;&#34389;&#29702;'()&#30340;&#21407;&#22240;
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-3">*** little change</span>
    1. use `myapply' to rename `apply'
    2. add *null
    3. change a way of <span class="org-link"><a href="*identifer and notfound">error report</a></span>
<span class="org-level-3">*** important terms</span>
    1. &#25105;&#23531;&#30340;&#35299;&#37323;&#22120;&#30452;&#25509;&#34987;&#31281;&#20316;&#8220;&#25105;&#23531;&#30340;&#35299;&#37323;&#22120;&#8221;
       &#65288;&#30070;&#28982;&#36889;&#20854;&#23526;&#26159;Friedman&#23531;&#30340;&#35299;&#37323;&#22120;&#65289;
       &#20854;&#20013;&#30340;&#31526;&#34399;&#34920;&#36948;&#24335;&#35352;&#29234;&lt;sexp&gt;
    2. &#25105;&#23531;&#30340;&#35299;&#37323;&#22120;&#25152;&#23884;&#20837;&#30340;&#35299;&#37323;&#22120;&#34987;&#31281;&#20316;&#8220;&#20803;&#35299;&#37323;&#22120;&#8221;
       &#20854;&#20013;&#30340;&#31526;&#34399;&#34920;&#36948;&#24335;&#35352;&#29234;sexp
<span class="org-level-3">*** typesetting</span>
    1. &#38656;&#35201;&#34987;&#24341;&#29992;&#30340;&#20195;&#30908;&#22602;&#26371;&#34987;&#21152;&#19978;&#27161;&#38988;
<span class="org-level-2">** lexical scope, entry and table of environment</span>
   ``the scope of a binding is the block
   in which the bound identifier is visible
   minus any portions of the block
   in which the identifier is shadowed''

   ``a variable that occurs free in a lambda expression
   should always be bound
   otherwise when the procedure is apply
   there will be an error about the unbound variable''

   ``to support lexical scoping
   a procedure carries the lexical context (environment)
   along with its code''

   ``so that
   when the procedure is applied somewhere outside the scope
   of the bindings for variables that occur free within the procedure
   the same bindings
   that were in effect when the procedure was created
   are in effect again when the procedure is applied''

   --kent dybvig

   lambda&#34920;&#36948;&#24335; &#34920;&#36948;procedure&#35486;&#32681; &#22312;&#35299;&#37323;&#22120;&#20013;&#26371;&#34987;&#36681;&#21270;&#29234;closure
   closure&#26371;&#25226;&#30070;&#26178;&#30340;environment&#21253;&#20837;&#20854;&#20839;
   &#27599;&#27425;closure&#30340;action&#26371;&#29992;&lt;arg&gt;s&#33287;&lt;val&gt;s&#32068;&#25104;&#30340;new-entry&#25844;&#23637;environment
   &#28982;&#24460;&#22312;&#25844;&#23637;&#30340;environment&#20013;apply
   apply&#26178; &#19981;&#26159;&#36889;&#20491;procedure&#30340;&#21443;&#25976;&#30340;&lt;arg&gt;s &#33287; &#26159;&#36889;&#20491;procedure&#30340;&#21443;&#25976;&#30340;&lt;arg&gt;s
   &#37117;&#20197;&#19968;&#33268;&#30340;&#26041;&#24335; &#30001;&#20839;&#23652;&#21040;&#22806;&#23652;&#22320; &#22312;table&#30340;entry&#20013;&#26597;&#25214;&#23427;&#20497;&#30340;&lt;val&gt;s
   &#36889;&#31278;&#26041;&#24335;&#23601;&#26159;*identifer

   entry&#26159;&#29992;&#20358;&#35352;&#37636;&#19968;&#32068;names&#33287;&#19968;&#32068;values&#20043;&#38291;&#30340;&#21629;&#21517;&#38364;&#20418;&#30340;&#25976;&#25818;&#32080;&#27083;
   &#32771;&#24942;&#24590;&#27171;&#19968;&#20491;&#27193;&#36969;&#21512;&#29992;&#20358;&#23436;&#25104;&#36889;&#20491;&#20219;&#21209;&#23601;&#26126;&#30333;entry&#30340;&#27083;&#36896;&#20102;
   &#21363;&#19968;&#20491;names&#30340;list&#21644;&#19968;&#20491;&#21516;&#31561;&#38263;&#24230;&#30340;values&#30340;list&#20316;&#25104;&#30340;pair
   + pair&#36889;&#20491;&#34899;&#35486;&#34987;&#28651;&#29992;&#20102;
     &#36889;&#35023;&#25351;&#21482;&#21547;&#26377;&#20841;&#20491;&#20803;&#32032;&#30340;list
     &#20854;&#20182;&#22320;&#26041;&#21448;&#25351;&#24418;&#22914;(A . B)&#30340;&#26481;&#35199;
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">new-entry</span>
     (<span class="keyword">lambda</span> (a b)
       (cons a (cons b '()))))
   (<span class="keyword">define</span> <span class="function-name">first</span>
     (<span class="keyword">lambda</span> (l)
       (car l)))
   (<span class="keyword">define</span> <span class="function-name">second</span>
     (<span class="keyword">lambda</span> (l)
       (cadr l)))
<span class="org-block-end-line">   #+end_src
</span>
   lookup-in-entry&#26159;*identifer&#39006;&#22411;&#30340;&#20316;&#29992;&#30340;&#23526;&#29694;&#26041;&#24335;
   + &#30070;&#22312;entry&#20013;&#25214;&#19981;&#21040;name&#26178;&#36820;&#22238;(entry-f name) ``f'' denote function
     &#32771;&#24942;&#19979;&#38754;&#30340;environment&#25976;&#25818;&#32080;&#27083;&#23601;&#30693;&#36947;
     &#30070;&#22312;&#19968;&#20491;entry&#20013;&#25214;&#19981;&#21040;name&#26178;&#19981;&#25226;&#36889;&#20491;name&#25172;&#25481;
     &#26159;&#22240;&#29234;&#36996;&#35201;&#22312;environment&#20013;&#30340;&#19979;&#19968;&#20491;entry&#20013;&#25214;name
   + &#20808;&#25226;entry&#20013;&#30340;names&#33287;values&#25286;&#38283; &#28982;&#24460;&#20132;&#32102;&#36628;&#21161;&#20989;&#25976;&#34389;&#29702;
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">lookup-in-entry</span>
     (<span class="keyword">lambda</span> (name entry entry-f)
       (lookup-in-entry-help name
                             (first entry)
                             (second entry)
                             entry-f)))
   (<span class="keyword">define</span> <span class="function-name">lookup-in-entry-help</span>
     (<span class="keyword">lambda</span> (name names values entry-f)
       (<span class="keyword">cond</span>
        ((null? names)
         (entry-f name))
        ((eq? name (car names))
         (car values))
        (<span class="keyword">else</span>
         (lookup-in-entry-help name (cdr names) (cdr values) entry-f)))))
<span class="org-block-end-line">   #+end_src
</span>
   table (of environment) is a list of entries
   &#32771;&#24942;&#22312;environment&#20013;&#26597;&#25214;name&#30340;&#26041;&#24335;&#23601;&#30693;&#36947;
   &#36889;&#20491;&#25976;&#25818;&#32080;&#27083;&#20351;&#24471;&#19968;&#20491;name&#25152;&#23565;&#25033;&#30340;&#26032;value&#21487;&#20197;&#35206;&#33995;&#23427;&#25152;&#23565;&#25033;&#30340;&#33290;value
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">extend-table</span> cons)
   (<span class="keyword">define</span> <span class="function-name">lookup-in-table</span>
     (<span class="keyword">lambda</span> (name table table-f)
       (<span class="keyword">cond</span> ((null? table)
              (table-f name))
             (<span class="keyword">else</span>
              (lookup-in-entry name
                               (car table)
                               (<span class="keyword">lambda</span> (name)
                                 (lookup-in-table name (cdr table) table-f)))))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** value and meaning</span>
   &#25353;&#20316;&#29992;&#39006;&#22411;&#23565;&lt;sexp&gt;<span class="org-link"><a href="&#20998;&#39006;">&#20998;&#39006;</a></span>
   &#19968;&#20849;&#20677;&#26377;7&#31278;&#20316;&#29992;&#26041;&#24335;
   atom-to-action: *const *identifer
   list-to-action: *null *quote *lambda *cond *application

<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">value</span>
     (<span class="keyword">lambda</span> (e)
       (meaning e '())))
   (<span class="keyword">define</span> <span class="function-name">meaning</span>
     (<span class="keyword">lambda</span> (e table)
       ((expression-to-action e) e table)))
   (<span class="keyword">define</span> <span class="function-name">expression-to-action</span>
     (<span class="keyword">lambda</span> (e)
       (<span class="keyword">cond</span>
        ((atom? e)
         (atom-to-action e))
        (<span class="keyword">else</span>
         (list-to-action e)))))
   (<span class="keyword">define</span> <span class="function-name">atom-to-action</span>
     (<span class="keyword">lambda</span> (e)
       (<span class="keyword">cond</span>
        ((number? e)
         ,*const)
        ((eq? e #t)
         ,*const)
        ((eq? e #f)
         ,*const)
        ((eq? e 'cons)
         ,*const)
        ((eq? e 'car)
         ,*const)
        ((eq? e 'cdr)
         ,*const)
        ((eq? e 'null?)
         ,*const)
        ((eq? e 'eq?)
         ,*const)
        ((eq? e 'atom?)
         ,*const)
        ((eq? e 'zero?)
         ,*const)
        ((eq? e 'add1)
         ,*const)
        ((eq? e 'sub1)
         ,*const)
        ((eq? e 'number?)
         ,*const)
        (<span class="keyword">else</span>
         ,*identifer))))
   (<span class="keyword">define</span> <span class="function-name">list-to-action</span>
     (<span class="keyword">lambda</span> (e)
       (<span class="keyword">cond</span> ((null? e)
              ,*null)
             ((atom? (car e))
              (<span class="keyword">cond</span> ((eq? (car e) 'quote)
                     ,*quote)
                    ((eq? (car e) 'lambda)
                     ,*lambda)
                    ((eq? (car e) 'cond)
                     ,*cond)
                    (<span class="keyword">else</span>
                     ,*application)))
             (<span class="keyword">else</span>
              *application))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** after classification</span>
   &#19979;&#38754;&#26159;&#19981;&#21516;&#39006;&#22411;&#30340;&#20316;&#29992;&#30340;&#32048;&#31680;
   &#27880;&#24847; &#23427;&#20497;&#33287;&#19978;&#38754;&#22519;&#34892;&#20998;&#39006;&#21151;&#33021;&#30340;&#20195;&#30908;&#26159;&#20998;&#38626;&#30340;
   &#32780;&#19978;&#38754;&#30340;&#20195;&#30908;&#21934;&#32020;&#30340;&#22519;&#34892;&#20998;&#39006;&#30340;&#20219;&#21209;&#27794;&#26377;&#36958;&#27512;
   &#25152;&#20197;&#36958;&#27512;&#30340;&#20219;&#21209;&#20840;&#22312;&#20316;&#29992;&#30340;&#32048;&#31680;&#20013;&#23436;&#25104;
<span class="org-level-3">*** dependence</span>
<span class="org-block-begin-line">    #+begin_src scheme
</span>    (<span class="keyword">define</span> <span class="function-name">atom?</span>
      (<span class="keyword">lambda</span> (x)
        (<span class="keyword">and</span> (not (pair? x))
             (not (null? x)))))
    (<span class="keyword">define</span> <span class="function-name">add1</span>
      (<span class="keyword">lambda</span> (x)
        (+ 1 x)))
    (<span class="keyword">define</span> <span class="function-name">sub1</span>
      (<span class="keyword">lambda</span> (x)
        (- x 1)))
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** *const</span>
    &#26368;&#31777;&#21934;&#30340;&#26159;*const
    &#23427;&#25226;&#25976;&#23383;&#33287;&#37007;&#36655;&#20540;&#25353;&#21407;&#27171;&#36664;&#20986;
    &#32780;&#32102;&lt;name-of-primitive-procedure&gt;&#36028;&#19978;primitive&#30340;&#27161;&#31844;
    &#20197;&#34920;&#26126;&#26159;&#36889;&#20491;&#35299;&#37323;&#22120;&#20013;&#25152;&#37197;&#20633;&#30340;&#22522;&#26412;&#20989;&#25976;&#33287;&#35586;&#35422;
<span class="org-block-begin-line">    #+begin_src scheme
</span>    (<span class="keyword">define</span> <span class="function-name">*const</span>
      (<span class="keyword">lambda</span> (e table)
        (<span class="keyword">cond</span> ((number? e)
               e)
              ((eq? e #t)
               #t)
              ((eq? e #f)
               #f)
              (<span class="keyword">else</span>
               (cons 'primitive (cons e '()))))))
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** *identifer</span>
    1. &#21069;&#38754;&#25152;&#25944;&#36848;&#30340;enrty&#33287;environment&#25976;&#25818;&#32080;&#27083;&#20197;&#21450;&#30456;&#38364;&#20989;&#25976;
       &#26159;&#29234;&#19988;&#20677;&#29234;*identifer&#36889;&#31278;&#39006;&#22411;&#30340;&#20316;&#29992;&#32780;&#28310;&#20633;&#30340;
    2. &#30070;&#38656;&#35201;&#29992;&#21040;lookup-in-table&#30340;&#31532;&#22235;&#20491;&#21443;&#25976;&#30340;&#26178;&#20505;
       &#23601;&#26159;&#25214;&#19981;&#21040;&#26576;&#20491;&#21517;&#31281;&#25152;&#23565;&#25033;&#30340;&#20540;&#30340;&#26178;&#20505;
       &#26360;&#20013;&#20351;&#29992;(car '()))) &#36889;&#27171;&#23601;&#20351;&#29992;&#25142;&#24471;&#21040;&#19968;&#20491;&#20803;&#35299;&#37323;&#22120;&#20013;&#30340;&#37679;&#35492;&#20449;&#24687;
       &#32780;&#36889;&#35023;&#20351;&#29992;&#19968;&#20491;&#23383;&#31526;&#20018;
       &#22909;&#34389;&#26159; &#36889;&#20491;&#23383;&#31526;&#20018;&#27161;&#35352;&#20102;&#37679;&#35492;&#20043;&#24460;&#36996;&#21487;&#20197;&#34987;&#20760;&#37327;&#22320;&#34389;&#29702;
       &#30452;&#21040;&#23526;&#22312;&#37679;&#19978;&#21152;&#37679;&#20102;&#29234;&#27490;
       &#36889;&#20491;&#29305;&#24615;&#31350;&#31455;&#26159;&#22909;&#26159;&#22750;&#23601;&#22240;&#29702;&#35299;&#26041;&#24335;&#32780;&#30064;&#20102;
    3. &#36889;&#23531;&#21839;&#38988;&#21482;&#26377;&#22312;&#23526;&#36368;&#20013;&#25165;&#26371;&#34987;&#34389;&#29702; &#22312;&#32020;&#29702;&#35542;&#35342;&#35542;&#20013;&#26159;&#19981;&#20316;&#34389;&#29702;&#30340;
       &#22240;&#29234;&#23601;&#36889;&#35023;&#30340;&#35469;&#35672;&#35542;&#32780;&#35328;&#8220;&#37679;&#35492;&#27704;&#36960;&#37117;&#26159;&#38750;&#26412;&#36074;&#30340;&#8221;
<span class="org-block-begin-line">    #+begin_src scheme
</span>    (<span class="keyword">define</span> <span class="function-name">*identifer</span>
      (<span class="keyword">lambda</span> (e table)
        (lookup-in-table e table notfound)))
    (<span class="keyword">define</span> <span class="function-name">notfound</span>
      (<span class="keyword">lambda</span> (name)
        <span class="string">"error: at least one name is unbound"</span>))
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** *null</span>
<span class="org-block-begin-line">    #+begin_src scheme
</span>    <span class="comment-delimiter">;</span><span class="comment">&#26368;&#26368;&#31777;&#21934;&#30340;*null
</span>    (<span class="keyword">define</span> <span class="function-name">*null</span>
      (<span class="keyword">lambda</span> (e table)
        '()))
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** *quote</span>
    *quote&#29992;&#20358;&#27161;&#35672;&lt;*sexp*&gt;&#25976;&#25818;&#39006;&#22411;
    &#21152;quote&#30340;&lt;sexp&gt;&#22312;&#35299;&#37323;&#26178;&#26371;&#34987;&#35469;&#29234;&#26159;&lt;*sexp*&gt;
    &#20043;&#25152;&#20197;&#26377;&lt;sexp&gt;&#33287;&lt;*sexp*&gt;&#20043;&#38291;&#30340;&#30456;&#20114;&#36681;&#25563;
    &#24471;&#30410;&#26044;McCarthy&#23565;LISP&#30340;&#35373;&#35336;
    ``scheme programs share a common printed representation
    with scheme data structures
    as a result
    any scheme program has a natural and obvious
    internal representation as a Scheme object''--kent dybvig
    &#36889;&#20491;&#29305;&#24615;&#20351;&#24471;&#25105;&#22312;&#25105;&#23531;&#30340;&#36889;&#20491;&#35299;&#37323;&#22120;&#35023;&#20877;&#23531;&#19968;&#20491;&#35299;&#37323;&#22120;&#25104;&#29234;&#21487;&#33021;
<span class="org-block-begin-line">    #+begin_src scheme
</span>    (<span class="keyword">define</span> <span class="function-name">*quote</span>
      (<span class="keyword">lambda</span> (e table)
        (text-of e)))
    (<span class="keyword">define</span> <span class="function-name">text-of</span> second)
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** *lambda</span>
    &#34987;*lambda&#20358;&#20316;&#29992;&#30340;&#26159;&lt;lambda-exp&gt; &#23427;&#30340;&#35486;&#32681;&#26159;non-primitive
    &lt;lambda-exp&gt;&#32147;*lambda&#20316;&#29992;&#34987;&#36681;&#21270;&#29234;closure
    &#23427;&#21069;&#26377;&#19968;&#20491;``non-primitive''&#27161;&#31844;
    &#20197;&#26041;&#20415;&#20043;&#24460;&#25353;&#20316;&#29992;&#26041;&#24335;&#30340;&#19981;&#21516;&#20358;&#20998;&#21029;&#34389;&#29702;primitive&#33287;non-primitive
<span class="org-block-begin-line">    #+begin_src scheme
</span>    <span class="type">&lt;closure&gt;</span> == (non-primitive (<span class="type">&lt;environment&gt;</span> <span class="type">&lt;formals&gt;</span> <span class="type">&lt;body&gt;</span>))
<span class="org-block-end-line">    #+end_src
</span>    non-primitive&#23601;&#26159;&#20197;&#36889;&#31278;&#26041;&#24335;&#22312;&#25105;&#30340;&#35299;&#37323;&#22120;&#20013;&#34987;&#35222;&#29234;&#19968;&#31278;&#25976;&#25818;&#39006;&#22411;&#30340;
<span class="org-block-begin-line">    #+begin_src scheme
</span>    (<span class="keyword">define</span> <span class="function-name">*lambda</span>
      (<span class="keyword">lambda</span> (e table)
        (list 'non-primitive
              (cons table (cdr e)))))
    (<span class="keyword">define</span> <span class="function-name">table-of</span>
      (<span class="keyword">lambda</span> (non-primitive)
        (car non-primitive)))
    (<span class="keyword">define</span> <span class="function-name">formals-of</span>
      (<span class="keyword">lambda</span> (non-primitive)
        (cadr non-primitive)))
    (<span class="keyword">define</span> <span class="function-name">body-of</span>
      (<span class="keyword">lambda</span> (non-primitive)
        (caddr non-primitive)))
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** *cond</span>
    cond&#30340;&#21151;&#33021;&#26159;&#20998;&#25903;&#25511;&#21046;
    &#23427;&#25226;&#35586;&#35422;&#30340;&#32080;&#26524;&#36681;&#21270;&#25104;&#20854;&#20182;&#30340;&#26481;&#35199;
    &#26377;&#40670;&#20687;&#8220;&#21453;&#35586;&#35422;&#8221;
    + &#22914;&#26524;&#27794;&#26377;&#19968;&#20491;&#26781;&#20214;&#26159;&#30495;&#30340;
      &#37027;&#40636;&#26368;&#24460;&#19968;&#23652;&#36958;&#27512;&#30340;cond-line&#29234;'() &#26371;&#20986;&#29694;(car '())&#30340;&#37679;&#35492;
      &#20445;&#25345;cond-lines&#30340;&#32080;&#23614;&#26159;else &#23601;&#19981;&#26371;&#20986;&#29694;&#36889;&#31278;&#37679;&#35492;
    + &#36889;&#35023;&#36958;&#27512;&#35519;&#29992;&#20102;meaning
<span class="org-block-begin-line">    #+begin_src scheme
</span>    (<span class="keyword">define</span> <span class="function-name">*cond</span>
      (<span class="keyword">lambda</span> (e table)
        (evcon (cond-lines-of e) table)))
    (<span class="keyword">define</span> <span class="function-name">cond-lines-of</span> cdr)
    (<span class="keyword">define</span> <span class="function-name">evcon</span>
      (<span class="keyword">lambda</span> (lines table)
        (<span class="keyword">cond</span> ((else? (question-of (car lines)))
               (meaning (answer-of (car lines)) table))
              ((meaning (question-of (car lines)) table)
               (meaning (answer-of (car lines)) table))
              (<span class="keyword">else</span>
               (evcon (cdr lines) table)))))
    (<span class="keyword">define</span> <span class="function-name">question-of</span>
      (<span class="keyword">lambda</span> (x)
        (car x)))
    (<span class="keyword">define</span> <span class="function-name">answer-of</span>
      (<span class="keyword">lambda</span> (x)
        (cadr x)))
    (<span class="keyword">define</span> <span class="function-name">else?</span>
      (<span class="keyword">lambda</span> (x)
        (<span class="keyword">cond</span> ((atom? x)
               (eq? x 'else))
              (<span class="keyword">else</span>
               #f))))
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** *application</span>
    &#21482;&#21097;&#26368;&#24460;&#19968;&#20491;&#20316;&#29992;&#26041;&#24335;*application&#20102;
    &#23427;&#30340;&#20219;&#21209;&#32321;&#37325; &#23427;&#26159;&#20351;&#29992;&#36958;&#27512;&#35519;&#29992;&#30340;&#20027;&#35201;&#37096;&#20998; &#21478;&#22806;&#30340;&#20351;&#29992;&#36958;&#27512;&#35519;&#29992;&#30340;&#37096;&#20998;&#26159;*cond
    1. &#34987;*application&#20316;&#29992;&#30340;&lt;sexp&gt;&#30340;car&#29234;&lt;*procedure*&gt;
       &#36889;&#20491;&lt;*procedure*&gt;&#26159;&#36890;&#36942;&#36958;&#27512;&#35519;&#29992;meaning
       &#20316;&#29992;&#26044;&#20986;&#29694;&#22312;car&#20301;&#32622;&#30340;&lt;sexp&gt;&#32780;&#27714;&#24471;&#30340;
       &#32645;&#21990;&#22320;&#35498;&lt;*procedure*&gt;&#26159;
       &#20197;&#25105;&#23450;&#32681;&#30340;&#26041;&#24335; &#22312;&#25105;&#23531;&#30340;&#35299;&#37323;&#22120;&#35023; &#34920;&#36948;&#20989;&#25976;&#35486;&#32681;&#30340; &#20803;&#35299;&#37323;&#22120;&#20013;&#30340;sexp
       &#21363; &#21069;&#38754;&#36028;&#30528;primitive&#25110;non-primitive&#27161;&#31844;&#30340;sexp
    2. &#34987;*application&#20316;&#29992;&#30340;&lt;sexp&gt;&#30340;cdr&#34987;&#29234;&lt;*procedure*&gt;&#30340;arg-list
       &#36889;&#20491;list&#20013;&#30340;&#20540;&#26159;&#32147;&#30001;evlis&#32780;&#36958;&#27512;&#35519;&#29992;meaning
       &#20316;&#29992;&#26044;&#20986;&#29694;&#22312;cdr&#20301;&#32622;&#30340;(&lt;sexp&gt; ...)&#32780;&#27714;&#24471;&#30340;
       ``evlis'' denote evaluation list
    3. &#21069;&#38754;&#30340;&#36958;&#27512;&#35519;&#29992;meaning&#20316;&#22909;&#28310;&#20633;&#24037;&#20316;&#24460;
       myapply&#23601;&#19978;&#22580;&#20102;
       apply&#26159;&#37325;&#35201;&#30340;&#20989;&#25976;
       + &#29234;&#20102;&#36991;&#20813;&#33287;&#20803;&#35299;&#37323;&#22120;&#20013;&#30340;apply&#34909;&#31361;&#32780;&#37325;&#21629;&#21517;&#29234;myapply
       + value&#21644;apply&#20316;&#29234;&#35299;&#37323;&#22120;&#30340;&#20841;&#37096;&#20998; &#22914;&#22826;&#26997;&#29983;&#20841;&#20736;
       + &gt;&lt; &#23531;&#35299;&#37323;&#22120;&#30340;&#26041;&#24335;&#19981;&#27490;&#26377;&#36889;&#19968;&#20013; sicp&#20013;&#26377;&#21478;&#19968;&#31278;&#24456;&#37239;&#30340;&#23531;&#27861;
         &#23427;&#20497;&#22312;&#24615;&#36074;&#19978;&#26377;&#20309;&#21312;&#21029;&#65311;
       &#23427;&#30340;&#20316;&#29992;&#26041;&#24335;&#26681;&#25818;&lt;*procedure*&gt;&#26159;&lt;*primitive*&gt;&#36996;&#26159;&lt;*non-primitive*&gt;
       &#32780;&#20998;&#39006;&#29234;apply-primitive&#33287;apply-closure
       1) apply-primitive
          &#25226;&#20219;&#21209;&#36681;&#20132;&#32102;&#26356;&#24213;&#23652; &#22312;&#36889;&#35023;&#23601;&#26159;&#20132;&#32102;&#20803;&#35299;&#37323;&#22120;
       2) apply-closure
          &lt;closure&gt;&#20013;&#26377;&lt;environment&gt; &lt;formals&gt; &lt;body&gt;
          &#39318;&#20808;arg-list&#33287;&lt;formals&gt;&#32068;&#25104;new-entry&#20358;extend-table
          &#20197;&#26356;&#26032;&lt;closure&gt;&#20013;&#30340;&lt;environment&gt;
          &#28982;&#24460;&#35519;&#29992;meaning&#25226;&lt;closure&gt;&#20013;&#30340;&lt;body&gt;&#22312;&#26032;&#30340;&lt;environment&gt;&#20013;&#27714;&#20540;
    4. &#29234;&#20160;&#40636;&#35201;&#37325;&#26032;&#23450;&#32681;atom?&#36889;&#20491;&#35586;&#35422;&#29234;:atom?
       &#22240;&#29234;&#25152;&#24076;&#26395;&#24471;&#21040;&#30340;atom?&#25033;&#35442;&#25226;&lt;*procedure*&gt;&#21028;&#26039;&#29234;#t
       &#21487;&#26159;
       &#20197;&#25105;&#23450;&#32681;&#30340;&#26041;&#24335; &#22312;&#25105;&#23531;&#30340;&#35299;&#37323;&#22120;&#35023; &#34920;&#36948;&#20989;&#25976;&#35486;&#32681;&#30340; &#20803;&#35299;&#37323;&#22120;&#20013;&#30340;sexp
       &#21371;&#26159;&#19968;&#20491;&#26222;&#36890;&#30340;list
       &#25152;&#20197;&#20677;&#29992;&#20803;&#35299;&#37323;&#22120;&#35023;&#30340;atom?&#20316;apply-primitive&#20013;&#30340;&#35586;&#35422;&#26159;&#19981;&#22816;&#30340;
<span class="org-block-begin-line">    #+begin_src scheme
</span>    (<span class="keyword">define</span> <span class="function-name">evlis</span>
      (<span class="keyword">lambda</span> (args table)
        (<span class="keyword">cond</span> ((null? args)
               '())
              (<span class="keyword">else</span>
               (cons (meaning (car args) table)
                     (evlis (cdr args) table))))))
    (<span class="keyword">define</span> <span class="function-name">*application</span>
      (<span class="keyword">lambda</span> (e table)
        (myapply
         (meaning (function-of e) table)
         (evlis (arguments-of e) table))))
    (<span class="keyword">define</span> <span class="function-name">function-of</span> car)
    (<span class="keyword">define</span> <span class="function-name">arguments-of</span> cdr)

    (<span class="keyword">define</span> <span class="function-name">myapply</span>
      (<span class="keyword">lambda</span> (fun vals)
        (<span class="keyword">cond</span> ((primitive? fun)
               (apply-primitive (second fun) vals))
              ((non-primitive? fun)
               (apply-closure (second fun) vals)))))
    (<span class="keyword">define</span> <span class="function-name">primitive?</span>
      (<span class="keyword">lambda</span> (l)
        (eq? (car l) 'primitive)))
    (<span class="keyword">define</span> <span class="function-name">non-primitive?</span>
      (<span class="keyword">lambda</span> (l)
        (eq? (car l) 'non-primitive)))

    (<span class="keyword">define</span> <span class="function-name">apply-primitive</span>
      (<span class="keyword">lambda</span> (name vals)
        (<span class="keyword">cond</span>
         ((eq? name 'cons)
          (cons (first vals) (second vals)))
         ((eq? name 'car)
          (car (first vals)))
         ((eq? name 'cdr)
          (cdr (first vals)))
         ((eq? name 'null?)
          (null? (first vals)))
         ((eq? name 'eq?)
          (eq? (first vals) (second vals)))
         ((eq? name 'atom?)
          (<span class="builtin">:atom?</span> (first vals)))
         ((eq? name 'zero?)
          (zero? (first vals)))
         ((eq? name 'add1)
          (add1 (first vals)))
         ((eq? name 'sub1)
          (sub1 (first vals)))
         ((eq? name 'number?)
          (number? (first vals))))))
    (<span class="keyword">define</span> <span class="function-name">:atom?</span>
      (<span class="keyword">lambda</span> (x)
        (<span class="keyword">cond</span> ((atom? x)
               #t)
              ((null? x)
               #f)
              ((eq? (car x) 'primitive)
               #t)
              ((eq? (car x) 'non-primitive)
               #t)
              (<span class="keyword">else</span>
               #f))))

    (<span class="keyword">define</span> <span class="function-name">apply-closure</span>
      (<span class="keyword">lambda</span> (closure vals)
        (meaning (body-of closure)
                 (extend-table (new-entry (formals-of closure) vals)
                               (table-of closure)))))
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** </span><span class="org-todo">&gt;&lt;</span><span class="org-level-2"> make good ues of other functions in this interpreter</span>
   except the function value
   what other functions in interpreter.scm can we use?
<span class="org-level-2">** </span><span class="org-todo">&gt;&lt;</span><span class="org-level-2"> add some functions into this interpreter for fun</span>
<span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src scheme :result output :session *scheme* :scheme ikarus
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#23565;*identifer&#30340;&#28204;&#35430;&#21487;&#20197;&#30475;&#20316;&#23565;&#22577;&#37679;&#24773;&#27841;&#30340;&#28204;&#35430;
</span>   (value 'not-const)

   <span class="comment-delimiter">;; </span><span class="comment">*const
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#25976;&#23383;&#33287;&#37007;&#36655;&#20540;
</span>   (value 1)
   <span class="comment-delimiter">;; </span><span class="comment">&#19979;&#38754;&#20841;&#20491;&#29992;&#21040;*application
</span>   (value '(add1 1))
   (value '(sub1 1))
   (value #t)
   (value #f)

   <span class="comment-delimiter">;; </span><span class="comment">&#22522;&#26412;&#20989;&#25976;primitive
</span>   (value 'add1)
   (value 'car)
   (value 'atom?)

   <span class="comment-delimiter">;; </span><span class="comment">*null
</span>   (value '())

   <span class="comment-delimiter">;; </span><span class="comment">*quote
</span>   (value '(<span class="keyword">quote</span> a-quoted-string))
   (value '(<span class="keyword">quote</span> (a-quoted-string)))
   (value '(<span class="keyword">quote</span> (<span class="keyword">lambda</span> (x) (add1 (add1 x)))))

   <span class="comment-delimiter">;; </span><span class="comment">*lambda &#38750;&#22522;&#26412;&#20989;&#25976;non-primitive
</span>   (value '(<span class="keyword">lambda</span> (x) (add1 (add1 x))))

   <span class="comment-delimiter">;; </span><span class="comment">*cond
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#29992;&#21040;*application
</span>   (value '(<span class="keyword">cond</span> ((eq? 1 2) 123) (<span class="keyword">else</span> 321)))
   (value '(<span class="keyword">cond</span> ((eq? 1 kkk) 123) (<span class="keyword">else</span> 321)))
   (value '(<span class="keyword">cond</span> ((eq? cons car) 123) (<span class="keyword">else</span> 321)))

   <span class="comment-delimiter">;; </span><span class="comment">*application
</span>   (value '(cons 1 '()))
   (value '((<span class="keyword">lambda</span> (x) (cons 'drink (cons x '())))
            'milk))
   (value '((<span class="keyword">lambda</span> (y) (<span class="keyword">cond</span>
                         ((eq? y 'thirst)
                          ((<span class="keyword">lambda</span> (x) (cons 'drink (cons x '())))
                           'water))
                         ((eq? y 'not-thirst)
                          ((<span class="keyword">lambda</span> (x) (cons 'do (cons 'not (cons 'drink (cons x '())))))
                           'water))
                         (<span class="keyword">else</span>
                          'what-ever)))
            'thirst))
   (value '((<span class="keyword">lambda</span> (y) (<span class="keyword">cond</span>
                         ((eq? y 'thirst)
                          ((<span class="keyword">lambda</span> (x) (cons 'drink (cons x '())))
                           'water))
                         ((eq? y 'not-thirst)
                          ((<span class="keyword">lambda</span> (x) (cons 'do (cons 'not (cons 'drink (cons x '())))))
                           'water))
                         (<span class="keyword">else</span>
                          'what-ever)))
            'not-thirst))
   <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#35023;&#29992;&#21040;&#30340;&#26159;&#26377;else&#20445;&#35703;&#30340;cond
</span>   (value '((<span class="keyword">lambda</span> (y) (<span class="keyword">cond</span>
                         ((eq? y 'thirst)
                          ((<span class="keyword">lambda</span> (x) (cons 'drink (cons x '())))
                           'water))
                         ((eq? y 'not-thirst)
                          ((<span class="keyword">lambda</span> (x) (cons 'do (cons 'not (cons 'drink (cons x '())))))
                           'water))
                         (<span class="keyword">else</span>
                          'what-ever)))
            'do-not-tell-you))
   <span class="comment-delimiter">;; </span><span class="comment">&#32780;&#22914;&#26524;&#19981;&#29992;else&#23601;&#26371;&#21487;&#33021;&#22577;&#37679;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#22577;&#20986;&#30340;&#26159;&#20803;&#35299;&#37323;&#22120;&#20013;&#30340;(car '())&#37679;&#35492;
</span>   <span class="comment-delimiter">;; </span><span class="comment">(value '((lambda (y) (cond
</span>   <span class="comment-delimiter">;;                     </span><span class="comment">((eq? y 'thirst)
</span>   <span class="comment-delimiter">;;                      </span><span class="comment">((lambda (x) (cons 'drink (cons x '())))
</span>   <span class="comment-delimiter">;;                       </span><span class="comment">'water))
</span>   <span class="comment-delimiter">;;                     </span><span class="comment">((eq? y 'not-thirst)
</span>   <span class="comment-delimiter">;;                      </span><span class="comment">((lambda (x) (cons 'do (cons 'not (cons 'drink (cons x '())))))
</span>   <span class="comment-delimiter">;;                       </span><span class="comment">'water))))
</span>   <span class="comment-delimiter">;;        </span><span class="comment">'do-not-tell-you))
</span>
   <span class="comment-delimiter">;; </span><span class="comment">&#28204;&#35430;&#32080;&#26524;(in ikarus)
</span>   <span class="comment-delimiter">;; </span><span class="comment">"error: at least one name is unbound"
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; 1
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; 2
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; 0
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; #t
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; #f
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; (primitive add1)
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; (primitive car)
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; (primitive atom?)
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; ()
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; a-quoted-string
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; (a-quoted-string)
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; (lambda (x) (add1 (add1 x)))
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; (non-primitive (() (x) (add1 (add1 x))))
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; 321
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; 321
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; 321
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; (1)
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; (drink milk)
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; (drink water)
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; (do not drink water)
</span>   <span class="comment-delimiter">;; </span><span class="comment">&gt; what-ever
</span><span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* </span><span class="org-level-1"><span class="bold">*the seasoned schemer*</span></span>
<span class="org-level-1">* </span><span class="org-todo">&gt;&lt;</span><span class="org-level-1"> lost</span>
<span class="org-level-1">* </span><span class="org-todo">&gt;&lt;</span><span class="org-level-1"> 14 let there be names</span>
  <span class="org-link"><a href="shell:evince -p 95 ~/learning-lisp/scheme/the-seasoned-schemer.pdf &amp;">shell:evince -p 95 ~/learning-lisp/scheme/the-seasoned-schemer.pdf &amp;</a></span>
<span class="org-block-begin-line">  #+begin_src scheme
</span>  (<span class="keyword">define-syntax</span> <span class="variable-name">try</span>
    (<span class="keyword">syntax-rules</span> ()
      [(_ <span class="type">&lt;var&gt;</span> a . b)
       (<span class="keyword">letcc</span> success
         (<span class="keyword">letcc</span> <span class="type">&lt;var&gt;</span> (success a)) . b)]
      ))
  (try x a b)

  (<span class="keyword">letcc</span> success
    (<span class="keyword">letcc</span> x (success <span class="type">&lt;sexp1&gt;</span>))
    <span class="type">&lt;sexp2&gt;</span>)
  &#24471;:(<span class="type">&lt;sexp2&gt;</span>&#26283;&#26178;&#34987;&#24536;&#25481;&#20102;)
  (<span class="keyword">letcc</span> success
    <span class="type">&lt;sexp1&gt;</span>)

  &#22833;&#25943;:
  x&#26159;&#22833;&#25943;&#30340;&#35352;&#34399;
  &#22914;&#26524;&#22312;&#27714;&#20540;<span class="type">&lt;sexp1&gt;</span>&#30340;&#36942;&#31243;&#20013;&#36935;&#21040;x&#30340;&#20316;&#29992;(x <span class="type">&lt;sexp*&gt;</span>)
  &#23601;&#24471;:
  (<span class="keyword">letcc</span> success
    (<span class="keyword">letcc</span> x <span class="type">&lt;sexp*&gt;</span>)
    <span class="type">&lt;sexp2&gt;</span>)
  (<span class="keyword">letcc</span> success
    <span class="type">&lt;sexp*&gt;</span>
    <span class="type">&lt;sexp2&gt;</span>)
  &#28982;&#24460;&#36820;&#22238;<span class="type">&lt;sexp2&gt;</span>&#30340;&#20540;

  &#25104;&#21151;:
  &#22914;&#26524;&#22312;&#27714;&#20540;<span class="type">&lt;sexp1&gt;</span>&#30340;&#36942;&#31243;&#20013;&#27794;&#26377;&#36935;&#21040;x&#30340;&#20316;&#29992;
  &#23601;&#36820;&#22238;<span class="type">&lt;sexp1&gt;</span>&#30340;&#20540;

<span class="org-block-end-line">  #+end_src
</span><span class="org-level-1">* </span><span class="org-todo">&gt;&lt;</span><span class="org-level-1"> 15 the difference between men and boys...</span>
<span class="org-level-1">* 16 ready, set, bang!</span>
  use (set! ...) to remember valuable things between
  two distinct uses of a function
<span class="org-level-2">** from deep to deepM</span>
   first write deep simply
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">deep</span>
     (<span class="keyword">lambda</span> (m)
       (<span class="keyword">cond</span> ((zero? m) 'pizza)
             (<span class="keyword">else</span> (cons (deep (sub1 m))
                         '())))))
   (deep 3)
<span class="org-block-end-line">   #+end_src
</span>   then write deepR
   which calls deep after a side effect remembered all input and output
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">Ns</span> '())
   (<span class="keyword">define</span> <span class="function-name">Rs</span> '())
   (<span class="keyword">define</span> <span class="function-name">deepR</span>
     (<span class="keyword">lambda</span> (n)
       (<span class="keyword">let</span> ((result (deep n)))
         (<span class="keyword">set!</span> Ns (cons n Ns))
         (<span class="keyword">set!</span> Rs (cons result Rs))
         result)))
   (deepR 5)
   (<span class="keyword">let</span> ()
     (display Ns)
     (newline))
   (<span class="keyword">let</span> ()
     (display Rs)
     (newline))
<span class="org-block-end-line">   #+end_src
</span>   then write deepM
   which calls deepR
   and will not remember the same in&amp;output twice
   and calls find as help function
   and builds Ns and Rs inside let
   + with Ns and Rs inside let means that the environment of
     the closure called deepM
     contains boxes called Ns and Rs with value '() in both of them
     and only during the application of the closure
     the value in the boxes called Ns and Rs can be
     taken by simply calling their names
     or changing by set!
     so after define deepM
     Ns and Rs are really there in the store in this way
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">find</span>
     (<span class="keyword">lambda</span> (n Ns Rs)
       (<span class="keyword">letrec</span>
           ((A (<span class="keyword">lambda</span> (ns rs)
                 (<span class="keyword">cond</span> ((null? ns) #f)
                       ((= (car ns) n) (car rs))
                       (<span class="keyword">else</span> (A (cdr ns) (cdr rs)))))))
         (A Ns Rs))))
   (find 1000000000 Ns Rs)
   (find 5 Ns Rs)

   (<span class="keyword">define</span> <span class="function-name">deepM</span>
     (<span class="keyword">let</span> ((Ns '())
           (Rs '()))
       (<span class="keyword">lambda</span> (n)
         (<span class="keyword">let</span> ((found (find n Ns Rs)))
           (<span class="keyword">if</span> found
               found
               (deepR n))))))
   (deepM 10)
<span class="org-block-end-line">   #+end_src
</span>   and to add the side effects casused by deepM
   to every self calling of the function deep
   by changing the recursion in deep
   from (deep (sub1 m)) to (deepM (sub1 m))
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">deep</span>
     (<span class="keyword">lambda</span> (m)
       (<span class="keyword">cond</span> ((zero? m) 'pizza)
             (<span class="keyword">else</span> (cons (deepM (sub1 m))
                         '())))))
<span class="org-block-end-line">   #+end_src
</span>   after every functions was correct
   we should simplify them by merging
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">deepM</span>
     (<span class="keyword">let</span> ((Ns '())
           (Rs '()))
       (<span class="keyword">lambda</span> (n)
         (<span class="keyword">let</span> ((found (find n Ns Rs)))
           (<span class="keyword">if</span> found
               found
               (<span class="keyword">let</span> ((result (<span class="keyword">if</span> (zero? n)
                                 'pizza
                                 (cons (deepM (sub1 n))
                                       '()))))
                 (<span class="keyword">set!</span> Ns (cons n Ns))
                 (<span class="keyword">set!</span> Rs (cons result Rs))
                 result))))))
   (deepM 1000)
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** define recursive function length in a new way</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">length</span>
     (<span class="keyword">let</span> ((f (<span class="keyword">lambda</span> (l) 0)))
       (<span class="keyword">set!</span> f (<span class="keyword">lambda</span> (l)
                 (<span class="keyword">cond</span> ((null? l) 0)
                       (<span class="keyword">else</span>
                        (add1 (f (cdr l)))))))
       f))

   (<span class="keyword">define</span> <span class="function-name">length</span>
     ((<span class="keyword">lambda</span> (f)
        (<span class="keyword">set!</span> f (<span class="keyword">lambda</span> (l)
                  (<span class="keyword">cond</span> ((null? l) 0)
                        (<span class="keyword">else</span>
                         (add1 (f (cdr l)))))))
        f)
      (<span class="keyword">lambda</span> (l) 0)))

   (length '(1 2 3 4))
<span class="org-block-end-line">   #+end_src
</span>   use (set! &lt;var&gt; &lt;obj*&gt;) for (let ((&lt;var&gt; &lt;obj&gt;)) ...)
   if there is at least one (lambda ... between them
   or if the new &lt;obj*&gt; for &lt;var&gt; is a function that refers to &lt;var&gt;
   + in this way we can define recursive function
   + &#30050;&#31455;set!&#21644;define&#30340;&#23526;&#29694;&#26041;&#24335;&#26159;&#39006;&#20284;&#30340;
<span class="org-level-2">** bang!</span>
   &#19979;&#38754;&#30070;procedure F&#38656;&#35201;&#34987;&#20659;&#20837;&#21443;&#25976;
   &#32780;&#22312;&#20659;&#20837;&#21443;&#25976;&#26178;&#24517;&#38920;&#19981;&#34987;&#31435;&#21051;&#27714;&#20540;&#26178;
   &#26371;&#20986;&#29694;&#33287;Y&#20013;&#21516;&#27171;&#30340;
   &#29992;(lambda (x) (F x))&#20358;&#20195;&#26367;F&#30340;&#25216;&#24039;

   &#20294;&#26159;&#36889;&#35023;&#29234;&#20160;&#40636;&#38656;&#35201;&#36889;&#31278;&#25216;&#24039;

   to extract a value and give it a name
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">length</span>
     (<span class="keyword">let</span> ([f (<span class="keyword">lambda</span> (l) 0)])
       (<span class="keyword">set!</span> f (L (<span class="keyword">lambda</span> (x) (f x))))
       f))

   (<span class="keyword">define</span> <span class="function-name">Y!</span>
     (<span class="keyword">lambda</span> (F)
       (<span class="keyword">let</span> ([f (<span class="keyword">lambda</span> (x) '())])
         (<span class="keyword">set!</span> f (F (<span class="keyword">lambda</span> (x) (f x))))
         f)))
   <span class="comment-delimiter">;</span><span class="comment">letrec as syntax sugar of let and set!
</span>   (<span class="keyword">define</span> <span class="function-name">Y-bang</span>
     (<span class="keyword">lambda</span> (F)
       (<span class="keyword">letrec</span> ((f (F (<span class="keyword">lambda</span> (x) (f x)))))
         f)))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-todo">&gt;&lt;</span><span class="org-level-2"> biz</span>
   &#23565;&#26044;L&#36889;&#39006;&#36890;&#36942;Y&#25110;Y!&#29983;&#29986;&#36958;&#27512;&#20989;&#25976;&#30340;&#31639;&#23376;&#20358;&#35498;
   Y&#33287;Y!&#20316;&#29992;&#26044;&#23427;&#20497;&#30340;&#32080;&#26524;&#26159;&#23436;&#20840;&#30456;&#21516;&#30340;
   &#20294;&#26159;&#23565;&#26044;&#20854;&#20182;&#24418;&#29376;&#30340;&#26481;&#35199;&#20316;&#29992;&#32080;&#26524;&#23601;&#21487;&#33021;&#19981;&#21516;&#20102;
   &#29234;&#20160;&#40636;?
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">biz</span>
     (<span class="keyword">let</span> ((x 0))
       (<span class="keyword">lambda</span> (f)
         (<span class="keyword">set!</span> x (add1 x))
         (<span class="keyword">lambda</span> (a) (<span class="keyword">if</span> (= a x)
                     0
                     (f a))))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* 17 we change, therefore we are (consC and why deepM is better than deep)</span>
<span class="org-level-2">** deepM again</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">deepM</span>
     (<span class="keyword">let</span> ((Ns '())
           (Rs '()))
       (<span class="keyword">lambda</span> (n)
         (<span class="keyword">let</span> ((found (find n Ns Rs)))
           (<span class="keyword">if</span> found
               found
               (<span class="keyword">let</span> ((result (<span class="keyword">if</span> (zero? n)
                                 'pizza
                                 (cons (deepM (sub1 n))
                                       '()))))
                 (<span class="keyword">set!</span> Ns (cons n Ns))
                 (<span class="keyword">set!</span> Rs (cons result Rs))
                 result))))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** consC</span>
   in the following
   set! procedure conter and set-conter inside the consC
   enable us to open the box called N
   outside the consC's application
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">conter</span>)
   (<span class="keyword">define</span> <span class="function-name">set-conter</span>)
   (<span class="keyword">define</span> <span class="function-name">consC</span>
     (<span class="keyword">let</span> ((N 0))
       (<span class="keyword">lambda</span> (a d)
         (<span class="keyword">set!</span> conter
               (<span class="keyword">lambda</span> () N))
         (<span class="keyword">set!</span> set-conter
               (<span class="keyword">lambda</span> (x) (<span class="keyword">set!</span> N x)))
         (<span class="keyword">set!</span> N (add1 N))
         (cons a d))))
   (consC 1 2)
   (conter)
   (set-conter 0)
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** why deepM is better then deep</span>
   let deep and deepM using consC in the recursion first
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">deep</span>
     (<span class="keyword">lambda</span> (m)
       (<span class="keyword">cond</span> ((zero? m) 'pizza)
             (<span class="keyword">else</span> (consC (deep (sub1 m))
                         '())))))
   (<span class="keyword">define</span> <span class="function-name">deepM</span>
     (<span class="keyword">let</span> ((Ns '())
           (Rs '()))
       (<span class="keyword">lambda</span> (n)
         (<span class="keyword">let</span> ((found (find n Ns Rs)))
           (<span class="keyword">if</span> found
               found
               (<span class="keyword">let</span> ((result (<span class="keyword">if</span> (zero? n)
                                 'pizza
                                 (consC (deepM (sub1 n))
                                       '()))))
                 (<span class="keyword">set!</span> Ns (cons n Ns))
                 (<span class="keyword">set!</span> Rs (cons result Rs))
                 result))))))
<span class="org-block-end-line">   #+end_src
</span>   &gt;&lt; any better way to use consC, rather than copy the code of them?
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">test-function-with-lots-of-numbers</span>
     (<span class="keyword">lambda</span> (f n)
       (<span class="keyword">letrec</span>
           ((N n)
            (T (<span class="keyword">lambda</span> (n)
                 (<span class="keyword">if</span> (zero? n)
                     (<span class="keyword">let</span> ()
                       (f n)
                       (<span class="keyword">let</span> ()
                         (newline)
                         (display
                          (list
                           <span class="string">"after runing"</span> `,f <span class="string">"from"</span> N <span class="string">"to zero,"</span>))
                         (newline)
                         (display
                          (list
                           <span class="string">"the number of cons been used is:"</span>))
                         (newline)
                         ))
                     (<span class="keyword">let</span> ()
                       (f n)
                       (T (sub1 n)))))))
         (set-conter 0)
         (T n)
         (conter)
         )))
   (test-function-with-lots-of-numbers deep 1000)
   (test-function-with-lots-of-numbers deepM 1000)
<span class="org-block-end-line">   #+end_src
</span>   test deepM one time the result is 1000
   test deepM another time the result will be 0

   ``a LISP programmer knows the value of everything
   but the cost of nothing''
   --alan j.perlis
<span class="org-level-2">** </span><span class="org-todo">&gt;&lt;</span><span class="org-level-2"> rember1* again</span>
<span class="org-level-1">* 18 we change, therefore we are the same! (kkk)</span>
<span class="org-level-2">** ccc</span>
   sexp is constructed by ``cons''
   and changed by ``car cdr''
   theoretically, ``car cdr cons'' are just functions
   that satisfy the following axioms:
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (car (cons <span class="type">&lt;obj1&gt;</span> <span class="type">&lt;obj2&gt;</span>)) == <span class="type">&lt;obj1&gt;</span>
   (cdr (cons <span class="type">&lt;obj1&gt;</span> <span class="type">&lt;obj2&gt;</span>)) == <span class="type">&lt;obj2&gt;</span>
<span class="org-block-end-line">   #+end_src
</span>   it is way we have this chapter
<span class="org-level-2">** add-at-end</span>
   we don't handle the '() here
   so the second `add-at-end' of the following source-block is taken
   though the `add-at-end' in the next source-block is much cooler
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">add-at-end</span>
     (<span class="keyword">lambda</span> (l)
       (<span class="keyword">cond</span> ((null? l)
              (cons 'egg '()))
             (<span class="keyword">else</span>
              (cons (car l)
                    (add-at-end (cdr l)))))))
   (<span class="keyword">define</span> <span class="function-name">add-at-end</span>
     (<span class="keyword">lambda</span> (l)
       (<span class="keyword">cond</span> ((null? (cdr l))
              (cons (car l) (cons 'egg '())))
             (<span class="keyword">else</span>
              (cons (car l) (add-at-end (cdr l)))))))
   (add-at-end '(egg1 egg2))
<span class="org-block-end-line">   #+end_src
</span><span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">add-at-end-too</span>
     (<span class="keyword">lambda</span> (l)
       (<span class="keyword">letrec</span>
           ((A (<span class="keyword">lambda</span> (ls)
                 (<span class="keyword">cond</span> ((null? (cdr ls))
                        (<span class="keyword">set-cdr!</span> ls (cons 'egg '())))
                       (<span class="keyword">else</span> (A (cdr ls)))))))
         (A l)
         l)))
   (add-at-end-too '(egg1 egg2))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** kkk</span>
   use ``lambda'' to make ``kar kdr kons''
   &#30001;&#19979;&#38754;&#30340;&#23526;&#29694;&#30475;&#20986;'()&#20006;&#27794;&#26377;&#20160;&#40636;&#29305;&#27530;&#24615;
   + &#27604;&#22914;&#35498;&#22914;&#26524;&#25105;&#26412;&#36523;&#27794;&#26377;'()
     &#25105;&#21487;&#20197;&#25361;&lt;atom&gt;&#39006;&#22411;&#20013;&#30340;&#20219;&#24847;&#19968;&#20491;&#20986;&#20358;&#30070;&#20316;'()
   &#28982;&#24460;&#25226;&#36889;&#20491;&#26481;&#35199;&#24478;&lt;atom&gt;&#39006;&#22411;&#20013;&#25490;&#38500; &#21152;&#20837;&#21040;&lt;list&gt;&#39006;&#22411;
   &#22914;&#20309;&#32102;scheme&#35299;&#37323;&#22120;&#21152;&#19968;&#20491;&#35498;&#26126;&#24615;&#30340;&#39006;&#22411;&#31995;&#32113;
<span class="org-block-begin-line">   #+begin_src scheme
</span>   <span class="builtin">:kons:</span> (<span class="type">&lt;kist&gt;</span> . <span class="type">&lt;kist&gt;</span>) -&gt; (<span class="type">&lt;selector&gt;</span> -&gt; <span class="type">&lt;selected-obj&gt;</span>)
   <span class="type">&lt;kist&gt;</span> <span class="builtin">::=</span> <span class="type">&lt;atom&gt;</span> | (<span class="type">&lt;selector&gt;</span> -&gt; <span class="type">&lt;selected-obj&gt;</span>)
   (<span class="keyword">define</span> <span class="function-name">kons</span>
     (<span class="keyword">lambda</span> (kar kdr)
       (<span class="keyword">lambda</span> (selector)
         (selector kar
                   kdr))))
   <span class="builtin">:kar:</span> (<span class="type">&lt;selector&gt;</span> -&gt; <span class="type">&lt;selected-obj&gt;</span>) -&gt; <span class="type">&lt;selected-obj&gt;</span>
   &#39023;&#28982;&#29234;&#20102;&#23526;&#29694; <span class="builtin">:kar:</span> &#30340;&#39006;&#22411;&#21482;&#38656;&#22312;kar&#20013;
   &#25226;(<span class="type">&lt;selector&gt;</span> -&gt; <span class="type">&lt;selected-obj&gt;</span>)&#20316;&#29992;&#21040;<span class="type">&lt;selector&gt;</span>&#19978;&#38754;
   (<span class="keyword">define</span> <span class="function-name">kar</span>
     (<span class="keyword">lambda</span> (c)
       (c (<span class="keyword">lambda</span> (a d) a))))
   (<span class="keyword">define</span> <span class="function-name">kdr</span>
     (<span class="keyword">lambda</span> (c)
       (c (<span class="keyword">lambda</span> (a d) d))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-todo">note</span>
   1. &#36889;&#35023;&#26126;&#39023;&#22320;&#38656;&#35201;&#24478;&#27604;&#25976;&#23416;&#20013;&#30340;&#20989;&#25976;&#26356;&#24291;&#32681;&#30340;&#35282;&#24230;&#20358;&#29702;&#35299;lambda&#34920;&#36948;&#24335;
      lexical scope&#20013;&#23565;lambda&#34920;&#36948;&#24335;&#34987;&#27714;&#20540;&#29234;closure
      closure&#30340;action &#39318;&#20808;&#26159;&#19968;&#20491;&#23565;sexp&#30340;&#20195;&#25563;&#36942;&#31243;
      &#26368;&#24460;&#26159;apply
      &#21482;&#26377;&#22312;&#26368;&#24460;apply&#30340;&#26178;&#20505; sexp&#30340;fun&#21644;args&#25165;&#34987;&#21312;&#20998; sexp&#20013;&#30340;&#38917;&#32404;&#26159;&#19981;&#24179;&#31561;&#30340;
      &#36889;&#27171;lambda&#34920;&#36948;&#24335; &#33021;&#27604;&#25976;&#23416;&#20013;&#20659;&#32113;&#24847;&#32681;&#19978;&#30340;&#20989;&#25976;&#34920;&#36948;&#26356;&#22810;&#30340;&#26481;&#35199;
      &#23601;&#22312;&#26044;&#20570;&#20195;&#25563;&#30340;&#26178;&#20505;fun&#20301;&#32622;&#20063;&#21487;&#20197;&#34987;&#20195;&#25563;
   2. &#35373;&#24819;&#29694;&#22312;&#35201;&#35373;&#35336;&#19968;&#31278;&#20989;&#25976;&#24335;&#32232;&#31243;&#31684;&#24335;&#30340;&#26032;&#35486;&#27861;
      &#22240;&#29234;&#25105;&#20006;&#19981;&#28415;&#36275;scheme&#20013;&#30340;apply
      &#22240;&#29234;apply&#30340;&#35486;&#32681;&#24456;&#20407;&#38480;
      &#23427;&#32317;&#25226;sexp&#30340;&#38957;&#19968;&#20491;&#20301;&#32622;&#30340;&#38917;&#29702;&#35299;&#29234;fun &#28982;&#24460;&#20854;&#20182;&#30340;&#38917;&#34987;&#23427;&#20316;&#29992;
   3. &#35201;&#35373;&#35336;&#19968;&#20491;&#20989;&#25976;&#24335;&#32232;&#31243;&#31684;&#24335;&#30340;&#32232;&#31243;&#35486;&#35328;
      &#39318;&#20808;&#35201;&#25214;&#19968;&#20491;&#34920;&#31034;&#26041;&#24335;
      * <span class="org-list-dt">LISP ::</span>
           sexp&#65288;&#31561;&#20729;&#26044;tree&#65289;
      &#28982;&#24460;&#35201;&#35373;&#35336;&#20986;&#8220;&#20989;&#25976;&#30340;&#20316;&#29992;&#8221;&#36889;&#20491;&#35486;&#32681;&#25033;&#35442;&#22914;&#20309;&#23526;&#29694; &#36889;&#27491;&#26159;&#8220;&#20989;&#25976;&#24335;&#8221;&#30340;&#25152;&#25351;
      * <span class="org-list-dt">LISP ::</span>
           &#29992;lambda&#34920;&#36948;&#24335;&#20358;&#23526;&#29694;&#19968;&#31278;&#20195;&#25563;&#26041;&#24335;
           &#36889;&#31278;&#20195;&#25563;&#26041;&#24335;&#25351;&#26126;&#30637;lambda&#34920;&#36948;&#24335;&#34987;&#21270;&#29234;closure&#24460;&#20316;&#29992;&#26044;&#21443;&#25976;&#30340;&#26041;&#24335;
           &#28982;&#24460;&#29992;apply&#21435;&#25351;&#26126;procedure&#65288;primitive&#25110;non-primitive&#30340;closure&#65289;
           &#22312;&#26126;&#30906;&#20102;&#30340;&#26041;&#24335;&#19979;&#20316;&#29992;&#26044;&#21443;&#25976;&#23559;&#24471;&#21040;&#20160;&#40636;
   4. &#24819;&#20687;&#19968;&#19979;
      &#25105;&#30340;&#26032;&#35486;&#35328;&#29992;&#19968;&#33324;&#30340;&#22294;&#20358;&#20570;&#29234;&#34920;&#36948;&#26041;&#24335;
      &#21516;&#27171;&#26377;&#39006;&#20284;lambda&#34920;&#36948;&#24335;&#30340;&#26481;&#35199;&#20358;&#25351;&#26126;&#20316;&#29992;&#26041;&#24335;
      &#20294;&#26159;apply&#23601;&#23436;&#20840;&#19981;&#19968;&#27171;&#20102;
      &#35201;&#27714;&#23427;&#19981;&#33021;&#25552;&#21069;&#29305;&#27530;&#21270;&#22294;&#20013;&#30340;&#26576;&#20123;&#20301;&#32622;
      &#37027;&#40636;&#23427;&#25033;&#35442;&#22914;&#20309;&#23436;&#25104;&#19968;&#27425;&#20316;&#29992;&#21602;&#65311;
      &#22914;&#26524;&#23427;&#21435;&#27298;&#28204;&#20803;&#32032;&#30340;&#39006;&#22411;&#30340;&#35441; procedure&#23601;&#19981;&#33021;&#20316;&#29992;&#26044;procedure&#20102;&#65281;
   5. &#22238;&#36942;&#38957;&#20358;&#24819;&#19968;&#19979;
      &#24819;&#35201;&#36861;&#27714;&#30340;&#35486;&#32681;&#26159;&#20160;&#40636;&#65311;
      &#21487;&#20197;&#35498;&#22312;&#25976;&#23416;&#20013; &#20006;&#19981;&#26159;&#25226;&#20316;&#29992;&#27515;&#26495;&#22320;&#29702;&#35299;&#29234;&#19968;&#20491;&#20989;&#25976;&#22312;&#20316;&#29992; &#19968;&#20123;&#21443;&#22312;&#34987;&#20316;&#29992;
      &#27491;&#30456;&#21453; &#21443;&#25976;&#21644;&#20989;&#25976;&#30340;&#22320;&#20301;&#26159;&#21487;&#20197;&#30456;&#20114;&#36681;&#21270;&#30340;
      &#25226;&#21443;&#25976;&#26126;&#30906;&#20102; &#28982;&#24460;&#25226;&#20989;&#25976;&#31354;&#19979;&#20358; &#25105;&#23601;&#24471;&#21040;&#19968;&#20491;&#27867;&#20989;(*,#)
      &#20294;&#26159;&#36889;&#27171;&#30340;&#19968;&#20491;&#26481;&#35199;&#20063;&#21487;&#20197;&#34987;&#30475;&#20316;&#26159;&#19968;&#20491;&#20108;&#20803;&#20989;&#25976;
      &#20063;&#23601;&#35498;&#36889;&#20841;&#20491;&#31354;&#20301;(*,*)&#19981;&#20677;&#20677;&#26159;&#20841;&#20491;&#31354;&#20301;&#32780;&#24050;
      &#25105;&#23531;&#20986;&#23427;&#20497;&#30340;&#21516;&#26178;&#36996;&#25351;&#23450;&#20102;&#30070;&#36889;&#20841;&#20491;&#31354;&#20301;&#34987;&#22635;&#19978;&#26178;&#25105;&#25033;&#35442;&#20197;&#20160;&#40636;&#26041;&#24335;
      &#24478;&#36889;&#20841;&#20491;&#20449;&#24687;&#24471;&#21040;&#35336;&#31639;&#30340;&#32080;&#26524; &#21363;(*,*) == f(*,*)
      &#25152;&#20197;LISP&#30340;&#33021;&#21147;&#20854;&#23526;&#26159;&#19981;&#34987;&#25105;&#30340;&#8220;&#26032;&#35486;&#35328;&#8221;&#25152;&#36229;&#36234;&#30340;
   6. (*,#) (*,*) f(*,*) &#19981;&#21516;&#30340;&#34920;&#36948;&#26041;&#24335;&#21487;&#33021;&#20195;&#34920;&#20102;&#19981;&#21516;&#30340;&#35336;&#31639;&#26041;&#24335;
   7. &#36889;&#30495;&#26159;&#29378;&#24819;
      &#25226;&#19968;&#20491;&#20316;&#29992;&#26041;&#24335;&#32080;&#27083;&#21270;
      &#37027;&#40636;&#36889;&#20491;&#32080;&#27083;&#25152;&#32102;&#20986;&#30340;&#35920;&#23500;&#20449;&#24687;&#22914;&#20309;&#24433;&#38911;&#20316;&#29992;&#26041;&#24335;&#21602;&#65311;
   8. &#22238;&#25014;&#19968;&#19979;friedman&#24819;&#35201;&#22312;&#36889;&#26412;&#26360;&#20013;&#25945;&#23566;&#20154;&#20497;&#35336;&#31639;&#30340;&#26412;&#36074;
      &#35336;&#31639;&#26159;&#26377;&#35079;&#38620;&#24615;&#30340;
      &#36889;&#22312;&#26044;
      &#25105;&#22312;&#21033;&#29992;&#35336;&#31639;&#27231;&#36914;&#34892;&#35336;&#31639;
      &#25105;&#25226;&#25105;&#24819;&#35201;&#35336;&#31639;&#30340;&#26481;&#35199;&#34920;&#36948;&#25104;&#35336;&#31639;&#27231;&#33021;&#29702;&#35299;&#30340;&#24418;&#24335;
      &#28982;&#24460;&#35336;&#31639;&#27231;&#20197;&#23427;&#30340;&#26041;&#24335;&#25226;&#25105;&#34920;&#36948;&#30340;&#35336;&#31639;&#20998;&#35299;&#29234;&#23427;&#23565;&#23427;&#23384;&#20786;&#29376;&#24907;&#30340;&#25805;&#20316;
      &#35079;&#38620;&#24615;&#27491;&#29986;&#29983;&#33287;&#36889;&#35023;
      &#38918;&#25033;&#35336;&#31639;&#27231;&#30340;&#34892;&#29234;&#26041;&#24335; &#25105;&#25165;&#33021;&#25226;&#25105;&#24076;&#26395;&#30340;&#35336;&#31639;&#20570;&#22909;
      &#23601;&#26159;&#22312;&#36889;&#27171;&#24801;&#21155;&#30340;&#26781;&#20214;&#19979; &#25105;&#35201;&#21033;&#29992;&#35336;&#31639;&#27231;&#20358;&#24171;&#21161;&#25105;&#30340;&#26576;&#20123;&#25976;&#23416;&#24605;&#32771;
      &#21487;&#20197;&#35498; &#37027;&#20123;&#25511;&#21046;&#23565;&#20154;&#30340;&#29702;&#35299;&#32780;&#35328;&#30340;&#35079;&#38620;&#24615;&#30340;&#25216;&#34899;
      &#27491;&#26159;&#25105;&#29234;&#20102;&#29554;&#24471;&#35336;&#31639;&#27231;&#23565;&#25105;&#30340;&#24171;&#21161;&#32780;&#23416;&#32722;&#30340;
<span class="org-level-2">** kkk with set!</span>
   &#29234;&#20102;&#23450;&#32681;set-kdr &#32780;&#21033;&#29992;&#19979;&#38754;&#30340;bons &#37325;&#26032;&#23450;&#32681;``kar kdr kons''
   + why bons and kons are separated?
     because we need to bind kdr to set! it letter
     but when closure is constructed
     no name will be bound to any loaction
     it is in the first step of the apply
     where the binding should happen temporarily
<span class="org-block-begin-line">   #+begin_src scheme
</span>   <span class="builtin">:kons:</span> <span class="type">&lt;kist&gt;</span> -&gt; (<span class="type">&lt;selector&gt;</span> -&gt; <span class="type">&lt;selected-obj&gt;</span>)
   (<span class="keyword">define</span> <span class="function-name">bons</span>
     (<span class="keyword">lambda</span> (kar)
       (<span class="keyword">let</span> [(kdr '())]
         (<span class="keyword">lambda</span> (selector)
           (selector (<span class="keyword">lambda</span> (x) (<span class="keyword">set!</span> kdr x))
                     kar
                     kdr)))))
   <span class="builtin">:kar:</span> (<span class="type">&lt;selector&gt;</span> -&gt; <span class="type">&lt;selected-obj&gt;</span>) -&gt; <span class="type">&lt;selected-obj&gt;</span>
   (<span class="keyword">define</span> <span class="function-name">kar</span>
     (<span class="keyword">lambda</span> (c)
       (c (<span class="keyword">lambda</span> (s a d) a))))
   (<span class="keyword">define</span> <span class="function-name">kdr</span>
     (<span class="keyword">lambda</span> (c)
       (c (<span class="keyword">lambda</span> (s a d) d))))
   (<span class="keyword">define</span> <span class="function-name">set-kdr</span>
     (<span class="keyword">lambda</span> (c x)
       ((c (<span class="keyword">lambda</span> (s a d) s))
        x)))
   <span class="builtin">:kons:</span> (<span class="type">&lt;kist&gt;</span> . <span class="type">&lt;kist&gt;</span>) -&gt; (<span class="type">&lt;selector&gt;</span> -&gt; <span class="type">&lt;selected-obj&gt;</span>)
   (<span class="keyword">define</span> <span class="function-name">kons</span>
     (<span class="keyword">lambda</span> (a d)
       (<span class="keyword">let</span> [(c (bons a))]
         (set-kdr c d)
         c)))
   (bons 1)
   (kar (bons 1))
   (kdr (bons 1))
   (kons 1 2)
   (kar (kons 1 2))
   (kdr (kons 1 2))
<span class="org-block-end-line">   #+end_src
</span>   + &#22039;&#35430;&#25551;&#36848;&#39006;&#22411;&#30340;&#36942;&#31243;&#20013;&#20358;&#30475;
     &#22909;&#20687;&#35201;&#24819;&#23526;&#29694;&#23436;&#20633;&#30340;&#39006;&#22411;&#31995;&#32113;&#23601;&#35201;&#23565;&#35486;&#35328;&#20316;&#24456;&#22810;&#38480;&#21046;
   + what the visual model of our kkk may looks like
     (*,*) is not a good one
     there are something more basic that is not in our define of kkk
<span class="org-level-2">** </span><span class="org-todo">&gt;&lt;</span><span class="org-level-2"> play with kkk with set!</span>
   when we use ``add-at-end''
   we will make a new list
   but when we change to use ``add-at-end-too''
   the konses are the same except fot the last one
   and the value of the &lt;arg&gt; of ``add-at-end-too'' is change
   ``we change, therefore we are the same!''
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">kounter</span>)
   (<span class="keyword">define</span> <span class="function-name">set-kounter</span>)
   (<span class="keyword">define</span> <span class="function-name">konsC</span>
     (<span class="keyword">lambda</span> ()))


   (<span class="keyword">define</span> <span class="function-name">lots</span>
     (<span class="keyword">lambda</span> (m)
       (<span class="keyword">cond</span> ((zero? m) '())
             (<span class="keyword">else</span> (konsC 'egg (lots (sub1 m)))))))
   (<span class="keyword">define</span> <span class="function-name">lenkth</span>
     (<span class="keyword">lambda</span> (l)
       (<span class="keyword">cond</span> ((null? l) 0)
             (<span class="keyword">else</span> (add1 (lenkth (kdr l)))))))
   (<span class="keyword">define</span> <span class="function-name">add-at-end</span>
     (<span class="keyword">lambda</span> (l)
       (<span class="keyword">cond</span> ((null? (kdr l))
              (konsC (kar l) (kons 'egg '())))
             (<span class="keyword">else</span>
              (konsC (kar l) (add-at-end (kdr l)))))))
   (<span class="keyword">define</span> <span class="function-name">add-at-end-too</span>
     (<span class="keyword">lambda</span> (l)
       (<span class="keyword">letrec</span>
           ((A (<span class="keyword">lambda</span> (ls)
                 (<span class="keyword">cond</span> ((null? (kdr ls))
                        (set-kdr ls (konsC 'egg '())))
                       (<span class="keyword">else</span> (A (kdr ls)))))))
         (A l)
         l)))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-todo">&gt;&lt;</span><span class="org-level-2"> same?</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">eklist?</span>
     (<span class="keyword">lambda</span> (ls1 ls2)
       (<span class="keyword">cond</span> (())
             (())
             (<span class="keyword">else</span>
              ()))))
<span class="org-block-end-line">   #+end_src
</span>
   there is a new idea of ``sameness'' once we introduce (set! ...)
   ``two konses are the same if changing one changes the other''
   by ``changing'' it means we are using the ``set-kdr''
   by ``two konses'' it means two different names
   + notice `c1 c2' must be non-empty kons-list
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">same?</span>
     (<span class="keyword">lambda</span> (c1 c2)
       (<span class="keyword">let</span> ((t1 (kdr c1))
             (t2 (kdr c2)))
         (set-kdr c1 1)
         (set-kdr c2 2)
         (<span class="keyword">let</span> ((v (= (kdr c1) (kdr c2))))
           (set-kdr c1 1)
           (set-kdr c2 2)
           v))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-todo">&gt;&lt;</span><span class="org-level-2"> play with same?</span>
<span class="org-level-2">** </span><span class="org-todo">&gt;&lt;</span><span class="org-level-2"> play with set-kdr</span>
<span class="org-level-2">** finite-lenkth</span>
   &#24490;&#29872;&#32773;&#36820;&#22238;#f
   &#19981;&#24490;&#29872;&#32773;&#35336;&#25976;&#20854;&#38263;&#24230;
   + because we are doing recursion
     the order of the questions is matter
   + &#36889;&#35023;&#25976;&#30340;&#26159;&#19968;&#20491;&#32218;&#24615;&#30340;list&#20013;&#30340;&#20803;&#32032; &#32780;&#19981;&#26159;&#19968;&#33324;&#30340;kons-sexp
     &#23427;&#25152;&#33021;&#24418;&#25104;&#30340;&#24490;&#29872;&#24456;&#31777;&#21934;
   + &#19968;&#33324;&#30340;kons-sexp&#33021;&#24418;&#25104;&#22810;&#40636;&#19968;&#33324;&#30340;&#22294;&#65311;
     &#39318;&#20808;&#26159;&#19968;&#38982;&#27193;
     &#35201;&#26126;&#30333; &#36889;&#35023;&#26159;&#29992;list&#20570;&#29234;&#27193;&#30340;&#27169;&#22411; &#32780;&#19981;&#26159;&#29992;pair
     &#22240;&#29234;pair&#23565;branch&#30340;&#25976;&#30446;&#26377;&#39023;&#31034;
     &#20363;&#22914;((1) (2) (3))&#26159;&#19968;&#20491;&#31680;&#40670;
     &#23427;&#30340;&#23376;&#31680;&#40670;&#26159; &#19977;&#20491;&#33865;&#31680;&#40670;&#65306;(1) (2) (3)
     &#32780;1 2 3&#26159;&#29992;&#20358;&#21312;&#20998;&#36889;&#20123;&#33865;&#31680;&#40670;&#30340;&#27161;&#35352;
     &#36889;&#27171;&#27599;&#20491;&#31680;&#40670;&#23601;&#37117;&#26159;&#19968;&#20491;list
     &#22312;&#36889;&#31278;&#27169;&#22411;&#19979;
     &#25226;list&#26411;&#23614;cons&#30340;'()&#25563;&#25104;&#27193;&#20013;&#30340;&#20854;&#23427;&#31680;&#40670;&#30340;&#22320;&#22336;&#30340;&#36942;&#31243;
     &#23601;&#21487;&#20197;&#34987;&#35222;&#29234;&#26159;&#32102;&#21407;&#20358;&#30340;&#27193;&#20013;&#30340;&#31680;&#40670;&#20043;&#38291;&#22686;&#28155;&#26377;&#21521;&#37002;
     &#22914;&#26524;&#24573;&#30053;&#36889;&#20123;&#22686;&#28155;&#30340;&#26377;&#21521;&#37002;&#30340;&#26041;&#21521;
     &#37027;&#40636;&#39023;&#28982;&#23601;&#24471;&#21040;&#20102;&#19968;&#20491;&#20219;&#24847;&#28961;&#21521;&#22294;&#30340;&#19968;&#33324;&#34920;&#31034;&#26041;&#27861;
     &#21839;&#38988;&#26159;&#24456;&#38627;&#21028;&#26039;&#20841;&#20491;&#34920;&#31034;&#26159;&#21542;&#34920;&#31034;&#30528;&#21516;&#19968;&#20491;&#22294;
     &#36889;&#26159;&#25152;&#38656;&#35201;&#30340;&#26368;&#22522;&#26412;&#30340;&#35586;&#35422; &#36889;&#32317;&#26159;&#34920;&#31034;&#30340;&#38627;&#40670;
     + sexp&#23565;&#27193;&#32080;&#27083;&#30340;&#34920;&#31034; &#20854;&#24615;&#36074;&#26159;&#65306;
       1) &#27599;&#19968;&#20491;&#34920;&#31034;&#37117;&#34920;&#31034;&#30528;&#21807;&#19968;&#30340;&#19968;&#20491;&#27193;
       2) &#20006;&#19988;&#25152;&#26377;&#30340;&#27193;&#37117;&#33021;&#29992;sexp&#34920;&#31034;&#20986;&#20358;
       &#36889;&#27171;sexp&#21644;&#27193;&#23601;&#26159;&#31561;&#20729;&#30340;
     &gt;&lt;&#36996;&#26377;&#19968;&#20491;&#21839;&#38988;&#23601;&#26159;&#19968;&#33324;&#30340;&#26377;&#21521;&#22294;&#24590;&#40636;&#36774;&#65311;
     &gt;&lt;&#28961;&#31406;&#30340;&#22294;&#21448;&#24590;&#40636;&#36774;&#65311;
     &gt;&lt;&#26377;&#38480;&#29376;&#24907;&#27231;&#21487;&#20197;&#29992;&#20358;&#23531;&#35586;&#35422; &#20294;&#26159;&#24456;&#19981;&#29702;&#24819;
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">finite-lenkth</span>
     (<span class="keyword">lambda</span> (p)
       (<span class="keyword">letcc</span> infinite
              (<span class="keyword">letrec</span>
                  ((C (<span class="keyword">lambda</span> (p q)
                        (<span class="keyword">cond</span> ((null? q) 0)
                              ((null? (kdr q)) 1)
                              ((same? p q) (infinite #f))
                              (<span class="keyword">else</span>
                               (+ (C (sl p) (qk q))
                                  2)))))
                   (qk (<span class="keyword">lambda</span> (x) (kdr (kdr x))))<span class="comment-delimiter">;</span><span class="comment">quickly
</span>                   (sl (<span class="keyword">lambda</span> (x) (kdr x)))<span class="comment-delimiter">;</span><span class="comment">slowly
</span>                   )
                (<span class="keyword">cond</span> ((null? p) 0)
                      (<span class="keyword">else</span>
                       (add1 (C p (kdr p)))))))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* 19 absconding with the jewels</span>
<span class="org-level-2">** deep again</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">deep</span>
     (<span class="keyword">lambda</span> (m)
       (<span class="keyword">if</span> (zero? m)
           'pizza
           (cons (deep (sub1 m)) '()))))
   (deep 12)

   (<span class="keyword">define</span> <span class="function-name">toppings</span>)
   (<span class="keyword">define</span> <span class="function-name">deepB</span>
     (<span class="keyword">lambda</span> (m)
       (<span class="keyword">cond</span> ((zero? m)
              (<span class="keyword">letcc</span> jump
                     (<span class="keyword">set!</span> toppings jump)
                     'pizza))
             (<span class="keyword">else</span>
              (cons (deepB (sub1 m)) '())))))
   (deepB 2)
   (cons (toppings 'k) (toppings 'kk))

   (<span class="keyword">define</span> <span class="function-name">deep&amp;co</span><span class="comment-delimiter">;</span><span class="comment">collector
</span>     (<span class="keyword">lambda</span> (m k)
       (<span class="keyword">cond</span> ((zero? m) (k 'pizza))
             (<span class="keyword">else</span>
              (deep&amp;co (sub1 m)
                       (<span class="keyword">lambda</span> (x)
                         (k (cons x '()))))))))
   (deep&amp;co 10 (<span class="keyword">lambda</span> (x) x))

   (<span class="keyword">define</span> <span class="function-name">deep&amp;coB</span>
     (<span class="keyword">lambda</span> (m k)
       (<span class="keyword">cond</span> ((zero? m)
              (<span class="keyword">let</span> ()
                (<span class="keyword">set!</span> toppings k)
                (k 'pizza)))
             (<span class="keyword">else</span>
              (deep&amp;coB (sub1 m)
                        (<span class="keyword">lambda</span> (x)
                          (k (cons x '()))))))))
   (deep&amp;coB 20 (<span class="keyword">lambda</span> (x) x))
   (cons (toppings 'a)
         (cons (toppings 'b)
               (cons (toppings 'c)
                     '())))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** kill-the-orc-hero</span>
   &gt;&lt;letcc&#21040;&#24213;&#26159;&#22914;&#20309;&#23526;&#29694;&#30340;&#65311;

   &#38614;&#28982;&#25105;&#30693;&#36947;&#23427;&#26159;&#30340;&#24190;&#31278;&#20351;&#29992;&#26041;&#24335;
   &#20294;&#26159;&#19981;&#30693;&#36947;&#23427;&#26159;&#22914;&#20309;&#23526;&#29694;&#30340;&#23601;&#27794;&#27861;&#23436;&#20840;&#30637;&#35299;&#23427;

   letcc&#26159;&#20154;&#26063;&#22823;&#27861;&#24107;&#30340;&#19968;&#20491;&#39764;&#27861;
   &#22823;&#27861;&#24107;&#29992;&#36889;&#20491;&#39764;&#27861;&#21046;&#20316;&#19968;&#20491;&#27161;&#35352;&#29234;&lt;marker&gt;&#30340;&#20659;&#36865;&#21367;&#36600;
   (letcc &lt;marker&gt;
   &lt;sexp1&gt;
   &lt;sexp2&gt;
   ...)
   &#22823;&#27861;&#24107;&#20316;&#36889;&#20491;&#21367;&#36600;&#30340;&#30446;&#30340;&#26159;
   &#24076;&#26395;&#25136;&#22763;&#20497;&#25226;&#20182;&#28212;&#26395;&#24471;&#21040;&#30340;&#23542;&#29289;&#25110;&#32773;&#28212;&#26395;&#20132;&#25163;&#30340;&#25973;&#20154;&lt;sexp*&gt;
   &#24478;&#25136;&#22580;&#19978;&#24118;&#21040;&#20182;&#38754;&#21069;
   &#22823;&#27861;&#24107;&#25226;&#21367;&#36600;&#30332;&#25918;&#32102;&#36889;&#20491;&#25136;&#22580;&#19978;&#30340;&#20154;&#26063;&#25136;&#22763;&#20497;
   &#25136;&#22763;&#21487;&#20197;&#36890;&#36942;(&lt;marker&gt; &lt;sexp*&gt;)&#20358;&#20351;&#29992;&#21367;&#36600;
   &#25226;&#33258;&#24049;&#21644;&#33258;&#24049;&#38754;&#21069;&#30340;&lt;sexp*&gt;&#20659;&#36865;&#22238;&#35069;&#20316;&#21367;&#36600;&#30340;&#22320;&#26041;
   &#25136;&#22763;&#20063;&#21487;&#20197;&#29992;(set! &lt;var&gt; &lt;marker&gt;)&#25226;&#21367;&#36600;&#36890;&#36942;&lt;var&gt;&#24118;&#20986;&#30070;&#21069;&#30340;&#25136;&#22580;
   &#28982;&#24460;&#22312;&#21029;&#30340;&#22320;&#26041;&#20197;(&lt;var&gt; &lt;sexp*&gt;)&#20043;&#21517;&#20351;&#29992;&#21367;&#36600;
   &#25226;&#20351;&#29992;&#32773;&#33287;&#20351;&#29992;&#32773;&#38754;&#21069;&#30340;&lt;sexp*&gt;&#20659;&#36865;&#22238;&#35069;&#20316;&#21367;&#36600;&#30340;&#22320;&#26041;
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">kill-the-orc-hero</span>
     (<span class="keyword">lambda</span> (battle-field)
       (<span class="keyword">let</span> ((find-him (<span class="keyword">lambda</span> (battle-field)
                        (<span class="keyword">letcc</span> bring-him-to-master
                               (<span class="keyword">set!</span> knight bring-him-to-master)
                               (go-and-search battle-field))))
             (kill-him (<span class="keyword">lambda</span> (him)
                         (list 'kill-you 'aha <span class="string">"---&gt;&gt;&gt;"</span> him))))
         (kill-him (find-him battle-field)))))
   (<span class="keyword">define</span> <span class="function-name">knight</span>)
   (<span class="keyword">define</span> <span class="function-name">go-and-search</span>
     (<span class="keyword">lambda</span> (battle-field)
       (<span class="keyword">cond</span> ((null? battle-field) <span class="string">"nobody in the battle-field"</span>)
             ((atom? (car battle-field))
              (<span class="keyword">if</span> (eq? (car battle-field) 'orc-hero)
                  (knight (car battle-field))
                  (go-and-search (cdr battle-field))))
             (<span class="keyword">else</span>
              (<span class="keyword">let</span> ()
                (go-and-search (car battle-field))
                (go-and-search (cdr battle-field)))))))
   (kill-the-orc-hero
    '((((1(331(3((3(1()31)4))132) 412414() 43241() ()) () 1344((43(((124())3413) ('orc-hero)))143))423)134)324))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-todo">&gt;&lt;</span><span class="org-level-2"> two-in-a-row*?</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">two-in-a-row?</span>
     (<span class="keyword">lambda</span> (lat)
       (<span class="keyword">letrec</span>
           ((W (<span class="keyword">lambda</span> (a lat)
                 (<span class="keyword">cond</span> ((null? lat) #f)
                       (<span class="keyword">else</span>
                        (<span class="keyword">let</span> ((nxt (car lat)))
                          (<span class="keyword">or</span> (eq? a nxt)
                              (W nxt (cdr lat)))))))))
         (<span class="keyword">cond</span> ((null? lat) #f)
               (<span class="keyword">else</span>
                (W (car lat) (cdr lat)))))))
   (two-in-a-row? '(1 2 3 4 5 6))
<span class="org-block-end-line">   #+end_src
</span>
   then two-in-a-row*? will do the same, regardless of parentheses
   but it is long way to go

   walk is like ``leftmost'' if we put the rigth kind of value into leave
   &#20854;&#23526;&#26159;&#25226;leftmost&#20998;&#35299;&#25104;&#24190;&#37096;&#20998; &#22240;&#29234;&#38656;&#35201;&#20998;&#21029;&#21629;&#21517; &#20197;&#22312;&#21029;&#34389;&#38728;&#27963;&#20351;&#29992;
   + &#20351;&#29992;letcc&#30340;&#21478;&#19968;&#31278;&#20856;&#22411;&#26041;&#24335;
     &#26356;&#22909;&#30340;&#26041;&#27861;
     &#22240;&#29234;&#26356;&#38728;&#27963;
     &#22240;&#29234;&#36889;&#27171;&#23601;&#21487;&#20197;&#25226;&#20989;&#25976;&#20998;&#38283;&#20358;&#23531;
   &#19979;&#38754;&#30340;&#20989;&#25976;&#21517;``walk'' ``waddle''&#26159;&#35498;&#20320;&#21482;&#19981;&#36942;&#26159;&#22312;&#36451;&#36314;&#23416;&#27493;&#21602; &#25152;&#20197;&#19981;&#35201;&#29275;&#36924;
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">leave</span>)
   (<span class="keyword">define</span> <span class="function-name">walk</span>
     (<span class="keyword">lambda</span> (l)
       (<span class="keyword">cond</span> ((null? l) '())
             ((atom? (car l))
              (leave (car l)))
             (<span class="keyword">else</span>
              (<span class="keyword">let</span> ()
                (walk (car l))
                (walk (cdr l)))))))
   (<span class="keyword">define</span> <span class="function-name">start-it</span>
     (<span class="keyword">lambda</span> (l)
       (<span class="keyword">letcc</span> here
              (<span class="keyword">set!</span> leave here)
              (walk l))))
   (start-it '(((((((((((((!)))))132)3)12)3)213)))))
   (<span class="keyword">define</span> <span class="function-name">fill</span>)
   (<span class="keyword">define</span> <span class="function-name">waddle</span>
     (<span class="keyword">lambda</span> (l)
       (<span class="keyword">cond</span> ((null? l) '())
             ((atom? (car l))
              (<span class="keyword">let</span> ()
                (<span class="keyword">letcc</span> rest
                       (<span class="keyword">set!</span> fill rest)
                       (leave (car l)))
                (waddle (cdr l))))
             (<span class="keyword">else</span>
              (<span class="keyword">let</span> ()
                (waddle (car l))
                (waddle (cdr l)))))))
   <span class="comment-delimiter">;; </span><span class="comment">why we need the following get-next then this one?
</span>   <span class="comment-delimiter">;; </span><span class="comment">(define start-it2
</span>   <span class="comment-delimiter">;;   </span><span class="comment">(lambda (l)
</span>   <span class="comment-delimiter">;;     </span><span class="comment">(letcc here
</span>   <span class="comment-delimiter">;;            </span><span class="comment">(set! leave here)
</span>   <span class="comment-delimiter">;;            </span><span class="comment">(waddle l))))
</span>   <span class="comment-delimiter">;; </span><span class="comment">(start-it2 '(((((((((((((!)))))132)3)12)3)213)))))
</span>   <span class="comment-delimiter">;; </span><span class="comment">(start-it2 '())
</span>   (<span class="keyword">define</span> <span class="function-name">get-next</span>
     (<span class="keyword">lambda</span> (x)
       (<span class="keyword">letcc</span> here-again
              (<span class="keyword">set!</span> leave here-again)
              (fill 'go))))
   (get-next 'go)
   (<span class="keyword">define</span> <span class="function-name">get-first</span>
     (<span class="keyword">lambda</span> (l)
       (<span class="keyword">letcc</span> here
              (<span class="keyword">set!</span> leave here)
              (waddle l)
              (leave '()))))
   (get-first '(((((((((((((!)))))132)3)12)3)213)))))
   (get-first '())
<span class="org-block-end-line">   #+end_src
</span>   &#19978;&#38754;&#22240;&#29234;&#20351;&#29992;&#20102;&#24456;&#22810;set!&#32780;&#20351;get-next&#23436;&#20840;&#34389;&#38626;&#20102;&#25976;&#23416;&#20989;&#25976;&#30340;&#31684;&#22285;

   then it is easy to define two-in-a-row*?
<span class="org-block-begin-line">   #+begin_src scheme
</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-todo">note</span>
   ``during the evaluation of a scheme expression
   the implementation must keep track of two things:
   1) what to evaluate
   2) what to do with the value.''

   ``we call `what to do with the value'
   the continuation of a computation''

   --kent dybvig

   &#21407;&#20358;call/cc&#20013;&#30340;``cc''&#23601;&#26159;&#25351;&#23637;&#38283;&#36958;&#27512;&#20989;&#25976;&#30340;&#36942;&#31243;&#20013;&#36935;&#21040;call/cc&#26178;&#30340;``&#30070;&#21069;&#29376;&#24907;''
   &#32780;(set! fill rest)&#23559;&#25226;(letcc rest ...)&#20301;&#32622;&#34389;&#30340;&#29376;&#24907;&#20445;&#23384;&#36215;&#20358;
   &#22312;&#22806;&#38754;&#20986;&#29694;&#20316;&#29992;fill&#30340;&#26178;&#20505;&#23559;&#22238;&#21040;&#36889;&#20491;&#20301;&#32622;&#25152;&#23565;&#25033;&#30340;&#35336;&#31639;&#29376;&#24907;
   + &#22240;&#27492;&#25226;(letcc &lt;marker&gt; &lt;sexp&gt;)&#20351;&#29992;&#22312;&#26368;&#22806;&#38754;
     &#20006;&#19988;&#22312;&lt;sexp&gt;&#20013;&#30452;&#25509;&#20351;&#29992;(&lt;marker&gt; &lt;sexp*&gt;)&#30340;&#25928;&#26524;&#23601;&#26159;
     &#30452;&#25509;&#20013;&#26039;&#36958;&#27512;&#35336;&#31639;&#32780;&#36820;&#22238;&lt;sexp*&gt;&#30340;&#32080;&#26524;
   &#22312;(letcc &lt;marker&gt; &lt;sexp&gt;)&#30340;&lt;sexp&gt;&#20043;&#20013;
   + &#25110;&#32773;&#22312;&#22810;&#20491;&lt;sexp&gt;&#32068;&#25104;&#30340;&lt;body&gt;&#20043;&#20013;
     &#19968;&#20123;&#29992;&#20358;&#21103;&#20316;&#29992;
     &#26368;&#24460;&#19968;&#20491;&#29992;&#20358;&#36820;&#22238;&#20540;
     &#22914;&#26524;&lt;body&gt;&#20013;&#21069;&#38754;&#30340;&lt;sexp&gt;&#20013;&#26377;&lt;marker&gt;&#30340;action&#20986;&#29694; &#24460;&#38754;&#30340;&#30070;&#28982;&#26371;&#34987;&#24573;&#30053;
<span class="org-block-begin-line">     #+begin_src scheme
</span>     (<span class="keyword">define</span> <span class="function-name">test-cc</span>
       (<span class="keyword">lambda</span> ()
         (<span class="keyword">letcc</span> kkk
                123
                456
                (kkk <span class="string">"good"</span>)
                (kkk <span class="string">"bad"</span>))))
     (test-cc)
<span class="org-block-end-line">     #+end_src
</span>   &lt;marker&gt;&#26159;&#19968;&#20491;&#21934;&#21443;&#25976;&#30340;procedure&#30340;name
   &#36889;&#20491;procedure&#30340;action&#65306;(&lt;marker&gt; &lt;sexp*&gt;)
   &#23559;&#25226;&lt;sexp*&gt;&#20195;&#20837;&#21040;&#22312;&#23637;&#38283;&#36958;&#27512;&#20989;&#25976;&#30340;&#36942;&#31243;&#20013;&#36935;&#21040;(letcc ...)&#30340;&#37027;&#20491;&#20301;&#32622;

   &#26356;&#22909;&#30340;&#35498;
   procedure&#30340;action&#30340;&#27714;&#20540;&#26159;&#19968;&#20491;&#23637;&#38283;&#36942;&#31243;
   &#22240;&#29234;&#23427;&#35201;&#31561;&#24453;fun&#37096;&#20998;&#21644;args&#37096;&#20998;&#30340;&#27714;&#20540;&#32080;&#26524;
   &#22312;&#36889;&#20491;&#23637;&#38283;&#36942;&#31243;&#20013;
   &#25226;&#20219;&#24847;&#19968;&#20491;&#38656;&#35201;&#34987;&#31561;&#24453;&#27714;&#20540;&#32080;&#26524;&#30340;&#20301;&#32622;&#31354;&#20986;&#20358;
   &#23601;&#26371;&#24418;&#25104;&#19968;&#20491;&#19968;&#20803;&#30340;procedure
   + &#30070;&#28982; &#23565;fun&#37096;&#20998;&#21644;args&#37096;&#20998;&#30340;&#27714;&#20540;&#26159;&#25353;&#38918;&#24207;&#19968;&#20491;&#19968;&#20491;&#27714;&#30340;
     &#35201;&#24819;&#24418;&#25104;&#19968;&#20491;&#19968;&#20803;&#30340;procedure
     &#23601;&#24517;&#38920;&#35201;&#35352;&#20303;&#37027;&#20123;&#36996;&#22312;&#31561;&#24453;&#20013;&#30340;&#20301;&#32622;&#25033;&#35442;&#22914;&#20309;&#34987;&#27714;&#20540;
   &#36889;&#20491;&#19968;&#20803;&#30340;procedure&#23601;&#26159;``call/cc''&#20013;&#30340;``cc''
   &#22914;&#26524;&#19968;&#20491;&#38656;&#35201;&#34987;&#31561;&#24453;&#27714;&#20540;&#32080;&#26524;&#30340;&#20301;&#32622;&#21407;&#26412;&#26159;&lt;sexp&gt;
   &#37027;&#40636;&#21482;&#35201;&#25226;&#23427;&#26367;&#25563;&#29234;(letcc &lt;marker&gt; &lt;sexp&gt;)
   &#23601;&#21487;&#20197;&#25226;&#19978;&#38754;&#25152;&#35498;&#30340;&#19968;&#20803;&#30340;procedure&#20445;&#23384;&#21040;
   &#29234;&#21517;&#23383;&lt;marker&gt;&#25152;&#38283;&#38370;&#30340;&#23384;&#20786;&#22320;&#22336;&#30070;&#20013;
   + &#36889;&#20491;&lt;marker&gt;&#30340;binding&#21482;&#22312;&#36889;&#20491;(letcc ...)&#20013;&#21487;&#35211;
     &#22240;&#27492;
     &#22914;&#26524;&#22312;&lt;sexp&gt;&#20013;&#19981;&#20986;&#29694;&#36889;&#20491;&lt;marker&gt;&#25152;&#23565;&#25033;&#30340;&#19968;&#20803;&#30340;procedure&#30340;action
     &#20063;&#19981;&#25226;&#36889;&#20491;&#19968;&#20803;&#30340;procedure&#21033;&#29992;(set! &lt;var&gt; &lt;marker&gt;)&#20445;&#23384;&#22312;&#21029;&#34389;
     &#30340;&#35441;
     &#37027;&#40636;letcc&#30340;&#20986;&#29694;&#26159;&#27794;&#26377;&#24847;&#32681;&#30340;
     &#20854;&#23526;&#20063;&#21487;&#20197;&#26159;&#26377;&#24847;&#32681;&#30340; &#27604;&#22914;&#19979;&#38754;&#36889;&#20491;&#20363;&#23376;
<span class="org-block-begin-line">     #+begin_src scheme
</span>     ((<span class="keyword">lambda</span> (x)
        (x (<span class="keyword">lambda</span> (ignore) <span class="string">"hi"</span>)))
      (<span class="keyword">letcc</span> k k))
<span class="org-block-end-line">     #+end_src
</span>   &#36889;&#27171;&#19968;&#20999;&#23601;&#37117;&#26126;&#30333;&#20102;
   + &#32780;letcc&#32102;&#20986;&#20102;&#36889;&#31278;&#35486;&#32681;&#30340;&#26368;&#28165;&#26224;&#30340;&#35486;&#27861;
     &#21448;&#29234;&#20160;&#40636;&#26377;call/cc&#36889;&#31278;&#19981;&#28165;&#26224;&#30340;&#35486;&#27861;?
     &#22240;&#29234;&#23427;&#25581;&#31034;&#20102;call/cc&#30340;&#23526;&#29694;&#26041;&#24335;&#21966;?
   + &#19968;&#20491;&#21839;&#38988;&#26159;&#21487;&#19981;&#21487;&#20197;&#23884;&#22871;&#65311;
     &#21363; &#20195;&#20837;&#20043;&#24460;&#26159;&#19981;&#26159;&#24471;(letcc &lt;marker&gt; &lt;sexp*&gt;)
<span class="org-block-begin-line">     #+begin_src scheme
</span>     (<span class="keyword">define</span> <span class="function-name">test-cc</span>
       (<span class="keyword">lambda</span> ()
         (<span class="keyword">letcc</span> kkk
                (kkk
                 (kkk <span class="string">"good"</span>)))))
     (test-cc)
<span class="org-block-end-line">     #+end_src
</span>     &#32080;&#26524;&#30906;&#23526;&#26159;&#22914;&#27492;&lt;marker&gt;&#22312;&lt;sexp&gt;&#20013;&#30340;&#20986;&#29694;&#26159;&#21487;&#20197;&#23884;&#22871;&#30340;
<span class="org-level-2">** play with call/cc</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">let</span> ([x (<span class="keyword">call/cc</span> (<span class="keyword">lambda</span> (k) k))])
     (x (<span class="keyword">lambda</span> (ignore) <span class="string">"hi"</span>)))
   ((<span class="keyword">lambda</span> (x)
      (x (<span class="keyword">lambda</span> (ignore) <span class="string">"hi"</span>)))
    (<span class="keyword">letcc</span> k k))

   (<span class="keyword">define</span> <span class="function-name">k</span> (<span class="keyword">letcc</span> x x))
   (k (<span class="keyword">lambda</span> (ignore) <span class="string">"hi"</span>))
   <span class="comment-delimiter">;; </span><span class="comment">&#31532;&#19968;&#27425;&#27714;&#20540;&#30340;&#26178;&#20505;&#26371;
</span>   <span class="comment-delimiter">;; </span><span class="comment">(define k (lambda (ignore) "hi"))
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#20877;&#27425;&#27714;&#20540;&#30340;&#26178;&#20505;&#23601;&#33287;(letcc x x)&#28961;&#38364;&#20102;
</span>
   (((<span class="keyword">letcc</span> k k)
     (<span class="keyword">lambda</span> (x) x))
    <span class="string">"HEY!"</span>)
<span class="org-block-end-line">   #+end_src
</span>
   the following mechanism could be the basis
   for a breakpoint package implemented with call/cc
   each time a breakpoint is encountered
   the continuation of the breakpoint is saved
   so that the computation may be restarted from the breakpoint
   more than once if desired
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">retry</span>)
   (<span class="keyword">define</span> <span class="function-name">factorial</span>
     (<span class="keyword">lambda</span> (x)
       (<span class="keyword">if</span> (= x 0)
           (<span class="keyword">letcc</span> k
                  (<span class="keyword">set!</span> retry k)
                  1)
           (* x (factorial (- x 1))))))
<span class="org-block-end-line">   #+end_src
</span>
   &#22914;&#20309;&#20351;&#29992;lwp? &#20160;&#40636;&#26159;multitasking
   &#23601;&#26159;&#20989;&#25976;&#20497;&#22312;&#36820;&#22238;&#20540;&#20043;&#21069;&#30456;&#20114;&#21830;&#37327;?
   ``the simple "light-weight process" mechanism
   defined below allows multiple computations to be interleaved
   since it is nonpreemptive
   it requires that each process voluntarily "pause" from time to time
   in order to allow the others to run''
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">lwp-list</span> '())
   (<span class="keyword">define</span> <span class="function-name">lwp</span><span class="comment-delimiter">;; </span><span class="comment">denote light-weight process
</span>     (<span class="keyword">lambda</span> (thunk)
       (<span class="keyword">set!</span> lwp-list (append lwp-list (list thunk)))))
   (<span class="keyword">define</span> <span class="function-name">start</span>
     (<span class="keyword">lambda</span> ()
       (<span class="keyword">let</span> ([p (car lwp-list)])
         (<span class="keyword">set!</span> lwp-list (cdr lwp-list))
         (p))))
   (<span class="keyword">define</span> <span class="function-name">pause</span>
     (<span class="keyword">lambda</span> ()
       (<span class="keyword">letcc</span> k
              (lwp (<span class="keyword">lambda</span> () (k #f)))
              (start))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* CPS</span>
  ``&#25226;&#20219;&#24847;&#19968;&#20491;&#38656;&#35201;&#34987;&#31561;&#24453;&#27714;&#20540;&#32080;&#26524;&#30340;&#20301;&#32622;&#31354;&#20986;&#20358;
  &#23601;&#26371;&#24418;&#25104;&#19968;&#20491;&#19968;&#20803;&#30340;procedure''
  &#20294;&#26159;&#36889;&#31278;&#24819;&#27861;&#21482;&#33021;&#20316;&#20986;&#19968;&#20803;procedure
  CPS&#21487;&#20197;&#23526;&#29694;&#20316;&#29234;&#22810;&#20803;procedure&#30340;continuation

  1. &#25105;&#25152;&#25797;&#38263;&#30340;&#23601;&#26159;&#22312;&#19979;&#38754;&#36889;&#31278;&#38957;&#33126;&#39080;&#26292;&#20013;&#32317;&#32080;&#25105;&#25152;&#35264;&#23519;&#21040;&#30340;&#35215;&#24459;
     &#19981;&#31649;&#27491;&#30906;&#19981;&#27491;&#30906;
     &#20808;&#24418;&#25104;&#19968;&#20491;&#33258;&#24049;&#30340;&#35469;&#35672;
     &#23565;&#25152;&#24418;&#25104;&#30340;&#36889;&#31278;&#35469;&#35672;&#30340;&#24907;&#24230;&#30070;&#28982;&#26159;
     &#21482;&#35201;&#26377;&#26356;&#28165;&#26224;&#26356;&#26377;&#21147;&#30340;&#26041;&#24335; &#25105;&#23601;&#19968;&#23450;&#35731;&#23427;&#20195;&#26367;&#25105;&#30340;&#33290;&#35469;&#35672;
  2. h&#34987;&#35519;&#29992;&#30340;&#20301;&#32622;&#30340;&#25913;&#35722;
     h&#34987;&#19968;&#20491;cons&#30340;&#20316;&#29992;&#35519;&#29992;(&#36889;&#20491;&#35519;&#29992;&#25152;&#24418;&#25104;&#30340;cc&#34987;&#26126;&#39023;&#30340;&#23531;&#20102;&#20986;&#20358;)
     &#32622;&#29234;
     h&#30340;&#20316;&#29992; &#20854;&#20013;h&#26159;&#22312;&#24460;&#38754;&#22686;&#21152;&#20102;&#19968;&#20491;&#21443;&#25976;&#20301;&#32622;&#30340;
     &#37027;&#20491;cc&#34987;&#26126;&#39023;&#22320;&#23531;&#20986;&#20358;&#20006;&#19988;&#34987;&#25918;&#20837;&#37027;&#20491;&#26032;&#30340;&#21443;&#25976;&#20301;&#32622;
  3. h&#30340;&#23450;&#32681;&#20301;&#32622;&#30340;&#25913;&#35722; h&#30340;&#23450;&#32681;&#35519;&#29992;&#20102;g &#22240;&#27492;&#36889;&#20063;&#26159;g&#30340;&#34987;&#35519;&#29992;&#30340;&#20301;&#32622;&#30340;&#25913;&#35722;
     &#22240;&#29234;&#30452;&#25509;&#26159;g&#30340;&#20316;&#29992;
     &#25152;&#20197;&#24190;&#20046;&#27794;&#20160;&#40636;&#25913;&#35722;&#21482;&#26159;&#32380;&#32396;&#25226;&#36889;&#20491;cc&#20659;&#32102;&#34987;h&#35519;&#29992;&#30340;g
     &#19981;&#29992;&#25913;&#35722;cc
  4. g&#30340;&#23450;&#32681;&#20301;&#32622;&#30340;&#25913;&#35722; &#20063;&#26159;f&#30340;&#35519;&#29992;&#20301;&#32622;&#30340;&#25913;&#35722;
     cons&#30340;&#20316;&#29992;&#35519;&#29992;f
     &#36889;&#20491;&#20316;&#29992;&#24418;&#25104;&#19968;&#20491;&#19968;&#20803;cc (&#35519;&#29992;f&#30340;&#20316;&#29992;&#30340;cc&#21487;&#20197;&#34987;&#35352;&#29234;cc-f(denote cc of f))
     &#21407;&#20358;&#30340;cc&#35201;&#34987; &#36889;&#20491;&#20316;&#29992;&#25152;&#24418;&#25104;&#30340;cc&#20358;&#25844;&#20805;
     &#20043;&#24460;&#25165;&#33021;&#34987;&#20659;&#20837;f&#30340;&#26032;&#21443;&#25976;&#20301;&#32622;
     &#36889;&#20491;&#25844;&#20805;&#31777;&#21934;&#22320;&#35498;&#23601;&#26159;&#25226;&#21407;&#20358;&#30340;cc&#20316;&#29992;&#22312;&#36889;&#20491;cc-f&#19978;&#24418;&#25104;&#19968;&#20491;&#26032;&#30340;cc
  5. f&#30340;&#23450;&#32681;&#20301;&#32622;&#30340;&#25913;&#35722;
     f&#19981;&#20877;&#35519;&#29992;&#20219;&#20309;non-primitive&#20102;
     &#25152;&#20197;&#36889;&#35023;&#31777;&#21934;&#30340;&#23601;&#26159;&#36889;&#35023;&#30340;&#34920;&#36948;&#24335;&#35201;&#34987;&#20659;&#20837;f&#30340;&#26032;&#21443;&#25976;&#20301;&#32622;&#30340;cc&#20316;&#29992;
<span class="org-block-begin-line">  #+begin_src scheme
</span>  (cons 'd
        (cons 'b
              (cons 'a
                    (cons 'c '()))))

  (<span class="keyword">letrec</span> ([f (<span class="keyword">lambda</span> (x) (cons 'a x))]
           [g (<span class="keyword">lambda</span> (x) (cons 'b (f x)))]
           [h (<span class="keyword">lambda</span> (x) (g (cons 'c x)))])
    (cons 'd (h '())))

  (<span class="keyword">letrec</span> ([f (<span class="keyword">lambda</span> (x k) (k (cons 'a x)))]
           [g (<span class="keyword">lambda</span> (x k) (f x
                           (<span class="keyword">lambda</span> (v) (k (cons 'b v)))))]
           [h (<span class="keyword">lambda</span> (x k) (g (cons 'c x)
                           k))])
    (h '()
       (<span class="keyword">lambda</span> (v) (cons 'd v))))
<span class="org-block-end-line">  #+end_src
</span>  not-CPS and CPS
<span class="org-block-begin-line">  #+begin_src scheme
</span>  (<span class="keyword">define</span> <span class="function-name">f</span> (x)
    <span class="type">&lt;sexp&gt;</span>)
  (g (f x))

  (<span class="keyword">define</span> <span class="function-name">f</span> (x cc-f)
    (cc-f <span class="type">&lt;sexp&gt;</span>))
  (f x
     (<span class="keyword">lambda</span> (y) (g y)))
<span class="org-block-end-line">  #+end_src
</span>
  CPS&#21487;&#20197;&#23526;&#29694;&#19968;&#20491;&#20989;&#25976;&#20316;&#29992;&#22312;&#19981;&#21516;&#30340;&#26781;&#20214;&#19979;&#29554;&#24471;&#19981;&#21516;&#30340;cc&#30340;&#25928;&#26524;
  &#19979;&#38754;&#30340;&#20989;&#25976;&#25509;&#21463;cc&#21443;&#25976;&#30340;&#21443;&#25976;&#20301;&#32622;&#26159;&#24460;&#20841;&#20491;
  integer-divide&#25104;&#21151;&#26178;&#36820;&#22238;&#21830;&#33287;&#39192;&#25976;&#30340;list
<span class="org-block-begin-line">  #+begin_src scheme
</span>  (<span class="keyword">define</span> <span class="function-name">integer-divide</span>
    (<span class="keyword">lambda</span> (x y success failure)
      (<span class="keyword">if</span> (= y 0)
          (failure <span class="string">"divide by zero"</span>)
          (<span class="keyword">let</span> ([q (quotient x y)])
            (success q (- x (* q y)))))))
  (integer-divide 10 3 list (<span class="keyword">lambda</span> (x) x))
  (integer-divide 10 0 list (<span class="keyword">lambda</span> (x) x))
<span class="org-block-end-line">  #+end_src
</span>  ``explicit success and failure continuations
  can sometimes help to avoid the extra communication necessary
  to separate successful execution of a procedure
  from unsuccessful execution
  furthermore
  it is possible to have multiple success or failure continuations
  for different flavors of success or failure
  each possibly taking different numbers and types of arguments''

  ``any program that uses call/cc can be rewritten in cps without call/cc
  but a total rewrite of the program
  (sometimes including even system-defined primitives)
  might be necessary''
<span class="org-block-begin-line">  #+begin_src scheme
</span>  (<span class="keyword">define</span> <span class="function-name">product</span>
    (<span class="keyword">lambda</span> (ls)
      (<span class="keyword">letcc</span> break
             (<span class="keyword">let</span> <span class="function-name">f</span> ([ls ls])
               (<span class="keyword">cond</span>
                [(null? ls) 1]
                [(= (car ls) 0) (break 0)]
                [else (* (car ls) (f (cdr ls)))])))))
  (<span class="keyword">define</span> <span class="function-name">product</span>
    (<span class="keyword">lambda</span> (ls)
      (<span class="keyword">letcc</span> break
             (<span class="keyword">letrec</span>
                 ([f (<span class="keyword">lambda</span> (ls)
                       (<span class="keyword">cond</span>
                        [(null? ls) 1]
                        [(= (car ls) 0) (break 0)]
                        [else (* (car ls) (f (cdr ls)))]))]
                  )
               (f ls)))))
  (product '(1 2 3 4 5))
  (product '(7 3 8 0 1 9 5))
  (<span class="keyword">define</span> <span class="function-name">product</span>
    (<span class="keyword">lambda</span> (ls k)
      (<span class="keyword">let</span> ([break k])<span class="comment-delimiter">;</span><span class="comment">&#36889;&#20491;&#36070;&#20540;&#21482;&#29234;&#20102;&#21312;&#20998;k&#30340;&#35486;&#32681; &#20006;&#19988;&#33287;&#19978;&#38754;&#19968;&#33268;
</span>        (<span class="keyword">letrec</span> ([f (<span class="keyword">lambda</span> (ls k)
                      (<span class="keyword">cond</span>
                       [(null? ls) (k 1)]
                       [(= (car ls) 0) (break 0)]
                       [else (f (cdr ls)
                                (<span class="keyword">lambda</span> (x)
                                  (k (* (car ls) x))))]))]
                 )
          (f ls k)))))
  (<span class="keyword">define</span> <span class="function-name">product</span>
    (<span class="keyword">lambda</span> (ls k)
      (<span class="keyword">letrec</span> ([f (<span class="keyword">lambda</span> (ls k)
                    (<span class="keyword">cond</span>
                     [(null? ls) (k 1)]
                     [(= (car ls) 0) (k 0)]
                     [else (f (cdr ls)
                              (<span class="keyword">lambda</span> (x)
                                (k (* (car ls) x))))]))]
               )
        (f ls k))))
  (product '(1 2 3 4 5)
           (<span class="keyword">lambda</span> (x) x))
  (product '(7 3 8 0 1 9 5)
           (<span class="keyword">lambda</span> (x) x))
<span class="org-block-end-line">  #+end_src
</span>  CPS&#20013;recursion&#22312;&#26044;&#25913;&#35722;cc
  &#20854;&#23526;&#36889;&#31278;&#25216;&#24039;&#22312;the little schemer&#30340;&#31532;8&#31456;&#24050;&#32147;&#23416;&#36942;&#20102;
<span class="org-level-1">* internal definitions</span>
  <span class="bold">*internal definitions can appear only at the front of a body*</span>
  <span class="bold">*syntax definitions may appear among the internal definitions*</span>
  &#24590;&#40636;&#33021;&#26377;&#36889;&#31278;&#26481;&#35199;?
  &#23427;&#19981;&#24433;&#38911;&#20195;&#30908;&#28165;&#26224;&#24615;&#30340;&#29992;&#27861;&#22914;&#19979;
<span class="org-block-begin-line">  #+begin_src scheme
</span>  (<span class="keyword">let</span> ()
    (<span class="keyword">define-syntax</span> <span class="variable-name">&lt;key&gt;</span>
      (<span class="keyword">syntax-rules</span> ()
        [<span class="type">&lt;p&gt;</span> <span class="type">&lt;t&gt;</span>]))
    (<span class="keyword">define</span> <span class="function-name">&lt;var1&gt;</span> <span class="type">&lt;sexp1&gt;</span>)
    (<span class="keyword">define</span> <span class="function-name">&lt;var2&gt;</span> <span class="type">&lt;sexp2&gt;</span>)
    (<span class="type">&lt;sexp3&gt;</span>))

  (<span class="keyword">begin</span>
    (<span class="keyword">define-syntax</span> <span class="variable-name">&lt;key&gt;</span>
      (<span class="keyword">syntax-rules</span> ()
        [<span class="type">&lt;p&gt;</span> <span class="type">&lt;t&gt;</span>]))
    (<span class="keyword">define</span> <span class="function-name">&lt;var1&gt;</span> <span class="type">&lt;sexp1&gt;</span>)
    (<span class="keyword">define</span> <span class="function-name">&lt;var2&gt;</span> <span class="type">&lt;sexp2&gt;</span>)
    (<span class="type">&lt;sexp3&gt;</span>))
<span class="org-block-end-line">  #+end_src
</span>  &#22914;&#21516;emacs-lisp&#20013;&#30340;progn
  &#21487;&#20197;&#22312;&#22823;&#30340;&#29872;&#22659;&#20013;&#20998;&#20986;&#20358;&#29544;&#31435;&#30340;&#21312;&#22495;
<span class="org-block-begin-line">  #+begin_src emacs-lisp
</span>  (<span class="keyword">progn</span>
    (<span class="keyword">defun</span> <span class="function-name">&lt;var1&gt;</span> &lt;sexp1&gt;)
    (<span class="keyword">defun</span> <span class="function-name">&lt;var2&gt;</span> &lt;sexp2&gt;)
    (&lt;sexp3&gt;))
<span class="org-block-end-line">  #+end_src
</span>  &#22312;scheme&#20013; &#21487;&#33021;&#38656;&#35201;&#29992;&#36889;&#31278;&#34920;&#31034;&#26041;&#27861;&#30340; &#23601;&#26159;&#19979;&#38754;&#30340;&#24773;&#27841;
  ``variable definitions are guaranteed
  to be evaluated from left to right
  while the bindings of a letrec may be evaluated in any order''
  ``however, use letrec*, which, like let*, guarantees
  left-to-right evaluation order''

  ``internal definitions may be used in conjunction with
  top-level definitions and assignments to help modularize programs
  each module of a program should make visible only those bindings
  that are needed by other modules
  while hiding other bindings
  that would otherwise clutter the top-level namespace
  and possibly result in unintended use
  or redefinition of those bindings''
  ``it does not support the publication of keyword bindings
  since there is no analogue to set! for keywords''
<span class="org-block-begin-line">  #+begin_src scheme
</span>  (<span class="keyword">define</span> <span class="function-name">export-var</span> #f)
  (<span class="keyword">let</span> ()
    (<span class="keyword">define</span> <span class="function-name">&lt;var1&gt;</span> <span class="type">&lt;sexp1&gt;</span>)
    (<span class="keyword">define</span> <span class="function-name">&lt;var2&gt;</span> <span class="type">&lt;sexp2&gt;</span>)
    (<span class="keyword">set!</span> export-var <span class="type">&lt;var1&gt;</span>)
    <span class="type">&lt;sexp3&gt;</span>
    )
<span class="org-block-end-line">  #+end_src
</span><span class="org-level-1">* libraries</span>
<span class="org-block-begin-line">  #+begin_src scheme
</span>  (<span class="keyword">library</span> (<span class="type">grades</span>)
           (<span class="keyword">export</span> gpa-&gt;grade gpa)
           (<span class="keyword">import</span> (rnrs))
           (<span class="keyword">define</span> <span class="function-name">in-range?</span>
             (<span class="keyword">lambda</span> (x n y)
               (<span class="keyword">and</span> (&gt;= n x) (&lt; n y))))
           (<span class="keyword">define-syntax</span> <span class="variable-name">range-case</span>
             (<span class="keyword">syntax-rules</span> (- else)
               [(_ expr ((x - y) e1 e2 ...) ... [else ee1 ee2 ...])
                (<span class="keyword">let</span> ([tmp expr])
                  (<span class="keyword">cond</span>
                   [(in-range? x tmp y) e1 e2 ...]
                   ...
                   [else ee1 ee2 ...]))]
               [(_ expr ((x - y) e1 e2 ...) ...)
                (<span class="keyword">let</span> ([tmp expr])
                  (<span class="keyword">cond</span>
                   [(in-range? x tmp y) e1 e2 ...]
                   ...))]))
           (<span class="keyword">define</span> <span class="function-name">letter-&gt;number</span>
             (<span class="keyword">lambda</span> (x)
               (<span class="keyword">case</span> x
                 [(a)  4.0]
                 [(b)  3.0]
                 [(c)  2.0]
                 [(d)  1.0]
                 [(f)  0.0]
                 [else (assertion-violation 'grade <span class="string">"invalid letter grade"</span> x)])))
           (<span class="keyword">define</span> <span class="function-name">gpa-&gt;grade</span>
             (<span class="keyword">lambda</span> (x)
               (range-case x
                           [(0.0 - 0.5) 'f]
                           [(0.5 - 1.5) 'd]
                           [(1.5 - 2.5) 'c]
                           [(2.5 - 3.5) 'b]
                           [else 'a])))
           (<span class="keyword">define-syntax</span> <span class="variable-name">gpa</span>
             (<span class="keyword">syntax-rules</span> ()
               [(_ g1 g2 ...)
                (<span class="keyword">let</span> ([ls (<span class="keyword">map</span> letter-&gt;number '(g1 g2 ...))])
                  (/ (<span class="keyword">apply</span> + ls) (length ls)))])))
<span class="org-block-end-line">  #+end_src
</span><span class="org-block-begin-line">  #+begin_src scheme
</span>  (<span class="keyword">import</span> (grades))
  (gpa c a c b b)
  (gpa-&gt;grade 2.8)
<span class="org-block-end-line">  #+end_src
</span><span class="org-level-1">* 20 what's in the store? (interpreter-with-define-and-set!)</span>
<span class="org-level-2">** </span><span class="org-todo">note</span>
   1. &#36889;&#19968;&#31456;&#23531;&#19968;&#20491;&#26032;&#30340;&#26377;define&#21644;set!&#30340;&#35299;&#37323;&#22120;
      &#26377;&#19968;&#20491;&#20840;&#23616;&#30340;&#21629;&#21517;&#31354;&#38291;global-table
      &#20197;&#20803;&#35299;&#37323;&#22120;&#20013;&#30340;procedure&#29234;&#26032;&#30340;table(of environment)&#30340;&#25976;&#25818;&#32080;&#27083;
      &#19968;&#20491;table&#23601;&#26159;&#19968;&#20491;procedure
      &#23427;&#20316;&#29992;&#26044;&#19968;&#20491;name&#36820;&#22238;&#36889;&#20491;name&#25152;&#23565;&#25033;&#30340;value
      table&#20013;name&#33287;box&#32129;&#23450; box&#20013;&#23384;&#25918;&#30528;value
      &#20840;&#23616;&#29983;&#25104;&#26032;box&#30340;&#26159;define &#23616;&#37096;&#29983;&#25104;&#26032;box&#30340;&#26159;closure&#30340;&#20316;&#29992;
      box&#21033;&#29992;lambda-exp&#30340;&#25216;&#24039;&#23526;&#29694;&#65288;&#25110;&#32773;&#35498;&#27169;&#25836;&#65289;&#19968;&#31278;&#35370;&#21839;&#27231;&#21046;
      &#26377;&#20102;&#35370;&#21839;&#27231;&#21046; &#23601;&#23526;&#29694;&#20102;set!
   2. &#21482;&#26377;&#23526;&#29694;&#20102;&#21629;&#21517;&#27231;&#21046;&#22312;&#25105;&#30340;&#35299;&#37323;&#22120;&#35023;&#35299;&#37323;&#33258;&#36523;&#25165;&#25104;&#29234;&#21487;&#33021;
   3. &#27880;&#24847;&#36889;&#35023;&#27794;&#26377;apply
      *const&#33287;*lambda&#37117;&#30452;&#25509;&#25226;e&#27714;&#20540;&#25104;&#20102;&#20803;&#35299;&#37323;&#22120;&#20013;&#30340;procedure
      &#35299;&#37323;&#20102;&#19968;&#20123;&#26481;&#35199;&#21371;&#21448;&#30663;&#34109;&#20102;&#21478;&#19968;&#20123;&#26481;&#35199;
      &gt;&lt; &#29234;&#20102;&#23526;&#29694;&#19978;&#38754;&#30340;&#24615;&#29376;&#32780;&#24517;&#38920;&#36889;&#27171;&#20570;&#21966;&#65311;
   4. &#26032;&#22686;&#21152;&#20102;*letcc
      &#20294;&#26159;&#20006;&#27794;&#26377;&#35320;&#21450;letcc&#30340;&#26412;&#36074;
      &#22312;&#25105;&#30340;&#36889;&#20491;&#35299;&#37323;&#22120;&#20013;&#20351;&#29992;letcc&#26159;&#29234;&#20102;&#25214;&#19981;&#21040;name&#26178;&#30340;&#22577;&#37679;
      &#32780;&#22686;&#21152;&#36889;&#20491;*letcc&#23601;&#20351;&#24471;
      &#22312;&#25105;&#30340;&#36889;&#20491;&#35299;&#37323;&#22120;&#20013;&#21487;&#26159;&#23526;&#29694;&#19968;&#20491;&#30456;&#21516;&#30340;
      &#21487;&#20197;&#22312;&#25214;&#19981;&#21040;name&#26178;&#22577;&#37679;&#30340;&#35299;&#37323;&#22120;
<span class="org-level-2">** </span><span class="org-todo">&gt;&lt;</span><span class="org-level-2"> hack</span>
   1. &#26082;&#28982;&#24050;&#32147;&#26371;&#20351;&#29992;letcc&#21644;set!&#20102; &#37027;&#40636;&#25105;&#33021;&#21644;&#36889;&#20491;&#35299;&#37323;&#22120;&#29609;&#30340;&#33457;&#27171;&#23601;&#26377;&#36259;&#22810;&#20102;
   2. &#35430;&#30528;&#22312;&#36889;&#20491;&#35299;&#37323;&#22120;&#20013;&#20351;&#29992;apply
   3. &#35430;&#30528;&#35036;&#20840;&lt;formals&gt;&#30340;&#24418;&#24335;&#65306;
      &lt;variable&gt;
      (&lt;variable&gt;*)
      (&lt;variable&gt; &lt;variable&gt;* . &lt;variable&gt;)
   4. &#29992;&#20803;&#35299;&#37323;&#22120;&#21109;&#36896;&#19968;&#31623;&#20013;&#25991;&#30340;&#35299;&#37323;&#22120;
      &#20197;&#36889;&#20491;&#20013;&#25991;&#30340;&#35299;&#37323;&#22120;&#29234;&#20803;&#35299;&#37323;&#22120;&#20877;&#23531;&#20986;&#32020;&#20013;&#25991;&#30340;&#35299;&#37323;&#22120;&#23601;&#26159;&#21487;&#20197;&#35299;&#37323;&#33258;&#36523;&#30340;&#20102;
      &#26377;&#36259;&#20043;&#34389;&#22312;&#26044;&#36889;&#26371;&#23436;&#20840;&#25913;&#35722;&#23531;&#20195;&#30908;&#21644;&#35712;&#20195;&#30908;&#26178;&#30340;&#24863;&#21463;
<span class="org-level-2">** table as procedures and value and the-meaning and meaning</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">the-empty-table</span>
     (<span class="keyword">lambda</span> (name)
       (abort
        (cons 'no-answer
              (cons name '())))))
   (<span class="keyword">define</span> <span class="function-name">global-table</span> the-empty-table)
   (<span class="keyword">define</span> <span class="function-name">lookup</span>
     (<span class="keyword">lambda</span> (table name)
       (table name)))
   <span class="comment-delimiter">;; </span><span class="comment">&#22312;&#20840;&#23616;&#25844;&#23637;global-table&#30340;&#26159;*define
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#32780;*lambda&#20316;&#29992;&#26044;lambda-exp&#25152;&#24418;&#25104;&#30340;ciosure&#22312;&#20316;&#29992;&#26044;args&#26178;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#26371;&#29234;closure&#30340;body&#33256;&#26178;&#25844;&#23637;global-table
</span>   (<span class="keyword">define</span> <span class="function-name">extend</span>
     (<span class="keyword">lambda</span> (name1 value table)
       (<span class="keyword">lambda</span> (name2)
         (<span class="keyword">cond</span> ((eq? name1 name2) value)
               (<span class="keyword">else</span> (table name2))))))

   (<span class="keyword">define</span> <span class="function-name">abort</span>)<span class="comment-delimiter">;; </span><span class="comment">&#36935;&#21040;the-empty-table&#26178;&#36339;&#20986;&#20358;&#22577;&#37679;
</span>   (<span class="keyword">define</span> <span class="function-name">value</span>
     (<span class="keyword">lambda</span> (e)
       (<span class="keyword">letcc</span> the-end
         (<span class="keyword">set!</span> abort the-end)
         (<span class="keyword">cond</span> ((define? e) (*define e))
               (<span class="keyword">else</span> (the-meaning e))))))
   (<span class="keyword">define</span> <span class="function-name">the-meaning</span>
     (<span class="keyword">lambda</span> (e)
       (meaning e lookup-in-global-table)))
   (<span class="keyword">define</span> <span class="function-name">meaning</span>
     (<span class="keyword">lambda</span> (e table)
       ((expression-to-action e) e table)))
   (<span class="keyword">define</span> <span class="function-name">lookup-in-global-table</span>
     (<span class="keyword">lambda</span> (name)
       (lookup global-table name)))
   <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#35023;&#36890;&#36942;&#35519;&#29992;lookup&#20358;&#20316;&#19968;&#20491;closure
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#20491;closure&#25226;&#30070;&#21069;&#30340;global-table&#20445;&#35703;&#36215;&#20358;
</span>   <span class="comment-delimiter">;; </span><span class="comment">(define lookup-in-global-table
</span>   <span class="comment-delimiter">;;   </span><span class="comment">(lambda (name) (global-table name)))
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#29234;&#20160;&#40636;&#38656;&#35201;&#36889;&#20491;closure&#65311;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#20445;&#35703;&#36215;&#20358;&#30340;&#24847;&#24605;&#23601;&#26159;&#35201;&#24310;&#36978;&#36889;&#20491;closure&#30340;body&#30340;&#27714;&#20540;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#20351;&#24471;&#27714;&#20540;&#26178;&#36889;&#20491;body&#20013;&#30340;global-table&#21487;&#20197;&#26159;&#26368;&#26032;&#30340;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#29694;&#22312;&#25026;&#24471;&#20351;&#29992;closure&#30340;&#25216;&#24039;&#20102;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#27491;&#26159;&#36889;&#31278;&#25216;&#24039;&#20351;&#24471;&#21033;&#29992;define&#20358;&#23450;&#32681;&#36958;&#27512;&#20989;&#25976;&#25104;&#29234;&#21487;&#33021;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#27171;&#20063;&#23601;&#26126;&#30333;&#20102;Y!&#21644;letrec
</span><span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** classification</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">expression-to-action</span>
     (<span class="keyword">lambda</span> (e)
       (<span class="keyword">cond</span> ((atom? e) (atom-to-action e))
             (<span class="keyword">else</span> (list-to-action e)))))
   (<span class="keyword">define</span> <span class="function-name">atom-to-action</span>
     (<span class="keyword">lambda</span> (e)
       (<span class="keyword">cond</span> [(number? e) *const]
             [(eq? e #t) *const]
             [(eq? e #f) *const]
             [(eq? e 'cons) *const]
             [(eq? e 'car) *const]
             [(eq? e 'cdr) *const]
             [(eq? e 'null?) *const]
             [(eq? e 'eq?) *const]
             [(eq? e 'atom?) *const]
             [(eq? e 'zero?) *const]
             [(eq? e 'add1) *const]
             [(eq? e 'sub1) *const]
             [(eq? e 'number?) *const]
             [else *identifer])))
   (<span class="keyword">define</span> <span class="function-name">list-to-action</span>
     (<span class="keyword">lambda</span> (e)
       (<span class="keyword">cond</span> [(null? e) *null]
             [(atom? (car e))
              (<span class="keyword">cond</span> [(eq? (car e) 'quote)
                     ,*quote]
                    [(eq? (car e) 'lambda)
                     ,*lambda]
                    [(eq? (car e) 'letcc)
                     ,*letcc]
                    [(eq? (car e) 'set!)
                     ,*set]
                    [(eq? (car e) 'cond)
                     ,*cond]
                    [else *application])]
             [else *application])))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *define and box</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">define?</span>
     (<span class="keyword">lambda</span> (e)
       (<span class="keyword">cond</span> ((atom? e) #f)
             ((atom? (car e))
              (eq? (car e) 'define))
             (<span class="keyword">else</span> #f))))
   (<span class="keyword">define</span> <span class="function-name">*define</span>
     (<span class="keyword">lambda</span> (e)
       (<span class="keyword">set!</span> global-table
             (extend (name-of e)
                     (box (the-meaning
                           (rigth-side-of e)))
                     global-table))))
   (<span class="keyword">define</span> <span class="function-name">box</span>
     (<span class="keyword">lambda</span> (it)
       (<span class="keyword">lambda</span> (selector)
         (selector it
                   (<span class="keyword">lambda</span> (new) (<span class="keyword">set!</span> it new))))))
   <span class="comment-delimiter">;; </span><span class="comment">&#19979;&#38754;&#26159;&#20841;&#20491;selector
</span>   <span class="comment-delimiter">;; </span><span class="comment">selector&#30340;&#29992;&#27861;&#26159;&#65306;(&#24478;&#21738;&#36984; (lambda (&#26377;&#37027;&#20123;) (&#36984;&#21738;&#20491;&#33287;&#22914;&#20309;&#34389;&#29702;)))
</span>   (<span class="keyword">define</span> <span class="function-name">setbox</span>
     (<span class="keyword">lambda</span> (box new)
       (box (<span class="keyword">lambda</span> (it set) (set new)))))
   (<span class="keyword">define</span> <span class="function-name">unbox</span>
     (<span class="keyword">lambda</span> (box)
       (box (<span class="keyword">lambda</span> (it set) it))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *null</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">*null</span>
     (<span class="keyword">lambda</span> (e table)
       '()))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *quote</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">*quote</span>
     (<span class="keyword">lambda</span> (e table)
       (text-of e)))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *identifer and *set</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">*identifer</span>
     (<span class="keyword">lambda</span> (e table)
       (unbox (lookup table e))))
   (<span class="keyword">define</span> <span class="function-name">*set</span>
     (<span class="keyword">lambda</span> (e table)
       (setbox (lookup table (name-of e))
               (meaning (rigth-side-of e) table))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *lambda</span>
   1. &#36889;&#35023;&#23526;&#29694;&#20102;&#22312;&lt;body&gt;&#20013;&#21487;&#20197;&#21253;&#21547;&#22810;&#20491;&lt;sexp&gt;&#36889;&#19968;&#29305;&#24615;
      *lambda&#20316;&#29992;&#26044;e&#33287;table&#23559;&#24418;&#25104;&#19968;&#20491;&#20803;&#35299;&#37323;&#22120;&#20013;&#30340;closure
      &#36889;&#20491;closure&#20316;&#29992;&#26178;beglis&#23559;&#22312;&#25844;&#23637;&#30340;table&#20013;&#23565;&lt;body&gt;&#27714;&#20540;
      closure&#20316;&#29992;&#30340;&#26178;&#20505;evlis&#36820;&#22238;&#30340;&#21443;&#25976;&#20540;&#26371;&#34987;&#34389;&#29702;&#29234;list
      &#25152;&#20197;&#36889;&#35023;&#20351;&#29992;&#20102;args&#36889;&#20491;&#24418;&#21443;&#21517;
      + &#22312;&#19979;&#38754;&#30340;*const&#20013;&#36996;&#38656;&#35201;&#25226;&#36889;&#20123;&#21443;&#25976;&#24478;args&#20013;&#25343;&#20986;&#20358;&#20877;&#35731;primitive&#20316;&#29992;
        &#20294;&#26159;closure&#30340;&#20316;&#29992;&#20677;&#20677;&#26159;&#21033;&#29992;args&#20358;&#25844;&#23637;table&#22240;&#27492;&#19981;&#38656;&#35201;&#36889;&#27171;
   2. &#36889;&#35023;*lambda&#25152;&#24418;&#25104;&#30340;closure&#29992;&#20803;&#35299;&#37323;&#22120;&#20013;&#30340;closure&#20358;&#23526;&#29694;&#20102;
      &#36889;&#27171;&#23601;&#19981;&#29992;&#20998;&#21029;&#23526;&#29694;primitive&#33287;non-primitive&#30340;apply&#20102;
      &#20294;&#26159;&#36889;&#26159;&#24517;&#38920;&#30340;&#21966;&#65311;
      &#30050;&#31455;&#22312;&#19978;&#19968;&#20491;&#35299;&#37323;&#22120;&#20013;&#25105;&#33021;&#23416;&#21040;&#38364;&#26044;closure&#30340;&#30693;&#35672;
      &#27491;&#26159;&#22240;&#29234;&#25105;&#29992;&#19968;&#20491;&#25976;&#25818;&#32080;&#27083;&#23526;&#29694;&#20102;closure
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">*lambda</span>
     (<span class="keyword">lambda</span> (e table)
       (<span class="keyword">lambda</span> (args)
         (beglis (body-of e)
                 (multi-extend (formals-of e)
                               (box-all args)
                               table)))))
   <span class="comment-delimiter">;; </span><span class="comment">beglis denote? begain list
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#23427;&#23565;&lt;body&gt;&#20013;&#30340;&#25152;&#26377;&lt;sexp&gt;&#27714;&#20540;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#21482;&#36820;&#22238;&#26368;&#24460;&#19968;&#20491;&lt;sexp&gt;&#30340;&#20540; &#20854;&#20182;&#30340;&lt;sexp&gt;&#29992;&#20358;&#24418;&#25104;&#21103;&#20316;&#29992;
</span>   (<span class="keyword">define</span> <span class="function-name">beglis</span>
     (<span class="keyword">lambda</span> (es table)
       (<span class="keyword">cond</span> ((null? (cdr es))<span class="comment-delimiter">;</span><span class="comment">so body-of e con't be empty
</span>              (meaning (car es) table))
             (<span class="keyword">else</span>
              <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#35023;&#38656;&#35201;&#19968;&#20491;&#36070;&#20540;
</span>              <span class="comment-delimiter">;; </span><span class="comment">&#22240;&#29234;&#24460;&#38754;&#30340;&#26481;&#35199;(beglis (cdr es) table)
</span>              <span class="comment-delimiter">;; </span><span class="comment">&#38656;&#35201;&#22312;&#21069;&#38754;&#30340;&#21103;&#20316;&#29992;&#25152;&#24418;&#25104;&#26032;&#29872;&#22659;&#20013;&#27714;&#20540;
</span>              ((<span class="keyword">lambda</span> (val)
                 (beglis (cdr es) table))
               (meaning (car es) table))))))
   (<span class="keyword">define</span> <span class="function-name">box-all</span>
     (<span class="keyword">lambda</span> (vals)
       (<span class="keyword">cond</span> ((null? vals) '())
             (<span class="keyword">else</span>
              (cons (box (car vals))
                    (box-all (cdr vals)))))))
   (<span class="keyword">define</span> <span class="function-name">multi-extend</span>
     (<span class="keyword">lambda</span> (names values table)
       (<span class="keyword">cond</span> ((null? names) table)
             (<span class="keyword">else</span>
              (extend (car names)
                      (car values)
                      (multi-extend (cdr names)
                                    (cdr values)
                                    table))))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *application</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">*application</span>
     (<span class="keyword">lambda</span> (e table)
       ((meaning (function-of e) table)
        (evlis (arguments-of e) table))))
   (<span class="keyword">define</span> <span class="function-name">evlis</span>
     (<span class="keyword">lambda</span> (args table)
       (<span class="keyword">cond</span> ((null? args) '())
             (<span class="keyword">else</span>
              <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#35023;&#29234;&#20160;&#40636;&#38656;&#35201;&#19968;&#20491;&#36070;&#20540;&#65311;
</span>              <span class="comment-delimiter">;; </span><span class="comment">&#36070;&#20540;&#22312;&#26044;&#22312;&#20316;&#29992;&#20043;&#21069;&#23601;&#20808;&#27714;&#26576;&#20123;&#34920;&#36948;&#24335;&#30340;&#20540;
</span>              <span class="comment-delimiter">;; </span><span class="comment">&#36070;&#20540;&#22312;&#26044;&#25511;&#21046;&#27714;&#20540;&#38918;&#24207;
</span>              <span class="comment-delimiter">;; </span><span class="comment">&#38656;&#35201;&#36889;&#20491;&#36070;&#20540;&#21487;&#33021;&#26159;&#22240;&#29234;&#25105;&#20497;&#19981;&#33021;&#38928;&#26009;cons&#23565;&#23427;&#21443;&#25976;&#30340;&#27714;&#20540;&#38918;&#24207;
</span>              ((<span class="keyword">lambda</span> (val)
                 (cons val
                       (evlis (cdr args) table)))
               (meaning (car args) table))))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *const</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#22240;&#29234;evlis&#36820;&#22238;&#30340;&#21443;&#25976;&#20540;&#26371;&#34987;&#34389;&#29702;&#29234;list
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#25152;&#20197;&#29992;&#19979;&#38754;&#30340;&#20841;&#20491;&#26481;&#35199;&#25226;&#21443;&#25976;&#24478;args-in-a-list&#20013;&#25343;&#20986;&#20358;
</span>   (<span class="keyword">define</span> <span class="function-name">a-prim</span>
     (<span class="keyword">lambda</span> (p)
       (<span class="keyword">lambda</span> (args-in-a-list)
         (p (car args-in-a-list)))))
   (<span class="keyword">define</span> <span class="function-name">b-prim</span>
     (<span class="keyword">lambda</span> (p)
       (<span class="keyword">lambda</span> (args-in-a-list)
         (p (car args-in-a-list)
            (cadr args-in-a-list)))))
   <span class="comment-delimiter">;; </span><span class="comment">&#36991;&#20813;&#37325;&#35079;&#20351;&#29992;a-prim&#33287;b-prim
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#22240;&#27492;&#22312;&#26368;&#22806;&#23652;&#23565;&#23427;&#20497;&#30340;&#20316;&#29992;&#32080;&#26524;&#36914;&#34892;&#36070;&#20540;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#27171;&#23450;&#32681;*const&#24460; &#20197;*const&#29234;&#21517;&#23383;&#30340;closure&#20013;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#20123;&#26412;&#20358;&#38656;&#35201;&#34987;a-prim&#33287;b-prim&#20316;&#29992;&#25165;&#33021;&#29554;&#24471;&#30340;&#20540;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#21482;&#35201;&#32147;&#36942;&#19968;&#20491;*identifer&#30340;&#26597;&#25214;&#23601;&#33021;&#29554;&#24471;&#20102;
</span>   (<span class="keyword">define</span> <span class="function-name">*const</span>
     ((<span class="keyword">lambda</span> (<span class="builtin">:cons</span> <span class="builtin">:car</span> <span class="builtin">:cdr</span> <span class="builtin">:null?</span> <span class="builtin">:eq?</span> <span class="builtin">:atom?</span> <span class="builtin">:zero?</span> <span class="builtin">:add1</span> <span class="builtin">:sub1</span> <span class="builtin">:number?</span>)
        (<span class="keyword">lambda</span> (e table)
          (<span class="keyword">cond</span> ((number? e) e)
                ((eq? e #t) #t)
                ((eq? e #f) #f)
                ((eq? e 'cons) <span class="builtin">:cons</span>)
                ((eq? e 'car) <span class="builtin">:car</span>)
                ((eq? e 'cdr) <span class="builtin">:cdr</span>)
                ((eq? e 'null?) <span class="builtin">:null?</span>)
                ((eq? e 'eq?) <span class="builtin">:eq?</span>)
                ((eq? e 'atom?) <span class="builtin">:atom?</span>)
                ((eq? e 'zero?) <span class="builtin">:zero?</span>)
                ((eq? e 'add1) <span class="builtin">:add1</span>)
                ((eq? e 'sub1) <span class="builtin">:sub1</span>)
                ((eq? e 'number?) <span class="builtin">:number?</span>)
                )))
      (b-prim cons)
      (a-prim car)
      (a-prim cdr)
      (a-prim null?)
      (b-prim eq?)
      (a-prim atom?)
      (a-prim zero?)
      (a-prim add1)
      (a-prim sub1)
      (a-prim number?)
      ))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *cond</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">*cond</span>
     (<span class="keyword">lambda</span> (e table)
       (evcon (cond-lines-of e) table)))
   (<span class="keyword">define</span> <span class="function-name">evcon</span>
     (<span class="keyword">lambda</span> (lines table)
       (<span class="keyword">cond</span> ((else? (question-of (car lines)))
              (meaning (answer-of (car lines)) table))
             ((meaning (question-of (car lines)) table)
              (meaning (answer-of (car lines)) table))
             (<span class="keyword">else</span> (evcon (cdr lines) table)))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *letcc</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#20854;&#23526;&#23531;&#35299;&#37323;&#22120;&#23416;&#30340;&#23601;&#26159;closure&#30340;&#20351;&#29992;&#26041;&#24335;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#27604;&#22914;&#19979;&#38754;&#36889;&#20491;&#25226;letcc&#30452;&#25509;&#21152;&#20837;&#25105;&#30340;&#35299;&#37323;&#22120;&#20013;&#30340;&#36942;&#31243;&#23601;&#26681;&#26412;&#19981;&#35320;&#21450;letcc&#30340;&#26412;&#36074;
</span>   (<span class="keyword">define</span> <span class="function-name">*letcc</span>
     (<span class="keyword">lambda</span> (e table)
       (<span class="keyword">letcc</span> skip
              (beglis (ccbody-of e)
                      (extend (name-of e)
                              (box (a-prim skip))
                              table)))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** auxiliary functions</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">text-of</span>
     (<span class="keyword">lambda</span> (x) (car (cdr x))))
   (<span class="keyword">define</span> <span class="function-name">formals-of</span>
     (<span class="keyword">lambda</span> (x) (car (cdr x))))
   (<span class="keyword">define</span> <span class="function-name">body-of</span>
     (<span class="keyword">lambda</span> (x) (cdr (cdr x))))
   (<span class="keyword">define</span> <span class="function-name">ccbody-of</span>
     (<span class="keyword">lambda</span> (x) (cdr (cdr x))))
   (<span class="keyword">define</span> <span class="function-name">name-of</span>
     (<span class="keyword">lambda</span> (x) (car (cdr x))))
   (<span class="keyword">define</span> <span class="function-name">rigth-side-of</span>
     (<span class="keyword">lambda</span> (x)
       (<span class="keyword">cond</span> ((null? (cdr (cdr x))) 0)
             <span class="comment-delimiter">;; </span><span class="comment">this handles definitions like (define kkk)
</span>             (<span class="keyword">else</span> (car (cdr (cdr x)))))))
   (<span class="keyword">define</span> <span class="function-name">cond-lines-of</span>
     (<span class="keyword">lambda</span> (x) (cdr x)))
   (<span class="keyword">define</span> <span class="function-name">else?</span>
     (<span class="keyword">lambda</span> (x)
       (<span class="keyword">cond</span> ((atom? x) (eq? x 'else))
             (<span class="keyword">else</span> #f))))
   (<span class="keyword">define</span> <span class="function-name">question-of</span>
     (<span class="keyword">lambda</span> (x) (car x)))
   (<span class="keyword">define</span> <span class="function-name">answer-of</span>
     (<span class="keyword">lambda</span> (x) (car (cdr x))))
   (<span class="keyword">define</span> <span class="function-name">function-of</span>
     (<span class="keyword">lambda</span> (x) (car x)))
   (<span class="keyword">define</span> <span class="function-name">arguments-of</span>
     (<span class="keyword">lambda</span> (x) (cdr x)))
<span class="org-block-end-line">   #+end_src
</span>   use (let ...) to name the values of repeated expressions
   in a function definition if they may be evaluated twice
   for one and the same use of the function
   and use (let ...) to name the values of expressions (without set!)
   that are re-evaluated every time a function is used
<span class="org-level-2">** &#28204;&#35430;&#26044;&#19979;&#38754;&#30340;&#20013;&#25991;&#20803;&#35299;&#37323;&#22120;</span>
<span class="org-level-1">* &#20013;&#25991;&#35299;&#37323;&#22120;&#38646;</span>
  &#38500;&#20102;&#25226;&#25152;&#26377;&#30340;&#35486;&#27861;&#35422;&#33287;&#22522;&#30990;&#20989;&#25976;&#21517;&#32763;&#35695;&#25104;&#20013;&#25991;&#20197;&#22806;
  &#36889;&#20491;&#35299;&#37323;&#22120;&#21516;&#19978;&#38754;&#30340;&#35299;&#37323;&#22120;&#23436;&#20840;&#19968;&#27171;
  &#26159;&#23531;&#22312;&#20803;&#35299;&#37323;&#22120;&#20013;&#30340;
  &#32780;&#20043;&#25152;&#20197;&#21448;&#31281;&#20043;&#29234; &#38646;
  &#26159;&#22240;&#29234; &#23601;&#19979;&#38754;&#30340;&#20013;&#25991;&#35299;&#37323;&#22120;&#32780;&#35328;&#23427;&#26159;&#20803;&#35299;&#37323;&#22120;
<span class="org-level-2">** table as procedures and value and the-meaning and meaning</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">the-empty-table</span>
     (<span class="keyword">lambda</span> (name)
       (abort
        (cons 'no-answer
              (cons name '())))))
   (<span class="keyword">define</span> <span class="function-name">global-table</span> the-empty-table)
   (<span class="keyword">define</span> <span class="function-name">lookup</span>
     (<span class="keyword">lambda</span> (table name)
       (table name)))
   (<span class="keyword">define</span> <span class="function-name">extend</span>
     (<span class="keyword">lambda</span> (name1 value table)
       (<span class="keyword">lambda</span> (name2)
         (<span class="keyword">cond</span> [(eq? name1 name2) value]
               [else (table name2)]))))

   (<span class="keyword">define</span> <span class="function-name">abort</span>)
   (<span class="keyword">define</span> <span class="function-name">&#27714;</span>
     (<span class="keyword">lambda</span> (e)
       (<span class="keyword">letcc</span> the-end
              (<span class="keyword">set!</span> abort the-end)
              (<span class="keyword">cond</span> [(define? e) (*define e)]
                    [else (the-meaning e)]))))
   (<span class="keyword">define</span> <span class="function-name">the-meaning</span>
     (<span class="keyword">lambda</span> (e)
       (meaning e lookup-in-global-table)))
   (<span class="keyword">define</span> <span class="function-name">meaning</span>
     (<span class="keyword">lambda</span> (e table)
       ((expression-to-action e) e table)))
   (<span class="keyword">define</span> <span class="function-name">lookup-in-global-table</span>
     (<span class="keyword">lambda</span> (name)
       (lookup global-table name)))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** classification</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">expression-to-action</span>
     (<span class="keyword">lambda</span> (e)
       (<span class="keyword">cond</span> ((atom? e) (atom-to-action e))
             (<span class="keyword">else</span> (list-to-action e)))))
   (<span class="keyword">define</span> <span class="function-name">atom-to-action</span>
     (<span class="keyword">lambda</span> (e)
       (<span class="keyword">cond</span> ((number? e) *const)
             ((eq? e #t) *const)
             ((eq? e #f) *const)
             ((eq? e '&#37832;) *const)
             ((eq? e '&#23481;) *const)
             ((eq? e '&#22336;) *const)
             ((eq? e '&#31354;?) *const)
             ((eq? e '&#31561;?) *const)
             ((eq? e '&#21407;&#23376;?) *const)
             ((eq? e '&#38646;?) *const)
             ((eq? e '&#22686;&#19968;) *const)
             ((eq? e '&#28187;&#19968;) *const)
             ((eq? e '&#25976;?) *const)
             (<span class="keyword">else</span> *identifer))))
   (<span class="keyword">define</span> <span class="function-name">list-to-action</span>
     (<span class="keyword">lambda</span> (e)
       (<span class="keyword">cond</span> [(null? e) *null]
             [(atom? (car e))
              (<span class="keyword">cond</span> [(eq? (car e) '&#24341;)
                     ,*quote]
                    [(eq? (car e) '&#955;)
                     ,*lambda]
                    [(eq? (car e) '&#25429;)
                     ,*letcc]
                    [(eq? (car e) '&#32622;!)
                     ,*set]
                    [(eq? (car e) '&#25511;)
                     ,*cond]
                    [else *application]
                    )]
             [else *application]
             )))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *define and box</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">define?</span>
     (<span class="keyword">lambda</span> (e)
       (<span class="keyword">cond</span> ((atom? e) #f)
             ((atom? (car e))
              (eq? (car e) '&#23450;))
             (<span class="keyword">else</span> #f))))
   (<span class="keyword">define</span> <span class="function-name">*define</span>
     (<span class="keyword">lambda</span> (e)
       (<span class="keyword">set!</span> global-table
             (extend (name-of e)
                     (box (the-meaning
                           (rigth-side-of e)))
                     global-table))))
   (<span class="keyword">define</span> <span class="function-name">box</span>
     (<span class="keyword">lambda</span> (it)
       (<span class="keyword">lambda</span> (selector)
         (selector it
                   (<span class="keyword">lambda</span> (new) (<span class="keyword">set!</span> it new))))))

   (<span class="keyword">define</span> <span class="function-name">setbox</span>
     (<span class="keyword">lambda</span> (box new)
       (box (<span class="keyword">lambda</span> (it set) (set new)))))
   (<span class="keyword">define</span> <span class="function-name">unbox</span>
     (<span class="keyword">lambda</span> (box)
       (box (<span class="keyword">lambda</span> (it set) it))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *null</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">*null</span>
     (<span class="keyword">lambda</span> (e table)
       '()))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *quote</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">*quote</span>
     (<span class="keyword">lambda</span> (e table)
       (text-of e)))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *identifer and *set</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">*identifer</span>
     (<span class="keyword">lambda</span> (e table)
       (unbox (lookup table e))))
   (<span class="keyword">define</span> <span class="function-name">*set</span>
     (<span class="keyword">lambda</span> (e table)
       (setbox (lookup table (name-of e))
               (meaning (rigth-side-of e) table))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *lambda</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">*lambda</span>
     (<span class="keyword">lambda</span> (e table)
       (<span class="keyword">lambda</span> (args)
         (beglis (body-of e)
                 (multi-extend (formals-of e)
                               (box-all args)
                               table)))))

   (<span class="keyword">define</span> <span class="function-name">beglis</span>
     (<span class="keyword">lambda</span> (es table)
       (<span class="keyword">cond</span> ((null? (cdr es))
              (meaning (car es) table))
             (<span class="keyword">else</span>
              ((<span class="keyword">lambda</span> (val)
                 (beglis (cdr es) table))
               (meaning (car es) table))))))
   (<span class="keyword">define</span> <span class="function-name">box-all</span>
     (<span class="keyword">lambda</span> (vals)
       (<span class="keyword">cond</span> ((null? vals) '())
             (<span class="keyword">else</span>
              (cons (box (car vals))
                    (box-all (cdr vals)))))))
   (<span class="keyword">define</span> <span class="function-name">multi-extend</span>
     (<span class="keyword">lambda</span> (names values table)
       (<span class="keyword">cond</span> ((null? names) table)
             (<span class="keyword">else</span>
              (extend (car names)
                      (car values)
                      (multi-extend (cdr names)
                                    (cdr values)
                                    table))))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *application</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">*application</span>
     (<span class="keyword">lambda</span> (e table)
       ((meaning (function-of e) table)
        (evlis (arguments-of e) table))))
   (<span class="keyword">define</span> <span class="function-name">evlis</span>
     (<span class="keyword">lambda</span> (args table)
       (<span class="keyword">cond</span> ((null? args) '())
             (<span class="keyword">else</span>
              ((<span class="keyword">lambda</span> (val)
                 (cons val
                       (evlis (cdr args) table)))
               (meaning (car args) table))))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *const</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">a-prim</span>
     (<span class="keyword">lambda</span> (p)
       (<span class="keyword">lambda</span> (args-in-a-list)
         (p (car args-in-a-list)))))
   (<span class="keyword">define</span> <span class="function-name">b-prim</span>
     (<span class="keyword">lambda</span> (p)
       (<span class="keyword">lambda</span> (args-in-a-list)
         (p (car args-in-a-list)
            (car (cdr args-in-a-list))))))
   (<span class="keyword">define</span> <span class="function-name">*const</span>
     ((<span class="keyword">lambda</span> (<span class="builtin">:cons</span> <span class="builtin">:car</span> <span class="builtin">:cdr</span> <span class="builtin">:null?</span> <span class="builtin">:eq?</span> <span class="builtin">:atom?</span> <span class="builtin">:zero?</span> <span class="builtin">:add1</span> <span class="builtin">:sub1</span> <span class="builtin">:number?</span>)
        (<span class="keyword">lambda</span> (e table)
          (<span class="keyword">cond</span> ((number? e) e)
                ((eq? e #t) #t)
                ((eq? e #f) #f)
                ((eq? e '&#37832;) <span class="builtin">:cons</span>)
                ((eq? e '&#23481;) <span class="builtin">:car</span>)
                ((eq? e '&#22336;) <span class="builtin">:cdr</span>)
                ((eq? e '&#31354;?) <span class="builtin">:null?</span>)
                ((eq? e '&#31561;?) <span class="builtin">:eq?</span>)
                ((eq? e '&#21407;&#23376;?) <span class="builtin">:atom?</span>)
                ((eq? e '&#38646;?) <span class="builtin">:zero?</span>)
                ((eq? e '&#22686;&#19968;) <span class="builtin">:add1</span>)
                ((eq? e '&#28187;&#19968;) <span class="builtin">:sub1</span>)
                ((eq? e '&#25976;?) <span class="builtin">:number?</span>)
                )))
      (b-prim cons)
      (a-prim car)
      (a-prim cdr)
      (a-prim null?)
      (b-prim eq?)
      (a-prim atom?)
      (a-prim zero?)
      (a-prim add1)
      (a-prim sub1)
      (a-prim number?)
      ))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *cond</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">*cond</span>
     (<span class="keyword">lambda</span> (e table)
       (evcon (cond-lines-of e) table)))
   (<span class="keyword">define</span> <span class="function-name">evcon</span>
     (<span class="keyword">lambda</span> (lines table)
       (<span class="keyword">cond</span> ((else? (question-of (car lines)))
              (meaning (answer-of (car lines)) table))
             ((meaning (question-of (car lines)) table)
              (meaning (answer-of (car lines)) table))
             (<span class="keyword">else</span> (evcon (cdr lines) table)))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *letcc</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">*letcc</span>
     (<span class="keyword">lambda</span> (e table)
       (<span class="keyword">letcc</span> skip
              (beglis (ccbody-of e)
                      (extend (name-of e)
                              (box (a-prim skip))
                              table)))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** auxiliary functions</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">text-of</span>
     (<span class="keyword">lambda</span> (x) (car (cdr x))))
   (<span class="keyword">define</span> <span class="function-name">formals-of</span>
     (<span class="keyword">lambda</span> (x) (car (cdr x))))
   (<span class="keyword">define</span> <span class="function-name">body-of</span>
     (<span class="keyword">lambda</span> (x) (cdr (cdr x))))
   (<span class="keyword">define</span> <span class="function-name">ccbody-of</span>
     (<span class="keyword">lambda</span> (x) (cdr (cdr x))))
   (<span class="keyword">define</span> <span class="function-name">name-of</span>
     (<span class="keyword">lambda</span> (x) (car (cdr x))))
   (<span class="keyword">define</span> <span class="function-name">rigth-side-of</span>
     (<span class="keyword">lambda</span> (x)
       (<span class="keyword">cond</span> ((null? (cdr (cdr x))) 0)
             (<span class="keyword">else</span> (car (cdr (cdr x)))))))
   (<span class="keyword">define</span> <span class="function-name">cond-lines-of</span>
     (<span class="keyword">lambda</span> (x) (cdr x)))
   (<span class="keyword">define</span> <span class="function-name">else?</span>
     (<span class="keyword">lambda</span> (x)
       (<span class="keyword">cond</span> ((atom? x) (eq? x '&#21542;&#21063;))
             (<span class="keyword">else</span> #f))))
   (<span class="keyword">define</span> <span class="function-name">question-of</span>
     (<span class="keyword">lambda</span> (x) (car x)))
   (<span class="keyword">define</span> <span class="function-name">answer-of</span>
     (<span class="keyword">lambda</span> (x) (car (cdr x))))
   (<span class="keyword">define</span> <span class="function-name">function-of</span>
     (<span class="keyword">lambda</span> (x) (car x)))
   (<span class="keyword">define</span> <span class="function-name">arguments-of</span>
     (<span class="keyword">lambda</span> (x) (cdr x)))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* &#20013;&#25991;&#35299;&#37323;&#22120;&#19968;</span>
<span class="org-level-2">** </span><span class="org-todo">&gt;&lt;</span><span class="org-level-2"> &#35352;</span>
   1. <span class="org-checkbox">[X]</span> &#29992;kkk&#32780;&#19981;&#29992;ccc
   2. <span class="org-checkbox">[ ]</span> &#21152;&#20837;apply
      &#36889;&#21487;&#33021;&#21966;?
   3. <span class="org-checkbox">[ ]</span> &#35036;&#20840;&lt;formals&gt;&#30340;&#24418;&#24335;&#65306;
      &lt;variable&gt;
      (&lt;variable&gt;*)
      (&lt;variable&gt; &lt;variable&gt;* . &lt;variable&gt;)
   4. <span class="org-checkbox">[ ]</span> &#35036;&#20840;&#29992;&#26044;&#21109;&#36896;&#35486;&#27861;&#30340;&#21305;&#37197;&#35486;&#35328;
      &#21305;&#37197;&#35486;&#35328;&#26159;&#21516;&#27171;&#37325;&#35201;&#30340;
   5. &#22312;&#35299;&#37323;&#22120;&#20013;&#23531;&#35299;&#37323;&#22120;
      &#21487;&#20197;&#20316;&#29234;&#19968;&#31278;&#26041;&#24335;&#20358;&#28472;&#36914;&#22320;&#25913;&#35722;&#35299;&#37323;&#22120;&#30340;&#24615;&#36074;
      &#20294;&#26159;&#38750;&#24120;&#24930;
      &#26377;&#27794;&#26377;&#26041;&#27861;&#20778;&#21270;?
   6. &#22914;&#26524;&#26159;&#32232;&#35695;&#22120;&#37027;&#24456;&#21487;&#33021;&#23601;&#21487;&#20197;&#20778;&#21270;
      &#20445;&#25345;&#25152;&#32232;&#35695;&#34389;&#29702;&#30340;&#26481;&#35199;&#33021;&#32232;&#35695;&#33258;&#36523;
      &#20006;&#19988;&#29983;&#25104;&#30340;&#30446;&#27161;&#20195;&#30908;&#36074;&#37327;&#30456;&#21516;
      &#37027;&#23601;&#26159;&#23526;&#29694;&#20102;&#32232;&#35695;&#22120;&#30340;&#23652;&#36914;&#38283;&#30332;
<span class="org-level-2">** &#34920; &#27714; &#20854;&#24847; &#24847;</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (&#23450; &#31354;&#34920;
       (<span class="keyword">&#955;</span> (&#21517;)
           (&#22833;&#25943;
            (&#37832; (&#24341; &#28961;&#20540;&#20043;&#21517;)
                (&#37832; &#21517; (&#24341; ()))))))
   (&#23450; &#32317;&#34920; &#31354;&#34920;)
   (&#23450; &#26597;
       (<span class="keyword">&#955;</span> (&#34920; &#21517;)
           (&#34920; &#21517;)))
   (&#23450; &#25844;&#23637;
       (<span class="keyword">&#955;</span> (&#21517;1 &#20540; &#34920;)
           (<span class="keyword">&#955;</span> (&#21517;2)
               (&#25511; [(&#31561;? &#21517;1 &#21517;2) &#20540;]
                   [&#21542;&#21063; (&#34920; &#21517;2)]))))

   (&#23450; &#22833;&#25943;)
   (&#23450; &#27714;
       (<span class="keyword">&#955;</span> (e)
           (&#25429; &#32066;
               (&#32622;! &#22833;&#25943; &#32066;)
               (&#25511; [(&#23450;? e) (*&#23450; e)]
                   [&#21542;&#21063; (&#20854;&#24847; e)]))))
   (&#23450; &#20854;&#24847;
       (<span class="keyword">&#955;</span> (e)
           (&#24847; e &#26597;&#32317;&#34920;)))
   (&#23450; &#24847;
       (<span class="keyword">&#955;</span> (e &#34920;)
           ((&#24335;&#20043;&#20316;&#29992; e) e &#34920;)))
   (&#23450; &#26597;&#32317;&#34920;
       (<span class="keyword">&#955;</span> (&#21517;)
           (&#26597; &#32317;&#34920; &#21517;)))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** &#20998;&#39006;</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (&#23450; &#24335;&#20043;&#20316;&#29992;
       (<span class="keyword">&#955;</span> (e)
           (&#25511; [(&#21407;&#23376;? e) (&#21407;&#23376;&#20043;&#20316;&#29992; e)]
               [&#21542;&#21063; (&#37832;&#20043;&#20316;&#29992; e)])))
   (&#23450; &#21407;&#23376;&#20043;&#20316;&#29992;
       (<span class="keyword">&#955;</span> (e)
           (&#25511; [(&#25976;? e) *&#24120;&#20803;]
               [(&#31561;? e #t) *&#24120;&#20803;]
               [(&#31561;? e #f) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#37832;)) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#23481;)) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#22336;)) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#31354;?)) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#31561;?)) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#21407;&#23376;?)) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#38646;?)) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#22686;&#19968;)) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#28187;&#19968;)) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#25976;?)) *&#24120;&#20803;]
               [&#21542;&#21063; *&#35722;&#20803;])))
   (&#23450; &#37832;&#20043;&#20316;&#29992;
       (<span class="keyword">&#955;</span> (e)
           (&#25511; [(&#31354;? e) *&#31354;]
               [(&#21407;&#23376;? (&#23481; e))
                (&#25511; [(&#31561;? (&#23481; e) (&#24341; &#24341;))
                     ,*&#24341;]
                    [(&#31561;? (&#23481; e) (&#24341; &#955;))
                     ,*&#955;]
                    [(&#31561;? (&#23481; e) (&#24341; &#25429;))
                     ,*&#25429;]
                    [(&#31561;? (&#23481; e) (&#24341; &#32622;!))
                     ,*&#32622;]
                    [(&#31561;? (&#23481; e) (&#24341; &#25511;))
                     ,*&#25511;]
                    [&#21542;&#21063; *&#20316;&#29992;])]
               [&#21542;&#21063; *&#20316;&#29992;])))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *&#23450; &#30418;</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (&#23450; &#23450;?
       (<span class="keyword">&#955;</span> (e)
           (&#25511; [(&#21407;&#23376;? e) #f]
               [(&#21407;&#23376;? (&#23481; e))
                (&#31561;? (&#23481; e) (&#24341; &#23450;))]
               [&#21542;&#21063; #f])))
   (&#23450; *&#23450;
       (<span class="keyword">&#955;</span> (e)
           (&#32622;! &#32317;&#34920;
                (&#25844;&#23637; (&#21517;&#37096; e)
                      (&#30418; (&#20854;&#24847;
                           (&#20540;&#37096; e)))
                      &#32317;&#34920;))))
   (&#23450; &#30418;
       (<span class="keyword">&#955;</span> (&#29289;)
           (<span class="keyword">&#955;</span> (&#36984;&#25799;&#23376;)
               (&#36984;&#25799;&#23376; &#29289;
                       (<span class="keyword">&#955;</span> (&#26032;&#29289;) (&#32622;! &#29289; &#26032;&#29289;))))))
   <span class="comment-delimiter">;; </span><span class="comment">&#19979;&#38754;&#26159;&#20841;&#20491;&#36984;&#25799;&#23376;
</span>   (&#23450; &#37325;&#32622;&#30418;
       (<span class="keyword">&#955;</span> (&#30418; &#26032;&#29289;)
           (&#30418; (<span class="keyword">&#955;</span> (&#20043;&#29289; &#20043;&#32622;) (&#20043;&#32622; &#26032;&#29289;)))))
   (&#23450; &#21462;&#26044;&#30418;
       (<span class="keyword">&#955;</span> (&#30418;)
           (&#30418; (<span class="keyword">&#955;</span> (&#20043;&#29289; &#20043;&#32622;) &#20043;&#29289;))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *&#31354;</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (&#23450; *&#31354;
       (<span class="keyword">&#955;</span> (e &#34920;)
           (&#24341; ())))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *&#24341;</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (&#23450; *&#24341;
     (<span class="keyword">&#955;</span> (e &#34920;)
       (&#25991;&#37096; e)))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *&#35722;&#20803; *&#32622;</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (&#23450; *&#35722;&#20803;
       (<span class="keyword">&#955;</span> (e &#34920;)
           (&#21462;&#26044;&#30418; (&#26597; &#34920; e))))
   (&#23450; *&#32622;
       (<span class="keyword">&#955;</span> (e &#34920;)
           (&#37325;&#32622;&#30418; (&#26597; &#34920; (&#21517;&#37096; e))
                   (&#24847; (&#20540;&#37096; e) &#34920;))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *&#955;</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (&#23450; *&#955;
       (<span class="keyword">&#955;</span> (e &#34920;)
         (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
           (&#27714;&#26044;&#39636; (&#39636;&#37096; e)
                   (&#22810;&#25844;&#23637; (&#24418;&#21443;&#37096; e)
                           (&#22810;&#30418; &#23526;&#21443;&#37832;)
                           &#34920;)))))

   (&#23450; &#27714;&#26044;&#39636;
       (<span class="keyword">&#955;</span> (&#24335;&#37832; &#34920;)
         (&#25511; [(&#31354;? (&#22336; &#24335;&#37832;))
              (&#24847; (&#23481; &#24335;&#37832;) &#34920;)]
             [&#21542;&#21063;
              ((<span class="keyword">&#955;</span> (&#36070;&#21443;)
                 (&#27714;&#26044;&#39636; (&#22336; &#24335;&#37832;) &#34920;))
               (&#24847; (&#23481; &#24335;&#37832;) &#34920;))])))
   (&#23450; &#22810;&#30418;
       (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
         (&#25511; [(&#31354;? &#23526;&#21443;&#37832;) (&#24341; ())]
             [&#21542;&#21063;
              (&#37832; (&#30418; (&#23481; &#23526;&#21443;&#37832;))
                  (&#22810;&#30418; (&#22336; &#23526;&#21443;&#37832;)))])))
   (&#23450; &#22810;&#25844;&#23637;
       (<span class="keyword">&#955;</span> (&#21517;&#37832; &#20540;&#37832; &#34920;)
         (&#25511; [(&#31354;? &#21517;&#37832;) &#34920;]
             [&#21542;&#21063;
              (&#25844;&#23637; (&#23481; &#21517;&#37832;)
                    (&#23481; &#20540;&#37832;)
                    (&#22810;&#25844;&#23637; (&#22336; &#21517;&#37832;)
                            (&#22336; &#20540;&#37832;)
                            &#34920;))])))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *&#20316;&#29992;</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (&#23450; *&#20316;&#29992;
       (<span class="keyword">&#955;</span> (e &#34920;)
           ((&#24847; (&#20989;&#25976;&#37096; e) &#34920;)
            (&#27714;&#26044;&#37832; (&#21443;&#25976;&#37832;&#37096; e) &#34920;))))
   (&#23450; &#27714;&#26044;&#37832;
       (<span class="keyword">&#955;</span> (&#24335;&#37832; &#34920;)
           (&#25511; [(&#31354;? &#24335;&#37832;) (&#24341; ())]
               [&#21542;&#21063;
                ((<span class="keyword">&#955;</span> (&#36070;&#21443;)
                     (&#37832; &#36070;&#21443;
                         (&#27714;&#26044;&#37832; (&#22336; &#24335;&#37832;) &#34920;)))
                 (&#24847; (&#23481; &#24335;&#37832;) &#34920;))]
               )))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *&#24120;&#20803;</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (&#23450; &#28310;&#20633;&#19968;&#20803;&#20989;&#25976;
       (<span class="keyword">&#955;</span> (&#19968;&#20803;&#20989;&#25976;)
           (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
               (&#19968;&#20803;&#20989;&#25976; (&#23481; &#23526;&#21443;&#37832;)))))
   (&#23450; &#28310;&#20633;&#20108;&#20803;&#20989;&#25976;
       (<span class="keyword">&#955;</span> (&#20108;&#20803;&#20989;&#25976;)
           (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
               (&#20108;&#20803;&#20989;&#25976; (&#23481; &#23526;&#21443;&#37832;)
                         (&#23481; (&#22336; &#23526;&#21443;&#37832;))))))

   (&#23450; *&#24120;&#20803;
       ((<span class="keyword">&#955;</span> (<span class="builtin">:&#37832;</span> <span class="builtin">:&#23481;</span> <span class="builtin">:&#22336;</span>
                 <span class="builtin">:&#31354;?</span> <span class="builtin">:&#31561;?</span> <span class="builtin">:&#21407;&#23376;?</span>
                 <span class="builtin">:&#38646;?</span> <span class="builtin">:&#22686;&#19968;</span> <span class="builtin">:&#28187;&#19968;</span> <span class="builtin">:&#25976;?</span>)
            (<span class="keyword">&#955;</span> (e &#34920;)
                (&#25511; [(&#25976;? e) e]
                    [(&#31561;? e #t) #t]
                    [(&#31561;? e #f) #f]
                    [(&#31561;? e (&#24341; &#37832;)) <span class="builtin">:&#37832;</span>]
                    [(&#31561;? e (&#24341; &#23481;)) <span class="builtin">:&#23481;</span>]
                    [(&#31561;? e (&#24341; &#22336;)) <span class="builtin">:&#22336;</span>]
                    [(&#31561;? e (&#24341; &#31354;?)) <span class="builtin">:&#31354;?</span>]
                    [(&#31561;? e (&#24341; &#31561;?)) <span class="builtin">:&#31561;?</span>]
                    [(&#31561;? e (&#24341; &#21407;&#23376;?)) <span class="builtin">:&#21407;&#23376;?</span>]
                    [(&#31561;? e (&#24341; &#38646;?)) <span class="builtin">:&#38646;?</span>]
                    [(&#31561;? e (&#24341; &#22686;&#19968;)) <span class="builtin">:&#22686;&#19968;</span>]
                    [(&#31561;? e (&#24341; &#28187;&#19968;)) <span class="builtin">:&#28187;&#19968;</span>]
                    [(&#31561;? e (&#24341; &#25976;?)) <span class="builtin">:&#25976;?</span>]
                    )))
        (&#28310;&#20633;&#20108;&#20803;&#20989;&#25976; &#37832;)
        (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#23481;)
        (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#22336;)
        (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#31354;?)
        (&#28310;&#20633;&#20108;&#20803;&#20989;&#25976; &#31561;?)
        (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#21407;&#23376;?)
        (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#38646;?)
        (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#22686;&#19968;)
        (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#28187;&#19968;)
        (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#25976;?)
        ))

   <span class="comment-delimiter">;; </span><span class="comment">&#29992;&#955;&#23526;&#29694;&#37832; &#24456;&#23481;&#26131;&#36890;&#36942;&#22686;&#21152;&#37832;&#20013;&#34987;&#36984;&#20043;&#29289; &#20358;&#25913;&#35722;&#37832;&#30340;&#32080;&#27083;
</span>   (&#23450; &#21021;&#37832;
       (<span class="keyword">&#955;</span> (&#23481;)
           ((<span class="keyword">&#955;</span> (&#36070;&#22336;)
                (<span class="keyword">&#955;</span> (&#36984;&#25799;&#23376;)
                    (&#36984;&#25799;&#23376; (<span class="keyword">&#955;</span> (x) (&#32622;! &#36070;&#22336; x))
                            &#23481;
                            &#36070;&#22336;)))
            (&#24341; ()))))
   (&#23450; &#37832;
       (<span class="keyword">&#955;</span> (&#23481; &#22336;)
           ((<span class="keyword">&#955;</span> (&#36070;&#37832;)
                (&#32622;&#22336; &#36070;&#37832; &#22336;)
                &#36070;&#37832;)
            (&#21021;&#37832; &#23481;))))
   (&#23450; &#32622;&#22336;
       (<span class="keyword">&#955;</span> (&#37832; &#26032;&#22336;)
           ((&#37832; (<span class="keyword">&#955;</span> (&#20043;&#32622; &#20043;&#23481; &#20043;&#22336;) &#20043;&#32622;))
            &#26032;&#22336;)))
   (&#23450; &#23481;
       (<span class="keyword">&#955;</span> (&#37832;)
           (&#37832; (<span class="keyword">&#955;</span> (&#20043;&#32622; &#20043;&#23481; &#20043;&#22336;) &#20043;&#23481;))))
   (&#23450; &#22336;
       (<span class="keyword">&#955;</span> (&#37832;)
           (&#37832; (<span class="keyword">&#955;</span> (&#20043;&#32622; &#20043;&#23481; &#20043;&#22336;) &#20043;&#22336;))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *&#25511;</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (&#23450; *&#25511;
       (<span class="keyword">&#955;</span> (e &#34920;)
           (&#27714;&#26044;&#25511; (&#21839;&#31572;&#37832;&#37096; e) &#34920;)))
   (&#23450; &#27714;&#26044;&#25511;
       (<span class="keyword">&#955;</span> (&#21839;&#31572;&#37832; &#34920;)
           (&#25511; [(&#21542;&#21063;? (&#21839;&#37096; (&#23481; &#21839;&#31572;&#37832;)))
                (&#24847; (&#31572;&#37096; (&#23481; &#21839;&#31572;&#37832;)) &#34920;)]
               [(&#24847; (&#21839;&#37096; (&#23481; &#21839;&#31572;&#37832;)) &#34920;)
                (&#24847; (&#31572;&#37096; (&#23481; &#21839;&#31572;&#37832;)) &#34920;)]
               [&#21542;&#21063; (&#27714;&#26044;&#25511; (&#22336; &#21839;&#31572;&#37832;) &#34920;)]
               )))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** *&#25429;</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (&#23450; *&#25429;
       (<span class="keyword">&#955;</span> (e &#34920;)
         (&#25429; &#25429;&#20043;&#27161;
             (&#27714;&#26044;&#39636; (&#25429;&#20043;&#39636;&#37096; e)
                     (&#25844;&#23637; (&#21517;&#37096; e)
                           (&#30418; (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#25429;&#20043;&#27161;))
                           &#34920;)))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** &#36628;</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (&#23450; &#25991;&#37096;
       (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x))))
   (&#23450; &#24418;&#21443;&#37096;
       (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x))))
   (&#23450; &#39636;&#37096;
       (<span class="keyword">&#955;</span> (x) (&#22336; (&#22336; x))))
   (&#23450; &#25429;&#20043;&#39636;&#37096;
       (<span class="keyword">&#955;</span> (x) (&#22336; (&#22336; x))))
   (&#23450; &#21517;&#37096;
       (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x))))
   (&#23450; &#20540;&#37096;
       (<span class="keyword">&#955;</span> (x)
           (&#25511; [(&#31354;? (&#22336; (&#22336; x))) 0]
               [&#21542;&#21063; (&#23481; (&#22336; (&#22336; x)))]
               )))
   (&#23450; &#21839;&#31572;&#37832;&#37096;
       (<span class="keyword">&#955;</span> (x) (&#22336; x)))
   (&#23450; &#21542;&#21063;?
       (<span class="keyword">&#955;</span> (x)
           (&#25511; [(&#21407;&#23376;? x) (&#31561;? x (&#24341; &#21542;&#21063;))]
               [&#21542;&#21063; #f]
               )))
   (&#23450; &#21839;&#37096;
       (<span class="keyword">&#955;</span> (x) (&#23481; x)))
   (&#23450; &#31572;&#37096;
       (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x))))
   (&#23450; &#20989;&#25976;&#37096;
       (<span class="keyword">&#955;</span> (x) (&#23481; x)))
   (&#23450; &#21443;&#25976;&#37832;&#37096;
       (<span class="keyword">&#955;</span> (x) (&#22336; x)))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* &#28204;&#35430;</span>
<span class="org-level-2">** load one</span>
<span class="org-meta-line">   #+name: &#22312;&#20803;&#35299;&#37323;&#22120;&#20013;&#21152;&#36617;value&#19968;&#23652;</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   <span class="comment-delimiter">;; </span><span class="comment">(load "dependence.scm")
</span>   <span class="comment-delimiter">;; </span><span class="comment">(load "interpreter-with-define-and-set!.scm")
</span>
   (value
    '(<span class="keyword">define</span> <span class="function-name">the-empty-table</span>
       (<span class="keyword">lambda</span> (name)
         (abort
          (cons 'no-answer
                (cons name '()))))))
   <span class="comment-delimiter">;; </span><span class="comment">((value 'value) 'the-empty-table)
</span>   (value
    '(<span class="keyword">define</span> <span class="function-name">global-table</span> the-empty-table))
   (value
    '(<span class="keyword">define</span> <span class="function-name">lookup</span>
       (<span class="keyword">lambda</span> (table name)
         (table name))))
   <span class="comment-delimiter">;; </span><span class="comment">&#22312;&#20840;&#23616;&#25844;&#23637;global-table&#30340;&#26159;*define
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#32780;*lambda&#20316;&#29992;&#26044;lambda-exp&#25152;&#24418;&#25104;&#30340;ciosure&#22312;&#20316;&#29992;&#26044;args&#26178;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#26371;&#29234;closure&#30340;body&#33256;&#26178;&#25844;&#23637;global-table
</span>   (value
    '(<span class="keyword">define</span> <span class="function-name">extend</span>
       (<span class="keyword">lambda</span> (name1 value table)
         (<span class="keyword">lambda</span> (name2)
           (<span class="keyword">cond</span> ((eq? name1 name2) value)
                 (<span class="keyword">else</span> (table name2)))))))

   (value
    '(<span class="keyword">define</span> <span class="function-name">abort</span>)) <span class="comment-delimiter">;; </span><span class="comment">&#36935;&#21040;the-empty-table&#26178;&#36339;&#20986;&#20358;&#22577;&#37679;
</span>   (value
    '(<span class="keyword">define</span> <span class="function-name">value</span>
       (<span class="keyword">lambda</span> (e)
         (<span class="keyword">letcc</span> the-end
                (<span class="keyword">set!</span> abort the-end)
                (<span class="keyword">cond</span> ((define? e) (*define e))
                      (<span class="keyword">else</span> (the-meaning e)))))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">the-meaning</span>
       (<span class="keyword">lambda</span> (e)
         (meaning e lookup-in-global-table))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">meaning</span>
       (<span class="keyword">lambda</span> (e table)
         ((expression-to-action e) e table))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">lookup-in-global-table</span>
       (<span class="keyword">lambda</span> (name)
         (lookup global-table name))))
   <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#35023;&#36890;&#36942;&#35519;&#29992;lookup&#20358;&#20316;&#19968;&#20491;closure
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#20491;closure&#25226;&#30070;&#21069;&#30340;global-table&#20445;&#35703;&#36215;&#20358;
</span>   <span class="comment-delimiter">;; </span><span class="comment">(define lookup-in-global-table
</span>   <span class="comment-delimiter">;;   </span><span class="comment">(lambda (name) (global-table name)))
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#29234;&#20160;&#40636;&#38656;&#35201;&#36889;&#20491;closure&#65311;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#20445;&#35703;&#36215;&#20358;&#30340;&#24847;&#24605;&#23601;&#26159;&#35201;&#24310;&#36978;&#36889;&#20491;closure&#30340;body&#30340;&#27714;&#20540;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#20351;&#24471;&#27714;&#20540;&#26178;&#36889;&#20491;body&#20013;&#30340;global-table&#21487;&#20197;&#26159;&#26368;&#26032;&#30340;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#29694;&#22312;&#25026;&#24471;&#20351;&#29992;closure&#30340;&#25216;&#24039;&#20102;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#27491;&#26159;&#36889;&#31278;&#25216;&#24039;&#20351;&#24471;&#21033;&#29992;define&#20358;&#23450;&#32681;&#36958;&#27512;&#20989;&#25976;&#25104;&#29234;&#21487;&#33021;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#27171;&#20063;&#23601;&#26126;&#30333;&#20102;Y!&#21644;letrec
</span>
   (value
    '(<span class="keyword">define</span> <span class="function-name">expression-to-action</span>
       (<span class="keyword">lambda</span> (e)
         (<span class="keyword">cond</span> ((atom? e) (atom-to-action e))
               (<span class="keyword">else</span> (list-to-action e))))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">atom-to-action</span>
       (<span class="keyword">lambda</span> (e)
         (<span class="keyword">cond</span> [(number? e) *const]
               [(eq? e #t) *const]
               [(eq? e #f) *const]
               [(eq? e 'cons) *const]
               [(eq? e 'car) *const]
               [(eq? e 'cdr) *const]
               [(eq? e 'null?) *const]
               [(eq? e 'eq?) *const]
               [(eq? e 'atom?) *const]
               [(eq? e 'zero?) *const]
               [(eq? e 'add1) *const]
               [(eq? e 'sub1) *const]
               [(eq? e 'number?) *const]
               [else *identifer]))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">list-to-action</span>
       (<span class="keyword">lambda</span> (e)
         (<span class="keyword">cond</span> [(null? e) *null]
               [(atom? (car e))
                (<span class="keyword">cond</span> [(eq? (car e) 'quote)
                       ,*quote]
                      [(eq? (car e) 'lambda)
                       ,*lambda]
                      [(eq? (car e) 'letcc)
                       ,*letcc]
                      [(eq? (car e) 'set!)
                       ,*set]
                      [(eq? (car e) 'cond)
                       ,*cond]
                      [else *application])]
               [else *application]))))

   (value
    '(<span class="keyword">define</span> <span class="function-name">define?</span>
       (<span class="keyword">lambda</span> (e)
         (<span class="keyword">cond</span> ((atom? e) #f)
               ((atom? (car e))
                (eq? (car e) 'define))
               (<span class="keyword">else</span> #f)))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">*define</span>
       (<span class="keyword">lambda</span> (e)
         (<span class="keyword">set!</span> global-table
               (extend (name-of e)
                       (box (the-meaning
                             (rigth-side-of e)))
                       global-table)))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">box</span>
       (<span class="keyword">lambda</span> (it)
         (<span class="keyword">lambda</span> (selector)
           (selector it
                     (<span class="keyword">lambda</span> (new) (<span class="keyword">set!</span> it new)))))))
   <span class="comment-delimiter">;; </span><span class="comment">&#19979;&#38754;&#26159;&#20841;&#20491;selector
</span>   <span class="comment-delimiter">;; </span><span class="comment">selector&#30340;&#29992;&#27861;&#26159;&#65306;(&#24478;&#21738;&#36984; (lambda (&#26377;&#37027;&#20123;) (&#36984;&#21738;&#20491;&#33287;&#22914;&#20309;&#34389;&#29702;)))
</span>   (value
    '(<span class="keyword">define</span> <span class="function-name">setbox</span>
       (<span class="keyword">lambda</span> (box new)
         (box (<span class="keyword">lambda</span> (it set) (set new))))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">unbox</span>
       (<span class="keyword">lambda</span> (box)
         (box (<span class="keyword">lambda</span> (it set) it)))))

   (value
    '(<span class="keyword">define</span> <span class="function-name">*null</span>
       (<span class="keyword">lambda</span> (e table)
         '())))

   (value
    '(<span class="keyword">define</span> <span class="function-name">*quote</span>
       (<span class="keyword">lambda</span> (e table)
         (text-of e))))

   (value
    '(<span class="keyword">define</span> <span class="function-name">*identifer</span>
       (<span class="keyword">lambda</span> (e table)
         (unbox (lookup table e)))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">*set</span>
       (<span class="keyword">lambda</span> (e table)
         (setbox (lookup table (name-of e))
                 (meaning (rigth-side-of e) table)))))

   (value
    '(<span class="keyword">define</span> <span class="function-name">*lambda</span>
       (<span class="keyword">lambda</span> (e table)
         (<span class="keyword">lambda</span> (args)
           (beglis (body-of e)
                   (multi-extend (formals-of e)
                                 (box-all args)
                                 table))))))
   <span class="comment-delimiter">;; </span><span class="comment">beglis denote? begain list
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#23427;&#23565;&lt;body&gt;&#20013;&#30340;&#25152;&#26377;&lt;sexp&gt;&#27714;&#20540;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#21482;&#36820;&#22238;&#26368;&#24460;&#19968;&#20491;&lt;sexp&gt;&#30340;&#20540; &#20854;&#20182;&#30340;&lt;sexp&gt;&#29992;&#20358;&#24418;&#25104;&#21103;&#20316;&#29992;
</span>   (value
    '(<span class="keyword">define</span> <span class="function-name">beglis</span>
       (<span class="keyword">lambda</span> (es table)
         (<span class="keyword">cond</span> ((null? (cdr es))           <span class="comment-delimiter">;</span><span class="comment">so body-of e con't be empty
</span>                (meaning (car es) table))
               (<span class="keyword">else</span>
                <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#35023;&#38656;&#35201;&#19968;&#20491;&#36070;&#20540;
</span>                <span class="comment-delimiter">;; </span><span class="comment">&#22240;&#29234;&#24460;&#38754;&#30340;&#26481;&#35199;(beglis (cdr es) table)
</span>                <span class="comment-delimiter">;; </span><span class="comment">&#38656;&#35201;&#22312;&#21069;&#38754;&#30340;&#21103;&#20316;&#29992;&#25152;&#24418;&#25104;&#26032;&#29872;&#22659;&#20013;&#27714;&#20540;
</span>                ((<span class="keyword">lambda</span> (val)
                   (beglis (cdr es) table))
                 (meaning (car es) table)))))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">box-all</span>
       (<span class="keyword">lambda</span> (vals)
         (<span class="keyword">cond</span> ((null? vals) '())
               (<span class="keyword">else</span>
                (cons (box (car vals))
                      (box-all (cdr vals))))))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">multi-extend</span>
       (<span class="keyword">lambda</span> (names values table)
         (<span class="keyword">cond</span> ((null? names) table)
               (<span class="keyword">else</span>
                (extend (car names)
                        (car values)
                        (multi-extend (cdr names)
                                      (cdr values)
                                      table)))))))

   (value
    '(<span class="keyword">define</span> <span class="function-name">*application</span>
       (<span class="keyword">lambda</span> (e table)
         ((meaning (function-of e) table)
          (evlis (arguments-of e) table)))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">evlis</span>
       (<span class="keyword">lambda</span> (args table)
         (<span class="keyword">cond</span> ((null? args) '())
               (<span class="keyword">else</span>
                <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#35023;&#29234;&#20160;&#40636;&#38656;&#35201;&#19968;&#20491;&#36070;&#20540;&#65311;
</span>                <span class="comment-delimiter">;; </span><span class="comment">&#36070;&#20540;&#22312;&#26044;&#22312;&#20316;&#29992;&#20043;&#21069;&#23601;&#20808;&#27714;&#26576;&#20123;&#34920;&#36948;&#24335;&#30340;&#20540;
</span>                <span class="comment-delimiter">;; </span><span class="comment">&#36070;&#20540;&#22312;&#26044;&#25511;&#21046;&#27714;&#20540;&#38918;&#24207;
</span>                <span class="comment-delimiter">;; </span><span class="comment">&#38656;&#35201;&#36889;&#20491;&#36070;&#20540;&#21487;&#33021;&#26159;&#22240;&#29234;&#25105;&#20497;&#19981;&#33021;&#38928;&#26009;cons&#23565;&#23427;&#21443;&#25976;&#30340;&#27714;&#20540;&#38918;&#24207;
</span>                ((<span class="keyword">lambda</span> (val)
                   (cons val
                         (evlis (cdr args) table)))
                 (meaning (car args) table)))))))

   <span class="comment-delimiter">;; </span><span class="comment">&#22240;&#29234;evlis&#36820;&#22238;&#30340;&#21443;&#25976;&#20540;&#26371;&#34987;&#34389;&#29702;&#29234;list
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#25152;&#20197;&#29992;&#19979;&#38754;&#30340;&#20841;&#20491;&#26481;&#35199;&#25226;&#21443;&#25976;&#24478;args-in-a-list&#20013;&#25343;&#20986;&#20358;
</span>   (value
    '(<span class="keyword">define</span> <span class="function-name">a-prim</span>
       (<span class="keyword">lambda</span> (p)
         (<span class="keyword">lambda</span> (args-in-a-list)
           (p (car args-in-a-list))))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">b-prim</span>
       (<span class="keyword">lambda</span> (p)
         (<span class="keyword">lambda</span> (args-in-a-list)
           (p (car args-in-a-list)
              (car (cdr args-in-a-list)))))))
   <span class="comment-delimiter">;; </span><span class="comment">&#36991;&#20813;&#37325;&#35079;&#20351;&#29992;a-prim&#33287;b-prim
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#22240;&#27492;&#22312;&#26368;&#22806;&#23652;&#23565;&#23427;&#20497;&#30340;&#20316;&#29992;&#32080;&#26524;&#36914;&#34892;&#36070;&#20540;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#27171;&#23450;&#32681;*const&#24460; &#20197;*const&#29234;&#21517;&#23383;&#30340;closure&#20013;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#20123;&#26412;&#20358;&#38656;&#35201;&#34987;a-prim&#33287;b-prim&#20316;&#29992;&#25165;&#33021;&#29554;&#24471;&#30340;&#20540;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#21482;&#35201;&#32147;&#36942;&#19968;&#20491;*identifer&#30340;&#26597;&#25214;&#23601;&#33021;&#29554;&#24471;&#20102;
</span>   (value
    '(<span class="keyword">define</span> <span class="function-name">*const</span>
       ((<span class="keyword">lambda</span> (<span class="builtin">:cons</span> <span class="builtin">:car</span> <span class="builtin">:cdr</span> <span class="builtin">:null?</span> <span class="builtin">:eq?</span> <span class="builtin">:atom?</span> <span class="builtin">:zero?</span> <span class="builtin">:add1</span> <span class="builtin">:sub1</span> <span class="builtin">:number?</span>)
          (<span class="keyword">lambda</span> (e table)
            (<span class="keyword">cond</span> ((number? e) e)
                  ((eq? e #t) #t)
                  ((eq? e #f) #f)
                  ((eq? e 'cons) <span class="builtin">:cons</span>)
                  ((eq? e 'car) <span class="builtin">:car</span>)
                  ((eq? e 'cdr) <span class="builtin">:cdr</span>)
                  ((eq? e 'null?) <span class="builtin">:null?</span>)
                  ((eq? e 'eq?) <span class="builtin">:eq?</span>)
                  ((eq? e 'atom?) <span class="builtin">:atom?</span>)
                  ((eq? e 'zero?) <span class="builtin">:zero?</span>)
                  ((eq? e 'add1) <span class="builtin">:add1</span>)
                  ((eq? e 'sub1) <span class="builtin">:sub1</span>)
                  ((eq? e 'number?) <span class="builtin">:number?</span>)
                  )))
        (b-prim cons)
        (a-prim car)
        (a-prim cdr)
        (a-prim null?)
        (b-prim eq?)
        (a-prim atom?)
        (a-prim zero?)
        (a-prim add1)
        (a-prim sub1)
        (a-prim number?)
        )))

   (value
    '(<span class="keyword">define</span> <span class="function-name">*cond</span>
       (<span class="keyword">lambda</span> (e table)
         (evcon (cond-lines-of e) table))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">evcon</span>
       (<span class="keyword">lambda</span> (lines table)
         (<span class="keyword">cond</span> ((else? (question-of (car lines)))
                (meaning (answer-of (car lines)) table))
               ((meaning (question-of (car lines)) table)
                (meaning (answer-of (car lines)) table))
               (<span class="keyword">else</span> (evcon (cdr lines) table))))))

   <span class="comment-delimiter">;; </span><span class="comment">&#20854;&#23526;&#23531;&#35299;&#37323;&#22120;&#23416;&#30340;&#23601;&#26159;closure&#30340;&#20351;&#29992;&#26041;&#24335;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#27604;&#22914;&#19979;&#38754;&#36889;&#20491;&#25226;letcc&#30452;&#25509;&#21152;&#20837;&#25105;&#30340;&#35299;&#37323;&#22120;&#20013;&#30340;&#36942;&#31243;&#23601;&#26681;&#26412;&#19981;&#35320;&#21450;letcc&#30340;&#26412;&#36074;
</span>   (value
    '(<span class="keyword">define</span> <span class="function-name">*letcc</span>
       (<span class="keyword">lambda</span> (e table)
         (<span class="keyword">letcc</span> skip
                (beglis (ccbody-of e)
                        (extend (name-of e)
                                (box (a-prim skip))
                                table))))))

   (value
    '(<span class="keyword">define</span> <span class="function-name">text-of</span>
       (<span class="keyword">lambda</span> (x) (car (cdr x)))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">formals-of</span>
       (<span class="keyword">lambda</span> (x) (car (cdr x)))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">body-of</span>
       (<span class="keyword">lambda</span> (x) (cdr (cdr x)))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">ccbody-of</span>
       (<span class="keyword">lambda</span> (x) (cdr (cdr x)))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">name-of</span>
       (<span class="keyword">lambda</span> (x) (car (cdr x)))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">rigth-side-of</span>
       (<span class="keyword">lambda</span> (x)
         (<span class="keyword">cond</span> ((null? (cdr (cdr x))) 0)
               <span class="comment-delimiter">;; </span><span class="comment">this handles definitions like (define kkk)
</span>               (<span class="keyword">else</span> (car (cdr (cdr x))))))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">cond-lines-of</span>
       (<span class="keyword">lambda</span> (x) (cdr x))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">else?</span>
       (<span class="keyword">lambda</span> (x)
         (<span class="keyword">cond</span> ((atom? x) (eq? x 'else))
               (<span class="keyword">else</span> #f)))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">question-of</span>
       (<span class="keyword">lambda</span> (x) (car x))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">answer-of</span>
       (<span class="keyword">lambda</span> (x) (car (cdr x)))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">function-of</span>
       (<span class="keyword">lambda</span> (x) (car x))))
   (value
    '(<span class="keyword">define</span> <span class="function-name">arguments-of</span>
       (<span class="keyword">lambda</span> (x) (cdr x))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-todo">&gt;&lt;</span><span class="org-level-2"> load two</span>
   &#29234;&#20160;&#40636;&#38656;&#35201;list&#20043;&#24460;&#25165;&#33021;&#27491;&#24120;&#28204;&#35430;?
<span class="org-meta-line">   #+name: &#22312;value&#20013;&#21152;&#36617;value&#20108;&#23652;</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   <span class="comment-delimiter">;; </span><span class="comment">(define value-one
</span>   <span class="comment-delimiter">;;   </span><span class="comment">(lambda (e)
</span>   <span class="comment-delimiter">;;     </span><span class="comment">((value 'value) e)))
</span>   <span class="comment-delimiter">;; </span><span class="comment">(value-one
</span>   <span class="comment-delimiter">;;  </span><span class="comment">'((lambda (x) (cons 1 x)) 2))
</span>   (<span class="keyword">define</span> <span class="function-name">value-one</span>
     (<span class="keyword">lambda</span> (e)
       ((value 'value) (list e))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">the-empty-table</span>
       (<span class="keyword">lambda</span> (name)
         (abort
          (cons 'no-answer
                (cons name '()))))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">global-table</span> the-empty-table))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">lookup</span>
       (<span class="keyword">lambda</span> (table name)
         (table name))))
   <span class="comment-delimiter">;; </span><span class="comment">&#22312;&#20840;&#23616;&#25844;&#23637;global-table&#30340;&#26159;*define
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#32780;*lambda&#20316;&#29992;&#26044;lambda-exp&#25152;&#24418;&#25104;&#30340;ciosure&#22312;&#20316;&#29992;&#26044;args&#26178;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#26371;&#29234;closure&#30340;body&#33256;&#26178;&#25844;&#23637;global-table
</span>   (value-one
    '(<span class="keyword">define</span> <span class="function-name">extend</span>
       (<span class="keyword">lambda</span> (name1 value table)
         (<span class="keyword">lambda</span> (name2)
           (<span class="keyword">cond</span> ((eq? name1 name2) value)
                 (<span class="keyword">else</span> (table name2)))))))

   (value-one
    '(<span class="keyword">define</span> <span class="function-name">abort</span>)) <span class="comment-delimiter">;; </span><span class="comment">&#36935;&#21040;the-empty-table&#26178;&#36339;&#20986;&#20358;&#22577;&#37679;
</span>   (value-one
    '(<span class="keyword">define</span> <span class="function-name">value</span>
       (<span class="keyword">lambda</span> (e)
         (<span class="keyword">letcc</span> the-end
                (<span class="keyword">set!</span> abort the-end)
                (<span class="keyword">cond</span> ((define? e) (*define e))
                      (<span class="keyword">else</span> (the-meaning e)))))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">the-meaning</span>
       (<span class="keyword">lambda</span> (e)
         (meaning e lookup-in-global-table))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">meaning</span>
       (<span class="keyword">lambda</span> (e table)
         ((expression-to-action e) e table))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">lookup-in-global-table</span>
       (<span class="keyword">lambda</span> (name)
         (lookup global-table name))))
   <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#35023;&#36890;&#36942;&#35519;&#29992;lookup&#20358;&#20316;&#19968;&#20491;closure
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#20491;closure&#25226;&#30070;&#21069;&#30340;global-table&#20445;&#35703;&#36215;&#20358;
</span>   <span class="comment-delimiter">;; </span><span class="comment">(define lookup-in-global-table
</span>   <span class="comment-delimiter">;;   </span><span class="comment">(lambda (name) (global-table name)))
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#29234;&#20160;&#40636;&#38656;&#35201;&#36889;&#20491;closure&#65311;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#20445;&#35703;&#36215;&#20358;&#30340;&#24847;&#24605;&#23601;&#26159;&#35201;&#24310;&#36978;&#36889;&#20491;closure&#30340;body&#30340;&#27714;&#20540;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#20351;&#24471;&#27714;&#20540;&#26178;&#36889;&#20491;body&#20013;&#30340;global-table&#21487;&#20197;&#26159;&#26368;&#26032;&#30340;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#29694;&#22312;&#25026;&#24471;&#20351;&#29992;closure&#30340;&#25216;&#24039;&#20102;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#27491;&#26159;&#36889;&#31278;&#25216;&#24039;&#20351;&#24471;&#21033;&#29992;define&#20358;&#23450;&#32681;&#36958;&#27512;&#20989;&#25976;&#25104;&#29234;&#21487;&#33021;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#27171;&#20063;&#23601;&#26126;&#30333;&#20102;Y!&#21644;letrec
</span>
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">expression-to-action</span>
       (<span class="keyword">lambda</span> (e)
         (<span class="keyword">cond</span> ((atom? e) (atom-to-action e))
               (<span class="keyword">else</span> (list-to-action e))))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">atom-to-action</span>
       (<span class="keyword">lambda</span> (e)
         (<span class="keyword">cond</span> [(number? e) *const]
               [(eq? e #t) *const]
               [(eq? e #f) *const]
               [(eq? e 'cons) *const]
               [(eq? e 'car) *const]
               [(eq? e 'cdr) *const]
               [(eq? e 'null?) *const]
               [(eq? e 'eq?) *const]
               [(eq? e 'atom?) *const]
               [(eq? e 'zero?) *const]
               [(eq? e 'add1) *const]
               [(eq? e 'sub1) *const]
               [(eq? e 'number?) *const]
               [else *identifer]))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">list-to-action</span>
       (<span class="keyword">lambda</span> (e)
         (<span class="keyword">cond</span> [(null? e) *null]
               [(atom? (car e))
                (<span class="keyword">cond</span> [(eq? (car e) 'quote)
                       ,*quote]
                      [(eq? (car e) 'lambda)
                       ,*lambda]
                      [(eq? (car e) 'letcc)
                       ,*letcc]
                      [(eq? (car e) 'set!)
                       ,*set]
                      [(eq? (car e) 'cond)
                       ,*cond]
                      [else *application])]
               [else *application]))))

   (value-one
    '(<span class="keyword">define</span> <span class="function-name">define?</span>
       (<span class="keyword">lambda</span> (e)
         (<span class="keyword">cond</span> ((atom? e) #f)
               ((atom? (car e))
                (eq? (car e) 'define))
               (<span class="keyword">else</span> #f)))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">*define</span>
       (<span class="keyword">lambda</span> (e)
         (<span class="keyword">set!</span> global-table
               (extend (name-of e)
                       (box (the-meaning
                             (rigth-side-of e)))
                       global-table)))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">box</span>
       (<span class="keyword">lambda</span> (it)
         (<span class="keyword">lambda</span> (selector)
           (selector it
                     (<span class="keyword">lambda</span> (new) (<span class="keyword">set!</span> it new)))))))
   <span class="comment-delimiter">;; </span><span class="comment">&#19979;&#38754;&#26159;&#20841;&#20491;selector
</span>   <span class="comment-delimiter">;; </span><span class="comment">selector&#30340;&#29992;&#27861;&#26159;&#65306;(&#24478;&#21738;&#36984; (lambda (&#26377;&#37027;&#20123;) (&#36984;&#21738;&#20491;&#33287;&#22914;&#20309;&#34389;&#29702;)))
</span>   (value-one
    '(<span class="keyword">define</span> <span class="function-name">setbox</span>
       (<span class="keyword">lambda</span> (box new)
         (box (<span class="keyword">lambda</span> (it set) (set new))))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">unbox</span>
       (<span class="keyword">lambda</span> (box)
         (box (<span class="keyword">lambda</span> (it set) it)))))

   (value-one
    '(<span class="keyword">define</span> <span class="function-name">*null</span>
       (<span class="keyword">lambda</span> (e table)
         '())))

   (value-one
    '(<span class="keyword">define</span> <span class="function-name">*quote</span>
       (<span class="keyword">lambda</span> (e table)
         (text-of e))))

   (value-one
    '(<span class="keyword">define</span> <span class="function-name">*identifer</span>
       (<span class="keyword">lambda</span> (e table)
         (unbox (lookup table e)))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">*set</span>
       (<span class="keyword">lambda</span> (e table)
         (setbox (lookup table (name-of e))
                 (meaning (rigth-side-of e) table)))))

   (value-one
    '(<span class="keyword">define</span> <span class="function-name">*lambda</span>
       (<span class="keyword">lambda</span> (e table)
         (<span class="keyword">lambda</span> (args)
           (beglis (body-of e)
                   (multi-extend (formals-of e)
                                 (box-all args)
                                 table))))))
   <span class="comment-delimiter">;; </span><span class="comment">beglis denote? begain list
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#23427;&#23565;&lt;body&gt;&#20013;&#30340;&#25152;&#26377;&lt;sexp&gt;&#27714;&#20540;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#21482;&#36820;&#22238;&#26368;&#24460;&#19968;&#20491;&lt;sexp&gt;&#30340;&#20540; &#20854;&#20182;&#30340;&lt;sexp&gt;&#29992;&#20358;&#24418;&#25104;&#21103;&#20316;&#29992;
</span>   (value-one
    '(<span class="keyword">define</span> <span class="function-name">beglis</span>
       (<span class="keyword">lambda</span> (es table)
         (<span class="keyword">cond</span> ((null? (cdr es))           <span class="comment-delimiter">;</span><span class="comment">so body-of e con't be empty
</span>                (meaning (car es) table))
               (<span class="keyword">else</span>
                <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#35023;&#38656;&#35201;&#19968;&#20491;&#36070;&#20540;
</span>                <span class="comment-delimiter">;; </span><span class="comment">&#22240;&#29234;&#24460;&#38754;&#30340;&#26481;&#35199;(beglis (cdr es) table)
</span>                <span class="comment-delimiter">;; </span><span class="comment">&#38656;&#35201;&#22312;&#21069;&#38754;&#30340;&#21103;&#20316;&#29992;&#25152;&#24418;&#25104;&#26032;&#29872;&#22659;&#20013;&#27714;&#20540;
</span>                ((<span class="keyword">lambda</span> (val)
                   (beglis (cdr es) table))
                 (meaning (car es) table)))))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">box-all</span>
       (<span class="keyword">lambda</span> (vals)
         (<span class="keyword">cond</span> ((null? vals) '())
               (<span class="keyword">else</span>
                (cons (box (car vals))
                      (box-all (cdr vals))))))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">multi-extend</span>
       (<span class="keyword">lambda</span> (names values table)
         (<span class="keyword">cond</span> ((null? names) table)
               (<span class="keyword">else</span>
                (extend (car names)
                        (car values)
                        (multi-extend (cdr names)
                                      (cdr values)
                                      table)))))))

   (value-one
    '(<span class="keyword">define</span> <span class="function-name">*application</span>
       (<span class="keyword">lambda</span> (e table)
         ((meaning (function-of e) table)
          (evlis (arguments-of e) table)))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">evlis</span>
       (<span class="keyword">lambda</span> (args table)
         (<span class="keyword">cond</span> ((null? args) '())
               (<span class="keyword">else</span>
                <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#35023;&#29234;&#20160;&#40636;&#38656;&#35201;&#19968;&#20491;&#36070;&#20540;&#65311;
</span>                <span class="comment-delimiter">;; </span><span class="comment">&#36070;&#20540;&#22312;&#26044;&#22312;&#20316;&#29992;&#20043;&#21069;&#23601;&#20808;&#27714;&#26576;&#20123;&#34920;&#36948;&#24335;&#30340;&#20540;
</span>                <span class="comment-delimiter">;; </span><span class="comment">&#36070;&#20540;&#22312;&#26044;&#25511;&#21046;&#27714;&#20540;&#38918;&#24207;
</span>                <span class="comment-delimiter">;; </span><span class="comment">&#38656;&#35201;&#36889;&#20491;&#36070;&#20540;&#21487;&#33021;&#26159;&#22240;&#29234;&#25105;&#20497;&#19981;&#33021;&#38928;&#26009;cons&#23565;&#23427;&#21443;&#25976;&#30340;&#27714;&#20540;&#38918;&#24207;
</span>                ((<span class="keyword">lambda</span> (val)
                   (cons val
                         (evlis (cdr args) table)))
                 (meaning (car args) table)))))))

   <span class="comment-delimiter">;; </span><span class="comment">&#22240;&#29234;evlis&#36820;&#22238;&#30340;&#21443;&#25976;&#20540;&#26371;&#34987;&#34389;&#29702;&#29234;list
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#25152;&#20197;&#29992;&#19979;&#38754;&#30340;&#20841;&#20491;&#26481;&#35199;&#25226;&#21443;&#25976;&#24478;args-in-a-list&#20013;&#25343;&#20986;&#20358;
</span>   (value-one
    '(<span class="keyword">define</span> <span class="function-name">a-prim</span>
       (<span class="keyword">lambda</span> (p)
         (<span class="keyword">lambda</span> (args-in-a-list)
           (p (car args-in-a-list))))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">b-prim</span>
       (<span class="keyword">lambda</span> (p)
         (<span class="keyword">lambda</span> (args-in-a-list)
           (p (car args-in-a-list)
              (cadr args-in-a-list))))))
   <span class="comment-delimiter">;; </span><span class="comment">&#36991;&#20813;&#37325;&#35079;&#20351;&#29992;a-prim&#33287;b-prim
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#22240;&#27492;&#22312;&#26368;&#22806;&#23652;&#23565;&#23427;&#20497;&#30340;&#20316;&#29992;&#32080;&#26524;&#36914;&#34892;&#36070;&#20540;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#27171;&#23450;&#32681;*const&#24460; &#20197;*const&#29234;&#21517;&#23383;&#30340;closure&#20013;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#36889;&#20123;&#26412;&#20358;&#38656;&#35201;&#34987;a-prim&#33287;b-prim&#20316;&#29992;&#25165;&#33021;&#29554;&#24471;&#30340;&#20540;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#21482;&#35201;&#32147;&#36942;&#19968;&#20491;*identifer&#30340;&#26597;&#25214;&#23601;&#33021;&#29554;&#24471;&#20102;
</span>   (value-one
    '(<span class="keyword">define</span> <span class="function-name">*const</span>
       ((<span class="keyword">lambda</span> (<span class="builtin">:cons</span> <span class="builtin">:car</span> <span class="builtin">:cdr</span> <span class="builtin">:null?</span> <span class="builtin">:eq?</span> <span class="builtin">:atom?</span> <span class="builtin">:zero?</span> <span class="builtin">:add1</span> <span class="builtin">:sub1</span> <span class="builtin">:number?</span>)
          (<span class="keyword">lambda</span> (e table)
            (<span class="keyword">cond</span> ((number? e) e)
                  ((eq? e #t) #t)
                  ((eq? e #f) #f)
                  ((eq? e 'cons) <span class="builtin">:cons</span>)
                  ((eq? e 'car) <span class="builtin">:car</span>)
                  ((eq? e 'cdr) <span class="builtin">:cdr</span>)
                  ((eq? e 'null?) <span class="builtin">:null?</span>)
                  ((eq? e 'eq?) <span class="builtin">:eq?</span>)
                  ((eq? e 'atom?) <span class="builtin">:atom?</span>)
                  ((eq? e 'zero?) <span class="builtin">:zero?</span>)
                  ((eq? e 'add1) <span class="builtin">:add1</span>)
                  ((eq? e 'sub1) <span class="builtin">:sub1</span>)
                  ((eq? e 'number?) <span class="builtin">:number?</span>)
                  )))
        (b-prim cons)
        (a-prim car)
        (a-prim cdr)
        (a-prim null?)
        (b-prim eq?)
        (a-prim atom?)
        (a-prim zero?)
        (a-prim add1)
        (a-prim sub1)
        (a-prim number?)
        )))

   (value-one
    '(<span class="keyword">define</span> <span class="function-name">*cond</span>
       (<span class="keyword">lambda</span> (e table)
         (evcon (cond-lines-of e) table))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">evcon</span>
       (<span class="keyword">lambda</span> (lines table)
         (<span class="keyword">cond</span> ((else? (question-of (car lines)))
                (meaning (answer-of (car lines)) table))
               ((meaning (question-of (car lines)) table)
                (meaning (answer-of (car lines)) table))
               (<span class="keyword">else</span> (evcon (cdr lines) table))))))

   <span class="comment-delimiter">;; </span><span class="comment">&#20854;&#23526;&#23531;&#35299;&#37323;&#22120;&#23416;&#30340;&#23601;&#26159;closure&#30340;&#20351;&#29992;&#26041;&#24335;
</span>   <span class="comment-delimiter">;; </span><span class="comment">&#27604;&#22914;&#19979;&#38754;&#36889;&#20491;&#25226;letcc&#30452;&#25509;&#21152;&#20837;&#25105;&#30340;&#35299;&#37323;&#22120;&#20013;&#30340;&#36942;&#31243;&#23601;&#26681;&#26412;&#19981;&#35320;&#21450;letcc&#30340;&#26412;&#36074;
</span>   (value-one
    '(<span class="keyword">define</span> <span class="function-name">*letcc</span>
       (<span class="keyword">lambda</span> (e table)
         (<span class="keyword">letcc</span> skip
                (beglis (ccbody-of e)
                        (extend (name-of e)
                                (box (a-prim skip))
                                table))))))

   (value-one
    '(<span class="keyword">define</span> <span class="function-name">text-of</span>
       (<span class="keyword">lambda</span> (x) (car (cdr x)))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">formals-of</span>
       (<span class="keyword">lambda</span> (x) (car (cdr x)))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">body-of</span>
       (<span class="keyword">lambda</span> (x) (cdr (cdr x)))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">ccbody-of</span>
       (<span class="keyword">lambda</span> (x) (cdr (cdr x)))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">name-of</span>
       (<span class="keyword">lambda</span> (x) (car (cdr x)))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">rigth-side-of</span>
       (<span class="keyword">lambda</span> (x)
         (<span class="keyword">cond</span> ((null? (cdr (cdr x))) 0)
               <span class="comment-delimiter">;; </span><span class="comment">this handles definitions like (define kkk)
</span>               (<span class="keyword">else</span> (car (cdr (cdr x))))))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">cond-lines-of</span>
       (<span class="keyword">lambda</span> (x) (cdr x))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">else?</span>
       (<span class="keyword">lambda</span> (x)
         (<span class="keyword">cond</span> ((atom? x) (eq? x 'else))
               (<span class="keyword">else</span> #f)))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">question-of</span>
       (<span class="keyword">lambda</span> (x) (car x))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">answer-of</span>
       (<span class="keyword">lambda</span> (x) (car (cdr x)))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">function-of</span>
       (<span class="keyword">lambda</span> (x) (car x))))
   (value-one
    '(<span class="keyword">define</span> <span class="function-name">arguments-of</span>
       (<span class="keyword">lambda</span> (x) (cdr x))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** &#21152;&#36617; &#38646;</span>
<span class="org-meta-line">   #+name: &#22312;&#20013;&#25991;&#35299;&#37323;&#22120;&#38646;&#20013;&#21152;&#36617;&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (load <span class="string">"dependence.scm"</span>)
   (load <span class="string">"&#20013;&#25991;&#35299;&#37323;&#22120;&#38646;.scm"</span>)
   (&#27714; '(&#23450; &#31354;&#34920;
            (<span class="keyword">&#955;</span> (&#21517;)
                (&#22833;&#25943;
                 (&#37832; (&#24341; &#28961;&#20540;&#20043;&#21517;)
                     (&#37832; &#21517; (&#24341; ())))))))

   (&#27714; '(&#23450; &#31354;&#34920;
        (<span class="keyword">&#955;</span> (&#21517;)
            (&#22833;&#25943;
             (&#37832; (&#24341; &#28961;&#20540;&#20043;&#21517;)
                 (&#37832; &#21517; (&#24341; ())))))))
   (&#27714; '(&#23450; &#32317;&#34920; &#31354;&#34920;))
   (&#27714; '(&#23450; &#26597;
        (<span class="keyword">&#955;</span> (&#34920; &#21517;)
            (&#34920; &#21517;))))
   (&#27714; '(&#23450; &#25844;&#23637;
        (<span class="keyword">&#955;</span> (&#21517;1 &#20540; &#34920;)
            (<span class="keyword">&#955;</span> (&#21517;2)
                (&#25511; [(&#31561;? &#21517;1 &#21517;2) &#20540;]
                    [&#21542;&#21063; (&#34920; &#21517;2)])))))

   (&#27714; '(&#23450; &#22833;&#25943;))
   (&#27714; '(&#23450; &#27714;
        (<span class="keyword">&#955;</span> (e)
            (&#25429; &#32066;
                (&#32622;! &#22833;&#25943; &#32066;)
                (&#25511; [(&#23450;? e) (*&#23450; e)]
                    [&#21542;&#21063; (&#20854;&#24847; e)])))))
   (&#27714; '(&#23450; &#20854;&#24847;
        (<span class="keyword">&#955;</span> (e)
            (&#24847; e &#26597;&#32317;&#34920;))))
   (&#27714; '(&#23450; &#24847;
        (<span class="keyword">&#955;</span> (e &#34920;)
            ((&#24335;&#20043;&#20316;&#29992; e) e &#34920;))))
   (&#27714; '(&#23450; &#26597;&#32317;&#34920;
        (<span class="keyword">&#955;</span> (&#21517;)
            (&#26597; &#32317;&#34920; &#21517;))))

   (&#27714; '(&#23450; &#24335;&#20043;&#20316;&#29992;
        (<span class="keyword">&#955;</span> (e)
            (&#25511; [(&#21407;&#23376;? e) (&#21407;&#23376;&#20043;&#20316;&#29992; e)]
                [&#21542;&#21063; (&#37832;&#20043;&#20316;&#29992; e)]))))
   (&#27714; '(&#23450; &#21407;&#23376;&#20043;&#20316;&#29992;
        (<span class="keyword">&#955;</span> (e)
            (&#25511; [(&#25976;? e) *&#24120;&#20803;]
                [(&#31561;? e #t) *&#24120;&#20803;]
                [(&#31561;? e #f) *&#24120;&#20803;]
                [(&#31561;? e (&#24341; &#37832;)) *&#24120;&#20803;]
                [(&#31561;? e (&#24341; &#23481;)) *&#24120;&#20803;]
                [(&#31561;? e (&#24341; &#22336;)) *&#24120;&#20803;]
                [(&#31561;? e (&#24341; &#31354;?)) *&#24120;&#20803;]
                [(&#31561;? e (&#24341; &#31561;?)) *&#24120;&#20803;]
                [(&#31561;? e (&#24341; &#21407;&#23376;?)) *&#24120;&#20803;]
                [(&#31561;? e (&#24341; &#38646;?)) *&#24120;&#20803;]
                [(&#31561;? e (&#24341; &#22686;&#19968;)) *&#24120;&#20803;]
                [(&#31561;? e (&#24341; &#28187;&#19968;)) *&#24120;&#20803;]
                [(&#31561;? e (&#24341; &#25976;?)) *&#24120;&#20803;]
                [&#21542;&#21063; *&#35722;&#20803;]))))
   (&#27714; '(&#23450; &#37832;&#20043;&#20316;&#29992;
        (<span class="keyword">&#955;</span> (e)
            (&#25511; [(&#31354;? e) *&#31354;]
                [(&#21407;&#23376;? (&#23481; e))
                 (&#25511; [(&#31561;? (&#23481; e) (&#24341; &#24341;))
                      ,*&#24341;]
                     [(&#31561;? (&#23481; e) (&#24341; &#955;))
                      ,*&#955;]
                     [(&#31561;? (&#23481; e) (&#24341; &#25429;))
                      ,*&#25429;]
                     [(&#31561;? (&#23481; e) (&#24341; &#32622;!))
                      ,*&#32622;]
                     [(&#31561;? (&#23481; e) (&#24341; &#25511;))
                      ,*&#25511;]
                     [&#21542;&#21063; *&#20316;&#29992;])]
                [&#21542;&#21063; *&#20316;&#29992;]))))

   (&#27714; '(&#23450; &#23450;?
        (<span class="keyword">&#955;</span> (e)
            (&#25511; [(&#21407;&#23376;? e) #f]
                [(&#21407;&#23376;? (&#23481; e))
                 (&#31561;? (&#23481; e) (&#24341; &#23450;))]
                [&#21542;&#21063; #f]))))
   (&#27714; '(&#23450; *&#23450;
        (<span class="keyword">&#955;</span> (e)
            (&#32622;! &#32317;&#34920;
                 (&#25844;&#23637; (&#21517;&#37096; e)
                       (&#30418; (&#20854;&#24847;
                            (&#20540;&#37096; e)))
                       &#32317;&#34920;)))))
   (&#27714; '(&#23450; &#30418;
        (<span class="keyword">&#955;</span> (&#29289;)
            (<span class="keyword">&#955;</span> (&#36984;&#25799;&#23376;)
                (&#36984;&#25799;&#23376; &#29289;
                        (<span class="keyword">&#955;</span> (&#26032;&#29289;) (&#32622;! &#29289; &#26032;&#29289;)))))))
   <span class="comment-delimiter">;; </span><span class="comment">&#19979;&#38754;&#26159;&#20841;&#20491;&#36984;&#25799;&#23376;
</span>   (&#27714; '(&#23450; &#37325;&#32622;&#30418;
        (<span class="keyword">&#955;</span> (&#30418; &#26032;&#29289;)
            (&#30418; (<span class="keyword">&#955;</span> (&#20043;&#29289; &#20043;&#32622;) (&#20043;&#32622; &#26032;&#29289;))))))
   (&#27714; '(&#23450; &#21462;&#26044;&#30418;
        (<span class="keyword">&#955;</span> (&#30418;)
            (&#30418; (<span class="keyword">&#955;</span> (&#20043;&#29289; &#20043;&#32622;) &#20043;&#29289;)))))

   (&#27714; '(&#23450; *&#31354;
        (<span class="keyword">&#955;</span> (e &#34920;)
            (&#24341; ()))))

   (&#27714; '(&#23450; *&#24341;
        (<span class="keyword">&#955;</span> (e &#34920;)
            (&#25991;&#37096; e))))

   (&#27714; '(&#23450; *&#35722;&#20803;
        (<span class="keyword">&#955;</span> (e &#34920;)
            (&#21462;&#26044;&#30418; (&#26597; &#34920; e)))))
   (&#27714; '(&#23450; *&#32622;
        (<span class="keyword">&#955;</span> (e &#34920;)
            (&#37325;&#32622;&#30418; (&#26597; &#34920; (&#21517;&#37096; e))
                    (&#24847; (&#20540;&#37096; e) &#34920;)))))

   (&#27714; '(&#23450; *&#955;
        (<span class="keyword">&#955;</span> (e &#34920;)
            (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
                (&#27714;&#26044;&#39636; (&#39636;&#37096; e)
                        (&#22810;&#25844;&#23637; (&#24418;&#21443;&#37096; e)
                                (&#22810;&#30418; &#23526;&#21443;&#37832;)
                                &#34920;))))))

   (&#27714; '(&#23450; &#27714;&#26044;&#39636;
        (<span class="keyword">&#955;</span> (&#24335;&#37832; &#34920;)
            (&#25511; [(&#31354;? (&#22336; &#24335;&#37832;))
                 (&#24847; (&#23481; &#24335;&#37832;) &#34920;)]
                [&#21542;&#21063;
                 ((<span class="keyword">&#955;</span> (&#36070;&#21443;)
                      (&#27714;&#26044;&#39636; (&#22336; &#24335;&#37832;) &#34920;))
                  (&#24847; (&#23481; &#24335;&#37832;) &#34920;))]))))
   (&#27714; '(&#23450; &#22810;&#30418;
        (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
            (&#25511; [(&#31354;? &#23526;&#21443;&#37832;) (&#24341; ())]
                [&#21542;&#21063;
                 (&#37832; (&#30418; (&#23481; &#23526;&#21443;&#37832;))
                     (&#22810;&#30418; (&#22336; &#23526;&#21443;&#37832;)))]))))
   (&#27714; '(&#23450; &#22810;&#25844;&#23637;
        (<span class="keyword">&#955;</span> (&#21517;&#37832; &#20540;&#37832; &#34920;)
            (&#25511; [(&#31354;? &#21517;&#37832;) &#34920;]
                [&#21542;&#21063;
                 (&#25844;&#23637; (&#23481; &#21517;&#37832;)
                       (&#23481; &#20540;&#37832;)
                       (&#22810;&#25844;&#23637; (&#22336; &#21517;&#37832;)
                               (&#22336; &#20540;&#37832;)
                               &#34920;))]))))

   (&#27714; '(&#23450; *&#20316;&#29992;
        (<span class="keyword">&#955;</span> (e &#34920;)
            ((&#24847; (&#20989;&#25976;&#37096; e) &#34920;)
             (&#27714;&#26044;&#37832; (&#21443;&#25976;&#37832;&#37096; e) &#34920;)))))
   (&#27714; '(&#23450; &#27714;&#26044;&#37832;
        (<span class="keyword">&#955;</span> (&#24335;&#37832; &#34920;)
            (&#25511; [(&#31354;? &#24335;&#37832;) (&#24341; ())]
                [&#21542;&#21063;
                 ((<span class="keyword">&#955;</span> (&#36070;&#21443;)
                      (&#37832; &#36070;&#21443;
                          (&#27714;&#26044;&#37832; (&#22336; &#24335;&#37832;) &#34920;)))
                  (&#24847; (&#23481; &#24335;&#37832;) &#34920;))]
                ))))

   (&#27714; '(&#23450; &#28310;&#20633;&#19968;&#20803;&#20989;&#25976;
        (<span class="keyword">&#955;</span> (&#19968;&#20803;&#20989;&#25976;)
            (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
                (&#19968;&#20803;&#20989;&#25976; (&#23481; &#23526;&#21443;&#37832;))))))
   (&#27714; '(&#23450; &#28310;&#20633;&#20108;&#20803;&#20989;&#25976;
        (<span class="keyword">&#955;</span> (&#20108;&#20803;&#20989;&#25976;)
            (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
                (&#20108;&#20803;&#20989;&#25976; (&#23481; &#23526;&#21443;&#37832;)
                          (&#23481; (&#22336; &#23526;&#21443;&#37832;)))))))

   (&#27714; '(&#23450; *&#24120;&#20803;
        ((<span class="keyword">&#955;</span> (<span class="builtin">:&#37832;</span> <span class="builtin">:&#23481;</span> <span class="builtin">:&#22336;</span>
                  <span class="builtin">:&#31354;?</span> <span class="builtin">:&#31561;?</span> <span class="builtin">:&#21407;&#23376;?</span>
                  <span class="builtin">:&#38646;?</span> <span class="builtin">:&#22686;&#19968;</span> <span class="builtin">:&#28187;&#19968;</span> <span class="builtin">:&#25976;?</span>)
             (<span class="keyword">&#955;</span> (e &#34920;)
                 (&#25511; [(&#25976;? e) e]
                     [(&#31561;? e #t) #t]
                     [(&#31561;? e #f) #f]
                     [(&#31561;? e (&#24341; &#37832;)) <span class="builtin">:&#37832;</span>]
                     [(&#31561;? e (&#24341; &#23481;)) <span class="builtin">:&#23481;</span>]
                     [(&#31561;? e (&#24341; &#22336;)) <span class="builtin">:&#22336;</span>]
                     [(&#31561;? e (&#24341; &#31354;?)) <span class="builtin">:&#31354;?</span>]
                     [(&#31561;? e (&#24341; &#31561;?)) <span class="builtin">:&#31561;?</span>]
                     [(&#31561;? e (&#24341; &#21407;&#23376;?)) <span class="builtin">:&#21407;&#23376;?</span>]
                     [(&#31561;? e (&#24341; &#38646;?)) <span class="builtin">:&#38646;?</span>]
                     [(&#31561;? e (&#24341; &#22686;&#19968;)) <span class="builtin">:&#22686;&#19968;</span>]
                     [(&#31561;? e (&#24341; &#28187;&#19968;)) <span class="builtin">:&#28187;&#19968;</span>]
                     [(&#31561;? e (&#24341; &#25976;?)) <span class="builtin">:&#25976;?</span>]
                     )))
         (&#28310;&#20633;&#20108;&#20803;&#20989;&#25976; &#37832;)
         (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#23481;)
         (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#22336;)
         (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#31354;?)
         (&#28310;&#20633;&#20108;&#20803;&#20989;&#25976; &#31561;?)
         (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#21407;&#23376;?)
         (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#38646;?)
         (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#22686;&#19968;)
         (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#28187;&#19968;)
         (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#25976;?)
         )))

   <span class="comment-delimiter">;; </span><span class="comment">&#29992;&#955;&#23526;&#29694;&#37832; &#24456;&#23481;&#26131;&#36890;&#36942;&#22686;&#21152;&#37832;&#20013;&#34987;&#36984;&#20043;&#29289; &#20358;&#25913;&#35722;&#37832;&#30340;&#32080;&#27083;
</span>   (&#27714; '(&#23450; &#21021;&#37832;
        (<span class="keyword">&#955;</span> (&#23481;)
            ((<span class="keyword">&#955;</span> (&#36070;&#22336;)
                 (<span class="keyword">&#955;</span> (&#36984;&#25799;&#23376;)
                     (&#36984;&#25799;&#23376; (<span class="keyword">&#955;</span> (x) (&#32622;! &#36070;&#22336; x))
                             &#23481;
                             &#36070;&#22336;)))
             (&#24341; ())))))
   (&#27714; '(&#23450; &#37832;
        (<span class="keyword">&#955;</span> (&#23481; &#22336;)
            ((<span class="keyword">&#955;</span> (&#36070;&#37832;)
                 (&#32622;&#22336; &#36070;&#37832; &#22336;)
                 &#36070;&#37832;)
             (&#21021;&#37832; &#23481;)))))
   (&#27714; '(&#23450; &#32622;&#22336;
        (<span class="keyword">&#955;</span> (&#37832; &#26032;&#22336;)
            ((&#37832; (<span class="keyword">&#955;</span> (&#20043;&#32622; &#20043;&#23481; &#20043;&#22336;) &#20043;&#32622;))
             &#26032;&#22336;))))
   (&#27714; '(&#23450; &#23481;
        (<span class="keyword">&#955;</span> (&#37832;)
            (&#37832; (<span class="keyword">&#955;</span> (&#20043;&#32622; &#20043;&#23481; &#20043;&#22336;) &#20043;&#23481;)))))
   (&#27714; '(&#23450; &#22336;
        (<span class="keyword">&#955;</span> (&#37832;)
            (&#37832; (<span class="keyword">&#955;</span> (&#20043;&#32622; &#20043;&#23481; &#20043;&#22336;) &#20043;&#22336;)))))

   (&#27714; '(&#23450; *&#25511;
        (<span class="keyword">&#955;</span> (e &#34920;)
            (&#27714;&#26044;&#25511; (&#21839;&#31572;&#37832;&#37096; e) &#34920;))))
   (&#27714; '(&#23450; &#27714;&#26044;&#25511;
        (<span class="keyword">&#955;</span> (&#21839;&#31572;&#37832; &#34920;)
            (&#25511; [(&#21542;&#21063;? (&#21839;&#37096; (&#23481; &#21839;&#31572;&#37832;)))
                 (&#24847; (&#31572;&#37096; (&#23481; &#21839;&#31572;&#37832;)) &#34920;)]
                [(&#24847; (&#21839;&#37096; (&#23481; &#21839;&#31572;&#37832;)) &#34920;)
                 (&#24847; (&#31572;&#37096; (&#23481; &#21839;&#31572;&#37832;)) &#34920;)]
                [&#21542;&#21063; (&#27714;&#26044;&#25511; (&#22336; &#21839;&#31572;&#37832;) &#34920;)]
                ))))

   (&#27714; '(&#23450; *&#25429;
        (<span class="keyword">&#955;</span> (e &#34920;)
            (&#25429; &#25429;&#20043;&#27161;
                (&#27714;&#26044;&#39636; (&#25429;&#20043;&#39636;&#37096; e)
                        (&#25844;&#23637; (&#21517;&#37096; e)
                              (&#30418; (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#25429;&#20043;&#27161;))
                              &#34920;))))))

   (&#27714; '(&#23450; &#25991;&#37096;
        (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x)))))
   (&#27714; '(&#23450; &#24418;&#21443;&#37096;
        (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x)))))
   (&#27714; '(&#23450; &#39636;&#37096;
        (<span class="keyword">&#955;</span> (x) (&#22336; (&#22336; x)))))
   (&#27714; '(&#23450; &#25429;&#20043;&#39636;&#37096;
        (<span class="keyword">&#955;</span> (x) (&#22336; (&#22336; x)))))
   (&#27714; '(&#23450; &#21517;&#37096;
        (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x)))))
   (&#27714; '(&#23450; &#20540;&#37096;
        (<span class="keyword">&#955;</span> (x)
            (&#25511; [(&#31354;? (&#22336; (&#22336; x))) 0]
                [&#21542;&#21063; (&#23481; (&#22336; (&#22336; x)))]
                ))))
   (&#27714; '(&#23450; &#21839;&#31572;&#37832;&#37096;
        (<span class="keyword">&#955;</span> (x) (&#22336; x))))
   (&#27714; '(&#23450; &#21542;&#21063;?
        (<span class="keyword">&#955;</span> (x)
            (&#25511; [(&#21407;&#23376;? x) (&#31561;? x (&#24341; &#21542;&#21063;))]
                [&#21542;&#21063; #f]
                ))))
   (&#27714; '(&#23450; &#21839;&#37096;
        (<span class="keyword">&#955;</span> (x) (&#23481; x))))
   (&#27714; '(&#23450; &#31572;&#37096;
        (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x)))))
   (&#27714; '(&#23450; &#20989;&#25976;&#37096;
        (<span class="keyword">&#955;</span> (x) (&#23481; x))))
   (&#27714; '(&#23450; &#21443;&#25976;&#37832;&#37096;
        (<span class="keyword">&#955;</span> (x) (&#22336; x))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-todo">&gt;&lt;</span><span class="org-level-2"> &#21152;&#36617; &#19968;</span>
   &#29234;&#20160;&#40636;&#38656;&#35201;&#25226;&#21443;&#25976;&#21015;&#34920;&#20043;&#24460;&#25165;&#33021;&#20316;&#20013;&#25991;&#35299;&#37323;&#22120;&#20013;&#30340;&#27714;&#20540;?
   &#24478;&#37679;&#35492;&#20449;&#24687;&#30475;&#20986;&#19968;&#38283;&#22987;&#23601;&#22312;&#20316;&#29992;(car x)
<span class="org-meta-line">   #+name: &#22312;&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;&#20013;&#21152;&#36617;&#33258;&#36523;&#31532;&#19968;&#23652;</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;</span>
     (<span class="keyword">lambda</span> (x)
       ((&#27714; '&#27714;) (list x))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#31354;&#34920;
         (<span class="keyword">&#955;</span> (&#21517;)
           (&#22833;&#25943;
            (&#37832; (&#24341; &#28961;&#20540;&#20043;&#21517;)
                (&#37832; &#21517; (&#24341; ())))))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#32317;&#34920; &#31354;&#34920;))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#26597;
         (<span class="keyword">&#955;</span> (&#34920; &#21517;)
           (&#34920; &#21517;))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#25844;&#23637;
         (<span class="keyword">&#955;</span> (&#21517;1 &#20540; &#34920;)
           (<span class="keyword">&#955;</span> (&#21517;2)
             (&#25511; [(&#31561;? &#21517;1 &#21517;2) &#20540;]
                 [&#21542;&#21063; (&#34920; &#21517;2)])))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#22833;&#25943;))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#27714;
         (<span class="keyword">&#955;</span> (e)
           (&#25429; &#32066;
               (&#32622;! &#22833;&#25943; &#32066;)
               (&#25511; [(&#23450;? e) (*&#23450; e)]
                   [&#21542;&#21063; (&#20854;&#24847; e)])))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#20854;&#24847;
         (<span class="keyword">&#955;</span> (e)
           (&#24847; e &#26597;&#32317;&#34920;))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#24847;
         (<span class="keyword">&#955;</span> (e &#34920;)
           ((&#24335;&#20043;&#20316;&#29992; e) e &#34920;))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#26597;&#32317;&#34920;
         (<span class="keyword">&#955;</span> (&#21517;)
           (&#26597; &#32317;&#34920; &#21517;))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#24335;&#20043;&#20316;&#29992;
         (<span class="keyword">&#955;</span> (e)
           (&#25511; [(&#21407;&#23376;? e) (&#21407;&#23376;&#20043;&#20316;&#29992; e)]
               [&#21542;&#21063; (&#37832;&#20043;&#20316;&#29992; e)]))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#21407;&#23376;&#20043;&#20316;&#29992;
         (<span class="keyword">&#955;</span> (e)
           (&#25511; [(&#25976;? e) *&#24120;&#20803;]
               [(&#31561;? e #t) *&#24120;&#20803;]
               [(&#31561;? e #f) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#37832;)) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#23481;)) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#22336;)) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#31354;?)) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#31561;?)) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#21407;&#23376;?)) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#38646;?)) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#22686;&#19968;)) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#28187;&#19968;)) *&#24120;&#20803;]
               [(&#31561;? e (&#24341; &#25976;?)) *&#24120;&#20803;]
               [&#21542;&#21063; *&#35722;&#20803;]))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#37832;&#20043;&#20316;&#29992;
         (<span class="keyword">&#955;</span> (e)
           (&#25511; [(&#31354;? e) *&#31354;]
               [(&#21407;&#23376;? (&#23481; e))
                (&#25511; [(&#31561;? (&#23481; e) (&#24341; &#24341;))
                     ,*&#24341;]
                    [(&#31561;? (&#23481; e) (&#24341; &#955;))
                     ,*&#955;]
                    [(&#31561;? (&#23481; e) (&#24341; &#25429;))
                     ,*&#25429;]
                    [(&#31561;? (&#23481; e) (&#24341; &#32622;!))
                     ,*&#32622;]
                    [(&#31561;? (&#23481; e) (&#24341; &#25511;))
                     ,*&#25511;]
                    [&#21542;&#21063; *&#20316;&#29992;])]
               [&#21542;&#21063; *&#20316;&#29992;]))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#23450;?
         (<span class="keyword">&#955;</span> (e)
           (&#25511; [(&#21407;&#23376;? e) #f]
               [(&#21407;&#23376;? (&#23481; e))
                (&#31561;? (&#23481; e) (&#24341; &#23450;))]
               [&#21542;&#21063; #f]))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; *&#23450;
         (<span class="keyword">&#955;</span> (e)
           (&#32622;! &#32317;&#34920;
                (&#25844;&#23637; (&#21517;&#37096; e)
                      (&#30418; (&#20854;&#24847;
                           (&#20540;&#37096; e)))
                      &#32317;&#34920;)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#30418;
         (<span class="keyword">&#955;</span> (&#29289;)
           (<span class="keyword">&#955;</span> (&#36984;&#25799;&#23376;)
             (&#36984;&#25799;&#23376; &#29289;
                     (<span class="keyword">&#955;</span> (&#26032;&#29289;) (&#32622;! &#29289; &#26032;&#29289;)))))))
   <span class="comment-delimiter">;; </span><span class="comment">&#19979;&#38754;&#26159;&#20841;&#20491;&#36984;&#25799;&#23376;
</span>   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#37325;&#32622;&#30418;
         (<span class="keyword">&#955;</span> (&#30418; &#26032;&#29289;)
           (&#30418; (<span class="keyword">&#955;</span> (&#20043;&#29289; &#20043;&#32622;) (&#20043;&#32622; &#26032;&#29289;))))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#21462;&#26044;&#30418;
         (<span class="keyword">&#955;</span> (&#30418;)
           (&#30418; (<span class="keyword">&#955;</span> (&#20043;&#29289; &#20043;&#32622;) &#20043;&#29289;)))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; *&#31354;
         (<span class="keyword">&#955;</span> (e &#34920;)
           (&#24341; ()))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; *&#24341;
         (<span class="keyword">&#955;</span> (e &#34920;)
           (&#25991;&#37096; e))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; *&#35722;&#20803;
         (<span class="keyword">&#955;</span> (e &#34920;)
           (&#21462;&#26044;&#30418; (&#26597; &#34920; e)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; *&#32622;
         (<span class="keyword">&#955;</span> (e &#34920;)
           (&#37325;&#32622;&#30418; (&#26597; &#34920; (&#21517;&#37096; e))
                   (&#24847; (&#20540;&#37096; e) &#34920;)))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; *&#955;
         (<span class="keyword">&#955;</span> (e &#34920;)
           (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
             (&#27714;&#26044;&#39636; (&#39636;&#37096; e)
                     (&#22810;&#25844;&#23637; (&#24418;&#21443;&#37096; e)
                             (&#22810;&#30418; &#23526;&#21443;&#37832;)
                             &#34920;))))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#27714;&#26044;&#39636;
         (<span class="keyword">&#955;</span> (&#24335;&#37832; &#34920;)
           (&#25511; [(&#31354;? (&#22336; &#24335;&#37832;))
                (&#24847; (&#23481; &#24335;&#37832;) &#34920;)]
               [&#21542;&#21063;
                ((<span class="keyword">&#955;</span> (&#36070;&#21443;)
                   (&#27714;&#26044;&#39636; (&#22336; &#24335;&#37832;) &#34920;))
                 (&#24847; (&#23481; &#24335;&#37832;) &#34920;))]))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#22810;&#30418;
         (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
           (&#25511; [(&#31354;? &#23526;&#21443;&#37832;) (&#24341; ())]
               [&#21542;&#21063;
                (&#37832; (&#30418; (&#23481; &#23526;&#21443;&#37832;))
                    (&#22810;&#30418; (&#22336; &#23526;&#21443;&#37832;)))]))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#22810;&#25844;&#23637;
         (<span class="keyword">&#955;</span> (&#21517;&#37832; &#20540;&#37832; &#34920;)
           (&#25511; [(&#31354;? &#21517;&#37832;) &#34920;]
               [&#21542;&#21063;
                (&#25844;&#23637; (&#23481; &#21517;&#37832;)
                      (&#23481; &#20540;&#37832;)
                      (&#22810;&#25844;&#23637; (&#22336; &#21517;&#37832;)
                              (&#22336; &#20540;&#37832;)
                              &#34920;))]))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; *&#20316;&#29992;
         (<span class="keyword">&#955;</span> (e &#34920;)
           ((&#24847; (&#20989;&#25976;&#37096; e) &#34920;)
            (&#27714;&#26044;&#37832; (&#21443;&#25976;&#37832;&#37096; e) &#34920;)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#27714;&#26044;&#37832;
         (<span class="keyword">&#955;</span> (&#24335;&#37832; &#34920;)
           (&#25511; [(&#31354;? &#24335;&#37832;) (&#24341; ())]
               [&#21542;&#21063;
                ((<span class="keyword">&#955;</span> (&#36070;&#21443;)
                   (&#37832; &#36070;&#21443;
                       (&#27714;&#26044;&#37832; (&#22336; &#24335;&#37832;) &#34920;)))
                 (&#24847; (&#23481; &#24335;&#37832;) &#34920;))]
               ))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#28310;&#20633;&#19968;&#20803;&#20989;&#25976;
         (<span class="keyword">&#955;</span> (&#19968;&#20803;&#20989;&#25976;)
           (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
             (&#19968;&#20803;&#20989;&#25976; (&#23481; &#23526;&#21443;&#37832;))))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#28310;&#20633;&#20108;&#20803;&#20989;&#25976;
         (<span class="keyword">&#955;</span> (&#20108;&#20803;&#20989;&#25976;)
           (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
             (&#20108;&#20803;&#20989;&#25976; (&#23481; &#23526;&#21443;&#37832;)
                       (&#23481; (&#22336; &#23526;&#21443;&#37832;)))))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; *&#24120;&#20803;
         ((<span class="keyword">&#955;</span> (<span class="builtin">:&#37832;</span> <span class="builtin">:&#23481;</span> <span class="builtin">:&#22336;</span>
                   <span class="builtin">:&#31354;?</span> <span class="builtin">:&#31561;?</span> <span class="builtin">:&#21407;&#23376;?</span>
                   <span class="builtin">:&#38646;?</span> <span class="builtin">:&#22686;&#19968;</span> <span class="builtin">:&#28187;&#19968;</span> <span class="builtin">:&#25976;?</span>)
            (<span class="keyword">&#955;</span> (e &#34920;)
              (&#25511; [(&#25976;? e) e]
                  [(&#31561;? e #t) #t]
                  [(&#31561;? e #f) #f]
                  [(&#31561;? e (&#24341; &#37832;)) <span class="builtin">:&#37832;</span>]
                  [(&#31561;? e (&#24341; &#23481;)) <span class="builtin">:&#23481;</span>]
                  [(&#31561;? e (&#24341; &#22336;)) <span class="builtin">:&#22336;</span>]
                  [(&#31561;? e (&#24341; &#31354;?)) <span class="builtin">:&#31354;?</span>]
                  [(&#31561;? e (&#24341; &#31561;?)) <span class="builtin">:&#31561;?</span>]
                  [(&#31561;? e (&#24341; &#21407;&#23376;?)) <span class="builtin">:&#21407;&#23376;?</span>]
                  [(&#31561;? e (&#24341; &#38646;?)) <span class="builtin">:&#38646;?</span>]
                  [(&#31561;? e (&#24341; &#22686;&#19968;)) <span class="builtin">:&#22686;&#19968;</span>]
                  [(&#31561;? e (&#24341; &#28187;&#19968;)) <span class="builtin">:&#28187;&#19968;</span>]
                  [(&#31561;? e (&#24341; &#25976;?)) <span class="builtin">:&#25976;?</span>]
                  )))
          (&#28310;&#20633;&#20108;&#20803;&#20989;&#25976; &#37832;)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#23481;)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#22336;)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#31354;?)
          (&#28310;&#20633;&#20108;&#20803;&#20989;&#25976; &#31561;?)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#21407;&#23376;?)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#38646;?)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#22686;&#19968;)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#28187;&#19968;)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#25976;?)
          )))

   <span class="comment-delimiter">;; </span><span class="comment">&#29992;&#955;&#23526;&#29694;&#37832; &#24456;&#23481;&#26131;&#36890;&#36942;&#22686;&#21152;&#37832;&#20013;&#34987;&#36984;&#20043;&#29289; &#20358;&#25913;&#35722;&#37832;&#30340;&#32080;&#27083;
</span>   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#21021;&#37832;
         (<span class="keyword">&#955;</span> (&#23481;)
           ((<span class="keyword">&#955;</span> (&#36070;&#22336;)
              (<span class="keyword">&#955;</span> (&#36984;&#25799;&#23376;)
                (&#36984;&#25799;&#23376; (<span class="keyword">&#955;</span> (x) (&#32622;! &#36070;&#22336; x))
                        &#23481;
                        &#36070;&#22336;)))
            (&#24341; ())))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#37832;
         (<span class="keyword">&#955;</span> (&#23481; &#22336;)
           ((<span class="keyword">&#955;</span> (&#36070;&#37832;)
              (&#32622;&#22336; &#36070;&#37832; &#22336;)
              &#36070;&#37832;)
            (&#21021;&#37832; &#23481;)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#32622;&#22336;
         (<span class="keyword">&#955;</span> (&#37832; &#26032;&#22336;)
           ((&#37832; (<span class="keyword">&#955;</span> (&#20043;&#32622; &#20043;&#23481; &#20043;&#22336;) &#20043;&#32622;))
            &#26032;&#22336;))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#23481;
         (<span class="keyword">&#955;</span> (&#37832;)
           (&#37832; (<span class="keyword">&#955;</span> (&#20043;&#32622; &#20043;&#23481; &#20043;&#22336;) &#20043;&#23481;)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#22336;
         (<span class="keyword">&#955;</span> (&#37832;)
           (&#37832; (<span class="keyword">&#955;</span> (&#20043;&#32622; &#20043;&#23481; &#20043;&#22336;) &#20043;&#22336;)))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; *&#25511;
         (<span class="keyword">&#955;</span> (e &#34920;)
           (&#27714;&#26044;&#25511; (&#21839;&#31572;&#37832;&#37096; e) &#34920;))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#27714;&#26044;&#25511;
         (<span class="keyword">&#955;</span> (&#21839;&#31572;&#37832; &#34920;)
           (&#25511; [(&#21542;&#21063;? (&#21839;&#37096; (&#23481; &#21839;&#31572;&#37832;)))
                (&#24847; (&#31572;&#37096; (&#23481; &#21839;&#31572;&#37832;)) &#34920;)]
               [(&#24847; (&#21839;&#37096; (&#23481; &#21839;&#31572;&#37832;)) &#34920;)
                (&#24847; (&#31572;&#37096; (&#23481; &#21839;&#31572;&#37832;)) &#34920;)]
               [&#21542;&#21063; (&#27714;&#26044;&#25511; (&#22336; &#21839;&#31572;&#37832;) &#34920;)]
               ))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; *&#25429;
         (<span class="keyword">&#955;</span> (e &#34920;)
           (&#25429; &#25429;&#20043;&#27161;
               (&#27714;&#26044;&#39636; (&#25429;&#20043;&#39636;&#37096; e)
                       (&#25844;&#23637; (&#21517;&#37096; e)
                             (&#30418; (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#25429;&#20043;&#27161;))
                             &#34920;))))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#25991;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#24418;&#21443;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#39636;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#22336; (&#22336; x)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#25429;&#20043;&#39636;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#22336; (&#22336; x)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#21517;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#20540;&#37096;
         (<span class="keyword">&#955;</span> (x)
           (&#25511; [(&#31354;? (&#22336; (&#22336; x))) 0]
               [&#21542;&#21063; (&#23481; (&#22336; (&#22336; x)))]
               ))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#21839;&#31572;&#37832;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#22336; x))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#21542;&#21063;?
         (<span class="keyword">&#955;</span> (x)
           (&#25511; [(&#21407;&#23376;? x) (&#31561;? x (&#24341; &#21542;&#21063;))]
               [&#21542;&#21063; #f]
               ))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#21839;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#23481; x))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#31572;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#20989;&#25976;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#23481; x))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;
    '(&#23450; &#21443;&#25976;&#37832;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#22336; x))))

<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** &#21152;&#36617; &#20108;</span>
   &#29234;&#20160;&#40636;&#27599;&#22686;&#21152;&#19968;&#23652;&#37117;&#35201;&#32102;&#21443;&#25976;&#22686;&#21152;&#19968;&#27425;list
<span class="org-meta-line">   #+name: &#22312;&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;&#20013;&#21152;&#36617;&#33258;&#36523;&#31532;&#20108;&#23652;</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;</span>
     (<span class="keyword">lambda</span> (x)
       ((&#20013;&#25991;&#35299;&#37323;&#22120;&#19968; '&#27714;) (list (list x)))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#31354;&#34920;
         (<span class="keyword">&#955;</span> (&#21517;)
             (&#22833;&#25943;
              (&#37832; (&#24341; &#28961;&#20540;&#20043;&#21517;)
                  (&#37832; &#21517; (&#24341; ())))))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#31354;&#34920;
         (<span class="keyword">&#955;</span> (&#21517;)
             (&#22833;&#25943;
              (&#37832; (&#24341; &#28961;&#20540;&#20043;&#21517;)
                  (&#37832; &#21517; (&#24341; ())))))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#32317;&#34920; &#31354;&#34920;))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#26597;
         (<span class="keyword">&#955;</span> (&#34920; &#21517;)
             (&#34920; &#21517;))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#25844;&#23637;
         (<span class="keyword">&#955;</span> (&#21517;1 &#20540; &#34920;)
             (<span class="keyword">&#955;</span> (&#21517;2)
                 (&#25511; [(&#31561;? &#21517;1 &#21517;2) &#20540;]
                     [&#21542;&#21063; (&#34920; &#21517;2)])))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#22833;&#25943;))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#27714;
         (<span class="keyword">&#955;</span> (e)
             (&#25429; &#32066;
                 (&#32622;! &#22833;&#25943; &#32066;)
                 (&#25511; [(&#23450;? e) (*&#23450; e)]
                     [&#21542;&#21063; (&#20854;&#24847; e)])))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#20854;&#24847;
         (<span class="keyword">&#955;</span> (e)
             (&#24847; e &#26597;&#32317;&#34920;))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#24847;
         (<span class="keyword">&#955;</span> (e &#34920;)
             ((&#24335;&#20043;&#20316;&#29992; e) e &#34920;))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#26597;&#32317;&#34920;
         (<span class="keyword">&#955;</span> (&#21517;)
             (&#26597; &#32317;&#34920; &#21517;))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#24335;&#20043;&#20316;&#29992;
         (<span class="keyword">&#955;</span> (e)
             (&#25511; [(&#21407;&#23376;? e) (&#21407;&#23376;&#20043;&#20316;&#29992; e)]
                 [&#21542;&#21063; (&#37832;&#20043;&#20316;&#29992; e)]))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#21407;&#23376;&#20043;&#20316;&#29992;
         (<span class="keyword">&#955;</span> (e)
             (&#25511; [(&#25976;? e) *&#24120;&#20803;]
                 [(&#31561;? e #t) *&#24120;&#20803;]
                 [(&#31561;? e #f) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#37832;)) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#23481;)) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#22336;)) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#31354;?)) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#31561;?)) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#21407;&#23376;?)) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#38646;?)) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#22686;&#19968;)) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#28187;&#19968;)) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#25976;?)) *&#24120;&#20803;]
                 [&#21542;&#21063; *&#35722;&#20803;]))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#37832;&#20043;&#20316;&#29992;
         (<span class="keyword">&#955;</span> (e)
             (&#25511; [(&#31354;? e) *&#31354;]
                 [(&#21407;&#23376;? (&#23481; e))
                  (&#25511; [(&#31561;? (&#23481; e) (&#24341; &#24341;))
                       ,*&#24341;]
                      [(&#31561;? (&#23481; e) (&#24341; &#955;))
                       ,*&#955;]
                      [(&#31561;? (&#23481; e) (&#24341; &#25429;))
                       ,*&#25429;]
                      [(&#31561;? (&#23481; e) (&#24341; &#32622;!))
                       ,*&#32622;]
                      [(&#31561;? (&#23481; e) (&#24341; &#25511;))
                       ,*&#25511;]
                      [&#21542;&#21063; *&#20316;&#29992;])]
                 [&#21542;&#21063; *&#20316;&#29992;]))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#23450;?
         (<span class="keyword">&#955;</span> (e)
             (&#25511; [(&#21407;&#23376;? e) #f]
                 [(&#21407;&#23376;? (&#23481; e))
                  (&#31561;? (&#23481; e) (&#24341; &#23450;))]
                 [&#21542;&#21063; #f]))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; *&#23450;
         (<span class="keyword">&#955;</span> (e)
             (&#32622;! &#32317;&#34920;
                  (&#25844;&#23637; (&#21517;&#37096; e)
                        (&#30418; (&#20854;&#24847;
                             (&#20540;&#37096; e)))
                        &#32317;&#34920;)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#30418;
         (<span class="keyword">&#955;</span> (&#29289;)
             (<span class="keyword">&#955;</span> (&#36984;&#25799;&#23376;)
                 (&#36984;&#25799;&#23376; &#29289;
                         (<span class="keyword">&#955;</span> (&#26032;&#29289;) (&#32622;! &#29289; &#26032;&#29289;)))))))
   <span class="comment-delimiter">;; </span><span class="comment">&#19979;&#38754;&#26159;&#20841;&#20491;&#36984;&#25799;&#23376;
</span>   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#37325;&#32622;&#30418;
         (<span class="keyword">&#955;</span> (&#30418; &#26032;&#29289;)
             (&#30418; (<span class="keyword">&#955;</span> (&#20043;&#29289; &#20043;&#32622;) (&#20043;&#32622; &#26032;&#29289;))))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#21462;&#26044;&#30418;
         (<span class="keyword">&#955;</span> (&#30418;)
             (&#30418; (<span class="keyword">&#955;</span> (&#20043;&#29289; &#20043;&#32622;) &#20043;&#29289;)))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; *&#31354;
         (<span class="keyword">&#955;</span> (e &#34920;)
             (&#24341; ()))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; *&#24341;
         (<span class="keyword">&#955;</span> (e &#34920;)
             (&#25991;&#37096; e))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; *&#35722;&#20803;
         (<span class="keyword">&#955;</span> (e &#34920;)
             (&#21462;&#26044;&#30418; (&#26597; &#34920; e)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; *&#32622;
         (<span class="keyword">&#955;</span> (e &#34920;)
             (&#37325;&#32622;&#30418; (&#26597; &#34920; (&#21517;&#37096; e))
                     (&#24847; (&#20540;&#37096; e) &#34920;)))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; *&#955;
         (<span class="keyword">&#955;</span> (e &#34920;)
             (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
                 (&#27714;&#26044;&#39636; (&#39636;&#37096; e)
                         (&#22810;&#25844;&#23637; (&#24418;&#21443;&#37096; e)
                                 (&#22810;&#30418; &#23526;&#21443;&#37832;)
                                 &#34920;))))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#27714;&#26044;&#39636;
         (<span class="keyword">&#955;</span> (&#24335;&#37832; &#34920;)
             (&#25511; [(&#31354;? (&#22336; &#24335;&#37832;))
                  (&#24847; (&#23481; &#24335;&#37832;) &#34920;)]
                 [&#21542;&#21063;
                  ((<span class="keyword">&#955;</span> (&#36070;&#21443;)
                       (&#27714;&#26044;&#39636; (&#22336; &#24335;&#37832;) &#34920;))
                   (&#24847; (&#23481; &#24335;&#37832;) &#34920;))]))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#22810;&#30418;
         (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
             (&#25511; [(&#31354;? &#23526;&#21443;&#37832;) (&#24341; ())]
                 [&#21542;&#21063;
                  (&#37832; (&#30418; (&#23481; &#23526;&#21443;&#37832;))
                      (&#22810;&#30418; (&#22336; &#23526;&#21443;&#37832;)))]))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#22810;&#25844;&#23637;
         (<span class="keyword">&#955;</span> (&#21517;&#37832; &#20540;&#37832; &#34920;)
             (&#25511; [(&#31354;? &#21517;&#37832;) &#34920;]
                 [&#21542;&#21063;
                  (&#25844;&#23637; (&#23481; &#21517;&#37832;)
                        (&#23481; &#20540;&#37832;)
                        (&#22810;&#25844;&#23637; (&#22336; &#21517;&#37832;)
                                (&#22336; &#20540;&#37832;)
                                &#34920;))]))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; *&#20316;&#29992;
         (<span class="keyword">&#955;</span> (e &#34920;)
             ((&#24847; (&#20989;&#25976;&#37096; e) &#34920;)
              (&#27714;&#26044;&#37832; (&#21443;&#25976;&#37832;&#37096; e) &#34920;)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#27714;&#26044;&#37832;
         (<span class="keyword">&#955;</span> (&#24335;&#37832; &#34920;)
             (&#25511; [(&#31354;? &#24335;&#37832;) (&#24341; ())]
                 [&#21542;&#21063;
                  ((<span class="keyword">&#955;</span> (&#36070;&#21443;)
                       (&#37832; &#36070;&#21443;
                           (&#27714;&#26044;&#37832; (&#22336; &#24335;&#37832;) &#34920;)))
                   (&#24847; (&#23481; &#24335;&#37832;) &#34920;))]
                 ))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#28310;&#20633;&#19968;&#20803;&#20989;&#25976;
         (<span class="keyword">&#955;</span> (&#19968;&#20803;&#20989;&#25976;)
             (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
                 (&#19968;&#20803;&#20989;&#25976; (&#23481; &#23526;&#21443;&#37832;))))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#28310;&#20633;&#20108;&#20803;&#20989;&#25976;
         (<span class="keyword">&#955;</span> (&#20108;&#20803;&#20989;&#25976;)
             (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
                 (&#20108;&#20803;&#20989;&#25976; (&#23481; &#23526;&#21443;&#37832;)
                           (&#23481; (&#22336; &#23526;&#21443;&#37832;)))))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; *&#24120;&#20803;
         ((<span class="keyword">&#955;</span> (<span class="builtin">:&#37832;</span> <span class="builtin">:&#23481;</span> <span class="builtin">:&#22336;</span>
                   <span class="builtin">:&#31354;?</span> <span class="builtin">:&#31561;?</span> <span class="builtin">:&#21407;&#23376;?</span>
                   <span class="builtin">:&#38646;?</span> <span class="builtin">:&#22686;&#19968;</span> <span class="builtin">:&#28187;&#19968;</span> <span class="builtin">:&#25976;?</span>)
              (<span class="keyword">&#955;</span> (e &#34920;)
                  (&#25511; [(&#25976;? e) e]
                      [(&#31561;? e #t) #t]
                      [(&#31561;? e #f) #f]
                      [(&#31561;? e (&#24341; &#37832;)) <span class="builtin">:&#37832;</span>]
                      [(&#31561;? e (&#24341; &#23481;)) <span class="builtin">:&#23481;</span>]
                      [(&#31561;? e (&#24341; &#22336;)) <span class="builtin">:&#22336;</span>]
                      [(&#31561;? e (&#24341; &#31354;?)) <span class="builtin">:&#31354;?</span>]
                      [(&#31561;? e (&#24341; &#31561;?)) <span class="builtin">:&#31561;?</span>]
                      [(&#31561;? e (&#24341; &#21407;&#23376;?)) <span class="builtin">:&#21407;&#23376;?</span>]
                      [(&#31561;? e (&#24341; &#38646;?)) <span class="builtin">:&#38646;?</span>]
                      [(&#31561;? e (&#24341; &#22686;&#19968;)) <span class="builtin">:&#22686;&#19968;</span>]
                      [(&#31561;? e (&#24341; &#28187;&#19968;)) <span class="builtin">:&#28187;&#19968;</span>]
                      [(&#31561;? e (&#24341; &#25976;?)) <span class="builtin">:&#25976;?</span>]
                      )))
          (&#28310;&#20633;&#20108;&#20803;&#20989;&#25976; &#37832;)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#23481;)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#22336;)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#31354;?)
          (&#28310;&#20633;&#20108;&#20803;&#20989;&#25976; &#31561;?)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#21407;&#23376;?)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#38646;?)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#22686;&#19968;)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#28187;&#19968;)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#25976;?)
          )))

   <span class="comment-delimiter">;; </span><span class="comment">&#29992;&#955;&#23526;&#29694;&#37832; &#24456;&#23481;&#26131;&#36890;&#36942;&#22686;&#21152;&#37832;&#20013;&#34987;&#36984;&#20043;&#29289; &#20358;&#25913;&#35722;&#37832;&#30340;&#32080;&#27083;
</span>   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#21021;&#37832;
         (<span class="keyword">&#955;</span> (&#23481;)
             ((<span class="keyword">&#955;</span> (&#36070;&#22336;)
                  (<span class="keyword">&#955;</span> (&#36984;&#25799;&#23376;)
                      (&#36984;&#25799;&#23376; (<span class="keyword">&#955;</span> (x) (&#32622;! &#36070;&#22336; x))
                              &#23481;
                              &#36070;&#22336;)))
              (&#24341; ())))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#37832;
         (<span class="keyword">&#955;</span> (&#23481; &#22336;)
             ((<span class="keyword">&#955;</span> (&#36070;&#37832;)
                  (&#32622;&#22336; &#36070;&#37832; &#22336;)
                  &#36070;&#37832;)
              (&#21021;&#37832; &#23481;)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#32622;&#22336;
         (<span class="keyword">&#955;</span> (&#37832; &#26032;&#22336;)
             ((&#37832; (<span class="keyword">&#955;</span> (&#20043;&#32622; &#20043;&#23481; &#20043;&#22336;) &#20043;&#32622;))
              &#26032;&#22336;))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#23481;
         (<span class="keyword">&#955;</span> (&#37832;)
             (&#37832; (<span class="keyword">&#955;</span> (&#20043;&#32622; &#20043;&#23481; &#20043;&#22336;) &#20043;&#23481;)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#22336;
         (<span class="keyword">&#955;</span> (&#37832;)
             (&#37832; (<span class="keyword">&#955;</span> (&#20043;&#32622; &#20043;&#23481; &#20043;&#22336;) &#20043;&#22336;)))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; *&#25511;
         (<span class="keyword">&#955;</span> (e &#34920;)
             (&#27714;&#26044;&#25511; (&#21839;&#31572;&#37832;&#37096; e) &#34920;))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#27714;&#26044;&#25511;
         (<span class="keyword">&#955;</span> (&#21839;&#31572;&#37832; &#34920;)
             (&#25511; [(&#21542;&#21063;? (&#21839;&#37096; (&#23481; &#21839;&#31572;&#37832;)))
                  (&#24847; (&#31572;&#37096; (&#23481; &#21839;&#31572;&#37832;)) &#34920;)]
                 [(&#24847; (&#21839;&#37096; (&#23481; &#21839;&#31572;&#37832;)) &#34920;)
                  (&#24847; (&#31572;&#37096; (&#23481; &#21839;&#31572;&#37832;)) &#34920;)]
                 [&#21542;&#21063; (&#27714;&#26044;&#25511; (&#22336; &#21839;&#31572;&#37832;) &#34920;)]
                 ))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; *&#25429;
         (<span class="keyword">&#955;</span> (e &#34920;)
             (&#25429; &#25429;&#20043;&#27161;
                 (&#27714;&#26044;&#39636; (&#25429;&#20043;&#39636;&#37096; e)
                         (&#25844;&#23637; (&#21517;&#37096; e)
                               (&#30418; (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#25429;&#20043;&#27161;))
                               &#34920;))))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#25991;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#24418;&#21443;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#39636;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#22336; (&#22336; x)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#25429;&#20043;&#39636;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#22336; (&#22336; x)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#21517;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#20540;&#37096;
         (<span class="keyword">&#955;</span> (x)
             (&#25511; [(&#31354;? (&#22336; (&#22336; x))) 0]
                 [&#21542;&#21063; (&#23481; (&#22336; (&#22336; x)))]
                 ))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#21839;&#31572;&#37832;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#22336; x))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#21542;&#21063;?
         (<span class="keyword">&#955;</span> (x)
             (&#25511; [(&#21407;&#23376;? x) (&#31561;? x (&#24341; &#21542;&#21063;))]
                 [&#21542;&#21063; #f]
                 ))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#21839;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#23481; x))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#31572;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#20989;&#25976;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#23481; x))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#20108;
    '(&#23450; &#21443;&#25976;&#37832;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#22336; x))))
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** &#21152;&#36617; &#19977;</span>
   ikarus&#30340;&#36895;&#24230;&#24456;&#24555;
   &#20294;&#26159;``&#19977;''&#22312;&#25105;&#30340;&#27231;&#22120;&#19978;&#27492;&#26178;&#24050;&#32147;&#38656;&#35201;&#21313;&#31186;&#30340;&#26178;&#38291;&#20102;
<span class="org-meta-line">   #+name: &#22312;&#20013;&#25991;&#35299;&#37323;&#22120;&#19968;&#20013;&#21152;&#36617;&#33258;&#36523;&#31532;&#19977;&#23652;</span>
<span class="org-block-begin-line">   #+begin_src scheme
</span>   (<span class="keyword">define</span> <span class="function-name">&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;</span>
     (<span class="keyword">lambda</span> (x)
       ((&#20013;&#25991;&#35299;&#37323;&#22120;&#20108; '&#27714;) (list (list (list x))))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#31354;&#34920;
         (<span class="keyword">&#955;</span> (&#21517;)
             (&#22833;&#25943;
              (&#37832; (&#24341; &#28961;&#20540;&#20043;&#21517;)
                  (&#37832; &#21517; (&#24341; ())))))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#31354;&#34920;
         (<span class="keyword">&#955;</span> (&#21517;)
             (&#22833;&#25943;
              (&#37832; (&#24341; &#28961;&#20540;&#20043;&#21517;)
                  (&#37832; &#21517; (&#24341; ())))))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#32317;&#34920; &#31354;&#34920;))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#26597;
         (<span class="keyword">&#955;</span> (&#34920; &#21517;)
             (&#34920; &#21517;))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#25844;&#23637;
         (<span class="keyword">&#955;</span> (&#21517;1 &#20540; &#34920;)
             (<span class="keyword">&#955;</span> (&#21517;2)
                 (&#25511; [(&#31561;? &#21517;1 &#21517;2) &#20540;]
                     [&#21542;&#21063; (&#34920; &#21517;2)])))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#22833;&#25943;))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#27714;
         (<span class="keyword">&#955;</span> (e)
             (&#25429; &#32066;
                 (&#32622;! &#22833;&#25943; &#32066;)
                 (&#25511; [(&#23450;? e) (*&#23450; e)]
                     [&#21542;&#21063; (&#20854;&#24847; e)])))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#20854;&#24847;
         (<span class="keyword">&#955;</span> (e)
             (&#24847; e &#26597;&#32317;&#34920;))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#24847;
         (<span class="keyword">&#955;</span> (e &#34920;)
             ((&#24335;&#20043;&#20316;&#29992; e) e &#34920;))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#26597;&#32317;&#34920;
         (<span class="keyword">&#955;</span> (&#21517;)
             (&#26597; &#32317;&#34920; &#21517;))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#24335;&#20043;&#20316;&#29992;
         (<span class="keyword">&#955;</span> (e)
             (&#25511; [(&#21407;&#23376;? e) (&#21407;&#23376;&#20043;&#20316;&#29992; e)]
                 [&#21542;&#21063; (&#37832;&#20043;&#20316;&#29992; e)]))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#21407;&#23376;&#20043;&#20316;&#29992;
         (<span class="keyword">&#955;</span> (e)
             (&#25511; [(&#25976;? e) *&#24120;&#20803;]
                 [(&#31561;? e #t) *&#24120;&#20803;]
                 [(&#31561;? e #f) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#37832;)) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#23481;)) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#22336;)) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#31354;?)) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#31561;?)) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#21407;&#23376;?)) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#38646;?)) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#22686;&#19968;)) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#28187;&#19968;)) *&#24120;&#20803;]
                 [(&#31561;? e (&#24341; &#25976;?)) *&#24120;&#20803;]
                 [&#21542;&#21063; *&#35722;&#20803;]))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#37832;&#20043;&#20316;&#29992;
         (<span class="keyword">&#955;</span> (e)
             (&#25511; [(&#31354;? e) *&#31354;]
                 [(&#21407;&#23376;? (&#23481; e))
                  (&#25511; [(&#31561;? (&#23481; e) (&#24341; &#24341;))
                       ,*&#24341;]
                      [(&#31561;? (&#23481; e) (&#24341; &#955;))
                       ,*&#955;]
                      [(&#31561;? (&#23481; e) (&#24341; &#25429;))
                       ,*&#25429;]
                      [(&#31561;? (&#23481; e) (&#24341; &#32622;!))
                       ,*&#32622;]
                      [(&#31561;? (&#23481; e) (&#24341; &#25511;))
                       ,*&#25511;]
                      [&#21542;&#21063; *&#20316;&#29992;])]
                 [&#21542;&#21063; *&#20316;&#29992;]))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#23450;?
         (<span class="keyword">&#955;</span> (e)
             (&#25511; [(&#21407;&#23376;? e) #f]
                 [(&#21407;&#23376;? (&#23481; e))
                  (&#31561;? (&#23481; e) (&#24341; &#23450;))]
                 [&#21542;&#21063; #f]))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; *&#23450;
         (<span class="keyword">&#955;</span> (e)
             (&#32622;! &#32317;&#34920;
                  (&#25844;&#23637; (&#21517;&#37096; e)
                        (&#30418; (&#20854;&#24847;
                             (&#20540;&#37096; e)))
                        &#32317;&#34920;)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#30418;
         (<span class="keyword">&#955;</span> (&#29289;)
             (<span class="keyword">&#955;</span> (&#36984;&#25799;&#23376;)
                 (&#36984;&#25799;&#23376; &#29289;
                         (<span class="keyword">&#955;</span> (&#26032;&#29289;) (&#32622;! &#29289; &#26032;&#29289;)))))))
   <span class="comment-delimiter">;; </span><span class="comment">&#19979;&#38754;&#26159;&#20841;&#20491;&#36984;&#25799;&#23376;
</span>   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#37325;&#32622;&#30418;
         (<span class="keyword">&#955;</span> (&#30418; &#26032;&#29289;)
             (&#30418; (<span class="keyword">&#955;</span> (&#20043;&#29289; &#20043;&#32622;) (&#20043;&#32622; &#26032;&#29289;))))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#21462;&#26044;&#30418;
         (<span class="keyword">&#955;</span> (&#30418;)
             (&#30418; (<span class="keyword">&#955;</span> (&#20043;&#29289; &#20043;&#32622;) &#20043;&#29289;)))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; *&#31354;
         (<span class="keyword">&#955;</span> (e &#34920;)
             (&#24341; ()))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; *&#24341;
         (<span class="keyword">&#955;</span> (e &#34920;)
             (&#25991;&#37096; e))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; *&#35722;&#20803;
         (<span class="keyword">&#955;</span> (e &#34920;)
             (&#21462;&#26044;&#30418; (&#26597; &#34920; e)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; *&#32622;
         (<span class="keyword">&#955;</span> (e &#34920;)
             (&#37325;&#32622;&#30418; (&#26597; &#34920; (&#21517;&#37096; e))
                     (&#24847; (&#20540;&#37096; e) &#34920;)))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; *&#955;
         (<span class="keyword">&#955;</span> (e &#34920;)
             (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
                 (&#27714;&#26044;&#39636; (&#39636;&#37096; e)
                         (&#22810;&#25844;&#23637; (&#24418;&#21443;&#37096; e)
                                 (&#22810;&#30418; &#23526;&#21443;&#37832;)
                                 &#34920;))))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#27714;&#26044;&#39636;
         (<span class="keyword">&#955;</span> (&#24335;&#37832; &#34920;)
             (&#25511; [(&#31354;? (&#22336; &#24335;&#37832;))
                  (&#24847; (&#23481; &#24335;&#37832;) &#34920;)]
                 [&#21542;&#21063;
                  ((<span class="keyword">&#955;</span> (&#36070;&#21443;)
                       (&#27714;&#26044;&#39636; (&#22336; &#24335;&#37832;) &#34920;))
                   (&#24847; (&#23481; &#24335;&#37832;) &#34920;))]))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#22810;&#30418;
         (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
             (&#25511; [(&#31354;? &#23526;&#21443;&#37832;) (&#24341; ())]
                 [&#21542;&#21063;
                  (&#37832; (&#30418; (&#23481; &#23526;&#21443;&#37832;))
                      (&#22810;&#30418; (&#22336; &#23526;&#21443;&#37832;)))]))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#22810;&#25844;&#23637;
         (<span class="keyword">&#955;</span> (&#21517;&#37832; &#20540;&#37832; &#34920;)
             (&#25511; [(&#31354;? &#21517;&#37832;) &#34920;]
                 [&#21542;&#21063;
                  (&#25844;&#23637; (&#23481; &#21517;&#37832;)
                        (&#23481; &#20540;&#37832;)
                        (&#22810;&#25844;&#23637; (&#22336; &#21517;&#37832;)
                                (&#22336; &#20540;&#37832;)
                                &#34920;))]))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; *&#20316;&#29992;
         (<span class="keyword">&#955;</span> (e &#34920;)
             ((&#24847; (&#20989;&#25976;&#37096; e) &#34920;)
              (&#27714;&#26044;&#37832; (&#21443;&#25976;&#37832;&#37096; e) &#34920;)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#27714;&#26044;&#37832;
         (<span class="keyword">&#955;</span> (&#24335;&#37832; &#34920;)
             (&#25511; [(&#31354;? &#24335;&#37832;) (&#24341; ())]
                 [&#21542;&#21063;
                  ((<span class="keyword">&#955;</span> (&#36070;&#21443;)
                       (&#37832; &#36070;&#21443;
                           (&#27714;&#26044;&#37832; (&#22336; &#24335;&#37832;) &#34920;)))
                   (&#24847; (&#23481; &#24335;&#37832;) &#34920;))]
                 ))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#28310;&#20633;&#19968;&#20803;&#20989;&#25976;
         (<span class="keyword">&#955;</span> (&#19968;&#20803;&#20989;&#25976;)
             (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
                 (&#19968;&#20803;&#20989;&#25976; (&#23481; &#23526;&#21443;&#37832;))))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#28310;&#20633;&#20108;&#20803;&#20989;&#25976;
         (<span class="keyword">&#955;</span> (&#20108;&#20803;&#20989;&#25976;)
             (<span class="keyword">&#955;</span> (&#23526;&#21443;&#37832;)
                 (&#20108;&#20803;&#20989;&#25976; (&#23481; &#23526;&#21443;&#37832;)
                           (&#23481; (&#22336; &#23526;&#21443;&#37832;)))))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; *&#24120;&#20803;
         ((<span class="keyword">&#955;</span> (<span class="builtin">:&#37832;</span> <span class="builtin">:&#23481;</span> <span class="builtin">:&#22336;</span>
                   <span class="builtin">:&#31354;?</span> <span class="builtin">:&#31561;?</span> <span class="builtin">:&#21407;&#23376;?</span>
                   <span class="builtin">:&#38646;?</span> <span class="builtin">:&#22686;&#19968;</span> <span class="builtin">:&#28187;&#19968;</span> <span class="builtin">:&#25976;?</span>)
              (<span class="keyword">&#955;</span> (e &#34920;)
                  (&#25511; [(&#25976;? e) e]
                      [(&#31561;? e #t) #t]
                      [(&#31561;? e #f) #f]
                      [(&#31561;? e (&#24341; &#37832;)) <span class="builtin">:&#37832;</span>]
                      [(&#31561;? e (&#24341; &#23481;)) <span class="builtin">:&#23481;</span>]
                      [(&#31561;? e (&#24341; &#22336;)) <span class="builtin">:&#22336;</span>]
                      [(&#31561;? e (&#24341; &#31354;?)) <span class="builtin">:&#31354;?</span>]
                      [(&#31561;? e (&#24341; &#31561;?)) <span class="builtin">:&#31561;?</span>]
                      [(&#31561;? e (&#24341; &#21407;&#23376;?)) <span class="builtin">:&#21407;&#23376;?</span>]
                      [(&#31561;? e (&#24341; &#38646;?)) <span class="builtin">:&#38646;?</span>]
                      [(&#31561;? e (&#24341; &#22686;&#19968;)) <span class="builtin">:&#22686;&#19968;</span>]
                      [(&#31561;? e (&#24341; &#28187;&#19968;)) <span class="builtin">:&#28187;&#19968;</span>]
                      [(&#31561;? e (&#24341; &#25976;?)) <span class="builtin">:&#25976;?</span>]
                      )))
          (&#28310;&#20633;&#20108;&#20803;&#20989;&#25976; &#37832;)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#23481;)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#22336;)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#31354;?)
          (&#28310;&#20633;&#20108;&#20803;&#20989;&#25976; &#31561;?)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#21407;&#23376;?)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#38646;?)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#22686;&#19968;)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#28187;&#19968;)
          (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#25976;?)
          )))

   <span class="comment-delimiter">;; </span><span class="comment">&#29992;&#955;&#23526;&#29694;&#37832; &#24456;&#23481;&#26131;&#36890;&#36942;&#22686;&#21152;&#37832;&#20013;&#34987;&#36984;&#20043;&#29289; &#20358;&#25913;&#35722;&#37832;&#30340;&#32080;&#27083;
</span>   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#21021;&#37832;
         (<span class="keyword">&#955;</span> (&#23481;)
             ((<span class="keyword">&#955;</span> (&#36070;&#22336;)
                  (<span class="keyword">&#955;</span> (&#36984;&#25799;&#23376;)
                      (&#36984;&#25799;&#23376; (<span class="keyword">&#955;</span> (x) (&#32622;! &#36070;&#22336; x))
                              &#23481;
                              &#36070;&#22336;)))
              (&#24341; ())))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#37832;
         (<span class="keyword">&#955;</span> (&#23481; &#22336;)
             ((<span class="keyword">&#955;</span> (&#36070;&#37832;)
                  (&#32622;&#22336; &#36070;&#37832; &#22336;)
                  &#36070;&#37832;)
              (&#21021;&#37832; &#23481;)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#32622;&#22336;
         (<span class="keyword">&#955;</span> (&#37832; &#26032;&#22336;)
             ((&#37832; (<span class="keyword">&#955;</span> (&#20043;&#32622; &#20043;&#23481; &#20043;&#22336;) &#20043;&#32622;))
              &#26032;&#22336;))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#23481;
         (<span class="keyword">&#955;</span> (&#37832;)
             (&#37832; (<span class="keyword">&#955;</span> (&#20043;&#32622; &#20043;&#23481; &#20043;&#22336;) &#20043;&#23481;)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#22336;
         (<span class="keyword">&#955;</span> (&#37832;)
             (&#37832; (<span class="keyword">&#955;</span> (&#20043;&#32622; &#20043;&#23481; &#20043;&#22336;) &#20043;&#22336;)))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; *&#25511;
         (<span class="keyword">&#955;</span> (e &#34920;)
             (&#27714;&#26044;&#25511; (&#21839;&#31572;&#37832;&#37096; e) &#34920;))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#27714;&#26044;&#25511;
         (<span class="keyword">&#955;</span> (&#21839;&#31572;&#37832; &#34920;)
             (&#25511; [(&#21542;&#21063;? (&#21839;&#37096; (&#23481; &#21839;&#31572;&#37832;)))
                  (&#24847; (&#31572;&#37096; (&#23481; &#21839;&#31572;&#37832;)) &#34920;)]
                 [(&#24847; (&#21839;&#37096; (&#23481; &#21839;&#31572;&#37832;)) &#34920;)
                  (&#24847; (&#31572;&#37096; (&#23481; &#21839;&#31572;&#37832;)) &#34920;)]
                 [&#21542;&#21063; (&#27714;&#26044;&#25511; (&#22336; &#21839;&#31572;&#37832;) &#34920;)]
                 ))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; *&#25429;
         (<span class="keyword">&#955;</span> (e &#34920;)
             (&#25429; &#25429;&#20043;&#27161;
                 (&#27714;&#26044;&#39636; (&#25429;&#20043;&#39636;&#37096; e)
                         (&#25844;&#23637; (&#21517;&#37096; e)
                               (&#30418; (&#28310;&#20633;&#19968;&#20803;&#20989;&#25976; &#25429;&#20043;&#27161;))
                               &#34920;))))))

   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#25991;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#24418;&#21443;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#39636;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#22336; (&#22336; x)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#25429;&#20043;&#39636;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#22336; (&#22336; x)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#21517;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#20540;&#37096;
         (<span class="keyword">&#955;</span> (x)
             (&#25511; [(&#31354;? (&#22336; (&#22336; x))) 0]
                 [&#21542;&#21063; (&#23481; (&#22336; (&#22336; x)))]
                 ))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#21839;&#31572;&#37832;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#22336; x))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#21542;&#21063;?
         (<span class="keyword">&#955;</span> (x)
             (&#25511; [(&#21407;&#23376;? x) (&#31561;? x (&#24341; &#21542;&#21063;))]
                 [&#21542;&#21063; #f]
                 ))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#21839;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#23481; x))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#31572;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#23481; (&#22336; x)))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#20989;&#25976;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#23481; x))))
   (&#20013;&#25991;&#35299;&#37323;&#22120;&#19977;
    '(&#23450; &#21443;&#25976;&#37832;&#37096;
         (<span class="keyword">&#955;</span> (x) (&#22336; x))))
<span class="org-block-end-line">   #+end_src
</span></pre>
  </body>
</html>
