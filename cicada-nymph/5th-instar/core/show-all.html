---
---
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
  <head>
    <title>core.org</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <style type="text/css">
    <!--
      body {
        color: #f8f8f0;
        background-color: #1b1d1e;
      }
      .bold {
        /* bold */
        font-weight: bold;
      }
      .cicada-nymph-bool {
        /* cicada-nymph-bool-face */
        color: #fd971f;
        font-weight: bold;
      }
      .cicada-nymph-comment {
        /* cicada-nymph-comment-face */
        color: #FF8888;
      }
      .cicada-nymph-end {
        /* cicada-nymph-end-face */
        color: #00ffff;
        font-weight: bold;
      }
      .cicada-nymph-fetch-local-variable-1 {
        /* cicada-nymph-fetch-local-variable-1-face */
        color: #83EA83;
        font-weight: bold;
      }
      .cicada-nymph-fetch-local-variable-2 {
        /* cicada-nymph-fetch-local-variable-2-face */
        color: #5CDD5C;
        font-weight: bold;
      }
      .cicada-nymph-lexicographer {
        /* cicada-nymph-lexicographer-face */
        color: #ae81ff;
        font-weight: bold;
      }
      .cicada-nymph-number {
        /* cicada-nymph-number-face */
        color: #fd971f;
        font-weight: bold;
      }
      .cicada-nymph-sentence-reader {
        /* cicada-nymph-sentence-reader-face */
        color: #ffff00;
        font-weight: bold;
      }
      .cicada-nymph-string {
        /* cicada-nymph-string-face */
        color: #e6db74;
      }
      .cicada-nymph-syntax-key-word {
        /* cicada-nymph-syntax-key-word-face */
        color: #f92672;
        font-weight: bold;
      }
      .cicada-nymph-variable {
        /* cicada-nymph-variable-face */
        color: #fd971f;
      }
      .cicada-nymph-word-to-define {
        /* cicada-nymph-word-to-define-face */
        color: #ef5939;
        font-weight: bold;
      }
      .org-block-begin-line {
        /* org-block-begin-line */
        color: #FF8888;
      }
      .org-block-end-line {
        /* org-block-end-line */
        color: #FF8888;
      }
      .org-document-info {
        /* org-document-info */
        color: #afeeee;
      }
      .org-document-info-keyword {
        /* org-document-info-keyword */
        color: #b3b3b3;
      }
      .org-document-title {
        /* org-document-title */
        color: #afeeee;
        font-weight: bold;
      }
      .org-done {
        /* org-done */
        color: #98fb98;
        font-weight: bold;
      }
      .org-level-1 {
        /* org-level-1 */
        color: #a6e22e;
      }
      .org-level-2 {
        /* org-level-2 */
        color: #fd971f;
      }
      .org-level-3 {
        /* org-level-3 */
        color: #f92672;
        font-weight: bold;
      }
      .org-table {
        /* org-table */
        color: #87cefa;
      }
      .org-todo {
        /* org-todo */
        color: #ffc0cb;
        font-weight: bold;
      }

      a {
        color: inherit;
        background-color: inherit;
        font: inherit;
        text-decoration: inherit;
      }
      a:hover {
        text-decoration: underline;
      }
    -->
    </style>
{% include in-org-head.html %}
  </head>
  <body>
    {% include before-pre.html %}
<pre>
<span class="org-document-info-keyword">#+TITLE:</span>  <span class="org-document-title">&#23567;&#34796;&#35486;&#26680; / core of cicada-nymph
</span><span class="org-document-info-keyword">#+AUTHOR:</span> <span class="org-document-info">&#35613;&#23431;&#24646; / XIE Yuheng
</span><span class="org-document-info-keyword">#+EMAIL:</span>  <span class="org-document-info">xyheme@gmail.com
</span>
<span class="org-level-1">* </span><span class="org-done">todo</span>
<span class="org-level-2">** use name-hash-table to implement local-variable-support</span>
<span class="org-level-2">** re-design the color of cicada-nymph-mode and re-write the emacs-lisp code</span>
<span class="org-level-2">** compare the improvement about syntax after local-variable is supported</span>
<span class="org-level-2">** name-hash-table</span>
   * better factoring
   * better naming
<span class="org-level-2">** little tester</span>
<span class="org-level-2">** title-name-table</span>
<span class="org-level-2">** data-giver</span>
<span class="org-level-2">** be able to switch REPL</span>
<span class="org-level-2">** syntax for exception handling in cicada-nymph</span>
<span class="org-level-2">** big number and &#21516;&#39192;&#26041;&#31243;</span>
   * &#29234;&#20102;&#29609; hash-table
<span class="org-level-1">* ===================================</span>
<span class="org-level-1">* </span><span class="org-todo">note</span>
<span class="org-level-2">** notation</span>
   * use ","
<span class="org-level-2">** data section in cicada-nymph</span>
<span class="org-level-2">** style</span>
   * to use global-variable more
     may will make code be better
     for stack operations are less
   * another way is to design good macro for operations
<span class="org-level-1">* -----------------------------------</span>
<span class="org-level-1">* misc</span>
<span class="org-block-begin-line">  #+begin_src cicada-nymph :tangle core.cn
</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">cr</span> <span class="cicada-nymph-comment">&lt;&lt; cr denotes carriage return &gt;&gt;</span>
    <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
    <span class="cicada-nymph-number">10</span> write-byte
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">  #+end_src
</span><span class="org-level-1">* -----------------------------------</span>
<span class="org-level-1">* if &amp; else &amp; then</span>
  * one predicate can make two branchs
    three predicates can make four branchs
    three predicates may only make three branchs
    but indeed there must be an invisible branch
<span class="org-block-begin-line">  #+begin_src cicada-nymph :tangle core.cn
</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-comment">&lt;&lt; string[address, length] --
       address, string[address, length] &gt;&gt;</span>
    <span class="cicada-nymph-variable">*false?branch*</span> save-into,jo-heap
    <span class="cicada-nymph-variable">*current-free-address,jo-heap*</span> xx|swap|x
    <span class="cicada-nymph-number">0</span> save-into,jo-heap
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-macro</span>

  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-syntax-key-word">else</span>
    <span class="cicada-nymph-comment">&lt;&lt; address, string[address, length] --
       address, string[address, length] &gt;&gt;</span>
    <span class="cicada-nymph-variable">*branch*</span> save-into,jo-heap
    x|swap|xx
    <span class="cicada-nymph-variable">*current-free-address,jo-heap*</span> xxx|swap|x
    <span class="cicada-nymph-number">0</span> save-into,jo-heap
    <span class="cicada-nymph-comment">&lt;&lt; address, string[address, length], address &gt;&gt;</span>
    <span class="cicada-nymph-variable">*current-free-address,jo-heap*</span>
    over sub <span class="cicada-nymph-variable">*jo-size*</span> div
    swap save
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-macro</span>

  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-syntax-key-word">then</span>
    <span class="cicada-nymph-comment">&lt;&lt; address, string[address, length] --
       string[address, length] &gt;&gt;</span>
    x|swap|xx
    <span class="cicada-nymph-variable">*current-free-address,jo-heap*</span>
    over sub <span class="cicada-nymph-variable">*jo-size*</span> div
    swap save
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-macro</span>
<span class="org-block-end-line">  #+end_src
</span><span class="org-level-1">* </span><span class="org-done">test</span>
<span class="org-block-begin-line">  #+begin_src cicada-nymph :tangle core.cn.test
</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">kkk</span>
    <span class="cicada-nymph-string">"kkk took my baby away !"</span> write-string
    cr
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">factorial</span>
    <span class="cicada-nymph-comment">&lt;&lt; number -- number &gt;&gt;</span>
    dup
    one? <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-syntax-key-word">then</span>
    dup sub1 factorial
    mul
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>


  cr
  <span class="cicada-nymph-number">1</span> factorial . cr
  <span class="cicada-nymph-number">2</span> factorial . cr
  <span class="cicada-nymph-number">3</span> factorial . cr
  <span class="cicada-nymph-number">4</span> factorial . cr
  <span class="cicada-nymph-number">5</span> factorial . cr
  <span class="cicada-nymph-number">6</span> factorial . cr
  <span class="cicada-nymph-number">7</span> factorial . cr
  <span class="cicada-nymph-number">8</span> factorial . cr
  <span class="cicada-nymph-number">9</span> factorial . cr
  <span class="cicada-nymph-number">10</span> factorial . cr
  <span class="cicada-nymph-number">11</span> factorial . cr
  <span class="cicada-nymph-number">12</span> factorial . cr
  <span class="cicada-nymph-number">13</span> factorial . cr
  <span class="cicada-nymph-number">14</span> factorial . cr
  <span class="cicada-nymph-number">15</span> factorial . cr
  <span class="cicada-nymph-number">16</span> factorial . cr
  <span class="cicada-nymph-number">17</span> factorial . cr
  <span class="cicada-nymph-number">18</span> factorial . cr
  <span class="cicada-nymph-number">19</span> factorial . cr
  <span class="cicada-nymph-number">20</span> factorial . cr


  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">.12</span>
    <span class="cicada-nymph-comment">&lt;&lt; 1 2 -- &gt;&gt;</span>
    <span class="cicada-nymph-number">2</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-string">"(^-^)"</span> write-string
      <span class="cicada-nymph-number">1</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-string">"\^o^/"</span> write-string
      <span class="cicada-nymph-syntax-key-word">else</span>
        <span class="cicada-nymph-string">"     "</span> write-string
      <span class="cicada-nymph-syntax-key-word">then</span>
    <span class="cicada-nymph-syntax-key-word">else</span>
      <span class="cicada-nymph-string">"     "</span> write-string
      <span class="cicada-nymph-number">1</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-string">"\^o^/"</span> write-string
      <span class="cicada-nymph-syntax-key-word">else</span>
        <span class="cicada-nymph-string">"     "</span> write-string
      <span class="cicada-nymph-syntax-key-word">then</span>
    <span class="cicada-nymph-syntax-key-word">then</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

  cr
  <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">2</span> .12 cr
  <span class="cicada-nymph-number">6</span> <span class="cicada-nymph-number">2</span> .12 cr
  <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">6</span> .12 cr
  <span class="cicada-nymph-number">6</span> <span class="cicada-nymph-number">6</span> .12 cr
<span class="org-block-end-line">  #+end_src
</span><span class="org-level-1">* re-define execute-word &amp; basic-REPL</span>
  * to protect macro &amp; exception from be called from basic-REPL
<span class="org-block-begin-line">  #+begin_src cicada-nymph :tangle core.cn
</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">execute-word</span>
    <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- unknown &gt;&gt;</span>
    dup2 integer-string? <span class="cicada-nymph-syntax-key-word">if</span>
      string-&gt;integer
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-syntax-key-word">then</span>
    dup2
    find <span class="cicada-nymph-syntax-key-word">if</span>
      dup macro-jo? <span class="cicada-nymph-syntax-key-word">if</span>
        drop
        <span class="cicada-nymph-string">"* (execute-word) CAN NOT EXECUTE MACRO DIRECTLY : "</span> write-string
        write-string cr
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup exception-jo? <span class="cicada-nymph-syntax-key-word">if</span>
        drop
        <span class="cicada-nymph-string">"* (execute-word) CAN NOT EXECUTE EXCEPTION DIRECTLY : "</span> write-string
        write-string cr
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-comment">&lt;&lt; function &amp; primitive-function &amp; variable &gt;&gt;</span>
      xx|swap|x drop2
      execute-jo
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-syntax-key-word">else</span>
    <span class="cicada-nymph-string">"* (execute-word) MEETS UNDEFINED WORD : "</span> write-string
    write-string cr
    <span class="cicada-nymph-syntax-key-word">then</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">basic-REPL</span>
    <span class="cicada-nymph-comment">&lt;&lt; unknown -- unknown &gt;&gt;</span>
    read-word-for-REPL
    execute-word
    <span class="cicada-nymph-end">&lt;&gt;</span> basic-REPL
  <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

  basic-REPL
<span class="org-block-end-line">  #+end_src
</span><span class="org-level-1">* allocate</span>
<span class="org-level-2">** </span><span class="org-todo">note</span>
   * an interface of <span class="bold">*un-initialized-memory*</span>
<span class="org-level-2">** clear-memory [not using]</span>
   * this kinds of functions
     must be implemented in assembly code
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">clear-memory</span>
     <span class="cicada-nymph-comment">&lt;&lt; size, address -- &gt;&gt;</span>
     over zero? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-number">0</span> over save
     add1 swap
     sub1 swap
     <span class="cicada-nymph-end">&lt;&gt;</span> clear-memory
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** allocate-memory</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">allocate-memory</span>
     <span class="cicada-nymph-comment">&lt;&lt; size -- address &gt;&gt;</span>
     dup <span class="cicada-nymph-variable">*current-free-address,un-initialized-memory*</span> clear-memory
     <span class="cicada-nymph-variable">*current-free-address,un-initialized-memory*</span> swap <span class="cicada-nymph-comment">&lt;&lt; address as return value &gt;&gt;</span>
     <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*current-free-address,un-initialized-memory*</span> add-save
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* -----------------------------------</span>
<span class="org-level-1">* report</span>
<span class="org-level-2">** show-dictionary,primitive-function</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">loop,show-dictionary,primitive-function</span>
     <span class="cicada-nymph-comment">&lt;&lt; counter, jo -- total &gt;&gt;</span>
     dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
       drop
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     dup primitive-function-jo? false? <span class="cicada-nymph-syntax-key-word">if</span>
       jo-&gt;pre-jo
       <span class="cicada-nymph-end">&lt;&gt;</span> loop,show-dictionary,primitive-function
     <span class="cicada-nymph-syntax-key-word">then</span>
     swap
       <span class="cicada-nymph-string">"  "</span> write-string
       add1 dup .
     swap
     dup jo-&gt;name
     dup2 space-string? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-string">"UN-NAMED"</span> write-string cr
     <span class="cicada-nymph-syntax-key-word">else</span>
       write-string cr
     <span class="cicada-nymph-syntax-key-word">then</span>
     jo-&gt;pre-jo
     <span class="cicada-nymph-end">&lt;&gt;</span> loop,show-dictionary,primitive-function
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">show-dictionary,primitive-function</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"* ALL PRIMITIVE-FUNCTION IN DICTIONARY :"</span> write-string cr
     <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-variable">*first-jo-in-dictionary*</span>
     loop,show-dictionary,primitive-function
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** show-dictionary,function</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">loop,show-dictionary,function</span>
     <span class="cicada-nymph-comment">&lt;&lt; counter, jo -- total &gt;&gt;</span>
     dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
       drop
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     dup function-jo? false? <span class="cicada-nymph-syntax-key-word">if</span>
       jo-&gt;pre-jo
       <span class="cicada-nymph-end">&lt;&gt;</span> loop,show-dictionary,function
     <span class="cicada-nymph-syntax-key-word">then</span>
     swap
       <span class="cicada-nymph-string">"  "</span> write-string
       add1 dup .
     swap
     dup jo-&gt;name
     dup2 space-string? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-string">"UN-NAMED"</span> write-string cr
     <span class="cicada-nymph-syntax-key-word">else</span>
       write-string cr
     <span class="cicada-nymph-syntax-key-word">then</span>
     jo-&gt;pre-jo
     <span class="cicada-nymph-end">&lt;&gt;</span> loop,show-dictionary,function
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">show-dictionary,function</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"* ALL FUNCTION IN DICTIONARY :"</span> write-string cr
     <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-variable">*first-jo-in-dictionary*</span>
     loop,show-dictionary,function
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** show-dictionary,macro</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">loop,show-dictionary,macro</span>
     <span class="cicada-nymph-comment">&lt;&lt; counter, jo -- total &gt;&gt;</span>
     dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
       drop
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     dup macro-jo? false? <span class="cicada-nymph-syntax-key-word">if</span>
       jo-&gt;pre-jo
       <span class="cicada-nymph-end">&lt;&gt;</span> loop,show-dictionary,macro
     <span class="cicada-nymph-syntax-key-word">then</span>
     swap
       <span class="cicada-nymph-string">"  "</span> write-string
       add1 dup .
     swap
     dup jo-&gt;name
     dup2 space-string? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-string">"UN-NAMED"</span> write-string cr
     <span class="cicada-nymph-syntax-key-word">else</span>
       write-string cr
     <span class="cicada-nymph-syntax-key-word">then</span>
     jo-&gt;pre-jo
     <span class="cicada-nymph-end">&lt;&gt;</span> loop,show-dictionary,macro
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">show-dictionary,macro</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"* ALL MACRO IN DICTIONARY :"</span> write-string cr
     <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-variable">*first-jo-in-dictionary*</span>
     loop,show-dictionary,macro
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** show-dictionary,exception</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">loop,show-dictionary,exception</span>
     <span class="cicada-nymph-comment">&lt;&lt; counter, jo -- total &gt;&gt;</span>
     dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
       drop
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     dup exception-jo? false? <span class="cicada-nymph-syntax-key-word">if</span>
       jo-&gt;pre-jo
       <span class="cicada-nymph-end">&lt;&gt;</span> loop,show-dictionary,exception
     <span class="cicada-nymph-syntax-key-word">then</span>
     swap
       <span class="cicada-nymph-string">"  "</span> write-string
       add1 dup .
     swap
     dup jo-&gt;name
     dup2 space-string? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-string">"UN-NAMED"</span> write-string cr
     <span class="cicada-nymph-syntax-key-word">else</span>
       write-string cr
     <span class="cicada-nymph-syntax-key-word">then</span>
     jo-&gt;pre-jo
     <span class="cicada-nymph-end">&lt;&gt;</span> loop,show-dictionary,exception
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">show-dictionary,exception</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"* ALL EXCEPTION IN DICTIONARY :"</span> write-string cr
     <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-variable">*first-jo-in-dictionary*</span>
     loop,show-dictionary,exception
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** show-dictionary,variable</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">loop,show-dictionary,variable</span>
     <span class="cicada-nymph-comment">&lt;&lt; counter, jo -- total &gt;&gt;</span>
     dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
       drop
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     dup variable-jo? false? <span class="cicada-nymph-syntax-key-word">if</span>
       jo-&gt;pre-jo
       <span class="cicada-nymph-end">&lt;&gt;</span> loop,show-dictionary,variable
     <span class="cicada-nymph-syntax-key-word">then</span>
     swap
       <span class="cicada-nymph-string">"  "</span> write-string
       add1 dup .
     swap
     dup jo-&gt;name
     dup2 space-string? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-string">"UN-NAMED"</span> write-string cr
     <span class="cicada-nymph-syntax-key-word">else</span>
       write-string cr
     <span class="cicada-nymph-syntax-key-word">then</span>
     jo-&gt;pre-jo
     <span class="cicada-nymph-end">&lt;&gt;</span> loop,show-dictionary,variable
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">show-dictionary,variable</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"* ALL VARIABLE IN DICTIONARY :"</span> write-string cr
     <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-variable">*first-jo-in-dictionary*</span>
     loop,show-dictionary,variable
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** show-dictionary</span>
   * different types of words in dictionary
     are showed separately
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">show-dictionary</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     show-dictionary,primitive-function
     show-dictionary,function
     show-dictionary,macro
     show-dictionary,exception
     show-dictionary,variable
     <span class="cicada-nymph-string">"* TOTALLY : "</span> write-string
     add add add add . cr
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** report-memory</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">report-memory</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"* *un-initialized-memory*"</span> write-string cr
     <span class="cicada-nymph-string">"  * SIZE : "</span> write-string
          <span class="cicada-nymph-variable">*size,un-initialized-memory*</span>
          . cr
     <span class="cicada-nymph-string">"  * USED : "</span> write-string
          <span class="cicada-nymph-variable">*current-free-address,un-initialized-memory*</span>
          <span class="cicada-nymph-variable">*un-initialized-memory*</span>
          sub . cr
     <span class="cicada-nymph-string">"  * FREE : "</span> write-string
          <span class="cicada-nymph-variable">*size,un-initialized-memory*</span>
          <span class="cicada-nymph-variable">*current-free-address,un-initialized-memory*</span>
          <span class="cicada-nymph-variable">*un-initialized-memory*</span>
          sub sub . cr
     <span class="cicada-nymph-string">"* *primitive-string-heap*"</span> write-string cr
     <span class="cicada-nymph-string">"  * SIZE : "</span> write-string
          <span class="cicada-nymph-variable">*size,primitive-string-heap*</span>
          . cr
     <span class="cicada-nymph-string">"  * USED : "</span> write-string
          <span class="cicada-nymph-variable">*current-free-address,primitive-string-heap*</span>
          <span class="cicada-nymph-variable">*primitive-string-heap*</span>
          sub . cr
     <span class="cicada-nymph-string">"  * FREE : "</span> write-string
          <span class="cicada-nymph-variable">*size,primitive-string-heap*</span>
          <span class="cicada-nymph-variable">*current-free-address,primitive-string-heap*</span>
          <span class="cicada-nymph-variable">*primitive-string-heap*</span>
          sub sub . cr
     <span class="cicada-nymph-string">"* *jo-heap*"</span> write-string cr
     <span class="cicada-nymph-string">"  * SIZE : "</span> write-string
          <span class="cicada-nymph-variable">*size,jo-heap*</span> . cr
     <span class="cicada-nymph-string">"  * USED : "</span> write-string
          <span class="cicada-nymph-variable">*current-free-address,jo-heap*</span>
          <span class="cicada-nymph-variable">*jo-heap*</span>
          sub . cr
     <span class="cicada-nymph-string">"  * FREE : "</span> write-string
          <span class="cicada-nymph-variable">*size,jo-heap*</span>
          <span class="cicada-nymph-variable">*current-free-address,jo-heap*</span>
          <span class="cicada-nymph-variable">*jo-heap*</span>
          sub sub . cr
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* to load</span>
<span class="org-level-2">** load core.cn.test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">test</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"core.cn.test"</span> load-file
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* I wish you a lovely day</span>
<span class="org-level-2">** hi</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-number">0</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">*hi,random-base*</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-variable</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">hi,random</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- random-number &gt;&gt;</span>
     <span class="cicada-nymph-variable">*hi,random-base*</span>
     <span class="cicada-nymph-variable">*hi,random-base*</span> add1 <span class="cicada-nymph-number">10</span> mod
     <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*hi,random-base*</span> save
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">hi,say</span>
     <span class="cicada-nymph-comment">&lt;&lt; number -- &gt;&gt;</span>
     dup <span class="cicada-nymph-number">0</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">" cica cica da yaya !!!"</span> .s <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">1</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">" hi ^-^"</span> .s <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">2</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">" hello :)"</span> .s <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">3</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">" hey *^-^*"</span> .s <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">4</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">" hiya \^o^/"</span> .s <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">5</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">" I wish you a lovely day"</span> .s <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">6</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">" I wish you a lovely day { or night :P }"</span> .s <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">7</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">" o.o"</span> .s <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     drop <span class="cicada-nymph-string">" love love ^3^"</span> .s <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">hi</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     hi,random
     hi,say
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* -----------------------------------</span>
<span class="org-level-1">* stack-REPL</span>
<span class="org-level-2">** </span><span class="org-todo">note</span>
   * print argument-stack in every loop
<span class="org-level-2">** write-argument-stack</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">print-argument-stack,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; address, counter -- &gt;&gt;</span>
     dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     sub1 swap
       dup fetch .
     <span class="cicada-nymph-variable">*jo-size*</span> add
     swap
     <span class="cicada-nymph-end">&lt;&gt;</span> print-argument-stack,loop
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">print-argument-stack</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     snapshot-the-stack-pointer
     <span class="cicada-nymph-variable">*the-stack-pointer-snapshot*</span>
     <span class="cicada-nymph-variable">*the-stack*</span> greater-or-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-variable">*the-stack*</span>   <span class="cicada-nymph-comment">&lt;&lt; address as return value &gt;&gt;</span>
       <span class="cicada-nymph-variable">*the-stack-pointer-snapshot*</span> <span class="cicada-nymph-variable">*the-stack*</span> sub
       <span class="cicada-nymph-variable">*jo-size*</span> div <span class="cicada-nymph-comment">&lt;&lt; counter as return value &gt;&gt;</span>
       print-argument-stack,loop
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-string">"BELOW THE STACK "</span> write-string
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** stack-REPL</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">stack-REPL</span>
     <span class="cicada-nymph-comment">&lt;&lt; unknown -- unknown &gt;&gt;</span>
     read-word-for-REPL
     execute-word
     snapshot-the-stack-pointer
     cr
     <span class="cicada-nymph-string">" * "</span> write-string
        <span class="cicada-nymph-variable">*the-stack-pointer-snapshot*</span>
        <span class="cicada-nymph-variable">*the-stack*</span> sub
        <span class="cicada-nymph-comment">&lt;&lt; ad hoc for the BUG of div &gt;&gt;</span>
        dup negative? <span class="cicada-nymph-syntax-key-word">if</span>
          negate
          <span class="cicada-nymph-variable">*jo-size*</span> div
          negate
        <span class="cicada-nymph-syntax-key-word">else</span>
          <span class="cicada-nymph-variable">*jo-size*</span> div
        <span class="cicada-nymph-syntax-key-word">then</span>
        write-integer
     <span class="cicada-nymph-string">" * "</span> write-string
     <span class="cicada-nymph-string">" -- "</span> write-string
       print-argument-stack
     <span class="cicada-nymph-string">"--"</span> write-string
     cr
     <span class="cicada-nymph-end">&lt;&gt;</span> stack-REPL
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* -----------------------------------</span>
<span class="org-level-1">* name-hash-table</span>
<span class="org-level-2">** </span><span class="org-todo">note</span><span class="org-level-2"> naming &amp; factoring</span>
   * open addressing
     for we do not need to delete
   * math
     * hash
     * probe
   * memory
     * insert
     * search
   * function
     * map
     * reverse
<span class="org-level-2">** memory allocation</span>
   * the following are some prime number
     ready to be used
     * 1000003   about 976 k
     * 1000033
     * 1000333
     * 100003    about 97 k
     * 100333
     * 997
     * 499
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-number">100333</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">*name-hash-table,size*</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-variable</span>

   <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">4</span> mul
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">*name-hash-table,unit*</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-variable</span>

   <span class="cicada-nymph-variable">*name-hash-table,size*</span>
   <span class="cicada-nymph-variable">*name-hash-table,unit*</span> mul
   allocate-memory
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">*name-hash-table*</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-variable</span>

   <span class="cicada-nymph-number">0</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">*name-hash-table,counter*</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-variable</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** hash</span>
   * prime table size
   * linear probing
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name-hash-table,hash</span>
     <span class="cicada-nymph-comment">&lt;&lt; number, counter -- index &gt;&gt;</span>
     add <span class="cicada-nymph-variable">*name-hash-table,size*</span> mod
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** string-&gt;finite-carry-sum</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-number">16</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">*max-carry-position*</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-variable</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">string-&gt;finite-carry-sum,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; carry-sum, string[address, length], counter -- carry-sum &gt;&gt;</span>
     over zero? <span class="cicada-nymph-syntax-key-word">if</span>
       drop drop2
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-variable">*max-carry-position*</span> greater-than? <span class="cicada-nymph-syntax-key-word">if</span>
       drop <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-comment">&lt;&lt; re-start from 0 &gt;&gt;</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     xx|over|x
     string-head,char over
     <span class="cicada-nymph-number">2</span> swap power
     mul
     x|swap|xxxx add xxx|swap|x
     add1 xx|swap|x
     string-tail,char x|swap|xx
     <span class="cicada-nymph-end">&lt;&gt;</span> string-&gt;finite-carry-sum,loop
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">string-&gt;finite-carry-sum</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- carry-sum &gt;&gt;</span>
     <span class="cicada-nymph-number">0</span> xx|swap|x <span class="cicada-nymph-comment">&lt;&lt; carry-sum &gt;&gt;</span>
     <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-comment">&lt;&lt; counter &gt;&gt;</span>
     string-&gt;finite-carry-sum,loop
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** name</span>
<span class="org-level-3">*** </span><span class="org-todo">note</span>
    * a name is an index into name-hash-table
    * an entry can be viewed
      1. as a point
      2. as an orbit
    * in a name entry we have the following fields
      <span class="org-table">|-------------------------------+-------------------------|</span>
      <span class="org-table">|                               | note                    |</span>
      <span class="org-table">|-------------------------------+-------------------------|</span>
      <span class="org-table">| primitive-string              | 0 denotes               |</span>
      <span class="org-table">| [address]                     | name not used           |</span>
      <span class="org-table">|-------------------------------+-------------------------|</span>
      <span class="org-table">| title                         | 0 denotes               |</span>
      <span class="org-table">| [index into name-title-table] | name not used as title  |</span>
      <span class="org-table">|-------------------------------+-------------------------|</span>
      <span class="org-table">| orbit-length                  | as an orbit             |</span>
      <span class="org-table">| [number]                      | its length gets updated |</span>
      <span class="org-table">|-------------------------------+-------------------------|</span>
      <span class="org-table">| orbiton                       | as a point              |</span>
      <span class="org-table">| [address]                     | it is on an orbit       |</span>
      <span class="org-table">|-------------------------------+-------------------------|</span>
<span class="org-level-3">*** name-&gt;address</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name-&gt;address</span>
      <span class="cicada-nymph-comment">&lt;&lt; name -- address &gt;&gt;</span>
      <span class="cicada-nymph-variable">*name-hash-table,unit*</span> mul
      <span class="cicada-nymph-variable">*name-hash-table*</span> add
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,used?</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name,used?</span>
      <span class="cicada-nymph-comment">&lt;&lt; name -- bool &gt;&gt;</span>
      name-&gt;address
      fetch zero? false?
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,used-as-title?</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name,used-as-title?</span>
      <span class="cicada-nymph-comment">&lt;&lt; name -- bool &gt;&gt;</span>
      name-&gt;address
      <span class="cicada-nymph-variable">*jo-size*</span> add
      fetch zero?
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,fetch-string</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name,fetch-string</span>
      <span class="cicada-nymph-comment">&lt;&lt; name -- string[address, length] &gt;&gt;</span>
      name-&gt;address
      fetch
      address-&gt;primitive-string
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,fetch-title-index</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name,fetch-title-index</span>
      <span class="cicada-nymph-comment">&lt;&lt; name -- index &gt;&gt;</span>
      name-&gt;address
      <span class="cicada-nymph-variable">*jo-size*</span> add
      fetch
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,fetch-orbit-length</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name,fetch-orbit-length</span>
      <span class="cicada-nymph-comment">&lt;&lt; name -- length &gt;&gt;</span>
      name-&gt;address
      <span class="cicada-nymph-variable">*jo-size*</span> add
      <span class="cicada-nymph-variable">*jo-size*</span> add
      fetch
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,fetch-orbiton</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name,fetch-orbiton</span>
      <span class="cicada-nymph-comment">&lt;&lt; name -- address &gt;&gt;</span>
      name-&gt;address
      <span class="cicada-nymph-variable">*jo-size*</span> add
      <span class="cicada-nymph-variable">*jo-size*</span> add
      <span class="cicada-nymph-variable">*jo-size*</span> add
      fetch
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,save-string</span>
    * note that
      primitive-string-heap is used
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name,save-string</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length], name -- &gt;&gt;</span>
      <span class="cicada-nymph-variable">*current-free-address,primitive-string-heap*</span>
      xx|swap|xx
      save-into,primitive-string-heap
      swap
      name-&gt;address
      save
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,save-title-index</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name,save-title-index</span>
      <span class="cicada-nymph-comment">&lt;&lt; index, name -- &gt;&gt;</span>
      name-&gt;address
      <span class="cicada-nymph-variable">*jo-size*</span> add
      save
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,save-orbit-length</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name,save-orbit-length</span>
      <span class="cicada-nymph-comment">&lt;&lt; index, name -- &gt;&gt;</span>
      name-&gt;address
      <span class="cicada-nymph-variable">*jo-size*</span> add
      <span class="cicada-nymph-variable">*jo-size*</span> add
      save
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,save-orbiton</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name,save-orbiton</span>
      <span class="cicada-nymph-comment">&lt;&lt; index, name -- &gt;&gt;</span>
      name-&gt;address
      <span class="cicada-nymph-variable">*jo-size*</span> add
      <span class="cicada-nymph-variable">*jo-size*</span> add
      <span class="cicada-nymph-variable">*jo-size*</span> add
      save
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,no-collision?</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name,no-collision?</span>
      <span class="cicada-nymph-comment">&lt;&lt; name -- bool &gt;&gt;</span>
      dup name,fetch-orbiton
      equal?
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** search</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name-hash-table,search,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length], number, counter
        -- name, true
        -- name, false &gt;&gt;</span>
     xx|tuck|xx name-hash-table,hash
     xx|tuck|x
     <span class="cicada-nymph-comment">&lt;&lt; number, counter, name, string[address, length], name &gt;&gt;</span>
     name,used? false? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2 xx|swap|x drop2
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-comment">&lt;&lt; number, counter, name, string[address, length] &gt;&gt;</span>
     x|over|xx name,fetch-string
     xx|over|xx string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2 xx|swap|x drop2
       <span class="cicada-nymph-bool">true</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-comment">&lt;&lt; number, counter, name, string[address, length] &gt;&gt;</span>
     x|over|xx name,fetch-orbit-length
     x|over|xxxx equal? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2 xx|swap|x drop2
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-comment">&lt;&lt; number, counter, name, string[address, length] &gt;&gt;</span>
     x|swap|xx drop
     xx|swap|xx add1
     <span class="cicada-nymph-end">&lt;&gt;</span> name-hash-table,search,loop
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name-hash-table,search</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length]
        -- name, true
        -- false &gt;&gt;</span>
     dup2 string-&gt;finite-carry-sum
     <span class="cicada-nymph-number">0</span> name-hash-table,search,loop
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** insert</span>
   * I found that (insert) can not re-use (search)
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name-hash-table,insert,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length], number, counter
        -- name, true
        -- name, false &gt;&gt;</span>
     xx|tuck|xx name-hash-table,hash
     xx|tuck|x
     <span class="cicada-nymph-comment">&lt;&lt; number, counter, name, string[address, length], name &gt;&gt;</span>
     name,used? false? <span class="cicada-nymph-syntax-key-word">if</span>
       x|over|xx name,save-string
         xx|tuck|x <span class="cicada-nymph-comment">&lt;&lt; name as return value &gt;&gt;</span>
       <span class="cicada-nymph-comment">&lt;&lt; name, number, counter, name &gt;&gt;</span>
       x|over|xx <span class="cicada-nymph-number">0</span> name-hash-table,hash
       swap name,save-orbiton
       <span class="cicada-nymph-comment">&lt;&lt; name, number, counter &gt;&gt;</span>
       swap <span class="cicada-nymph-number">0</span> name-hash-table,hash
       name,save-orbit-length
       <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*name-hash-table,counter*</span> add-save
       <span class="cicada-nymph-bool">true</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-comment">&lt;&lt; number, counter, name, string[address, length] &gt;&gt;</span>
     x|over|xx name,fetch-string
     xx|over|xx string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2 xx|swap|x drop2
       <span class="cicada-nymph-bool">true</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-comment">&lt;&lt; number, counter, name, string[address, length] &gt;&gt;</span>
     x|over|xxx <span class="cicada-nymph-variable">*name-hash-table,size*</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2 xx|swap|x drop2
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-comment">&lt;&lt; number, counter, name, string[address, length] &gt;&gt;</span>
     x|swap|xx drop
     xx|swap|xx add1
     <span class="cicada-nymph-end">&lt;&gt;</span> name-hash-table,insert,loop
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name-hash-table,insert</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length]
        -- name, true
        -- name, false &gt;&gt;</span>
     dup2 string-&gt;finite-carry-sum
     <span class="cicada-nymph-number">0</span> name-hash-table,insert,loop
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** string-&gt;name &amp; name-&gt;string</span>
   * error handling here
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">string-&gt;name</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- name &gt;&gt;</span>
     name-hash-table,insert
     false? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"* (string-&gt;name) *name-hash-table* IS FULL!"</span> .s
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name-&gt;string</span>
     <span class="cicada-nymph-comment">&lt;&lt; name -- string[address, length]] &gt;&gt;</span>
     name,fetch-string
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
   * set <span class="bold">*name-hash-table,size*</span> to a small number [for example 13]
     then use the following function
     and (name-hash-table,report) to do test
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name-hash-table,test</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"a-000"</span> string-&gt;name . cr
     <span class="cicada-nymph-string">"a-111"</span> string-&gt;name . cr
     <span class="cicada-nymph-string">"a-222"</span> string-&gt;name . cr
     <span class="cicada-nymph-string">"a-333"</span> string-&gt;name . cr
     <span class="cicada-nymph-string">"a-444"</span> string-&gt;name . cr
     <span class="cicada-nymph-string">"a-555"</span> string-&gt;name . cr
     <span class="cicada-nymph-string">"a-666"</span> string-&gt;name . cr
     <span class="cicada-nymph-string">"a-777"</span> string-&gt;name . cr
     <span class="cicada-nymph-string">"a-888"</span> string-&gt;name . cr
     <span class="cicada-nymph-string">"a-999"</span> string-&gt;name . cr
     <span class="cicada-nymph-string">"b-000"</span> string-&gt;name . cr
     <span class="cicada-nymph-string">"b-111"</span> string-&gt;name . cr
     <span class="cicada-nymph-string">"b-222"</span> string-&gt;name . cr
     <span class="cicada-nymph-string">"b-333"</span> string-&gt;name . cr
     <span class="cicada-nymph-string">"b-444"</span> string-&gt;name . cr
     <span class="cicada-nymph-string">"b-555"</span> string-&gt;name . cr
     <span class="cicada-nymph-string">"b-666"</span> string-&gt;name . cr
     <span class="cicada-nymph-string">"b-777"</span> string-&gt;name . cr
     <span class="cicada-nymph-string">"b-888"</span> string-&gt;name . cr
     <span class="cicada-nymph-string">"b-999"</span> string-&gt;name . cr
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-todo">note</span><span class="org-level-2"> about report</span>
   * report point orbit by orbit
     in the following format
   * {index} string # orbit-lenght
     * {index} string
     * {index} string
     * {index} string
   * if used as title
     add a (AS TITLE) as postfix
<span class="org-level-2">** report</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name-hash-table,report,orbit</span>
     <span class="cicada-nymph-comment">&lt;&lt; name, counter -- &gt;&gt;</span>
     over name,fetch-orbit-length
     over less-than? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     over name,fetch-string string-&gt;finite-carry-sum
     over name-hash-table,hash
     dup name,fetch-orbiton
     <span class="cicada-nymph-comment">&lt;&lt; name, counter, new-name, orbiton &gt;&gt;</span>
     x|over|xxx name,fetch-string string-&gt;finite-carry-sum
     <span class="cicada-nymph-number">0</span> name-hash-table,hash
     equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"  {"</span> write-string
       dup write-nature-number
       <span class="cicada-nymph-string">"} "</span> write-string
       name,fetch-string write-string
       cr
     <span class="cicada-nymph-syntax-key-word">else</span>
       drop
     <span class="cicada-nymph-syntax-key-word">then</span>
     add1 <span class="cicada-nymph-end">&lt;&gt;</span> name-hash-table,report,orbit
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name-hash-table,report,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; name -- &gt;&gt;</span>
     dup <span class="cicada-nymph-variable">*name-hash-table,size*</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
       drop
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     dup name,used? <span class="cicada-nymph-syntax-key-word">if</span>
     dup name,no-collision? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-comment">&lt;&lt; * {index} string # orbit-lenght &gt;&gt;</span>
       <span class="cicada-nymph-string">"* {"</span> write-string
       dup write-nature-number
       <span class="cicada-nymph-string">"} "</span> write-string
       dup name,fetch-string write-string
       <span class="cicada-nymph-string">" # "</span> write-string
       dup name,fetch-orbit-length
       write-nature-number
       cr
       dup <span class="cicada-nymph-number">1</span> name-hash-table,report,orbit
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     add1 <span class="cicada-nymph-end">&lt;&gt;</span> name-hash-table,report,loop
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name-hash-table,report</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-number">0</span> name-hash-table,report,loop
     <span class="cicada-nymph-string">"* TOTALLY : "</span> write-string
     <span class="cicada-nymph-variable">*name-hash-table,counter*</span> write-nature-number
     cr
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* </span><span class="org-todo">&gt;&lt;</span><span class="org-level-1"> title-name-table</span>
<span class="org-level-1">* -----------------------------------</span>
<span class="org-level-1">* </span><span class="org-todo">&gt;&lt;</span><span class="org-level-1"> return-stack</span>
<span class="org-level-1">* </span><span class="org-todo">&gt;&lt;</span><span class="org-level-1"> argument-stack</span>
<span class="org-level-1">* </span><span class="org-todo">&gt;&lt;</span><span class="org-level-1"> frame-stack</span>
<span class="org-level-1">* -----------------------------------</span>
<span class="org-level-1">* epilog</span>
<span class="org-block-begin-line">  #+begin_src cicada-nymph :tangle core.cn
</span>  stack-REPL
  hi
<span class="org-block-end-line">  #+end_src
</span><span class="org-level-1">* -----------------------------------</span>
<span class="org-level-1">* </span><span class="org-done">test</span>
<span class="org-block-begin-line">  #+begin_src cicada-nymph
</span>  name-hash-table,test
  name-hash-table,report
<span class="org-block-end-line">  #+end_src
</span><span class="org-level-1">* ===================================</span>
<span class="org-level-1">* </span><span class="org-todo">&gt;&lt;</span>
<span class="org-level-2">** insert</span>
   * I found that (insert) can not re-use (search)
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name-hash-table,insert,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length], number, counter
        -- name, true
        -- name, false &gt;&gt;</span>
     xx|tuck|xx name-hash-table,hash
     xx|tuck|x
     <span class="cicada-nymph-comment">&lt;&lt; number, counter, name, string[address, length], name &gt;&gt;</span>
     name,used? false? <span class="cicada-nymph-syntax-key-word">if</span>
       x|over|xx name,save-string
         xx|tuck|x <span class="cicada-nymph-comment">&lt;&lt; name as return value &gt;&gt;</span>
       <span class="cicada-nymph-comment">&lt;&lt; name, number, counter, name &gt;&gt;</span>
       x|over|xx <span class="cicada-nymph-number">0</span> name-hash-table,hash
       swap name,save-orbiton
       <span class="cicada-nymph-comment">&lt;&lt; name, number, counter &gt;&gt;</span>
       swap <span class="cicada-nymph-number">0</span> name-hash-table,hash
       name,save-orbit-length
       <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*name-hash-table,counter*</span> add-save
       <span class="cicada-nymph-bool">true</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-comment">&lt;&lt; number, counter, name, string[address, length] &gt;&gt;</span>
     x|over|xx name,fetch-string
     xx|over|xx string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2 xx|swap|x drop2
       <span class="cicada-nymph-bool">true</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-comment">&lt;&lt; number, counter, name, string[address, length] &gt;&gt;</span>
     x|over|xxx <span class="cicada-nymph-variable">*name-hash-table,size*</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2 xx|swap|x drop2
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-comment">&lt;&lt; number, counter, name, string[address, length] &gt;&gt;</span>
     x|swap|xx drop
     xx|swap|xx add1
     <span class="cicada-nymph-end">&lt;&gt;</span> name-hash-table,insert,loop
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name-hash-table,insert</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length]
        -- name, true
        -- name, false &gt;&gt;</span>
     dup2 string-&gt;finite-carry-sum
     <span class="cicada-nymph-number">0</span> name-hash-table,insert,loop
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** insert</span>
   * I found that (insert) can not re-use (search)
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name-hash-table,insert,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length], number, counter
        -- name, true
        -- name, false &gt;&gt;</span>
     &lt;:counter &lt;:number &lt;::string
     <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-fetch-local-variable-1">:counter</span> name-hash-table,hash
     &lt;:name
     <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-number">0</span> name-hash-table,hash
     &lt;:orbit
     <span class="cicada-nymph-fetch-local-variable-1">:name</span> name,used? false? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-fetch-local-variable-1">:name</span>
       name,save-string
       <span class="cicada-nymph-fetch-local-variable-1">:orbit</span> <span class="cicada-nymph-fetch-local-variable-1">:name</span>
       name,save-orbiton
       <span class="cicada-nymph-fetch-local-variable-1">:counter</span> <span class="cicada-nymph-fetch-local-variable-1">:orbit</span>
       name,save-orbit-length
       <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*name-hash-table,counter*</span> add-save
       <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-bool">true</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-1">:name</span> name,fetch-string
     <span class="cicada-nymph-fetch-local-variable-2">::string</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-bool">true</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-1">:counter</span> <span class="cicada-nymph-variable">*name-hash-table,size*</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-2">::string</span>
     <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-fetch-local-variable-1">:counter</span> add1
     <span class="cicada-nymph-end">&lt;&gt;</span> name-hash-table,insert,loop
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-word-to-define">name-hash-table,insert</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length]
        -- name, true
        -- name, false &gt;&gt;</span>
     dup2 string-&gt;finite-carry-sum
     <span class="cicada-nymph-number">0</span> name-hash-table,insert,loop
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-lexicographer">define-function</span>
<span class="org-block-end-line">   #+end_src
</span></pre>
  </body>
</html>
