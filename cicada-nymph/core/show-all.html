---
---
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
  <head>
    <title>core.org</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <style type="text/css">
    <!--
      body {
        color: #f8f8f0;
        background-color: #1b1d1e;
      }
      .ATTRLIST {
        /* (:strike-through t org-level-2) */
        text-decoration: line-through;
      }
      .bold {
        /* bold */
        font-weight: bold;
      }
      .cicada-nymph-XdataX {
        /* cicada-nymph-<data>-face */
        color: #ffffff;
        font-weight: bold;
      }
      .cicada-nymph-allocate {
        /* cicada-nymph-allocate-face */
        color: #AE7C3B;
        font-weight: bold;
      }
      .cicada-nymph-bool {
        /* cicada-nymph-bool-face */
        color: #fd971f;
        font-weight: bold;
      }
      .cicada-nymph-comment {
        /* cicada-nymph-comment-face */
        color: #FF8888;
      }
      .cicada-nymph-constant {
        /* cicada-nymph-constant-face */
        color: #fd971f;
        font-weight: bold;
      }
      .cicada-nymph-define-exception {
        /* cicada-nymph-define-exception-face */
        color: #1ef15f;
        font-weight: bold;
      }
      .cicada-nymph-define-function {
        /* cicada-nymph-define-function-face */
        color: #ae81ff;
        font-weight: bold;
      }
      .cicada-nymph-define-variable {
        /* cicada-nymph-define-variable-face */
        color: #a1ab3a;
        font-weight: bold;
      }
      .cicada-nymph-end {
        /* cicada-nymph-end-face */
        color: #00ffff;
        font-weight: bold;
      }
      .cicada-nymph-exception {
        /* cicada-nymph-exception-face */
        color: #00ffff;
        font-weight: bold;
      }
      .cicada-nymph-fetch-local-variable-1 {
        /* cicada-nymph-fetch-local-variable-1-face */
        color: #83EA83;
        font-weight: bold;
      }
      .cicada-nymph-fetch-local-variable-2 {
        /* cicada-nymph-fetch-local-variable-2-face */
        color: #5CDD5C;
        font-weight: bold;
      }
      .cicada-nymph-function-to-define {
        /* cicada-nymph-function-to-define-face */
        color: #ef5939;
        font-weight: bold;
      }
      .cicada-nymph-meta-code-begin {
        /* cicada-nymph-meta-code-begin-face */
        color: #ef5939;
        font-weight: bold;
      }
      .cicada-nymph-meta-code-end {
        /* cicada-nymph-meta-code-end-face */
        color: #ae81ff;
        font-weight: bold;
      }
      .cicada-nymph-number {
        /* cicada-nymph-number-face */
        color: #fd971f;
        font-weight: bold;
      }
      .cicada-nymph-number-light {
        /* cicada-nymph-number-light-face */
        color: #ffff00;
      }
      .cicada-nymph-save-local-variable-1 {
        /* cicada-nymph-save-local-variable-1-face */
        color: #FF4C4C;
        font-weight: bold;
      }
      .cicada-nymph-save-local-variable-2 {
        /* cicada-nymph-save-local-variable-2-face */
        color: #dc322f;
        font-weight: bold;
      }
      .cicada-nymph-sentence-reader {
        /* cicada-nymph-sentence-reader-face */
        color: #ffff00;
        font-weight: bold;
      }
      .cicada-nymph-square-brackets {
        /* cicada-nymph-square-brackets-face */
        color: #93a8c6;
      }
      .cicada-nymph-string {
        /* cicada-nymph-string-face */
        color: #e6db74;
      }
      .cicada-nymph-syntax-key-word {
        /* cicada-nymph-syntax-key-word-face */
        color: #f92672;
        font-weight: bold;
      }
      .cicada-nymph-title {
        /* cicada-nymph-title-face */
        color: #ffffff;
        font-weight: bold;
      }
      .cicada-nymph-variable {
        /* cicada-nymph-variable-face */
        color: #fd971f;
        font-weight: bold;
      }
      .cicada-nymph-wody {
        /* cicada-nymph-wody-face */
        color: #a6e22e;
        font-weight: bold;
      }
      .italic {
        /* italic */
        font-style: italic;
      }
      .org-block-begin-line {
        /* org-block-begin-line */
        color: #FF8888;
      }
      .org-block-end-line {
        /* org-block-end-line */
        color: #FF8888;
      }
      .org-checkbox {
        /* org-checkbox */
        font-weight: bold;
      }
      .org-document-info {
        /* org-document-info */
        color: #afeeee;
      }
      .org-document-info-keyword {
        /* org-document-info-keyword */
        color: #b3b3b3;
      }
      .org-document-title {
        /* org-document-title */
        color: #afeeee;
        font-weight: bold;
      }
      .org-done {
        /* org-done */
        color: #98fb98;
        font-weight: bold;
      }
      .org-level-1 {
        /* org-level-1 */
        color: #a6e22e;
      }
      .org-level-2 {
        /* org-level-2 */
        color: #fd971f;
      }
      .org-level-3 {
        /* org-level-3 */
        color: #ff2727;
      }
      .org-table {
        /* org-table */
        color: #87cefa;
      }
      .org-tag {
        /* org-tag */
        font-weight: bold;
      }
      .org-todo {
        /* org-todo */
        color: #ffc0cb;
        font-weight: bold;
      }
      .return-stack-jo {
        /* return-stack-jo-face */
        color: #ef5939;
        font-weight: bold;
      }

      a {
        color: inherit;
        background-color: inherit;
        font: inherit;
        text-decoration: inherit;
      }
      a:hover {
        text-decoration: underline;
      }
    -->
    </style>
{% include in-org-head.html %}
  </head>
  <body>
    {% include before-pre.html %}
<pre>
<span class="org-document-info-keyword">#+TITLE:</span>  <span class="org-document-title">&#23567;&#34796;&#20043;&#26680; / core of cicada-nymph
</span><span class="org-document-info-keyword">#+AUTHOR:</span> <span class="org-document-info">&#35613;&#23431;&#24646; / XIE Yuheng
</span><span class="org-document-info-keyword">#+EMAIL:</span>  <span class="org-document-info">xyheme@gmail.com
</span>
<span class="org-level-1">* </span><span class="org-done">todo</span>
<span class="org-level-2">** &#21033;&#29992; alias &#20358;&#23526;&#29694;&#20013;&#25991;&#25903;&#25345;</span>
<span class="org-level-2">** &#37325;&#26032;&#23526;&#29694;&#38364;&#26044;&#23616;&#37096;&#35722;&#20803;&#30340;&#35486;&#27861; &#20351;&#24471;&#21487;&#20197;&#22312;&#21311;&#21517;&#20989;&#25976;&#20013;&#20351;&#29992; &#20462;&#24489; if &#30340;&#21839;&#38988; &#20006;&#22686;&#21152;&#35486;&#27861;</span>
   * &#36996;&#26377; &#27161;&#35352;&#35486;&#35328;&#35486;&#27861;&#30340;&#23526;&#29694; &#20197;&#21521;&#23884;&#22871;&#30340;&#21311;&#21517;&#20989;&#25976;&#20013;&#20195;&#20837;&#26481;&#35199;
     &#27880;&#24847;
     &#34987;&#20195;&#20837;&#30340;&#26481;&#35199; &#20854;&#23526;&#26159;&#22312; <span class="bold">*local-jo*</span> &#20013;&#30340;
     &#22914;&#26524;&#24819;&#35201;&#24418;&#25104;&#20841;&#31471;&#20989;&#25976;&#30340; concatenate
     &#37027;&#40636;&#23601;&#24517;&#38920;&#22312; &#35079;&#35069;&#30340;&#26178;&#20505;&#21435;&#34389;&#29702;&#36889;&#31278; concatenate
     &#20063;&#23601;&#26159;&#35498;
     &#20195;&#20837;&#30340;&#26041;&#24335;&#21487;&#20197;&#21508;&#31278;&#21508;&#27171;
     &#19968;&#22871;&#35373;&#35336;&#33391;&#22909;&#30340;&#27161;&#35352;&#35486;&#35328;&#35486;&#27861; &#23601;&#33021;&#23436;&#25104;&#36889;&#20491;&#29305;&#24615;
   * &#36996;&#26377; &#21508;&#31278;&#36820;&#22238;&#26041;&#24335;&#30340;&#23526;&#29694;
<span class="org-level-2">** better names for (make-*)</span>
<span class="org-level-2">** &#22522;&#30990;&#35373;&#26045; &#20043; &#25764;&#37559;</span>
<span class="org-level-2">** &#22522;&#30990;&#35373;&#26045; &#20043; &#21152;&#36617;&#33287;&#20381;&#36084;</span>
<span class="org-level-2">** &#22522;&#30990;&#35373;&#26045; &#20043; &#28204;&#35430;&#26694;&#26550;</span>
<span class="org-level-2">** &#22522;&#30990;&#35373;&#26045; &#20043; &#20195;&#30908;&#29983;&#25104;</span>
   * new way to do data-structure
   * more (define*) about with-title
<span class="org-level-2">** &#22522;&#30990;&#35373;&#26045; &#20043; &#38500;&#37679;&#27169;&#24335;               </span><span class="org-level-2"><span class="org-tag">:maybe:</span></span>
   * debug-REPL
<span class="org-level-2">** &#25972;&#29702;&#32080;&#27083; &#20043; &#20998;&#32068;&#21629;&#21517;</span>
<span class="org-level-2">** &#25972;&#29702;&#32080;&#27083; &#20043; &#21311;&#21517;&#20989;&#25976;&#30340;&#20351;&#29992;</span>
<span class="org-level-2">** &#25972;&#29702;&#32080;&#27083; &#20043; &#33391;&#22909;&#28204;&#35430;</span>
<span class="org-level-2">** &#25972;&#29702;&#32080;&#27083; &#20043; &#20998;&#25955;&#25991;&#20214;</span>
<span class="org-level-2">** &#22522;&#30990;&#35373;&#26045; &#20043; &#21311;&#21517;&#20989;&#25976; &#20043; </span><span class="org-level-2"><span class="bold">*circular-jojo-area*</span></span><span class="org-level-2"> </span><span class="org-level-2"><span class="org-tag">:maybe:</span></span>
   * &#38656;&#35201;&#37325;&#26032;&#23450;&#32681; mmake-jojo &#30340;&#25509;&#21475;&#20351;&#24471;&#23427;&#26356;&#21152;&#19968;&#33324;
   * &#20063;&#35377; make-jojo make-link make-jo-head
     &#36889;&#19968;&#31995;&#21015;&#20989;&#25976;&#30340;&#21517;&#23383;&#37117;&#25033;&#35442;&#37325;&#26032;&#20570;
     &#22240;&#29234;&#20182;&#20497;&#30340;&#21517;&#23383;
     &#24050;&#32147;&#36234;&#20358;&#36234;&#19981;&#33021;&#23637;&#31034;&#20182;&#20497;&#30340;&#25509;&#21475;&#20102;
<span class="org-level-2">** design a way to remove magic numbers [not variable, but file by file like erlang ?]</span>
<span class="org-level-2">** need more lib functions about string processing and better factoring for string processing</span>
<span class="org-level-2">** only one error-code-&gt;string is not enough </span><span class="org-level-2"><span class="org-tag">:maybe:</span></span>
<span class="org-level-2">** language-level support for creating and managing processes </span><span class="org-level-2"><span class="org-tag">:maybe:</span></span>
<span class="org-level-1">* ===================================</span>
<span class="org-level-1">* </span><span class="org-level-1"><span class="bold">*&#23567;&#34796;&#35352;*</span></span>
<span class="org-level-2">** &#29305;&#40670;</span>
   * no type
     * no type inference
     * no dynamic type tag
     * no static type declaration
   * no dynamic-memory-management
     * no garbage-collector
   * no inited local argument
   * no mixfix-notation
     * function call is "function" instead of "(function)"
     * no such thing like
       1 2 (add) = 1 (add 2) = (add 1 2)
   * no title-name-table
     * thus in this implementation
       we only use single name space
   * about comment
     * the comment of the argument &amp; return value of function
       is allowed to be written in free style normal comment
   * &#20854;&#23526;&#26368;&#26412;&#36074;&#30340;&#29305;&#40670;&#26159;
     1. &#27794;&#26377;&#39006;&#22411;
     2. &#27794;&#26377;&#21205;&#24907;&#20839;&#23384;&#31649;&#29702;
<span class="org-level-2">** &#27231;&#21046; &#33287; &#24615;&#29376;</span>
<span class="org-level-3">*** &#34899;&#35486;</span>
    * &#19968;&#20491;&#27231;&#21046; &#23526;&#29694; &#19968;&#20491;&#24615;&#29376;
      &#19968;&#32068;&#27231;&#21046; &#21487;&#20197;&#34987;&#25104;&#29234; &#19968;&#32068;&#24615;&#29376;&#30340;&#23526;&#29694;
<span class="org-level-3">*** &#21443;&#25976;&#26855;</span>
    * &#23526;&#29694;&#20989;&#25976;&#30340;&#21443;&#25976;&#20659;&#36958;
<span class="org-level-3">*** &#36820;&#22238;&#26855;</span>
    * &#23526;&#29694;&#23565;&#20989;&#25976;&#39636;&#20013;&#30340;&#36820;&#22238;&#22320;&#22336;&#30340;&#35352;&#25014;
    * &#23565;&#36820;&#22238;&#26855;&#30340;&#26597;&#25214;&#33287;&#30452;&#25509;&#25805;&#32305;
      &#23526;&#29694;&#30064;&#24120;&#34389;&#29702;
    * &#22312;&#36820;&#22238;&#26855;&#20013;&#20445;&#23384;&#20841;&#20491;&#23616;&#37096;&#25976;&#25818;&#21312;&#22495;&#30340;&#25351;&#37341;
      &#23526;&#29694; &#26377;&#21517;&#30340;&#23616;&#37096;&#35722;&#20803; &#21644; &#23616;&#37096;&#30340;&#20839;&#23384;&#20998;&#37197;
<span class="org-level-3">*** &#38321;&#35712;&#26855;</span>
    * &#20351;&#24471;&#38321;&#35712;&#22320;&#40670;&#21487;&#20197;&#34987;&#37325;&#26032;&#23450;&#21521;&#21040;&#23383;&#31526;&#20018;
      &#23526;&#29694;&#23565;&#23383;&#31526;&#20018;&#30340;&#35299;&#37323;
    * &#23526;&#29694; &#25226;&#25324;&#34399;&#35672;&#21029;&#29234;&#35422;
<span class="org-level-3">*** &#35486;&#27861;&#26855;</span>
    * &#23526;&#29694;&#23565;&#35486;&#22659;&#30340;&#38728;&#27963;&#36681;&#25563;
    * &#35486;&#27861;&#26855;&#20013;&#20445;&#23384;&#30340;&#35215;&#21063;&#38598;
      &#23526;&#29694;&#23565;&#35486;&#27861;&#21205;&#24907;&#28155;&#21152;&#33287;&#21034;&#38500;
<span class="org-level-3">*** &#37832;</span>
    * &#21482;&#26377;&#21807;&#19968;&#19968;&#20491;&#37832;
      &#35352;&#37636;&#20989;&#25976;&#34987;&#23450;&#32681;&#30340;&#32218;&#24615;&#32218;&#24615;&#38918;&#24207;
<span class="org-level-3">*** &#21517;&#25955;&#34920;</span>
    * &#23526;&#29694;&#23565;&#20989;&#25976;&#30340;&#24555;&#36895;&#26597;&#25214;
<span class="org-level-3">*** &#22995;</span>
    * &#35731;&#21629;&#21517;&#26356;&#21152;&#35215;&#21063;
<span class="org-level-3">*** &#25764;&#37559;&#26855;</span>
    * &#29992;&#20197;&#20445;&#23384;&#26576;&#19968;&#26178;&#21051;&#30340;&#20840;&#23616;&#29376;&#24907;
      &#20197;&#23526;&#29694;&#25764;&#37559;
<span class="org-level-3">*** &#21152;&#36617;&#26855;</span>
    * &#29992;&#20197;&#20445;&#23384;&#34987;&#21152;&#36617;&#30340;&#20195;&#30908;&#30340;&#20449;&#24687;
      &#20351;&#24471;&#20195;&#30908;&#21487;&#20197;&#34987;&#20998;&#25955;&#21040;&#19981;&#21516;&#30340;&#25991;&#20214;
      &#20197;&#24418;&#25104;&#30456;&#23565;&#29544;&#31435;&#30340;&#30340;&#27169;&#22602;
<span class="org-level-2">** &#21295;&#32232;</span>
<span class="org-level-3">*** &#33021;&#22816;&#32232;&#35695;&#33258;&#24049;&#20043;&#24460;&#20043;&#24460;&#25165;&#33021;&#23526;&#29694;&#30340;&#24615;&#29376;</span>
    * jotionary &#20013; jojo &#30340;&#38263;&#24230;
    * &#25226;&#23565; &#26855;&#35387;&#37323; &#34389;&#29702;&#25104; &#20803;&#25976;&#25818;
      &#21033;&#29992;&#36889;&#20123;&#20803;&#25976;&#25818; &#23601;&#33021;&#22816;&#23526;&#29694;&#31777;&#21934;&#30340;&#39006;&#22411;&#25512;&#23566;
    * &#19968;&#20491; debug &#27169;&#24335;
      &#22312;&#20854;&#20013; &#23565;&#25152;&#26377;&#30340;&#22522;&#26412;&#30340; &#26855;&#30340;&#25509;&#21475;&#21152;&#19978;&#20445;&#35703;
    * jojo &#30340;&#38957;&#37096; &#21644; jojo &#26412;&#36523;&#30340;&#20998;&#38626;
      &#36889;&#27171;&#23601;&#33021;&#22312; link &#26041;&#38754;&#22686;&#21152;&#19968;&#23652;&#38291;&#25509;
      &#32780;&#23526;&#29694;&#21029;&#21517;&#27231;&#21046;
<span class="org-level-3">*** &#23565;&#21295;&#32232;&#22120;&#30340;&#38656;&#35201;</span>
    * &#29234;&#20102;&#23526;&#29694;&#19978;&#38754;&#30340;&#24615;&#29376;
      &#25226; cicada-nymph &#32232;&#35695;&#21040;&#20219;&#20309;&#19968;&#20491;&#35486;&#35328;&#37117;&#26159;&#21487;&#20197;&#30340;
      [&#27604;&#22914; Fasm]
    * &#20294;&#26159;&#25105;&#36996;&#26159;&#38656;&#35201;&#33258;&#24049;&#23526;&#29694;&#21295;&#32232;&#22120;
      &#22240;&#29234;&#23601;&#24037;&#20316;&#37327;&#32780;&#35328; &#20108;&#32773;&#30456;&#30070;
      &#23601;&#25152;&#24418;&#25104;&#30340;&#23526;&#29694;&#31574;&#30053;&#30340;&#38728;&#27963;&#24615;&#32780;&#35328;
      &#26681;&#25818; &#33258;&#24049;&#30340;&#21295;&#32232;&#22120; &#25152;&#21046;&#23450;&#30340;&#23526;&#29694;&#31574;&#30053; &#35201;&#38728;&#27963;&#24456;&#22810;
<span class="org-level-3">*** &#23567;&#34796; &#33287; &#34796;&#35486;</span>
    * &#38364;&#20418;&#22914;&#19979;
<span class="org-block-begin-line">      #+begin_src return-stack
</span>      <span class="return-stack-jo">(machine)</span> -&gt; <span class="return-stack-jo">(cicada-nymph)</span> -&gt;
      <span class="return-stack-jo">(assembler)</span> &amp; <span class="return-stack-jo">(vm)</span> -&gt; <span class="return-stack-jo">(cicada-language)</span>
<span class="org-block-end-line">      #+end_src
</span>    * &#21487;&#31227;&#26893;&#24615;&#30001;&#23567;&#34796;&#30340;&#26131;&#23526;&#29694;&#24615;&#20358;&#32173;&#35703;
    * (vm) &#26159;
      &#23526;&#29694;&#33287; cicada-nymph &#20013;&#30340;
      &#23565;&#24213;&#23652;&#27231;&#22120;&#30340;&#29305;&#27530;&#23660;&#24615;&#20381;&#36084;&#24456;&#24369;&#30340;
      &#32218;&#20018;&#30908;&#35299;&#37323;&#22120;
    * (assembler) &#26159;
      &#20197; cicada-nymph &#25152;&#25552;&#20379;&#30340;&#20132;&#21449;&#21295;&#32232;&#22120;&#26694;&#26550;&#29234;&#22522;&#30990;&#30340;
<span class="org-level-3">*** </span><span class="org-todo">&gt;&lt;</span><span class="org-level-3"> &#20132;&#21449;&#21295;&#32232;&#22120;&#27083;&#26550;</span>
    * cross assembler framework
    * &#30446;&#30340; &#29234;&#20102;&#23531; cicada-language &#30340; VM &#30340; &#21295;&#32232;&#22120;
    * byte buffer editor
      bit buffer editor
      * cursor = 1 cursor
      * buffer = 2 cursor
      * xxxxxx = 3 cursor
    * like line editor with modes ?
    * hash-table for naming
      &#21508;&#31278; ?
<span class="org-level-2">** &#27794;&#26377;&#39006;&#22411;</span>
   * &#27794;&#26377;&#39006;&#22411;&#25512;&#23566;
     &#27794;&#26377;&#21205;&#24907;&#30340;&#39006;&#22411;&#27161;&#31844;
     &#27794;&#26377;&#38748;&#24907;&#30340;&#39006;&#22411;&#32882;&#26126;
<span class="org-level-2">** &#27794;&#26377;&#21205;&#24907;&#30340;&#20839;&#23384;&#31649;&#29702;</span>
   * &#27794;&#26377;&#22403;&#22334;&#22238;&#25910;&#22120;
<span class="org-level-2">** &#35486;&#22659;</span>
   * reading-stack
   * syntax-stack
   * rule-set
<span class="org-level-2">** &#20989;&#25976;&#39636;&#20839;&#30340;&#32080;&#27083;&#21270;&#25976;&#25818;</span>
<span class="org-level-3">*** &#19981;&#33021;&#29992;&#20358;&#20570;&#36820;&#22238;&#20540;&#30340;&#32080;&#27083;&#21270;&#25976;&#25818;</span>
    * &#22312;&#19968;&#20491;&#20989;&#25976;&#39636;&#20839;
      &#23427;&#30433;&#21487;&#20197; &#36890;&#36942; (allocate-local-memory)
      &#20358;&#20998;&#37197; <span class="bold">*local-byte*</span>
      &#28982;&#24460;&#33258;&#24049;&#35069;&#20316;&#32080;&#27083;&#21270;&#30340;&#25976;&#25818;
      &#20294;&#26159;&#36889;&#35023;&#25152;&#35069;&#20316;&#30340;&#25976;&#25818;&#20006;&#19981;&#33021;&#29992;&#20358;&#20570;&#36820;&#22238;&#20540;
      &#22240;&#29234;&#20989;&#25976;&#36864;&#20986;&#30340;&#26178;&#20505;
      &#25152;&#20998;&#37197;&#30340;&#23616;&#37096;&#20839;&#23384;&#23601;&#34987;&#22238;&#25910;&#20102;
<span class="org-level-3">*** &#20989;&#25976;&#36820;&#22238; &#38748;&#24907;&#30340; &#32080;&#27083;&#21270;&#25976;&#25818;</span>
    * &#20989;&#25976;&#33021;&#22816;&#36820;&#22238;&#32080;&#27083;&#21270;&#25976;&#25818;
      &#20294;&#26159;&#30001;&#26044;&#27794;&#26377;&#21205;&#24907;&#30340;&#20839;&#23384;&#31649;&#29702;
      &#25152;&#20197;&#20445;&#23384;&#20989;&#25976;&#20839;&#32080;&#27083;&#21270;&#25976;&#25818;&#30340;&#20839;&#23384;
      &#37117;&#26159;&#22312;&#23450;&#32681;&#20989;&#25976;&#30340;&#26178;&#20505;&#20998;&#37197;&#30340;
      &#23565;&#36889;&#20123;&#20989;&#25976;&#30340;&#36820;&#22238;&#20540;&#36914;&#34892;&#21103;&#20316;&#29992;&#23559;&#26159;&#21361;&#38570;&#30340;
    * &#27604;&#22914;
      <span class="org-table">| string | </span><span class="org-table"><span class="bold">*string-area*</span></span><span class="org-table"> |</span>
      <span class="org-table">| jojo   | </span><span class="org-table"><span class="bold">*jojo-area*</span></span><span class="org-table">   |</span>
<span class="org-level-3">*** &#20989;&#25976;&#36820;&#22238; &#21205;&#24907;&#30340; &#32080;&#27083;&#21270;&#25976;&#25818;</span>
    * &#36889;&#35023;&#31777;&#38475;&#30340;&#23526;&#29694;&#21205;&#24907;&#20839;&#23384;&#20998;&#37197;&#30340;&#26041;&#24335;&#26159;
      &#20351;&#29992; circular
      &#25152;&#36948;&#21040;&#30340;&#25928;&#26524;&#26159; &#35731;&#20154;&#20497;&#19981;&#33021;&#20381;&#36084;&#36889;&#35023;&#30340;&#25976;&#25818;
      &#25976;&#25818;&#20998;&#37197;&#21040;&#20102;&#36889;&#35023; &#23601;&#24471;&#20760;&#24555;&#20351;&#29992;&#25481;
      &#21542;&#21063;&#19968;&#20491;&#36913;&#26399;&#20043;&#24460; &#25976;&#25818;&#23601;&#34987;&#35206;&#33995;&#20102;
    * &#27604;&#22914;
      <span class="org-table">| string | </span><span class="org-table"><span class="bold">*circular-string-area*</span></span><span class="org-table"> |</span>
      <span class="org-table">| jojo   | </span><span class="org-table"><span class="bold">*circular-jojo-area*</span></span><span class="org-table">   |</span>
<span class="org-level-2">** &#25976;&#25818;&#32080;&#27083;</span>
<span class="org-level-3">*** &#35336;&#21123;</span>
    * &#36889;&#35023;&#20854;&#23526;&#26159;&#25226; &#34796;&#35486; &#20013;&#25152;&#35373;&#24819;&#30340; &#22995; &#30340;&#27231;&#21046;
      &#35722;&#25104; &#25976;&#25818;&#32080;&#27083;&#25509;&#21475;&#31649;&#29702;&#22120;
      &#20063;&#23601;&#26159; &#23526;&#29694; &#22995; &#20570;&#29234; &#25976;&#25818;&#32080;&#27083;
<span class="org-level-3">*** &#23526;&#29694;</span>
    * &#26082;&#28982;&#24050;&#32147;&#26377;&#20102; name-hash-table &#37027;&#40636;&#36889;&#20123;&#23601;&#37117;&#26159;&#21487;&#33021;&#23526;&#29694;&#30340;&#20102;
    * &#21487;&#20197;&#29992;&#35486;&#27861;&#25844;&#23637;&#20358;&#23526;&#29694;&#32232;&#35695;&#26178;&#26399;&#23565; jo &#30340;&#26597;&#25214;
    * &#25509;&#21475;&#26041;&#38754; &#26377;&#20841;&#31278;&#26041;&#24335;
      1. &#23436;&#20840;&#33287; &#24050;&#26377;&#30340; &#26597;&#25214; jo &#30340;&#27231;&#21046;&#30456;&#20114;&#20998;&#38626;
      2. &#37325;&#29992;&#24050;&#26377;&#30340;&#27231;&#21046;
      &#24050;&#26377;&#30340;&#27231;&#21046;&#26377;&#20841;&#31278;
      &#19968;&#20491;&#26159; &#21033;&#29992;&#21934;&#38917;&#37832;&#25509;&#30340;&#37832;&#34920;
      &#19968;&#20491;&#26159; &#21033;&#29992; name-hash-table &#20013;&#30340; nymph-jo &#22495;
    * &#20351;&#29992;&#20998;&#38626;&#30340; title-table &#21644; data-structure-table
      &#37117;&#26159;&#29234;&#20102; &#28187;&#36629; name-hash-table &#30340;&#36000;&#36617;
      &#20294;&#26159; &#20063;&#35377;&#36889;&#31278;&#36000;&#36617;&#23565;&#26044; name-hash-table &#26159;&#24494;&#20046;&#20854;&#24494;&#30340;
    * &#25105;&#20351;&#29992;&#36889;&#27171;&#19968;&#31278;&#26041;&#24335;&#20358;&#37325;&#29992; name-hash-table
      &#21033;&#29992;&#30340;&#29305;&#24615;&#26159; &#22914;&#26524;&#20570;&#29234;&#21517;&#23383;&#30340;&#23383;&#31526;&#20018;&#20013;&#24118;&#26377;&#31354;&#26684;
      &#37027;&#40636;&#23427;&#23601;&#19981;&#21487;&#33021;&#34987; &#20197;&#27491;&#24120;&#30340;&#26041;&#24335;&#25214;&#21040;
      &#32780;&#21033;&#29992;&#36889;&#31278; &#31354;&#26684;&#25152;&#24418;&#25104;&#30340;&#21517;&#23383;&#30340; &#23652;&#27425;&#32080;&#27083;
      &#25105;&#21487;&#20197;&#23526;&#29694;&#25105;&#25152;&#38656;&#35201;&#30340;&#24615;&#29376;
    * &#22312; name-hash-table &#20043;&#22806;
      &#25105;&#36996;&#38656;&#35201;&#20687; jo &#30340;&#20840;&#23616;&#37832;&#34920;&#19968;&#27171;&#30340;&#37832;&#34920;&#20358;&#23526;&#29694; &#27599;&#20491; data-structure
<span class="org-level-2">** &#21629;&#21517; &#33287; &#20998;&#35299; &#33287; &#21311;&#21517;</span>
   * &#21629;&#21517;
     &#21629;&#21517;&#26377;&#20841;&#31278;
     1. &#23616;&#37096;&#30340;
     2. &#20840;&#23616;&#30340;
   * &#20998;&#35299;
     &#20998;&#35299;&#26377;&#20841;&#31278;
     1. &#21033;&#29992;&#20989;&#25976;&#20316;&#29992;&#30340;
        &#36889;&#31278;&#20998;&#35299;&#21033;&#29992;&#20102;&#23616;&#37096;&#30340;&#21517;
     2. &#21033;&#29992;&#20989;&#25976;&#35079;&#21512;&#30340;
        &#36889;&#31278;&#20998;&#35299;&#21033;&#29992;&#20102;&#20840;&#23616;&#30340;&#21517;
   * &#35377;&#22810; forth &#25152;&#23815;&#23578;&#30340;&#20998;&#35299;
     &#20854;&#23526;&#26159;&#21934;&#32020;&#29234;&#20102;&#32233;&#35299; &#32622;&#25563;&#26855; &#30340;&#22739;&#21147;&#30340;
   * &#21311;&#21517;
     &#32233;&#35299;&#21629;&#21517;&#22739;&#21147;&#30340;&#26041;&#24335;&#26159;&#21311;&#21517;
     &#23526;&#29694;&#21311;&#21517;&#30340;&#26041;&#24335;&#26377;&#20841;&#31278;
     1. lambda
        &#20854;&#23526;&#26159;&#19968;&#31278;&#27161;&#35352;&#35486;&#35328;
        lambda &#30340;&#21443;&#25976;&#21517;&#23383; &#26159;&#29992;&#20358;&#27161;&#35352;&#20195;&#20837;&#40670;&#29992;&#30340;
        &#36889;&#35023;
        &#29702;&#35299;&#19978;&#30340;&#22739;&#21147;&#20358;&#28304;&#26044;
        &#23565;&#27161;&#35352;&#30340;&#20998;&#26512;
     2. &#32068;&#21512;&#23376;
        &#27599;&#20491;&#32068;&#21512;&#23376;&#37117;&#26159;&#19968;&#20491;&#20840;&#23616;&#30340;&#21517;&#23383;
        &#24478; lambda &#30340;&#35282;&#24230;&#30475;
        &#27599;&#20491;&#32068;&#21512;&#23376;&#25429;&#25417;&#26576;&#31278;&#20195;&#20837;&#27169;&#24335;
        &#28982;&#24460;&#32102;&#36889;&#31278;&#20195;&#20837;&#27169;&#24335;&#19968;&#20491;&#21517;&#23383;
        &#36889;&#35023;
        &#29702;&#35299;&#19978;&#30340;&#22739;&#21147;&#20358;&#28304;&#26044;
        &#23565;&#21517;&#23383;&#25152;&#25429;&#25417;&#30340;&#27169;&#24335;&#30340;&#29087;&#24713;
<span class="org-level-2">** &#22995;</span>
<span class="org-level-3">*** &#30446;&#30340;</span>
    * &#22312; &#23567;&#34796; &#20013;
      &#22995; &#21487;&#20197;&#34987;&#29702;&#35299;&#29234; &#25509;&#21475;&#31649;&#29702;&#22120;
      &#25110;&#32773; &#21517;&#23383;&#31649;&#29702;&#22120;
      &#20854;&#30446;&#30340;&#26159;
      &#22312;&#38656;&#35201;&#30340;&#26178;&#20505;
      &#23559;&#21629;&#21517;&#36942;&#31243;&#35722;&#24471;&#26356;&#21152;&#27491;&#35215;
    * &#22995; &#30340;
      1. &#32232;&#30908;&#25976;&#25818;&#39006;&#22411;&#30340;&#21151;&#33021;
      2. &#31777;&#21270;&#20989;&#25976;&#35519;&#29992;&#35486;&#27861;&#30340;&#21151;&#33021;
      &#21482;&#26377;&#22312; &#26377;&#39006;&#22411;&#30340; &#34796;&#35486; &#20013;
      &#25165;&#33021;&#23526;&#29694;
    * &#25509;&#21475;&#31649;&#29702;&#22120; &#21487;&#20197;&#29992;&#20358;&#24314;&#31435; &#25976;&#25818;&#32080;&#27083;&#30340;&#27010;&#24565;
      &#20294;&#26159; &#25509;&#21475;&#31649;&#29702;&#22120; &#26412;&#36523;&#30340;&#27231;&#21046;&#26159;&#33287; &#25976;&#25818;&#32080;&#27083;&#30340;&#27231;&#21046;&#30456;&#20114;&#20998;&#38626;&#30340;
<span class="org-level-3">*** &#23526;&#29694;</span>
    * &#27599;&#20491; &lt;title&gt; &#22312;&#20840;&#23616;&#30340; link &#20013;
      &#20570;&#29234;&#19968;&#20491; variable-jo &#32780;&#23384;&#22312;
      &#20854;&#20013;&#20445;&#23384;&#19968;&#20491; link
    * &#36889;&#20491; link &#20013;&#30340; jo &#23601;&#26159;&#30331;&#35352;&#22312; &#36889;&#20491; &lt;title&gt; &#19979;&#30340; jo
      &#21516;&#26178;&#20063;&#26371;&#22312; name-hash-table &#20013;&#30331;&#35352;
      &#27492;&#26178;
      &#27604;&#22914; function &#26371;&#34987;&#30331;&#35352;&#21040; "&lt;title&gt; function" &#36889;&#20491; name &#19979;
<span class="org-level-3">*** &#25509;&#21475;</span>
    * (define-function,with-title)
      &#30452;&#25509;&#35069;&#20316;&#26032;&#30340;&#26481;&#35199;
      &#20006;&#35387;&#20874;&#26032;&#30340; function &#21040; &lt;title&gt; &#19979;
      &#33287; (define-function) &#23436;&#20840;&#39006;&#20284;
      &#30070;&#31532;&#19968;&#27425;&#36935;&#21040;&#26576;&#20491; &lt;title&gt; &#26178;
      &#21021;&#22987;&#21270;&#36889;&#20491; &lt;title&gt; &#20570;&#29234; variable-jo &#30340;&#23384;&#22312;
    * (alias)
      &#25226;&#24050;&#26377;&#33290;&#30340;&#26481;&#35199;
      &#32102;&#19968;&#20491; name &#20197;&#35387;&#20874;&#21040; &lt;title&gt; &#19979;
      &#21487;&#20197;&#35731;&#23427;&#34389;&#29702;&#19968;&#20491;&#21015;&#34920;&#30340;&#26481;&#35199;
      &#21516;&#27171;&#21021;&#30340;&#29256;&#26412;&#21487;&#20197;&#26159;&#26368;&#31777;&#21934;&#30340;
    * &#22312;&#30528;&#20841;&#20491;&#24213;&#23652;&#20989;&#25976;&#20043;&#24460;
      &#25033;&#35442;&#37325;&#26032;&#23450;&#32681; (define-function)
      &#20351;&#24471;&#20182;&#20497;&#33021;&#22816;&#34389;&#29702; &#24118;&#26377; &lt;title&gt; &#30340;&#24773;&#24418;
<span class="org-level-3">*** implementation</span>
    * a title is a link
      a name under title can be found
      by normal link interface
    * a title also has some special meaning to the name-hash-table
      a name under title can NOT be found
      by normal name-hash-table interface
      to be found
      the name must be prefix by the string "&lt;title&gt; "
<span class="org-level-2">** &#26681;&#23616;&#37096;&#35722;&#20803;&#26377;&#38364;&#30340;&#35486;&#27861;&#25844;&#23637;</span>
   * joy &#20013;&#30340;&#21311;&#21517;&#35586;&#35422;
     &#22312;&#20316;&#29992;&#26044;&#26855;&#20013;&#30340;&#20540;&#30340;&#26178;&#20505;
     &#19981;&#24517;&#35079;&#35069;&#23427;&#25152;&#20316;&#29992;&#30340;&#20540;
   * &#32780; cicada-nymph &#24517;&#38920;&#20197;&#26126;&#39023;&#30340;&#26041;&#24335;&#35079;&#35069;&#26855;&#20013;&#30340;&#20540;
     &#22914;&#26524;&#27599;&#19968;&#32068;&#20989;&#25976;&#23565;&#26855;&#20013;&#30340;&#20540;&#30340;&#28040;&#32791;&#37117;&#33021;&#22816;&#34987;&#32232;&#35695;&#22120;&#35336;&#31639;&#20986;&#20358;
     &#37027;&#40636;&#23601;&#21487;&#20197;&#30465;&#30053;&#36889;&#20123;&#26126;&#39023;&#30340;&#35079;&#35069;&#20102;
     &#36889;&#20123;&#26159;&#21487;&#33021;&#23526;&#29694;&#30340;
     &#21482;&#35201;&#25226;&#35387;&#37323;&#20449;&#24687;&#35373;&#35336;&#25104; &#33391;&#22909;&#30340; &#21487;&#20197;&#34987;&#33258;&#21205;&#34389;&#29702;&#30340; &#26684;&#24335; &#23601;&#21487;&#20197;&#20102;
   * &#28982;&#32780;
     &#22312;&#27794;&#26377;&#23565;&#26855;&#30340;&#35387;&#37323;&#30340;&#33258;&#21205;&#25512;&#28436;&#30340;&#24773;&#27841;&#19979;
     &#25105;&#20063;&#21487;&#20197;&#36890;&#36942;&#35373;&#35336;&#29305;&#27530;&#30340;&#35486;&#27861;&#20358;&#23526;&#29694;&#27604;&#36611;&#22909;&#30340;&#25928;&#26524;
   * a macro to pickup values from stack by index
     index starts from 0
<span class="org-block-begin-line">     #+begin_src cicada-nymph
</span>     <span class="cicada-nymph-fetch-local-variable-1">:0</span> <span class="cicada-nymph-fetch-local-variable-1">:1</span> <span class="cicada-nymph-fetch-local-variable-1">:2</span> <span class="cicada-nymph-fetch-local-variable-1">:3</span>
     <span class="cicada-nymph-fetch-local-variable-2">::0</span> <span class="cicada-nymph-fetch-local-variable-2">::1</span>

     <span class="cicada-nymph-fetch-local-variable-1">:0</span> as dup
     <span class="cicada-nymph-fetch-local-variable-2">::0</span> as dup2
<span class="org-block-end-line">     #+end_src
</span>   * a macro to pickup values from stack by name
<span class="org-block-begin-line">     #+begin_src cicada-nymph
</span>     <span class="cicada-nymph-comment">&lt;&lt; string[address, length], counter -- &gt;&gt;</span>

     <span class="cicada-nymph-comment">&lt;&lt; do not eat &gt;&gt;</span>
     <span class="cicada-nymph-fetch-local-variable-1">:2</span> <span class="cicada-nymph-fetch-local-variable-1">:1</span> <span class="cicada-nymph-save-local-variable-2">&gt;::string</span> <span class="cicada-nymph-fetch-local-variable-1">:0</span> <span class="cicada-nymph-save-local-variable-1">&gt;:counter</span>
     <span class="cicada-nymph-fetch-local-variable-2">::2</span> <span class="cicada-nymph-save-local-variable-2">&gt;::string</span> <span class="cicada-nymph-fetch-local-variable-1">:0</span> <span class="cicada-nymph-save-local-variable-1">&gt;:counter</span>
     =&gt;<span class="cicada-nymph-square-brackets">[</span><span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-fetch-local-variable-1">:counter</span><span class="cicada-nymph-square-brackets">]</span>

     <span class="cicada-nymph-comment">&lt;&lt; eat &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:counter</span> <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>
     &gt;<span class="cicada-nymph-square-brackets">[</span><span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-fetch-local-variable-1">:counter</span><span class="cicada-nymph-square-brackets">]</span>
<span class="org-block-end-line">     #+end_src
</span>   * by the above example
     we know that
     we also need
<span class="org-block-begin-line">     #+begin_src cicada-nymph
</span>     =&gt;::name
<span class="org-block-end-line">     #+end_src
</span>     to replace
<span class="org-block-begin-line">     #+begin_src cicada-nymph
</span>     dup2 <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>
<span class="org-block-end-line">     #+end_src
</span><span class="org-level-2">** &#32080;&#27083;&#21270;&#25976;&#25818;&#30340;&#21021;&#22987;&#21270;&#35486;&#27861;</span>
   * <span class="org-checkbox">[ ]</span> &#26159; &#21311;&#21517;&#30340; jo &#36889;&#31278;&#32080;&#27083;&#21270;&#25976;&#25818;&#30340;&#21021;&#22987;&#21270;&#35486;&#27861;
     &#28982;&#32780;
     &#21029;&#30340;&#32080;&#27083;&#21270;&#30340;&#25976;&#25818;&#25033;&#35442;&#22914;&#20309;&#21602; ?
   * &#27604;&#22914; path: directory-name file-name ;
     &#26159;&#19968;&#31278;&#29992;&#20358;&#21021;&#22987;&#21270; &#29305;&#27530;&#30340;[&#20195;&#34920; path &#30340;]&#23383;&#31526;&#20018;&#30340;&#35486;&#27861;
   * &#38656;&#35201;&#39006;&#20284;&#30340;&#35486;&#27861;&#30340;&#22320;&#26041;&#36996;&#26377;
     1. vector of name
     2. vector of string
     &#27880;&#24847;&#36889;&#35023;&#30340; vector &#37117;&#26159;&#39006;&#22411;&#33391;&#22909;&#30340;
     &#24517;&#38920;&#26159;&#36889;&#27171;
     &#22240;&#29234;&#25105;&#26681;&#26412;&#27794;&#26377;&#23565;&#39006;&#22411;&#32232;&#30908;
   * &#23565;&#26044;&#19978;&#38754;&#25152;&#27424;&#32570;&#30340;&#20841;&#31278;&#35486;&#27861;
     &#25105;&#21487;&#20197;&#24456;&#23481;&#26131;&#24819;&#20986;&#24456;&#22810;&#35373;&#35336;&#26041;&#24335;
     &#20294;&#26159;&#35201;&#30693;&#36947;
     &#35486;&#27861;&#26159;&#21487;&#20197;&#38728;&#27963;&#36681;&#25563;&#30340;
     &#25152;&#20197;&#21487;&#20197;&#20808;&#23526;&#29694;&#24190;&#20491;&#35486;&#27861;&#35430;&#35430;&#25928;&#26524;
<span class="org-level-2">** &#23616;&#37096;&#35722;&#20803;&#20195;&#20837;&#23884;&#22871;&#30340;&#28961;&#21517;&#20989;&#25976;</span>
   * &#23616;&#37096;&#35722;&#20803;&#20195;&#20837;&#23884;&#22871;&#30340;&#28961;&#21517;&#20989;&#25976; &#26159;&#21487;&#20197;&#23526;&#29694;&#30340;
     &#21487;&#20197;&#23526;&#29694;&#29305;&#27530;&#30340;&#27161;&#35352;&#35486;&#27861;&#20358;&#25903;&#25345;&#36889;&#20491;&#29305;&#24615;
     &#20006;&#19988;
     &#30070;&#20123;&#28961;&#21517;&#20989;&#25976;&#38656;&#35201;&#34987;&#20570;&#29234;&#36820;&#22238;&#20540;&#36820;&#22238;&#26178;
     &#21435;&#36820;&#22238;&#28961;&#21517;&#20989;&#25976;&#30340;&#35079;&#35069;
     &#32780;&#19981;&#36820;&#22238;&#22312;&#22823;&#20989;&#25976;&#39636;&#20839;&#30340;&#28961;&#21517;&#20989;&#25976;&#26412;&#36523; &#23601;&#34892;&#20102;
     &#27492;&#26178;&#30340;&#35079;&#35069;&#26377;&#20841;&#31278;
     1. &#35079;&#35069;&#21040;&#22280;&#29376;&#20839;&#23384;&#20013;
        &#27492;&#26178;&#25152;&#36820;&#22238;&#30340;&#20540;&#24517;&#38920;&#22312;&#30701;&#26178;&#38291;&#20839;&#34987;&#29992;&#25481;
     2. &#35079;&#35069;&#21040;&#38748;&#24907;&#20839;&#23384;&#20013;
        &#36889;&#27171;&#23601;&#25552;&#20379;&#20102;&#19968;&#31278;&#29983;&#25104;&#20989;&#25976;&#30340;&#26041;&#24335;&#20102;
<span class="org-level-2">** data-structure</span>
   * a data-structure is a pattern of bit [thus byte [thus jo]] in memory
   * a data-structure is referenced by is address in memory
   * what a low level programming language should provide
     is a flexible way [a mechanism]
     to manage the interfaces of all kinds of data-structures
     including
     1. define
     2. allocate &amp; init
     3. fetch &amp; save
     4. equal &amp; copy
     and other operating functions
   * that is to say
     the interface of a data-structure is a set of functions
     what should be managed are
     1. how to define these functions
        maybe to generate these functions group by group
     2. how to apply these functions on their arguments
        i.e. to call these functions
   * the mechanism implemented here is very flexible
     thus
     it usage is not limited to help to form the concept about data-structure
<span class="org-level-2">** &#25976;&#25818;&#32080;&#27083;&#32317;&#32080;</span>
<span class="org-level-3">*** &lt;jo&gt;</span>
    apply
    size {<span class="bold">*jo-size*</span>}
    -&gt;name
    -&gt;link
    -&gt;pre-jo
    -&gt;type
    {primitive-function-jo?}
    {function-jo?}
    {exception-jo?}
    {variable-jo?}
<span class="org-level-3">*** &lt;string-area&gt;</span>
    size
    stay
<span class="org-level-3">*** &lt;link&gt;</span>
    last-jo?
    list-by-jo-predicate
    report
    find-jo
<span class="org-level-3">*** &lt;buffer&gt;</span>
    {compare-buffer}
    {cursor-&gt;next-matching-byte}
<span class="org-level-3">*** &lt;string&gt;</span>
    write {write-string}
    pretty-write {pretty-write-string}
    empty? {empty-string?}
    equal? {string-equal?}
    tail,byte {string-tail,byte}
    head,byte {string-head,byte}
    -&gt;buffer!
    reverse! {string-reverse!}
    {char-string?}
    {zero-string?}
    {digit-string?}
    {integer-string?}
    {digit-string-&gt;number}
    -&gt;integer
    find-char
    {space-string?}
    tail,word {string-tail,word}
    head,word {string-head,word}
<span class="org-level-3">*** &lt;word&gt;</span>
    {read-word-&gt;buffer}
    {read-word}
    {read-word-for-REPL}
    eval
<span class="org-level-3">*** &lt;jojo-area&gt;</span>
    size {<span class="bold">*jojo-area,size*</span>}
    current-free-address {<span class="bold">*jojo-area,current-free-address*</span>}
    stay
<span class="org-level-3">*** &lt;jojo&gt;</span>
    execute
<span class="org-level-3">*** &lt;syntax-stack&gt;</span>
    push pop
    tos drop
    empty?
    find-syntax
<span class="org-level-3">*** &lt;rule-set&gt;</span>
    fetch-border save-border
    add-rule sub-rule
    find-rule
    list-rule
<span class="org-level-3">*** &lt;local-jo&gt;</span>
    local-data-allocate,jo
    n-fetch,local-jo
    n-save,local-jo
<span class="org-level-3">*** &lt;local-variable-table&gt;</span>
    clear
    insert
    find
<span class="org-level-3">*** &lt;local-byte&gt;</span>
    allocate-local-memory
<span class="org-level-3">*** &lt;name-hash-table&gt;</span>
    size unit couter
    hash search insert report
    find-jo
<span class="org-level-3">*** &lt;name&gt;</span>
    -&gt;address
    used?
    used-as-title?
    used-as-jo?
    fetch-string
    fetch-title-index
    fetch-orbit-length
    fetch-jo
    save-string
    save-title-index
    save-orbit-length
    save-orbiton
    save-jo
    no-collision
<span class="org-level-3">*** &lt;title&gt;</span>
    find-jo
<span class="org-level-1">* ===================================</span>
<span class="org-level-1">* writers</span>
<span class="org-level-2">** </span><span class="org-todo">note</span><span class="org-level-2"> name of writers</span>
   * the use of "." as prefix
     is inherited from Forth
   * table
     <span class="org-table">| .  | pretty_write_integer | assembly |</span>
     <span class="org-table">| .i | write_integer        | core     |</span>
     <span class="org-table">| .s | write_string         | assembly |</span>
     <span class="org-table">| .l | linefeed             | core     |</span>
     <span class="org-table">| .b | write-byte           |          |</span>
<span class="org-level-2">** .l .i .b</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">.l</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-number">10</span> write-byte
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">.i</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     write-integer
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">.b</span>
     <span class="cicada-nymph-comment">&lt;&lt; byte -- &gt;&gt;</span>
     write-byte
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">kkk</span>
     <span class="cicada-nymph-string">"kkk took my baby away !"</span> .s
     .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   kkk
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* more syntax for definer</span>
<span class="org-level-2">** if &amp; else &amp; then                   </span><span class="org-level-2"><span class="org-tag">:syntax:</span></span>
<span class="org-level-3">*** </span><span class="org-todo">&#35352;</span><span class="org-level-3"> &#26781;&#20214;&#36681;&#36339;</span>
    * one predicate can make two branchs
      three predicates can make four branchs
      three predicates may only make three branchs
      but indeed there must be an invisible branch
<span class="org-level-3">*** word:[if|else|then]?</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">word:if?</span>
      <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- bool &gt;&gt;</span>
      <span class="cicada-nymph-string">"if"</span> string-equal?
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">word:else?</span>
      <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- bool &gt;&gt;</span>
      <span class="cicada-nymph-string">"else"</span> string-equal?
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">word:then?</span>
      <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- bool &gt;&gt;</span>
      <span class="cicada-nymph-string">"then"</span> string-equal?
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** syntax,[if|else|then],make-jojo</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,if,make-jojo</span>
      <span class="cicada-nymph-comment">&lt;&lt; jo, string[address, length], word:if --
         address, jo, string[address, length] &gt;&gt;</span>
      drop2
      <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">instruction</span>,false?branch
        <span class="cicada-nymph-title">jojo-area</span>,stay
      <span class="cicada-nymph-variable">*jojo-area,current-free-address*</span> xxx|swap|x
      <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">jojo-area</span>,stay
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,else,make-jojo</span>
      <span class="cicada-nymph-comment">&lt;&lt; address, jo, string[address, length], word:else --
         address, jo, string[address, length] &gt;&gt;</span>
      drop2
      <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">instruction</span>,branch
         <span class="cicada-nymph-title">jojo-area</span>,stay
      x|swap|xxx
      <span class="cicada-nymph-variable">*jojo-area,current-free-address*</span> xxxx|swap|x
      <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">jojo-area</span>,stay
      <span class="cicada-nymph-comment">&lt;&lt; address, string[address, length], address &gt;&gt;</span>
      <span class="cicada-nymph-variable">*jojo-area,current-free-address*</span>
      over sub <span class="cicada-nymph-variable">*jo-size*</span> div
      swap save
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,then,make-jojo</span>
      <span class="cicada-nymph-comment">&lt;&lt; address, jo, string[address, length], word:then --
         jo, string[address, length] &gt;&gt;</span>
      drop2
      x|swap|xxx
      <span class="cicada-nymph-variable">*jojo-area,current-free-address*</span>
      over sub <span class="cicada-nymph-variable">*jo-size*</span> div
      swap save
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span><span class="org-level-3"> if &amp; else &amp; then</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">.12</span>
      <span class="cicada-nymph-comment">&lt;&lt; 1 2 -- &gt;&gt;</span>
      <span class="cicada-nymph-number">2</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-string">"(^-^)"</span> .s
        <span class="cicada-nymph-number">1</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
          <span class="cicada-nymph-string">"\^o^/"</span> .s
        <span class="cicada-nymph-syntax-key-word">else</span>
          <span class="cicada-nymph-string">"     "</span> .s
        <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-syntax-key-word">else</span>
        <span class="cicada-nymph-string">"     "</span> .s
        <span class="cicada-nymph-number">1</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
          <span class="cicada-nymph-string">"\^o^/"</span> .s
        <span class="cicada-nymph-syntax-key-word">else</span>
          <span class="cicada-nymph-string">"     "</span> .s
        <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">.12,test</span>
      .l
      <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">2</span> .12 .l
      <span class="cicada-nymph-number">6</span> <span class="cicada-nymph-number">2</span> .12 .l
      <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">6</span> .12 .l
      <span class="cicada-nymph-number">6</span> <span class="cicada-nymph-number">6</span> .12 .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
    <span class="cicada-nymph-title">.12</span>,test
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span><span class="org-level-3"> if &amp; else &amp; then [by factorial]</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">factorial</span>
      <span class="cicada-nymph-comment">&lt;&lt; number -- number &gt;&gt;</span>
      dup
      one? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup sub1 factorial
      mul
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">factorial,test</span>
      .l
      <span class="cicada-nymph-number">1</span> factorial . .l
      <span class="cicada-nymph-number">2</span> factorial . .l
      <span class="cicada-nymph-number">3</span> factorial . .l
      <span class="cicada-nymph-number">4</span> factorial . .l
      <span class="cicada-nymph-number">5</span> factorial . .l
      <span class="cicada-nymph-number">6</span> factorial . .l
      <span class="cicada-nymph-number">7</span> factorial . .l
      <span class="cicada-nymph-number">8</span> factorial . .l
      <span class="cicada-nymph-number">9</span> factorial . .l
      <span class="cicada-nymph-number">10</span> factorial . .l
      <span class="cicada-nymph-number">11</span> factorial . .l
      <span class="cicada-nymph-number">12</span> factorial . .l
      <span class="cicada-nymph-number">13</span> factorial . .l
      <span class="cicada-nymph-number">14</span> factorial . .l
      <span class="cicada-nymph-number">15</span> factorial . .l
      <span class="cicada-nymph-number">16</span> factorial . .l
      <span class="cicada-nymph-number">17</span> factorial . .l
      <span class="cicada-nymph-number">18</span> factorial . .l
      <span class="cicada-nymph-number">19</span> factorial . .l
      <span class="cicada-nymph-number">20</span> factorial . .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
    <span class="cicada-nymph-title">factorial</span>,test
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** prepare-for                        </span><span class="org-level-2"><span class="org-tag">:syntax:</span></span>
<span class="org-level-3">*** word:prepare-for?</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">word:prepare-for?</span>
      <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- bool &gt;&gt;</span>
      <span class="cicada-nymph-string">"prepare-for"</span> string-equal?
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** syntax,prepare-for,make-jojo</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,prepare-for,make-jojo</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length], word:prepare-for --
         string[address, length] &gt;&gt;</span>
      drop2
      <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">instruction</span>,prepare-for
        <span class="cicada-nymph-title">jojo-area</span>,stay
      <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">instruction</span>,exception-head
        <span class="cicada-nymph-title">jojo-area</span>,stay
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** exception-reset-stack              </span><span class="org-level-2"><span class="org-tag">:syntax:</span></span>
<span class="org-level-3">*** word:exception-reset-stack?</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">word:exception-reset-stack?</span>
      <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- bool &gt;&gt;</span>
      <span class="cicada-nymph-string">"exception-reset-stack"</span> string-equal?
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** syntax,exception-reset-stack,make-jojo</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,exception-reset-stack,make-jojo</span>
      <span class="cicada-nymph-comment">&lt;&lt; jo, string[address, length], word:exception-reset-stack --
         jo, string[address, length] &gt;&gt;</span>
      drop2
      <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">instruction</span>,exception-reset-stack
        <span class="cicada-nymph-title">jojo-area</span>,stay
      x|over|xx
        <span class="cicada-nymph-title">jojo-area</span>,stay
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** loop                               </span><span class="org-level-2"><span class="org-tag">:syntax:</span></span>
<span class="org-level-3">*** word:loop?</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">word:loop?</span>
      <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- bool &gt;&gt;</span>
      <span class="cicada-nymph-string">"loop"</span> string-equal?
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** syntax,loop,make-jojo</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,loop,make-jojo</span>
      <span class="cicada-nymph-comment">&lt;&lt; jo, string[address, length], word:loop --
         jo, string[address, length] &gt;&gt;</span>
      drop2
      <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-end">tail-call</span>
        <span class="cicada-nymph-title">jojo-area</span>,stay
      x|over|xx
        <span class="cicada-nymph-title">jojo-area</span>,stay
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** recur                              </span><span class="org-level-2"><span class="org-tag">:syntax:</span></span>
<span class="org-level-3">*** word:recur?</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">word:recur?</span>
      <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- bool &gt;&gt;</span>
      <span class="cicada-nymph-string">"recur"</span> string-equal?
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** syntax,recur,make-jojo</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,recur,make-jojo</span>
      <span class="cicada-nymph-comment">&lt;&lt; jo, string[address, length], word:recur --
         jo, string[address, length] &gt;&gt;</span>
      drop2
      x|over|xx
        <span class="cicada-nymph-title">jojo-area</span>,stay
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span><span class="org-level-3"> recur [by factorial]</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">factorial</span>
      <span class="cicada-nymph-comment">&lt;&lt; number -- number &gt;&gt;</span>
      dup
      one? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup sub1 <span class="cicada-nymph-syntax-key-word">recur</span> mul
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">factorial,test</span>
      .l
      <span class="cicada-nymph-number">1</span> factorial . .l
      <span class="cicada-nymph-number">2</span> factorial . .l
      <span class="cicada-nymph-number">3</span> factorial . .l
      <span class="cicada-nymph-number">4</span> factorial . .l
      <span class="cicada-nymph-number">5</span> factorial . .l
      <span class="cicada-nymph-number">6</span> factorial . .l
      <span class="cicada-nymph-number">7</span> factorial . .l
      <span class="cicada-nymph-number">8</span> factorial . .l
      <span class="cicada-nymph-number">9</span> factorial . .l
      <span class="cicada-nymph-number">10</span> factorial . .l
      <span class="cicada-nymph-number">11</span> factorial . .l
      <span class="cicada-nymph-number">12</span> factorial . .l
      <span class="cicada-nymph-number">13</span> factorial . .l
      <span class="cicada-nymph-number">14</span> factorial . .l
      <span class="cicada-nymph-number">15</span> factorial . .l
      <span class="cicada-nymph-number">16</span> factorial . .l
      <span class="cicada-nymph-number">17</span> factorial . .l
      <span class="cicada-nymph-number">18</span> factorial . .l
      <span class="cicada-nymph-number">19</span> factorial . .l
      <span class="cicada-nymph-number">20</span> factorial . .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
    <span class="cicada-nymph-title">factorial</span>,test


    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">factorial,loop</span>
      <span class="cicada-nymph-comment">&lt;&lt; counter, product -- product &gt;&gt;</span>
      over one? <span class="cicada-nymph-syntax-key-word">if</span>
        swap drop
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      over mul
      swap sub1 swap
      <span class="cicada-nymph-end">loop</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">factorial</span>
      <span class="cicada-nymph-comment">&lt;&lt; number -- number &gt;&gt;</span>
      <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-title">factorial</span>,loop
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">factorial,test</span>
      .l
      <span class="cicada-nymph-number">1</span> factorial . .l
      <span class="cicada-nymph-number">2</span> factorial . .l
      <span class="cicada-nymph-number">3</span> factorial . .l
      <span class="cicada-nymph-number">4</span> factorial . .l
      <span class="cicada-nymph-number">5</span> factorial . .l
      <span class="cicada-nymph-number">6</span> factorial . .l
      <span class="cicada-nymph-number">7</span> factorial . .l
      <span class="cicada-nymph-number">8</span> factorial . .l
      <span class="cicada-nymph-number">9</span> factorial . .l
      <span class="cicada-nymph-number">10</span> factorial . .l
      <span class="cicada-nymph-number">11</span> factorial . .l
      <span class="cicada-nymph-number">12</span> factorial . .l
      <span class="cicada-nymph-number">13</span> factorial . .l
      <span class="cicada-nymph-number">14</span> factorial . .l
      <span class="cicada-nymph-number">15</span> factorial . .l
      <span class="cicada-nymph-number">16</span> factorial . .l
      <span class="cicada-nymph-number">17</span> factorial . .l
      <span class="cicada-nymph-number">18</span> factorial . .l
      <span class="cicada-nymph-number">19</span> factorial . .l
      <span class="cicada-nymph-number">20</span> factorial . .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
    <span class="cicada-nymph-title">factorial</span>,test
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** more,rule-set,make-jojo</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">more,rule-set,make-jojo</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-syntax-key-word">jo</span> word:if?   <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,if,make-jojo    <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> add-rule
     <span class="cicada-nymph-syntax-key-word">jo</span> word:else? <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,else,make-jojo  <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> add-rule
     <span class="cicada-nymph-syntax-key-word">jo</span> word:then? <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,then,make-jojo  <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> add-rule

     <span class="cicada-nymph-syntax-key-word">jo</span> word:prepare-for?
     <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,prepare-for,make-jojo
     <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> add-rule
     <span class="cicada-nymph-syntax-key-word">jo</span> word:exception-reset-stack?
     <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,exception-reset-stack,make-jojo
     <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> add-rule

     <span class="cicada-nymph-syntax-key-word">jo</span> word:loop?  <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,loop,make-jojo  <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> add-rule
     <span class="cicada-nymph-syntax-key-word">jo</span> word:recur? <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,recur,make-jojo <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> add-rule
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-title">more</span>,rule-set,make-jojo
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* name</span>
<span class="org-level-2">** </span><span class="org-todo">note</span>
   * the name-hash-table
     is used both in cicada-nymph and cicada-language
<span class="org-level-2">** allocate</span>
<span class="org-level-3">*** </span><span class="org-todo">note</span>
    * an interface of <span class="bold">*un-initialized-memory*</span>
<span class="org-level-3">*** allocate-memory</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">allocate-memory</span>
      <span class="cicada-nymph-comment">&lt;&lt; size -- address &gt;&gt;</span>
      dup <span class="cicada-nymph-variable">*un-initialized-memory,current-free-address*</span> clear-memory
      <span class="cicada-nymph-variable">*un-initialized-memory,current-free-address*</span> swap <span class="cicada-nymph-comment">&lt;&lt; address as return value &gt;&gt;</span>
      <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*un-initialized-memory,current-free-address*</span> add-save
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** memory allocation</span>
   * the following are some prime number
     ready to be used
     * 1000003   about 976 k
     * 1000033
     * 1000333
     * 100003    about 97 k
     * 100333
     * 997
     * 499
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-number">100333</span>
   <span class="cicada-nymph-comment">&lt;&lt; drop 13 &gt;&gt;</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*name-hash-table,size*</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

   <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">5</span> mul
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*name-hash-table,unit*</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

   <span class="cicada-nymph-variable">*name-hash-table,size*</span>
   <span class="cicada-nymph-variable">*name-hash-table,unit*</span> mul <span class="cicada-nymph-allocate">allocate-memory</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*name-hash-table*</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

   <span class="cicada-nymph-number">0</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*name-hash-table,counter*</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** name</span>
<span class="org-level-3">*** </span><span class="org-todo">note</span>
    * a name is an index into name-hash-table
    * an entry can be viewed
      1. as a point
      2. as an orbit
    * in a name entry we have the following fields
      <span class="org-table">|------+---------------------|</span>
      <span class="org-table">| name | name-string-address |</span>
      <span class="org-table">|      | name-string-length  |</span>
      <span class="org-table">|------+---------------------|</span>
      <span class="org-table">|      | orbit-length        |</span>
      <span class="org-table">|      | orbiton             |</span>
      <span class="org-table">|      | jo                  |</span>
      <span class="org-table">|------+---------------------|</span>
      1. name-string-address
         0 denotes name not used
      2. orbit-length
         as an orbit
         its length gets updated
      3. as a point
         it is on an orbit
      4. jo
         0 denotes name not used as jo
<span class="org-level-3">*** name-&gt;address</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-&gt;address</span>
      <span class="cicada-nymph-comment">&lt;&lt; name -- address &gt;&gt;</span>
      <span class="cicada-nymph-variable">*name-hash-table,unit*</span> mul
      <span class="cicada-nymph-variable">*name-hash-table*</span> add
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,used?</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,used?</span>
      <span class="cicada-nymph-comment">&lt;&lt; name -- bool &gt;&gt;</span>
      name-&gt;address
      fetch zero? false?
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,used-as-jo?</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,used-as-jo?</span>
      <span class="cicada-nymph-comment">&lt;&lt; name -- bool &gt;&gt;</span>
      name-&gt;address
      <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">4</span> mul add
      fetch zero? not
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name-&gt;string</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-&gt;string</span>
      <span class="cicada-nymph-comment">&lt;&lt; name -- string[address, length] &gt;&gt;</span>
      name-&gt;address
      <span class="cicada-nymph-number">2</span> n-fetch
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,fetch-orbit-length</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,fetch-orbit-length</span>
      <span class="cicada-nymph-comment">&lt;&lt; name -- orbit-length &gt;&gt;</span>
      name-&gt;address
      <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">2</span> mul add
      fetch
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,fetch-orbiton</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,fetch-orbiton</span>
      <span class="cicada-nymph-comment">&lt;&lt; name -- orbiton &gt;&gt;</span>
      name-&gt;address
      <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">3</span> mul add
      fetch
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,fetch-jo</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,fetch-jo</span>
      <span class="cicada-nymph-comment">&lt;&lt; name -- jo &gt;&gt;</span>
      name-&gt;address
      <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">4</span> mul add
      fetch
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,save-string</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,save-string</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length], name -- &gt;&gt;</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:name</span>
      make-string
      <span class="cicada-nymph-fetch-local-variable-1">:name</span> name-&gt;address
      <span class="cicada-nymph-number">2</span> n-save
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,save-string,share</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,save-string,share</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length], name -- &gt;&gt;</span>
      name-&gt;address
      <span class="cicada-nymph-number">2</span> n-save
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,save-orbit-length</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,save-orbit-length</span>
      <span class="cicada-nymph-comment">&lt;&lt; orbit-length, name -- &gt;&gt;</span>
      name-&gt;address
      <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">2</span> mul add
      save
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,save-orbiton</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,save-orbiton</span>
      <span class="cicada-nymph-comment">&lt;&lt; orbiton, name -- &gt;&gt;</span>
      name-&gt;address
      <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">3</span> mul add
      save
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,save-jo</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,save-jo</span>
      <span class="cicada-nymph-comment">&lt;&lt; jo, name -- &gt;&gt;</span>
      name-&gt;address
      <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">4</span> mul add
      save
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name,no-collision?</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,no-collision?</span>
      <span class="cicada-nymph-comment">&lt;&lt; name -- bool &gt;&gt;</span>
      dup <span class="cicada-nymph-title">name</span>,fetch-orbiton
      equal?
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** name-hash-table</span>
<span class="org-level-3">*** </span><span class="org-todo">note</span><span class="org-level-3"> interface</span>
    * open addressing
      for we do not need to delete
    * math
      * hash
    * memory
      * insert
      * search
    * function
      * string-&gt;name
      * name-&gt;string
<span class="org-level-3">*** name-hash-table,hash</span>
    * prime table size
    * linear probing
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,hash</span>
      <span class="cicada-nymph-comment">&lt;&lt; number, counter -- index &gt;&gt;</span>
      add <span class="cicada-nymph-variable">*name-hash-table,size*</span> mod
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** string-&gt;finite-carry-sum</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-number">16</span>
    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*max-carry-position*</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">string-&gt;finite-carry-sum,loop</span>
      <span class="cicada-nymph-comment">&lt;&lt; carry-sum, string[address, length], counter -- carry-sum &gt;&gt;</span>
      over zero? <span class="cicada-nymph-syntax-key-word">if</span>
        drop drop2
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup <span class="cicada-nymph-variable">*max-carry-position*</span> greater-than? <span class="cicada-nymph-syntax-key-word">if</span>
        drop <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-comment">&lt;&lt; re-start from 0 &gt;&gt;</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      xx|over|x
      <span class="cicada-nymph-title">string-head</span>,byte over
      <span class="cicada-nymph-number">2</span> swap power
      mul
      x|swap|xxxx add xxx|swap|x
      add1 xx|swap|x
      <span class="cicada-nymph-title">string-tail</span>,byte x|swap|xx
      <span class="cicada-nymph-end">loop</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">string-&gt;finite-carry-sum</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- carry-sum &gt;&gt;</span>
      <span class="cicada-nymph-number">0</span> xx|swap|x <span class="cicada-nymph-comment">&lt;&lt; carry-sum &gt;&gt;</span>
      <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-comment">&lt;&lt; counter &gt;&gt;</span>
      <span class="cicada-nymph-title">string-&gt;finite-carry-sum</span>,loop
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name-hash-table,search</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,search,loop</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length], number, counter
         -- name, true
         -- name, false &gt;&gt;</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:counter</span> <span class="cicada-nymph-save-local-variable-1">&gt;:number</span> <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>
      <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-fetch-local-variable-1">:counter</span> <span class="cicada-nymph-title">name-hash-table</span>,hash
      <span class="cicada-nymph-save-local-variable-1">&gt;:name</span>
      <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">name-hash-table</span>,hash
      <span class="cicada-nymph-save-local-variable-1">&gt;:orbit</span>
      <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-title">name</span>,used? false? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-bool">false</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-1">:name</span> name-&gt;string
      <span class="cicada-nymph-fetch-local-variable-2">::string</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-bool">true</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-title">name</span>,fetch-orbit-length
      <span class="cicada-nymph-fetch-local-variable-1">:counter</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-bool">false</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-2">::string</span>
      <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-fetch-local-variable-1">:counter</span> add1
      <span class="cicada-nymph-end">loop</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,search</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length]
         -- name, true
         -- name, false &gt;&gt;</span>
      dup2 string-&gt;finite-carry-sum
      <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">name-hash-table</span>,search,loop
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name-hash-table,insert</span>
    * I found that (insert) can not re-use (search)
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,insert,loop</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length], number, counter
         -- name, true
         -- name, false &gt;&gt;</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:counter</span> <span class="cicada-nymph-save-local-variable-1">&gt;:number</span> <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>
      <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-fetch-local-variable-1">:counter</span> <span class="cicada-nymph-title">name-hash-table</span>,hash
      <span class="cicada-nymph-save-local-variable-1">&gt;:name</span>
      <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">name-hash-table</span>,hash
      <span class="cicada-nymph-save-local-variable-1">&gt;:orbit</span>
      <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-title">name</span>,used? false? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-fetch-local-variable-1">:name</span>
        <span class="cicada-nymph-title">name</span>,save-string
        <span class="cicada-nymph-fetch-local-variable-1">:orbit</span> <span class="cicada-nymph-fetch-local-variable-1">:name</span>
        <span class="cicada-nymph-title">name</span>,save-orbiton
        <span class="cicada-nymph-fetch-local-variable-1">:counter</span> <span class="cicada-nymph-fetch-local-variable-1">:orbit</span>
        <span class="cicada-nymph-title">name</span>,save-orbit-length
        <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*name-hash-table,counter*</span> add-save
        <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-bool">true</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-1">:name</span> name-&gt;string
      <span class="cicada-nymph-fetch-local-variable-2">::string</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-bool">true</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-1">:counter</span> <span class="cicada-nymph-variable">*name-hash-table,size*</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-bool">false</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-2">::string</span>
      <span class="cicada-nymph-fetch-local-variable-1">:number</span>
      <span class="cicada-nymph-fetch-local-variable-1">:counter</span> add1
      <span class="cicada-nymph-end">loop</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,insert</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length]
         -- name, true
         -- name, false &gt;&gt;</span>
      dup2 string-&gt;finite-carry-sum
      <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">name-hash-table</span>,insert,loop
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name-hash-table,insert,share</span>
    * I found that (insert) can not re-use (search)
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,insert,share,loop</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length], number, counter
         -- name, true
         -- name, false &gt;&gt;</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:counter</span> <span class="cicada-nymph-save-local-variable-1">&gt;:number</span> <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>
      <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-fetch-local-variable-1">:counter</span> <span class="cicada-nymph-title">name-hash-table</span>,hash
      <span class="cicada-nymph-save-local-variable-1">&gt;:name</span>
      <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">name-hash-table</span>,hash
      <span class="cicada-nymph-save-local-variable-1">&gt;:orbit</span>
      <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-title">name</span>,used? false? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-fetch-local-variable-1">:name</span>
        <span class="cicada-nymph-title">name</span>,save-string,share
        <span class="cicada-nymph-fetch-local-variable-1">:orbit</span> <span class="cicada-nymph-fetch-local-variable-1">:name</span>
        <span class="cicada-nymph-title">name</span>,save-orbiton
        <span class="cicada-nymph-fetch-local-variable-1">:counter</span> <span class="cicada-nymph-fetch-local-variable-1">:orbit</span>
        <span class="cicada-nymph-title">name</span>,save-orbit-length
        <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*name-hash-table,counter*</span> add-save
        <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-bool">true</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-1">:name</span> name-&gt;string
      <span class="cicada-nymph-fetch-local-variable-2">::string</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-bool">true</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-1">:counter</span> <span class="cicada-nymph-variable">*name-hash-table,size*</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-bool">false</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-2">::string</span>
      <span class="cicada-nymph-fetch-local-variable-1">:number</span>
      <span class="cicada-nymph-fetch-local-variable-1">:counter</span> add1
      <span class="cicada-nymph-end">loop</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,insert,share</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length]
         -- name, true
         -- name, false &gt;&gt;</span>
      dup2 string-&gt;finite-carry-sum
      <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">name-hash-table</span>,insert,share,loop
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** string-&gt;name</span>
    * error handling here
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">string-&gt;name</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- name &gt;&gt;</span>
      <span class="cicada-nymph-title">name-hash-table</span>,insert
      false? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-string">"* (string-&gt;name) *name-hash-table* is full!"</span> .s .l
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** string-&gt;name,share</span>
    * error handling here
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">string-&gt;name,share</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- name &gt;&gt;</span>
      <span class="cicada-nymph-title">name-hash-table</span>,insert,share
      false? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-string">"* (string-&gt;name,share) *name-hash-table* is full!"</span> .s .l
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-variable">*string-area,current-free-address*</span> .
    <span class="cicada-nymph-string">"12345,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share .
    <span class="cicada-nymph-variable">*string-area,current-free-address*</span> .
    <span class="cicada-nymph-string">"12345,no-share"</span> string-&gt;name .
    <span class="cicada-nymph-variable">*string-area,current-free-address*</span> .
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-todo">note</span><span class="org-level-3"> about report</span>
    * report point orbit by orbit
      in the following format
    * {index} string # orbit-lenght
      * {index} string
      * {index} string
      * {index} string
    * if used as title
      add a (AS TITLE) as postfix
<span class="org-level-3">*** name-hash-table,report</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,report,orbit</span>
      <span class="cicada-nymph-comment">&lt;&lt; name, counter -- &gt;&gt;</span>
      over <span class="cicada-nymph-title">name</span>,fetch-orbit-length
      over less-than? <span class="cicada-nymph-syntax-key-word">if</span>
        drop2
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      over name-&gt;string string-&gt;finite-carry-sum
      over <span class="cicada-nymph-title">name-hash-table</span>,hash
      dup <span class="cicada-nymph-title">name</span>,fetch-orbiton
      <span class="cicada-nymph-comment">&lt;&lt; name, counter, new-name, orbiton &gt;&gt;</span>
      x|over|xxx name-&gt;string string-&gt;finite-carry-sum
      <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">name-hash-table</span>,hash
      equal? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-string">"  {"</span> .s
        dup write-number
        <span class="cicada-nymph-string">"} "</span> .s
        name-&gt;string .s
        .l
      <span class="cicada-nymph-syntax-key-word">else</span>
        drop
      <span class="cicada-nymph-syntax-key-word">then</span>
      add1
      <span class="cicada-nymph-end">loop</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,report,loop</span>
      <span class="cicada-nymph-comment">&lt;&lt; name -- &gt;&gt;</span>
      dup <span class="cicada-nymph-variable">*name-hash-table,size*</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
        drop
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup <span class="cicada-nymph-title">name</span>,used? <span class="cicada-nymph-syntax-key-word">if</span>
      dup <span class="cicada-nymph-title">name</span>,no-collision? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-comment">&lt;&lt; * {index} string # orbit-lenght &gt;&gt;</span>
        <span class="cicada-nymph-string">"* {"</span> .s
        dup write-number
        <span class="cicada-nymph-string">"} "</span> .s
        dup name-&gt;string .s
        <span class="cicada-nymph-string">" # "</span> .s
        dup <span class="cicada-nymph-title">name</span>,fetch-orbit-length
        write-number
        .l
        dup <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-title">name-hash-table</span>,report,orbit
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      add1
      <span class="cicada-nymph-end">loop</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,report</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">name-hash-table</span>,report,loop
      <span class="cicada-nymph-string">"* totally : "</span> .s
      <span class="cicada-nymph-variable">*name-hash-table,counter*</span> write-number
      .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span>
    * set <span class="bold">*name-hash-table,size*</span> to a small number [for example 13]
      then use the following function
      and (name-hash-table,report) to do test
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,name-hash-table</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-string">"a-000"</span> string-&gt;name . .l
      <span class="cicada-nymph-string">"a-111"</span> string-&gt;name . .l
      <span class="cicada-nymph-string">"a-222"</span> string-&gt;name . .l
      <span class="cicada-nymph-string">"a-333"</span> string-&gt;name . .l
      <span class="cicada-nymph-string">"a-444"</span> string-&gt;name . .l
      <span class="cicada-nymph-string">"a-555"</span> string-&gt;name . .l
      <span class="cicada-nymph-string">"a-666"</span> string-&gt;name . .l
      <span class="cicada-nymph-string">"a-777"</span> string-&gt;name . .l
      <span class="cicada-nymph-string">"a-888"</span> string-&gt;name . .l
      <span class="cicada-nymph-string">"a-999"</span> string-&gt;name . .l
      <span class="cicada-nymph-string">"b-000"</span> string-&gt;name . .l
      <span class="cicada-nymph-string">"b-111"</span> string-&gt;name . .l
      <span class="cicada-nymph-string">"b-222"</span> string-&gt;name . .l
      <span class="cicada-nymph-string">"b-333"</span> string-&gt;name . .l
      <span class="cicada-nymph-string">"b-444"</span> string-&gt;name . .l
      <span class="cicada-nymph-string">"b-555"</span> string-&gt;name . .l
      <span class="cicada-nymph-string">"b-666"</span> string-&gt;name . .l
      <span class="cicada-nymph-string">"b-777"</span> string-&gt;name . .l
      <span class="cicada-nymph-string">"b-888"</span> string-&gt;name . .l
      <span class="cicada-nymph-string">"b-999"</span> string-&gt;name . .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,name-hash-table,share</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-string">"a-000,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-string">"a-111,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-string">"a-222,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-string">"a-333,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-string">"a-444,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-string">"a-555,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-string">"a-666,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-string">"a-777,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-string">"a-888,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-string">"a-999,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-string">"b-000,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-string">"b-111,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-string">"b-222,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-string">"b-333,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-string">"b-444,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-string">"b-555,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-string">"b-666,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-string">"b-777,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-string">"b-888,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-string">"b-999,share"</span> <span class="cicada-nymph-title">string-&gt;name</span>,share . .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-XdataX">&lt;report&gt;</span> memory

    <span class="cicada-nymph-title">test</span>,name-hash-table,share
    <span class="cicada-nymph-XdataX">&lt;report&gt;</span> memory

    <span class="cicada-nymph-title">test</span>,name-hash-table
    <span class="cicada-nymph-XdataX">&lt;report&gt;</span> memory

    <span class="cicada-nymph-title">name-hash-table</span>,report
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name-hash-table,save-jo,by-link</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,save-jo,by-link</span>
      <span class="cicada-nymph-comment">&lt;&lt; link -- &gt;&gt;</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:link</span>
      <span class="cicada-nymph-fetch-local-variable-1">:link</span> link-&gt;jo
      <span class="cicada-nymph-fetch-local-variable-1">:link</span> link-&gt;name-string <span class="cicada-nymph-title">string-&gt;name</span>,share
      <span class="cicada-nymph-title">name</span>,save-jo
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name-hash-table,find-jo</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,find-jo</span>
      <span class="cicada-nymph-comment">&lt;&lt; word[address, length]
         -- jo, true
         -- false &gt;&gt;</span>
      <span class="cicada-nymph-title">name-hash-table</span>,search <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-syntax-key-word">else</span>
        drop
        <span class="cicada-nymph-bool">false</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup <span class="cicada-nymph-title">name</span>,used-as-jo? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-title">name</span>,fetch-jo
        <span class="cicada-nymph-bool">true</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      drop
      <span class="cicada-nymph-bool">false</span>
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** name-hash-table,delete-jo</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,delete-jo</span>
      <span class="cicada-nymph-comment">&lt;&lt; jo -- &gt;&gt;</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:jo</span>
      <span class="cicada-nymph-fetch-local-variable-1">:jo</span> jo-&gt;name-string <span class="cicada-nymph-title">string-&gt;name</span>,share <span class="cicada-nymph-save-local-variable-1">&gt;:name</span>
      <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-title">name</span>,save-jo
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-string">"add"</span> <span class="cicada-nymph-title">name-hash-table</span>,find-jo
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-1">* string</span>
<span class="org-level-2">** n-string-&gt;buffer!</span>
   * this function return length
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">n-string-&gt;buffer!,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; string-1[address, length],
        ...
        string-2[address, length],
        buffer, n, cursor
        -- length &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:n</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
     <span class="cicada-nymph-fetch-local-variable-1">:n</span> zero? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
       <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> sub
       string-reverse!
       swap drop
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
       <span class="cicada-nymph-fetch-local-variable-1">:n</span> sub1
       <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
       <span class="cicada-nymph-end">loop</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     dup2 add sub1 fetch-byte <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> save-byte
     sub1
     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
     <span class="cicada-nymph-fetch-local-variable-1">:n</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add1
     <span class="cicada-nymph-end">loop</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">n-string-&gt;buffer!</span>
     <span class="cicada-nymph-comment">&lt;&lt; string-1[address, length],
        ...
        string-2[address, length],
        buffer, n
        -- length &gt;&gt;</span>
     over <span class="cicada-nymph-title">n-string-&gt;buffer!</span>,loop
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*test,buffer*</span>
     <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-memory</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable</span>

   <span class="cicada-nymph-string">"/home"</span> <span class="cicada-nymph-string">"/xyh"</span> <span class="cicada-nymph-string">"/cicada"</span>
   <span class="cicada-nymph-variable">*test,buffer*</span>
   <span class="cicada-nymph-number">3</span> n-string-&gt;buffer!
   <span class="cicada-nymph-variable">*test,buffer*</span> swap
   .s
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* definers</span>
<span class="org-level-2">** &lt;word&gt;?</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;word&gt;?</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- bool &gt;&gt;</span>
     dup <span class="cicada-nymph-number">2</span> less-or-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     dup2 <span class="cicada-nymph-title">string-end</span>,byte
     <span class="cicada-nymph-string">"&gt;"</span> <span class="cicada-nymph-title">string-end</span>,byte equal? not <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-title">string-head</span>,byte
     <span class="cicada-nymph-string">"&lt;"</span> <span class="cicada-nymph-title">string-head</span>,byte equal?
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** make-jojo                          </span><span class="org-level-2"><span class="org-tag">:redefine:</span></span>
<span class="org-level-3">*** </span><span class="org-todo">&#35352;</span><span class="org-level-3"> ad hoc</span>
    * &#36889;&#35023;&#23565; name-hash-table &#30340; undo &#26159; ad hoc
      &#22240;&#29234;&#27794;&#27861;&#37325;&#26032;&#23450;&#32681; (!undo-make-jojo)
      &#22240;&#29234;&#26377;&#22826;&#22810;&#30340;&#20989;&#25976;&#35519;&#29992;&#23427;&#20102;
    * &#21482;&#26377;&#30070;&#26377;&#33258;&#24049;&#30340;&#21295;&#32232;&#22120;&#30340;&#26178;&#20505; &#25165;&#33021;&#35299;&#38500;&#36889;&#20491; ad hoc
    * &#20006;&#19988;
      &#27492;&#26178;&#21482;&#26377;&#23565; <span class="bold">*link*</span> &#30340; undo
      &#20294;&#26159;&#27794;&#26377;&#23565; (define-function,with-title) &#20013;&#30340;
      :address,link,title &#30340; undo
      &#36889;&#26159;&#37679;&#35492;&#30340; &#36889;&#23566;&#33268; :address,link,title &#22312;&#19981;&#24517;&#35201;&#22320;&#22686;&#38263;
      &#20294;&#26159;&#36889;&#19981;&#26159;&#30693;&#21517;&#30340;&#37679;&#35492;
      &#22240;&#29234;
      &#22312;&#35519;&#29992;&#30340;&#26178;&#20505; &#29992;&#30340;&#26159; name-hash-table &#20358;&#20570;&#26597;&#25214;
      &#32780;&#19981;&#26159;&#29992; link &#20358;&#26597;&#25214;
<span class="org-level-3">*** make-jojo,dispatch-word</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">make-jojo,dispatch-word</span>
      <span class="cicada-nymph-comment">&lt;&lt; jo, string[address, length], word[address, length] --
         jo, string[address, length] &gt;&gt;</span>
      dup2 find-syntax <span class="cicada-nymph-syntax-key-word">if</span>
        apply
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup2 <span class="cicada-nymph-title">name-hash-table</span>,find-jo <span class="cicada-nymph-syntax-key-word">if</span>
        xx|swap|x drop2
        <span class="cicada-nymph-title">jojo-area</span>,stay
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-string">"* (make-jojo) meets undefined word : "</span> .s .s .l
      x|over|xx <span class="cicada-nymph-title">name-hash-table</span>,delete-jo
      <span class="cicada-nymph-exception">!undo-make-jojo</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** make-jojo</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">make-jojo,loop</span>
      <span class="cicada-nymph-comment">&lt;&lt; jo, string[address, length] -- &gt;&gt;</span>
      dup2 space-string? <span class="cicada-nymph-syntax-key-word">if</span>
        drop2
        drop
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup2
      <span class="cicada-nymph-title">string-tail</span>,word
      xx|swap|xx
      <span class="cicada-nymph-title">string-head</span>,word
      <span class="cicada-nymph-title">make-jojo</span>,dispatch-word
      <span class="cicada-nymph-end">loop</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">make-jojo</span>
      <span class="cicada-nymph-comment">&lt;&lt; jo, string[address, length] -- &gt;&gt;</span>
      <span class="cicada-nymph-title">local-variable-table</span>,clear
      <span class="cicada-nymph-variable">*rule-set,make-jojo*</span>
      push-syntax-stack
      <span class="cicada-nymph-title">make-jojo</span>,loop
      drop-syntax-stack
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** init,name-hash-table,jo</span>
<span class="org-level-3">*** </span><span class="org-todo">note</span>
    * the function should be executed right after
      (define-function) is redefined
    * the function loads a jo into a entry in the name-hash-table
      only when the entry is not already used as jo
    * thus
      if a jo is redefined in the link
      only the newist get saved into name-hash-table
    * you can see
      how the features above
      make the re-definition of (define-function) hard to test
    * note that
      the interface of (name-hash-table,search)
      is not as usual find
<span class="org-level-3">*** </span><span class="org-todo">&#35352;</span>
    * &#27880;&#24847;&#36889;&#20491;&#21021;&#22987;&#21270;&#20989;&#25976;
      &#20006;&#19981;&#34389;&#29702;&#24118;&#26377; &lt;title&gt; &#30340;&#20989;&#25976;
<span class="org-level-3">*** init,name-hash-table,by-link</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">init,name-hash-table,by-link</span>
      <span class="cicada-nymph-comment">&lt;&lt; link -- &gt;&gt;</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:link</span>
      <span class="cicada-nymph-fetch-local-variable-1">:link</span> zero? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-1">:link</span> link-&gt;name-string <span class="cicada-nymph-save-local-variable-2">&gt;::name-string</span>
      <span class="cicada-nymph-fetch-local-variable-2">::name-string</span> <span class="cicada-nymph-title">name-hash-table</span>,search swap <span class="cicada-nymph-save-local-variable-1">&gt;:name</span> <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-title">name</span>,used-as-jo? <span class="cicada-nymph-syntax-key-word">if</span>
          <span class="cicada-nymph-fetch-local-variable-1">:link</span> link-&gt;next-link
          <span class="cicada-nymph-end">loop</span>
        <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-1">:link</span> <span class="cicada-nymph-title">name-hash-table</span>,save-jo,by-link
      <span class="cicada-nymph-fetch-local-variable-1">:link</span> link-&gt;next-link
      <span class="cicada-nymph-end">loop</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** define-function                    </span><span class="org-level-2"><span class="org-tag">:redefine:</span></span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">define-function</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- &gt;&gt;</span>
     <span class="cicada-nymph-variable">*string-area,current-free-address*</span> xx|swap|x
     <span class="cicada-nymph-variable">*jojo-area,current-free-address*</span> xx|swap|x
     <span class="cicada-nymph-variable">*link*</span> xx|swap|x
     <span class="cicada-nymph-comment">&lt;&lt; *string-area,current-free-address*
        *jojo-area,current-free-address*
        *link*
        string[address, length] &gt;&gt;</span>
     prepare-for
       <span class="cicada-nymph-exception">!undo-make-jojo</span>
       <span class="cicada-nymph-end">end</span>

     dup2 <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>

     <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-head</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::title</span>
     <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-title">string-head</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>
     <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::body</span>

     <span class="cicada-nymph-fetch-local-variable-2">::title</span> <span class="cicada-nymph-string">" "</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span>
     <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> dup <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
     <span class="cicada-nymph-number">3</span> n-string-&gt;buffer! <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span> <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>
     <span class="cicada-nymph-fetch-local-variable-2">::title</span> &lt;word&gt;? not <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-head</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>
       <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::body</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-2">::name</span>
     make-string <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>

     <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-variable">*link*</span> <span class="cicada-nymph-number">0</span>
     make-link <span class="cicada-nymph-save-local-variable-1">&gt;:link</span>

     <span class="cicada-nymph-fetch-local-variable-1">:link</span> <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*link*</span> save

     <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-variable">*explainer,function*</span> <span class="cicada-nymph-number">0</span>
     make-jo-head <span class="cicada-nymph-save-local-variable-1">&gt;:jo</span>

     <span class="cicada-nymph-fetch-local-variable-1">:jo</span> <span class="cicada-nymph-fetch-local-variable-1">:link</span> <span class="cicada-nymph-title">link</span>,save-jo

     <span class="cicada-nymph-fetch-local-variable-1">:link</span> <span class="cicada-nymph-title">name-hash-table</span>,save-jo,by-link

     <span class="cicada-nymph-variable">*jojo-area,current-free-address*</span> <span class="cicada-nymph-save-local-variable-1">&gt;:old-address</span>

     <span class="cicada-nymph-fetch-local-variable-1">:jo</span> <span class="cicada-nymph-fetch-local-variable-2">::body</span> make-jojo

     <span class="cicada-nymph-variable">*jojo-area,current-free-address*</span>
     <span class="cicada-nymph-fetch-local-variable-1">:old-address</span> sub <span class="cicada-nymph-variable">*jo-size*</span> div
     <span class="cicada-nymph-fetch-local-variable-1">:jo</span> <span class="cicada-nymph-title">jo</span>,save-length

     drop2
     drop
     drop
     drop
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** to load link into name-hash-table</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-variable">*link*</span> <span class="cicada-nymph-title">init</span>,name-hash-table,by-link
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** define-variable,with-tos           </span><span class="org-level-2"><span class="org-tag">:redefine:</span></span>
   * not undo is needed for define-variable,with-tos
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">define-variable,with-tos</span>
     <span class="cicada-nymph-comment">&lt;&lt; value, string[address, length] -- &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:value</span>

     <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-head</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::title</span>
     <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-title">string-head</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>

     <span class="cicada-nymph-fetch-local-variable-2">::title</span> <span class="cicada-nymph-string">" "</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span>
     <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> dup <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
     <span class="cicada-nymph-number">3</span> n-string-&gt;buffer! <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span> <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>
     <span class="cicada-nymph-fetch-local-variable-2">::title</span> &lt;word&gt;? not <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-fetch-local-variable-2">::title</span> <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-2">::name</span>
     make-string <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>

     <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-variable">*link*</span> <span class="cicada-nymph-number">0</span>
     make-link <span class="cicada-nymph-save-local-variable-1">&gt;:link</span>

     <span class="cicada-nymph-fetch-local-variable-1">:link</span> <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*link*</span> save

     <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-variable">*explainer,variable*</span> <span class="cicada-nymph-number">0</span>
     make-jo-head <span class="cicada-nymph-save-local-variable-1">&gt;:jo</span>

     <span class="cicada-nymph-fetch-local-variable-1">:jo</span> <span class="cicada-nymph-fetch-local-variable-1">:link</span> <span class="cicada-nymph-title">link</span>,save-jo

     <span class="cicada-nymph-fetch-local-variable-1">:link</span> <span class="cicada-nymph-title">name-hash-table</span>,save-jo,by-link

     <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-fetch-local-variable-1">:jo</span> <span class="cicada-nymph-title">jo</span>,save-length

     <span class="cicada-nymph-fetch-local-variable-1">:value</span> <span class="cicada-nymph-title">jojo-area</span>,stay
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** define-exception</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">define-exception</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- &gt;&gt;</span>
     <span class="cicada-nymph-variable">*string-area,current-free-address*</span> xx|swap|x
     <span class="cicada-nymph-variable">*jojo-area,current-free-address*</span> xx|swap|x
     <span class="cicada-nymph-variable">*link*</span> xx|swap|x
     <span class="cicada-nymph-comment">&lt;&lt; *string-area,current-free-address*
        *jojo-area,current-free-address*
        *link*
        string[address, length] &gt;&gt;</span>
     prepare-for
       <span class="cicada-nymph-exception">!undo-make-jojo</span>
       <span class="cicada-nymph-end">end</span>

     dup2 <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>

     <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-head</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::title</span>
     <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-title">string-head</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>
     <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::body</span>

     <span class="cicada-nymph-fetch-local-variable-2">::title</span> <span class="cicada-nymph-string">" "</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span>
     <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> dup <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
     <span class="cicada-nymph-number">3</span> n-string-&gt;buffer! <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>

     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span> <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>

     <span class="cicada-nymph-fetch-local-variable-2">::title</span> &lt;word&gt;? not <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-head</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>
       <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::body</span>
     <span class="cicada-nymph-syntax-key-word">then</span>

     <span class="cicada-nymph-fetch-local-variable-2">::name</span>
     make-string <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>

     <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-variable">*link*</span> <span class="cicada-nymph-number">0</span>
     make-link <span class="cicada-nymph-save-local-variable-1">&gt;:link</span>

     <span class="cicada-nymph-fetch-local-variable-1">:link</span> <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*link*</span> save

     <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-variable">*explainer,exception*</span> <span class="cicada-nymph-number">0</span>
     make-jo-head <span class="cicada-nymph-save-local-variable-1">&gt;:jo</span>

     <span class="cicada-nymph-fetch-local-variable-1">:jo</span> <span class="cicada-nymph-fetch-local-variable-1">:link</span> <span class="cicada-nymph-title">link</span>,save-jo

     <span class="cicada-nymph-fetch-local-variable-1">:link</span> <span class="cicada-nymph-title">name-hash-table</span>,save-jo,by-link

     <span class="cicada-nymph-variable">*jojo-area,current-free-address*</span> <span class="cicada-nymph-save-local-variable-1">&gt;:old-address</span>

     <span class="cicada-nymph-fetch-local-variable-1">:jo</span> <span class="cicada-nymph-fetch-local-variable-2">::body</span> make-jojo

     <span class="cicada-nymph-variable">*jojo-area,current-free-address*</span>
     <span class="cicada-nymph-fetch-local-variable-1">:old-address</span> sub <span class="cicada-nymph-variable">*jo-size*</span> div
     <span class="cicada-nymph-fetch-local-variable-1">:jo</span> <span class="cicada-nymph-title">jo</span>,save-length

     drop2
     drop
     drop
     drop
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** alias</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">alias</span>
     <span class="cicada-nymph-comment">&lt;&lt; alias[address, length], name[address, length] -- &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::name</span> <span class="cicada-nymph-save-local-variable-2">&gt;::alias</span>
     <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-title">name-hash-table</span>,find-jo <span class="cicada-nymph-syntax-key-word">if</span>
     <span class="cicada-nymph-syntax-key-word">else</span>
       <span class="cicada-nymph-string">"* (alias) fail"</span> .s .l
       <span class="cicada-nymph-string">"  because can not find name in name-hash-table"</span> .s .l
       <span class="cicada-nymph-string">"  alias : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::alias</span> .s .l
       <span class="cicada-nymph-string">"  name : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::name</span> .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:jo</span>
     <span class="cicada-nymph-fetch-local-variable-2">::alias</span> <span class="cicada-nymph-variable">*link*</span> <span class="cicada-nymph-fetch-local-variable-1">:jo</span>
     make-link <span class="cicada-nymph-save-local-variable-1">&gt;:link</span>

     <span class="cicada-nymph-fetch-local-variable-1">:link</span> <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*link*</span> save

     <span class="cicada-nymph-fetch-local-variable-1">:link</span> <span class="cicada-nymph-title">name-hash-table</span>,save-jo,by-link
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span><span class="org-level-2"> variable</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-number">233</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*three*</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">add-three</span> <span class="cicada-nymph-variable">*three*</span> add <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
   <span class="cicada-nymph-number">1</span> add-three . <span class="cicada-nymph-comment">&lt;&lt; 234 &gt;&gt;</span>

   <span class="cicada-nymph-comment">&lt;&lt; you get the address of the variable *three*
      by add "address" in front of it &gt;&gt;</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">fix-*three*</span> <span class="cicada-nymph-number">3</span> <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*three*</span> save <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
   fix-*three*
   <span class="cicada-nymph-number">1</span> add-three . <span class="cicada-nymph-comment">&lt;&lt; 4 &gt;&gt;</span>

   <span class="cicada-nymph-comment">&lt;&lt; with-title &gt;&gt;</span>
   <span class="cicada-nymph-number">233</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;test-title&gt;</span> <span class="cicada-nymph-variable">*three*</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">add-three</span> <span class="cicada-nymph-XdataX">&lt;test-title&gt;</span> <span class="cicada-nymph-variable">*three*</span> add <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
   <span class="cicada-nymph-number">1</span> add-three . <span class="cicada-nymph-comment">&lt;&lt; 234 &gt;&gt;</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span><span class="org-level-2"> function</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">k</span> <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">3</span> add add . <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
   k

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">k</span> <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">3</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
   k add add .

   <span class="cicada-nymph-comment">&lt;&lt; error &gt;&gt;</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">k</span> no <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>


   <span class="cicada-nymph-comment">&lt;&lt; with-title &gt;&gt;</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;test-title&gt; test-name</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"TEST"</span> .s .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,syntax,&lt;title&gt;,make-jojo</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-XdataX">&lt;test-title&gt;</span> test-name
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-title">test</span>,syntax,&lt;title&gt;,make-jojo

   <span class="cicada-nymph-comment">&lt;&lt; error &gt;&gt;</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;test-title&gt; test-name,testing-undefine</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     testing-undefine
     <span class="cicada-nymph-string">"TEST"</span> .s .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,syntax,&lt;title&gt;,make-jojo,testing-undefine</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-XdataX">&lt;test-title&gt;</span> <span class="cicada-nymph-title">test-name</span>,testing-undefine
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-title">test</span>,syntax,&lt;title&gt;,make-jojo,testing-undefine
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span><span class="org-level-2"> alias</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-string">"adba"</span> <span class="cicada-nymph-string">"add"</span> alias
   <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">2</span> adba .

   <span class="cicada-nymph-string">"&lt;test-title&gt; add"</span> <span class="cicada-nymph-string">"add"</span> alias
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,alias</span>
     <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-XdataX">&lt;test-title&gt;</span> add .
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
   <span class="cicada-nymph-title">test</span>,alias

   <span class="cicada-nymph-comment">&lt;&lt; error &gt;&gt;</span>
   <span class="cicada-nymph-string">"ab"</span> <span class="cicada-nymph-string">"ad"</span> alias
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* more syntax for definer</span>
<span class="org-level-2">** &lt;title&gt;                            </span><span class="org-level-2"><span class="org-tag">:syntax:</span></span>
<span class="org-level-3">*** </span><span class="org-todo">note</span>
    * &lt;title&gt; in <span class="bold">*rule-set,make-jojo*</span>
      &lt;title&gt; name
      save a jo into <span class="bold">*jojo-area*</span>
    * &lt;title&gt; in <span class="bold">*rule-set,basic-REPL*</span>
      &lt;title&gt; name
      execute a jo
<span class="org-level-3">*** name-hash-table,find-jo,with-title</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,find-jo,with-title</span>
      <span class="cicada-nymph-comment">&lt;&lt; title[address, length], word[address, length]
         -- jo, true
         -- false &gt;&gt;</span>
      <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
      <span class="cicada-nymph-string">" "</span> xx|swap|xx
      <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
      <span class="cicada-nymph-number">3</span> n-string-&gt;buffer! <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
      <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
      <span class="cicada-nymph-fetch-local-variable-1">:length</span>
      <span class="cicada-nymph-title">name-hash-table</span>,search <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-syntax-key-word">else</span>
        drop
        <span class="cicada-nymph-bool">false</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup <span class="cicada-nymph-title">name</span>,used-as-jo? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-title">name</span>,fetch-jo
        <span class="cicada-nymph-bool">true</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      drop
      <span class="cicada-nymph-bool">false</span>
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** syntax,&lt;title&gt;,make-jojo</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,&lt;title&gt;,make-jojo</span>
      <span class="cicada-nymph-comment">&lt;&lt; jo, string[address, length], &lt;title&gt;[address, length] --
         jo, string[address, length] &gt;&gt;</span>
      <span class="cicada-nymph-save-local-variable-2">&gt;::title</span>
      <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:jo</span>
      <span class="cicada-nymph-fetch-local-variable-2">::title</span> <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-head</span>,word
      <span class="cicada-nymph-title">name-hash-table</span>,find-jo,with-title <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-title">jojo-area</span>,stay
      <span class="cicada-nymph-syntax-key-word">else</span>
        <span class="cicada-nymph-string">"* (syntax,&lt;title&gt;,make-jojo) meet undefined"</span> .s .l
        <span class="cicada-nymph-string">"  title : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::title</span> .s .l
        <span class="cicada-nymph-string">"  name  : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-head</span>,word .s .l
        <span class="cicada-nymph-fetch-local-variable-1">:jo</span> <span class="cicada-nymph-title">name-hash-table</span>,delete-jo
        <span class="cicada-nymph-exception">!undo-make-jojo</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-1">:jo</span>
      <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-tail</span>,word
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** more,rule-set,make-jojo</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">more,rule-set,make-jojo</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-syntax-key-word">jo</span> &lt;word&gt;?
      <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,&lt;title&gt;,make-jojo
      <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> add-rule
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-title">more</span>,rule-set,make-jojo
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;test-title&gt; test-name</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-string">"TEST"</span> .s .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,syntax,&lt;title&gt;,make-jojo</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-XdataX">&lt;test-title&gt;</span> test-name
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-title">test</span>,syntax,&lt;title&gt;,make-jojo


    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;test-title&gt; test-name,testing-undefine</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      testing-undefine
      <span class="cicada-nymph-string">"TEST"</span> .s .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,syntax,&lt;title&gt;,make-jojo,testing-undefine</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-XdataX">&lt;test-title&gt;</span> <span class="cicada-nymph-title">test-name</span>,testing-undefine
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-title">test</span>,syntax,&lt;title&gt;,make-jojo,testing-undefine
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** un-named function                  </span><span class="org-level-2"><span class="org-tag">:syntax:</span></span>
<span class="org-level-3">*** string,find-word</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">string,find-word</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length], word[address, length]
         -- sub-string[address, length], true
         -- false &gt;&gt;</span>
      xx|over|xx space-string? <span class="cicada-nymph-syntax-key-word">if</span>
        drop2 drop2
        <span class="cicada-nymph-bool">false</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      xx|over|xx <span class="cicada-nymph-title">string-head</span>,word
      xx|over|xx string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
        drop2
        <span class="cicada-nymph-bool">true</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      xx|swap|xx <span class="cicada-nymph-title">string-tail</span>,word
      xx|swap|xx
      <span class="cicada-nymph-end">loop</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-string">"111 222 333"</span> <span class="cicada-nymph-string">"222"</span> <span class="cicada-nymph-title">string</span>,find-word <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-title">string-head</span>,word .s
    <span class="cicada-nymph-syntax-key-word">then</span>

    <span class="cicada-nymph-string">"111 222 333"</span> <span class="cicada-nymph-string">"444"</span> <span class="cicada-nymph-title">string</span>,find-word <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-title">string-head</span>,word .s
    <span class="cicada-nymph-syntax-key-word">then</span>

    <span class="cicada-nymph-string">"111 222 [] 333"</span> <span class="cicada-nymph-string">"["</span> <span class="cicada-nymph-title">string</span>,find-word <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-title">string-head</span>,word .s
    <span class="cicada-nymph-syntax-key-word">then</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-todo">note</span><span class="org-level-3"> side-effect</span>
    * side-effect on function [un-named or named] is actually not so needed
      for function is mainly used to encode algorithm
    * but side-effect on function is always possible when needed
<span class="org-level-3">*** </span><span class="org-todo">note</span><span class="org-level-3"> scope of named-local-variable</span>
    * in named function or un-named function
      the scope of named-local-variable is linear
<span class="org-level-3">*** word:square-bar?</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">word:square-bar?</span>
      <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- bool &gt;&gt;</span>
      <span class="cicada-nymph-string">"["</span> string-equal?
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** word:square-ket?</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">word:square-ket?</span>
      <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- bool &gt;&gt;</span>
      <span class="cicada-nymph-string">"]"</span> string-equal?
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-todo">note</span><span class="org-level-3"> memory usage</span>
    * for the array can be nested
      we must allocate the memory in place
      a branch is there helping us to achieve this
    * [dup drop end]
      <span class="org-table">|-------------------|</span>
      <span class="org-table">| branch            |</span>
      <span class="org-table">| offset to jo      |</span>
      <span class="org-table">|-------------------|</span>
      <span class="org-table">| &lt;jo-head&gt;         |</span>
      <span class="org-table">|-------------------|</span>
      <span class="org-table">| dup               |</span>
      <span class="org-table">| drop              |</span>
      <span class="org-table">| end               |</span>
      <span class="org-table">|-------------------|</span>
      <span class="org-table">| literal           |</span>
      <span class="org-table">| address of the jo |</span>
      <span class="org-table">|-------------------|</span>
<span class="org-level-3">*** syntax,square-bar,make-jojo</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,square-bar,make-jojo</span>
      <span class="cicada-nymph-comment">&lt;&lt; jo, string[address, length], word:square-bar --
         jo, string[address, length] &gt;&gt;</span>
      drop2
      <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>

      <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">instruction</span>,branch
        <span class="cicada-nymph-title">jojo-area</span>,stay
      <span class="cicada-nymph-variable">*jojo-area,current-free-address*</span> <span class="cicada-nymph-save-local-variable-1">&gt;:address,offset</span>
      <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">jojo-area</span>,stay

      "" <span class="cicada-nymph-variable">*explainer,function*</span> <span class="cicada-nymph-number">0</span>
      make-jo-head <span class="cicada-nymph-save-local-variable-1">&gt;:jo</span>

      <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-string">"]"</span> <span class="cicada-nymph-title">string</span>,find-word <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-syntax-key-word">else</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-2">::string</span> swap drop over sub <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
      <span class="cicada-nymph-save-local-variable-2">&gt;::string,found</span>
      <span class="cicada-nymph-fetch-local-variable-2">::string</span> drop <span class="cicada-nymph-fetch-local-variable-1">:length</span> <span class="cicada-nymph-save-local-variable-2">&gt;::body</span>

      <span class="cicada-nymph-fetch-local-variable-1">:jo</span> <span class="cicada-nymph-fetch-local-variable-2">::body</span> make-jojo

      <span class="cicada-nymph-variable">*jojo-area,current-free-address*</span>
      <span class="cicada-nymph-fetch-local-variable-1">:address,offset</span> sub
      <span class="cicada-nymph-variable">*jo-size*</span> div
      <span class="cicada-nymph-fetch-local-variable-1">:address,offset</span> save

      <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">instruction</span>,literal
        <span class="cicada-nymph-title">jojo-area</span>,stay
      <span class="cicada-nymph-fetch-local-variable-1">:jo</span>
        <span class="cicada-nymph-title">jojo-area</span>,stay

      <span class="cicada-nymph-fetch-local-variable-2">::string,found</span> <span class="cicada-nymph-title">string-tail</span>,word
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** more,rule-set,make-jojo</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">more,rule-set,make-jojo</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-syntax-key-word">jo</span> word:square-bar?
      <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,square-bar,make-jojo
      <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> add-rule
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-title">more</span>,rule-set,make-jojo
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span><span class="org-level-3"> [by factorial]</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,un-named-function</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-square-brackets">[</span><span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">3</span> . . . <span class="cicada-nymph-string">"here here"</span> .s .l <span class="cicada-nymph-end">end</span><span class="cicada-nymph-square-brackets">]</span>
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
    <span class="cicada-nymph-title">test</span>,un-named-function apply

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">factorial</span>
      <span class="cicada-nymph-comment">&lt;&lt; number -- number &gt;&gt;</span>
      <span class="cicada-nymph-square-brackets">[</span>dup
       one? <span class="cicada-nymph-syntax-key-word">if</span>
         <span class="cicada-nymph-end">end</span>
       <span class="cicada-nymph-syntax-key-word">then</span>
       dup sub1 <span class="cicada-nymph-syntax-key-word">recur</span>
       mul
       <span class="cicada-nymph-end">end</span><span class="cicada-nymph-square-brackets">]</span> apply
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">factorial,test</span>
      .l
      <span class="cicada-nymph-number">1</span> factorial . .l
      <span class="cicada-nymph-number">2</span> factorial . .l
      <span class="cicada-nymph-number">3</span> factorial . .l
      <span class="cicada-nymph-number">4</span> factorial . .l
      <span class="cicada-nymph-number">5</span> factorial . .l
      <span class="cicada-nymph-number">6</span> factorial . .l
      <span class="cicada-nymph-number">7</span> factorial . .l
      <span class="cicada-nymph-number">8</span> factorial . .l
      <span class="cicada-nymph-number">9</span> factorial . .l
      <span class="cicada-nymph-number">10</span> factorial . .l
      <span class="cicada-nymph-number">11</span> factorial . .l
      <span class="cicada-nymph-number">12</span> factorial . .l
      <span class="cicada-nymph-number">13</span> factorial . .l
      <span class="cicada-nymph-number">14</span> factorial . .l
      <span class="cicada-nymph-number">15</span> factorial . .l
      <span class="cicada-nymph-number">16</span> factorial . .l
      <span class="cicada-nymph-number">17</span> factorial . .l
      <span class="cicada-nymph-number">18</span> factorial . .l
      <span class="cicada-nymph-number">19</span> factorial . .l
      <span class="cicada-nymph-number">20</span> factorial . .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
    <span class="cicada-nymph-title">factorial</span>,test
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** name                               </span><span class="org-level-2"><span class="org-tag">:syntax:</span></span>
<span class="org-level-3">*** syntax,name,make-jojo</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,name,make-jojo</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length], word[address, length] --
         string[address, length] &gt;&gt;</span>
      drop2
      <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">instruction</span>,literal
        <span class="cicada-nymph-title">jojo-area</span>,stay
      dup2
      <span class="cicada-nymph-title">string-head</span>,word
      string-&gt;name
        <span class="cicada-nymph-title">jojo-area</span>,stay
      <span class="cicada-nymph-title">string-tail</span>,word
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** more,rule-set,make-jojo</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">more,rule-set,make-jojo</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-square-brackets">[</span><span class="cicada-nymph-string">"name"</span> string-equal? <span class="cicada-nymph-end">end</span><span class="cicada-nymph-square-brackets">]</span>
      <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,name,make-jojo
      <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> add-rule
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-title">more</span>,rule-set,make-jojo
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,syntax,name,make-jojo</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-syntax-key-word">name</span> test-test-test name-&gt;string .s
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
    <span class="cicada-nymph-title">test</span>,syntax,name,make-jojo
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** number with base</span>
<span class="org-level-3">*** </span><span class="org-todo">&#35352;</span><span class="org-level-3"> &#21407;&#29702;</span>
    * &#29694;&#22312; &#30340; number &#23601;&#21482;&#26159; "integer" &#32780;&#24050;
      &#26356;&#22810;&#30340;&#36319;&#25976;&#23416;&#26377;&#38364;&#30340;&#26481;&#35199;&#23559;&#22312; cicada &#20013;&#35373;&#35336;&#26032;&#30340;&#35486;&#27861;&#20358;&#23526;&#29694;
    * &#22312; "integer" &#36889;&#20491;&#20989;&#25976;&#20013; &#25105;&#23559;&#21482;&#25903;&#25345; &#23565;&#22235;&#31278;&#36914;&#20301;&#21046;&#30340; &#23383;&#31526;&#20018;&#30340; &#38321;&#35712;
      * &#21313;&#36914;&#21046;
        10#1231
        10#-1231
        1231
        -1231
      * &#20108;&#36914;&#21046;
        2#101001
        2#-101001
        2#-1011_1001
        "-" &#21644; "_" &#30340;&#21516;&#26178;&#23384;&#22312;&#26377;&#40670;&#38627;&#35712;
        &#27492;&#26178;&#21487;&#20197;&#29992; 2#1011_1001 negate
        &#20063;&#23601;&#26159;&#35498;&#38614;&#28982;&#20801;&#35377;&#29992; "-" &#20358;&#34920;&#31034;&#36000;&#25976;
        &#20294;&#26159;&#19981;&#40723;&#21237;&#36889;&#27171;&#20570;
        &#20043;&#25152;&#20197;&#20801;&#35377;&#36889;&#27171;&#20570;
        &#26159;&#22240;&#29234;&#22312;&#25171;&#21360;&#36000;&#25976;&#30340;&#26178;&#20505;&#38656;&#35201;&#36889;&#31278;&#34920;&#31034;&#26041;&#24335;
        &#19981;&#33021;&#25226; "-123" &#25171;&#21360;&#25104; "123 negate"
      * &#20843;&#36914;&#21046;
        8#712537
        8#-712537
      * &#21313;&#20845;&#36914;&#21046;
        16#f123acb3
        16#-F123ACB3
        &#22823;&#23531;&#23567;&#23531;&#23383;&#27597;&#37117;&#21487;&#20197;
    * one can use "_" to separate the number
      to make it more readable
      for example
      2#1111_0101_0001
    * actually, the base can be any 10 based number
      even greater then 36
      but when the base is greater then 36
      not all integer can be represented under this base
      for we only have 36 chars
<span class="org-level-3">*** remove-char!</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">remove-char!,loop</span>
      <span class="cicada-nymph-comment">&lt;&lt; cursor, length, char -- cursor &gt;&gt;</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:char</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
      <span class="cicada-nymph-fetch-local-variable-1">:length</span> zero? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> fetch-byte <span class="cicada-nymph-fetch-local-variable-1">:char</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add1 <span class="cicada-nymph-fetch-local-variable-1">:length</span> sub1
        <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
        string-&gt;buffer!
        <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
        <span class="cicada-nymph-fetch-local-variable-1">:length</span> sub1
        <span class="cicada-nymph-fetch-local-variable-1">:char</span>
      <span class="cicada-nymph-syntax-key-word">else</span>
        <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add1
        <span class="cicada-nymph-fetch-local-variable-1">:length</span> sub1
        <span class="cicada-nymph-fetch-local-variable-1">:char</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-end">loop</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">remove-char!</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length], char -- string[address, length] &gt;&gt;</span>
      x|over|xx <span class="cicada-nymph-save-local-variable-1">&gt;:address</span>
      <span class="cicada-nymph-title">remove-char!</span>,loop <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
      <span class="cicada-nymph-fetch-local-variable-1">:address</span>
      <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:address</span> sub
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,remove-char!</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-string">"2#1001_1001"</span>
      <span class="cicada-nymph-string">"_"</span> <span class="cicada-nymph-title">string-head</span>,byte
      remove-char! .s <span class="cicada-nymph-comment">&lt;&lt; 2#1001_1001 &gt;&gt;</span>
      .l
      <span class="cicada-nymph-string">"___2#1001___1001___"</span>
      <span class="cicada-nymph-string">"_"</span> <span class="cicada-nymph-title">string-head</span>,byte
      remove-char! .s <span class="cicada-nymph-comment">&lt;&lt; 2#1001_1001 &gt;&gt;</span>
      .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
    <span class="cicada-nymph-title">test</span>,remove-char!
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** latin-char?</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">latin-char?</span>
      <span class="cicada-nymph-comment">&lt;&lt; char -- bool &gt;&gt;</span>
      dup <span class="cicada-nymph-string">"A"</span> <span class="cicada-nymph-title">string-head</span>,byte less-than? <span class="cicada-nymph-syntax-key-word">if</span>
        drop <span class="cicada-nymph-bool">false</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup <span class="cicada-nymph-string">"Z"</span> <span class="cicada-nymph-title">string-head</span>,byte less-or-equal? <span class="cicada-nymph-syntax-key-word">if</span>
        drop <span class="cicada-nymph-bool">true</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup <span class="cicada-nymph-string">"a"</span> <span class="cicada-nymph-title">string-head</span>,byte less-than? <span class="cicada-nymph-syntax-key-word">if</span>
        drop <span class="cicada-nymph-bool">false</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup <span class="cicada-nymph-string">"z"</span> <span class="cicada-nymph-title">string-head</span>,byte less-or-equal? <span class="cicada-nymph-syntax-key-word">if</span>
        drop <span class="cicada-nymph-bool">true</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      drop <span class="cicada-nymph-bool">false</span>
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** latin-char-&gt;number</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">latin-char-&gt;number</span>
      <span class="cicada-nymph-comment">&lt;&lt; latin-char -- number &gt;&gt;</span>
      dup <span class="cicada-nymph-string">"A"</span> <span class="cicada-nymph-title">string-head</span>,byte less-than? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-string">"* (latin-char-&gt;number) the argument must be a latin-char"</span> .s .l
        <span class="cicada-nymph-string">"  but the following char is less-than 'A' : "</span> .s
        .i .l
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup <span class="cicada-nymph-string">"Z"</span> <span class="cicada-nymph-title">string-head</span>,byte less-or-equal? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-string">"A"</span> <span class="cicada-nymph-title">string-head</span>,byte
        sub
        <span class="cicada-nymph-number">10</span> add
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup <span class="cicada-nymph-string">"a"</span> <span class="cicada-nymph-title">string-head</span>,byte less-than? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-string">"* (latin-char-&gt;number) the argument must be a latin-char"</span> .s .l
        <span class="cicada-nymph-string">"  but the following char is less-than 'a' but greater-then 'Z' : "</span> .s
        .i .l
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup <span class="cicada-nymph-string">"z"</span> <span class="cicada-nymph-title">string-head</span>,byte less-or-equal? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-string">"a"</span> <span class="cicada-nymph-title">string-head</span>,byte
        sub
        <span class="cicada-nymph-number">10</span> add
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-string">"* (latin-char-&gt;number) the argument must be a latin-char"</span> .s .l
      <span class="cicada-nymph-string">"  but the following char is greater-then 'z' : "</span> .s
      .i .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** number-&gt;latin-char</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">number-&gt;latin-char</span>
      <span class="cicada-nymph-comment">&lt;&lt; number -- latin-char &gt;&gt;</span>
      <span class="cicada-nymph-number">10</span> sub
      <span class="cicada-nymph-string">"a"</span> <span class="cicada-nymph-title">string-head</span>,byte
      add
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** wild-digit-string?</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">wild-digit-string?</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- bool &gt;&gt;</span>
      dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
        drop2 <span class="cicada-nymph-bool">true</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      over fetch-byte
      dup digit-char?
      swap latin-char?
      or <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-title">string-tail</span>,byte
        <span class="cicada-nymph-end">loop</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      drop2
      <span class="cicada-nymph-bool">false</span>
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** wild-integer-string?</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">wild-integer-string?</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- bool &gt;&gt;</span>
      dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
        drop2 <span class="cicada-nymph-bool">false</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup2 <span class="cicada-nymph-title">string-head</span>,byte
      <span class="cicada-nymph-string">"-"</span> <span class="cicada-nymph-title">string-head</span>,byte
      equal? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-title">string-tail</span>,byte
        wild-digit-string?
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      wild-digit-string?
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,wild-integer-string?</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      "" wild-integer-string? . <span class="cicada-nymph-comment">&lt;&lt; 1 &gt;&gt;</span>
      .l
      <span class="cicada-nymph-string">" "</span> wild-integer-string? . <span class="cicada-nymph-comment">&lt;&lt; 0 &gt;&gt;</span>
      <span class="cicada-nymph-string">"_asd"</span> wild-integer-string? . <span class="cicada-nymph-comment">&lt;&lt; 0 &gt;&gt;</span>
      <span class="cicada-nymph-string">" asd"</span> wild-integer-string? . <span class="cicada-nymph-comment">&lt;&lt; 0 &gt;&gt;</span>
      .l
      <span class="cicada-nymph-string">"asd"</span> wild-integer-string? . <span class="cicada-nymph-comment">&lt;&lt; 1 &gt;&gt;</span>
      <span class="cicada-nymph-string">"123"</span> wild-integer-string? . <span class="cicada-nymph-comment">&lt;&lt; 1 &gt;&gt;</span>
      <span class="cicada-nymph-string">"123asd"</span> wild-integer-string? . <span class="cicada-nymph-comment">&lt;&lt; 1 &gt;&gt;</span>
      .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
    <span class="cicada-nymph-title">test</span>,wild-integer-string?
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** base#wild-integer-string?</span>
    * a string for the following format
      is viewed as a base#digit-string
      &lt;digit-string&gt;#[-]&lt;wild-integer-string-string&gt;
      any "_" in the anywhere of the above string
      will be ignored
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">base#wild-integer-string?</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- bool &gt;&gt;</span>
      <span class="cicada-nymph-number">128</span> <span class="cicada-nymph-allocate">allocate-local-memory</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:string-address</span>
      tuck
      <span class="cicada-nymph-fetch-local-variable-1">:string-address</span>
      string-&gt;buffer!
      <span class="cicada-nymph-fetch-local-variable-1">:string-address</span> swap
      <span class="cicada-nymph-string">"_"</span> <span class="cicada-nymph-title">string-head</span>,byte
      remove-char!
      <span class="cicada-nymph-save-local-variable-1">&gt;:new-string-length</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:new-string-address</span>
      <span class="cicada-nymph-comment">&lt;&lt; dup2 .s .l 0 end &gt;&gt;</span>
      <span class="cicada-nymph-fetch-local-variable-1">:new-string-address</span>
      <span class="cicada-nymph-fetch-local-variable-1">:new-string-length</span>
      <span class="cicada-nymph-string">"#"</span> <span class="cicada-nymph-title">string-head</span>,byte
      <span class="cicada-nymph-title">string</span>,find-char <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-syntax-key-word">else</span>
        <span class="cicada-nymph-bool">false</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:address-of-#</span>
      <span class="cicada-nymph-fetch-local-variable-1">:new-string-address</span>
      <span class="cicada-nymph-fetch-local-variable-1">:address-of-#</span> <span class="cicada-nymph-fetch-local-variable-1">:new-string-address</span> sub
      <span class="cicada-nymph-save-local-variable-2">&gt;::base-string</span>
      <span class="cicada-nymph-fetch-local-variable-1">:address-of-#</span> add1
      <span class="cicada-nymph-fetch-local-variable-1">:address-of-#</span> <span class="cicada-nymph-fetch-local-variable-1">:new-string-address</span> sub add1
      <span class="cicada-nymph-fetch-local-variable-1">:new-string-length</span> swap sub
      <span class="cicada-nymph-save-local-variable-2">&gt;::wild-integer-string</span>
      <span class="cicada-nymph-fetch-local-variable-2">::base-string</span> digit-string?
      <span class="cicada-nymph-fetch-local-variable-2">::base-string</span> empty-string? not
      and <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-syntax-key-word">else</span>
        <span class="cicada-nymph-bool">false</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-2">::wild-integer-string</span> wild-integer-string?
      <span class="cicada-nymph-fetch-local-variable-2">::wild-integer-string</span> empty-string? not
      and <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-bool">true</span>
      <span class="cicada-nymph-syntax-key-word">else</span>
        <span class="cicada-nymph-bool">false</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,base#wild-integer-string?</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-string">"#"</span> base#wild-integer-string? . <span class="cicada-nymph-comment">&lt;&lt; 0 &gt;&gt;</span>
      <span class="cicada-nymph-string">"##"</span> base#wild-integer-string? . <span class="cicada-nymph-comment">&lt;&lt; 0 &gt;&gt;</span>
      <span class="cicada-nymph-string">"#___#"</span> base#wild-integer-string? . <span class="cicada-nymph-comment">&lt;&lt; 0 &gt;&gt;</span>
      <span class="cicada-nymph-string">"   "</span> base#wild-integer-string? . <span class="cicada-nymph-comment">&lt;&lt; 0 &gt;&gt;</span>
      <span class="cicada-nymph-string">"______#__1______"</span> base#wild-integer-string? . <span class="cicada-nymph-comment">&lt;&lt; 0 &gt;&gt;</span>
      <span class="cicada-nymph-string">"___2___#__1___c29bf210019___&#28450;&#23383;"</span> base#wild-integer-string? . <span class="cicada-nymph-comment">&lt;&lt; 0 &gt;&gt;</span>
      .l
      <span class="cicada-nymph-string">"1#1"</span> base#wild-integer-string? . <span class="cicada-nymph-comment">&lt;&lt; 1 &gt;&gt;</span>
      <span class="cicada-nymph-string">"123#1c29bf219g42"</span> base#wild-integer-string? . <span class="cicada-nymph-comment">&lt;&lt; 1 &gt;&gt;</span>
      <span class="cicada-nymph-string">"___2___#__1___c29bf210019___g42"</span> base#wild-integer-string? . <span class="cicada-nymph-comment">&lt;&lt; 1 &gt;&gt;</span>
      .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
    <span class="cicada-nymph-title">test</span>,base#wild-integer-string?
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** base#wild-integer-string-&gt;base-string</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">base#wild-integer-string-&gt;base-string</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- string[address, length] &gt;&gt;</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:address</span>
      <span class="cicada-nymph-fetch-local-variable-1">:address</span>
      <span class="cicada-nymph-fetch-local-variable-1">:length</span>
      <span class="cicada-nymph-string">"#"</span> <span class="cicada-nymph-title">string-head</span>,byte
      <span class="cicada-nymph-title">string</span>,find-char <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-syntax-key-word">else</span>
        <span class="cicada-nymph-string">"* (base#wild-integer-string-&gt;base-string)"</span> .s .l
        <span class="cicada-nymph-string">"  the argument must be a base#wild-integer-string"</span> .s .l
        <span class="cicada-nymph-string">"  but the following string does not even have a '#' in it :"</span> .s .l
        <span class="cicada-nymph-string">"  "</span> .s
        <span class="cicada-nymph-fetch-local-variable-1">:address</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span> .s .l
        <span class="cicada-nymph-comment">&lt;&lt; to balance the argument-stack or not ??? &gt;&gt;</span>
        <span class="cicada-nymph-comment">&lt;&lt; :address :length &gt;&gt;</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:address-of-#</span>
      <span class="cicada-nymph-fetch-local-variable-1">:address</span>
      <span class="cicada-nymph-fetch-local-variable-1">:address-of-#</span> <span class="cicada-nymph-fetch-local-variable-1">:address</span> sub
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** base#wild-integer-string-&gt;wild-integer-string</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">base#wild-integer-string-&gt;wild-integer-string</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- string[address, length] &gt;&gt;</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:address</span>
      <span class="cicada-nymph-fetch-local-variable-1">:address</span>
      <span class="cicada-nymph-fetch-local-variable-1">:length</span>
      <span class="cicada-nymph-string">"#"</span> <span class="cicada-nymph-title">string-head</span>,byte
      <span class="cicada-nymph-title">string</span>,find-char <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-syntax-key-word">else</span>
        <span class="cicada-nymph-string">"* (base#wild-integer-string-&gt;wild-integer-string)"</span> .s .l
        <span class="cicada-nymph-string">"  the argument must be a base#wild-integer-string"</span> .s .l
        <span class="cicada-nymph-string">"  but the following string does not even have a '#' in it :"</span> .s .l
        <span class="cicada-nymph-string">"  "</span> .s
        <span class="cicada-nymph-fetch-local-variable-1">:address</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span> .s .l
        <span class="cicada-nymph-comment">&lt;&lt; to balance the argument-stack or not ??? &gt;&gt;</span>
        <span class="cicada-nymph-comment">&lt;&lt; :address :length &gt;&gt;</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:address-of-#</span>
      <span class="cicada-nymph-fetch-local-variable-1">:address-of-#</span> add1
      <span class="cicada-nymph-fetch-local-variable-1">:address-of-#</span> <span class="cicada-nymph-fetch-local-variable-1">:address</span> sub add1
      <span class="cicada-nymph-fetch-local-variable-1">:length</span> swap sub
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,base#wild-integer-string-&gt;base-string</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-string">"___2___ __1___c29bf210019___&#28450;&#23383;"</span> base#wild-integer-string-&gt;base-string
      .l
      <span class="cicada-nymph-string">"1#1"</span> base#wild-integer-string-&gt;base-string .s .l <span class="cicada-nymph-comment">&lt;&lt; 1 &gt;&gt;</span>
      <span class="cicada-nymph-string">"123#1c29bf219g42"</span> base#wild-integer-string-&gt;base-string .s .l <span class="cicada-nymph-comment">&lt;&lt; 123 &gt;&gt;</span>
      <span class="cicada-nymph-string">"___2___#__1___c29bf210019___g42"</span> base#wild-integer-string-&gt;base-string .s .l <span class="cicada-nymph-comment">&lt;&lt; ___2___ &gt;&gt;</span>
      .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
    <span class="cicada-nymph-title">test</span>,base#wild-integer-string-&gt;base-string

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,base#wild-integer-string-&gt;wild-integer-string</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-string">"___2___ __1___c29bf210019___&#28450;&#23383;"</span> base#wild-integer-string-&gt;wild-integer-string
      .l
      <span class="cicada-nymph-string">"1#1"</span> base#wild-integer-string-&gt;wild-integer-string .s .l <span class="cicada-nymph-comment">&lt;&lt; 1 &gt;&gt;</span>
      <span class="cicada-nymph-string">"123#1c29bf219g42"</span> base#wild-integer-string-&gt;wild-integer-string .s .l <span class="cicada-nymph-comment">&lt;&lt; 1c29bf219g42 &gt;&gt;</span>
      <span class="cicada-nymph-string">"___2___#__1___c29bf210019___g42"</span> base#wild-integer-string-&gt;wild-integer-string .s .l <span class="cicada-nymph-comment">&lt;&lt; __1___c29bf210019___g42 &gt;&gt;</span>
      .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
    <span class="cicada-nymph-title">test</span>,base#wild-integer-string-&gt;wild-integer-string
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** wild-integer-string-&gt;integer,with-base</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">wild-integer-string-&gt;integer,with-base,loop</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length], base, sum, counter -- integer &gt;&gt;</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:counter</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:sum</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:base</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:address</span>
      <span class="cicada-nymph-fetch-local-variable-1">:length</span> zero? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-fetch-local-variable-1">:sum</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-1">:address</span> fetch-byte <span class="cicada-nymph-save-local-variable-1">&gt;:char</span>
      <span class="cicada-nymph-fetch-local-variable-1">:char</span> digit-char? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-fetch-local-variable-1">:char</span> digit-char-&gt;number
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-1">:char</span> latin-char? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-fetch-local-variable-1">:char</span> latin-char-&gt;number
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-1">:base</span> <span class="cicada-nymph-fetch-local-variable-1">:counter</span> power
      mul
      <span class="cicada-nymph-fetch-local-variable-1">:sum</span> add
      <span class="cicada-nymph-save-local-variable-1">&gt;:sum</span>
      <span class="cicada-nymph-fetch-local-variable-1">:address</span> add1
      <span class="cicada-nymph-fetch-local-variable-1">:length</span> sub1
      <span class="cicada-nymph-fetch-local-variable-1">:base</span>
      <span class="cicada-nymph-fetch-local-variable-1">:sum</span>
      <span class="cicada-nymph-fetch-local-variable-1">:counter</span> add1
      <span class="cicada-nymph-end">loop</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">wild-integer-string-&gt;integer,with-base</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length], base -- integer &gt;&gt;</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:base</span>
      dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
        drop2
        <span class="cicada-nymph-number">0</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup2 <span class="cicada-nymph-title">string-head</span>,byte
      <span class="cicada-nymph-string">"-"</span> <span class="cicada-nymph-title">string-head</span>,byte
      equal? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-title">string-tail</span>,byte
        <span class="cicada-nymph-number">-1</span> <span class="cicada-nymph-save-local-variable-1">&gt;:sign</span>
      <span class="cicada-nymph-syntax-key-word">else</span>
        <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-save-local-variable-1">&gt;:sign</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>
      <span class="cicada-nymph-fetch-local-variable-2">::string</span> string-reverse!
      <span class="cicada-nymph-fetch-local-variable-1">:base</span>
      <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">wild-integer-string-&gt;integer</span>,with-base,loop
      <span class="cicada-nymph-fetch-local-variable-1">:sign</span> mul
      <span class="cicada-nymph-fetch-local-variable-2">::string</span> string-reverse!
      drop2
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** base#wild-integer-string-&gt;integer</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">base#wild-integer-string-&gt;integer</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- integer &gt;&gt;</span>
      <span class="cicada-nymph-number">128</span> <span class="cicada-nymph-allocate">allocate-local-memory</span>
        <span class="cicada-nymph-save-local-variable-1">&gt;:address</span>
      tuck <span class="cicada-nymph-fetch-local-variable-1">:address</span> string-&gt;buffer!
        <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
      <span class="cicada-nymph-fetch-local-variable-1">:address</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
      <span class="cicada-nymph-string">"_"</span> <span class="cicada-nymph-title">string-head</span>,byte remove-char!
        <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>
      <span class="cicada-nymph-fetch-local-variable-2">::string</span>
      base#wild-integer-string-&gt;base-string
        <span class="cicada-nymph-save-local-variable-2">&gt;::base-string</span>
      <span class="cicada-nymph-fetch-local-variable-2">::string</span>
      base#wild-integer-string-&gt;wild-integer-string
        <span class="cicada-nymph-save-local-variable-2">&gt;::wild-integer-string</span>
      <span class="cicada-nymph-fetch-local-variable-2">::base-string</span>
      digit-string-&gt;number
        <span class="cicada-nymph-save-local-variable-1">&gt;:base</span>
      <span class="cicada-nymph-fetch-local-variable-2">::wild-integer-string</span>
      <span class="cicada-nymph-fetch-local-variable-1">:base</span>
      <span class="cicada-nymph-title">wild-integer-string-&gt;integer</span>,with-base
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,base#wild-integer-string-&gt;integer</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-string">"0#111"</span> base#wild-integer-string-&gt;integer .
      <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">1</span> mul
      <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">1</span> mul add
      <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">1</span> mul add .
      .l
      <span class="cicada-nymph-string">"1#111"</span> base#wild-integer-string-&gt;integer .
      <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">1</span> mul
      <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">1</span> mul add
      <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">1</span> mul add .
      .l
      <span class="cicada-nymph-string">"10#123"</span> base#wild-integer-string-&gt;integer .
      <span class="cicada-nymph-string">"_1_0__#_1__2_3_"</span> base#wild-integer-string-&gt;integer .
      <span class="cicada-nymph-number">10</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">3</span> mul
      <span class="cicada-nymph-number">10</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">2</span> mul add
      <span class="cicada-nymph-number">10</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">1</span> mul add .
      .l
      <span class="cicada-nymph-string">"2#1000"</span> base#wild-integer-string-&gt;integer .
      <span class="cicada-nymph-string">"2#_1000_"</span> base#wild-integer-string-&gt;integer .
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">0</span> mul
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">0</span> mul add
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">0</span> mul add
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">3</span> power <span class="cicada-nymph-number">1</span> mul add .
      .l
      <span class="cicada-nymph-string">"2#1111_1111"</span> base#wild-integer-string-&gt;integer .
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">1</span> mul
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">1</span> mul add
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">1</span> mul add
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">3</span> power <span class="cicada-nymph-number">1</span> mul add
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">4</span> power <span class="cicada-nymph-number">1</span> mul add
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">5</span> power <span class="cicada-nymph-number">1</span> mul add
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">6</span> power <span class="cicada-nymph-number">1</span> mul add
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">7</span> power <span class="cicada-nymph-number">1</span> mul add .
      <span class="cicada-nymph-string">"16#f_f"</span> base#wild-integer-string-&gt;integer .
      <span class="cicada-nymph-number">16</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">15</span> mul
      <span class="cicada-nymph-number">16</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">15</span> mul add .
      .l
      <span class="cicada-nymph-string">"100#111"</span> base#wild-integer-string-&gt;integer .
      <span class="cicada-nymph-number">100</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">1</span> mul
      <span class="cicada-nymph-number">100</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">1</span> mul add
      <span class="cicada-nymph-number">100</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">1</span> mul add .
      .l
      <span class="cicada-nymph-string">"64#zzz"</span> base#wild-integer-string-&gt;integer .
      <span class="cicada-nymph-number">64</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">35</span> mul
      <span class="cicada-nymph-number">64</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">35</span> mul add
      <span class="cicada-nymph-number">64</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">35</span> mul add .
      .l
      <span class="cicada-nymph-string">"36#zzzz"</span> base#wild-integer-string-&gt;integer .
      <span class="cicada-nymph-number">36</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">35</span> mul
      <span class="cicada-nymph-number">36</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">35</span> mul add
      <span class="cicada-nymph-number">36</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">35</span> mul add
      <span class="cicada-nymph-number">36</span> <span class="cicada-nymph-number">3</span> power <span class="cicada-nymph-number">35</span> mul add .
      .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
    <span class="cicada-nymph-title">test</span>,base#wild-integer-string-&gt;integer
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-todo">note</span><span class="org-level-3"> writers</span>
    * a general function
      and three special ones
    * they all writer integer
    * I will implemented them by syntax when needed
<span class="org-level-3">*** .#</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">.#,loop</span>
      <span class="cicada-nymph-comment">&lt;&lt; number, base, cursor -- cursor &gt;&gt;</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:base</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:number</span>
      <span class="cicada-nymph-fetch-local-variable-1">:number</span> zero? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-1">:number</span>
      <span class="cicada-nymph-fetch-local-variable-1">:base</span>
      divmod <span class="cicada-nymph-save-local-variable-1">&gt;:mod</span> <span class="cicada-nymph-save-local-variable-1">&gt;:div</span>
      <span class="cicada-nymph-fetch-local-variable-1">:mod</span> <span class="cicada-nymph-number">10</span> less-than? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-fetch-local-variable-1">:mod</span> number-&gt;digit-char
      <span class="cicada-nymph-syntax-key-word">else</span>
        <span class="cicada-nymph-fetch-local-variable-1">:mod</span> number-&gt;latin-char
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
      save-byte
      <span class="cicada-nymph-fetch-local-variable-1">:div</span>
      <span class="cicada-nymph-fetch-local-variable-1">:base</span>
      <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add1
      <span class="cicada-nymph-end">loop</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">.#</span>
      <span class="cicada-nymph-comment">&lt;&lt; integer, base -- &gt;&gt;</span>
      over zero? <span class="cicada-nymph-syntax-key-word">if</span>
        drop .i
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup <span class="cicada-nymph-number">36</span> greater-than?
      over <span class="cicada-nymph-number">2</span> less-than?
      or <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-string">"* (.#) the base "</span> .s .i <span class="cicada-nymph-string">" is not valid to write a number"</span> .s .l
        <span class="cicada-nymph-string">"  a base should in between 2 and 36 includingly"</span> .s .l
        <span class="cicada-nymph-string">"  the integer to be written is "</span> .s .i .l
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup .i
      <span class="cicada-nymph-string">"#"</span> .s
      over negative? <span class="cicada-nymph-syntax-key-word">if</span>
        swap negate swap
        <span class="cicada-nymph-string">"-"</span> .s
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-number">128</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
      <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
      <span class="cicada-nymph-title">.#</span>,loop <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
      <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
      <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> sub
      string-reverse! .s
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** .#2 .#8 .#16</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">.#2</span>  <span class="cicada-nymph-number">2</span>  .# <span class="cicada-nymph-string">" "</span> .s <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">.#8</span>  <span class="cicada-nymph-number">8</span>  .# <span class="cicada-nymph-string">" "</span> .s <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">.#16</span> <span class="cicada-nymph-number">16</span> .# <span class="cicada-nymph-string">" "</span> .s <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-number">0</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">111</span>        <span class="cicada-nymph-number">0</span>  .#
    <span class="cicada-nymph-number">1</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">111</span>        <span class="cicada-nymph-number">1</span>  .#
    <span class="cicada-nymph-number">10</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">123</span>       <span class="cicada-nymph-number">10</span> .#
    <span class="cicada-nymph-number">10</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0</span>         <span class="cicada-nymph-number">10</span> .#
    <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1000</span>       <span class="cicada-nymph-number">2</span>  .#
    <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1111_1111</span>  <span class="cicada-nymph-number">2</span>  .#
    <span class="cicada-nymph-number">16</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">f_f</span>       <span class="cicada-nymph-number">16</span> .#
    <span class="cicada-nymph-number">36</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">zzzz</span>      <span class="cicada-nymph-number">36</span> .#

    <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1111_1111</span>  .#2
    <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">123</span>        .#8
    <span class="cicada-nymph-number">16</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">fff</span>       .#16
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-todo">&#35352;</span><span class="org-level-3"> bit-xor</span>
    * &#23565; bit-xor &#30340;&#35299;&#37323;
      1. &#23565;&#31281;&#22320;&#30475;
         diff
      2. &#38750;&#23565;&#31281;&#22320;&#30475;
         &#24460;&#32773;&#26159; 1 &#21063; &#27714; invert
      &#32080;&#27083;&#19978; &#23565;&#26044;&#21516;&#27171;&#30340;&#25277;&#35937;&#20989;&#25976;
      &#35469;&#35672;&#19978; &#21487;&#20197;&#26377;&#19981;&#21516;&#30340;&#29702;&#35299;&#26041;&#24335;
<span class="org-level-3">*** </span><span class="org-todo">&#35352;</span><span class="org-level-3"> gamber</span>
    * gray code &#24456;&#26377;&#36259;
      &#23588;&#20854;&#26159;&#20854;&#29983;&#25104;&#26041;&#24335;
      &#21363; &#20808;&#21462;&#23565;&#31281; &#20877;&#21152;&#21069;&#32180;
      &#26159;&#21033;&#29992; &#23565;&#31281;&#24615; &#21644; &#19981;&#35722;&#37327;[&#19981;&#35722;&#24615;] &#30340;&#20856;&#22411;&#20363;&#23376;
    * &#21516;&#27171;&#30340;&#19968;&#20491; 0 1 &#23383;&#31526;&#20018;
      &#27604;&#22914; "100"
      &#25226;&#23427;&#20570;&#29234;&#33258;&#28982;&#32232;&#30908;&#30340;&#20108;&#36914;&#21046;&#25976; &#20854;&#20540;&#29234; 4 &#36889;&#20491;&#26159; number
      &#25226;&#23427;&#20570;&#29234; gray code &#32232;&#30908;&#30340;&#20108;&#36914;&#21046;&#25976; &#20854;&#20540;&#29234; 7 &#36889;&#20491;&#25105;&#31281;&#20043;&#29234; gamber
    * &#36889;&#27171; &#25105;&#20497;&#23601;&#26377;&#22914;&#19979;&#20841;&#20491;&#20989;&#25976;
      string-&gt;number
      string-&gt;gamber
      &#21516;&#26178;&#36889;&#20841;&#20491;&#20989;&#25976;&#36996;&#24341;&#20986;&#20102;&#19979;&#38754;&#20841;&#20491;&#20989;&#25976;
      number-&gt;gamber
      gamber-&gt;number
    * &#19979;&#38754;&#30340;&#30340;&#31639;&#27861;&#26159;&#36890;&#36942;&#25226;&#25976;&#23383;&#21015;&#34920;&#20043;&#24460;
      &#36880; bit &#35264;&#23519;&#27599;&#21015;&#30340;&#25509;&#36899; bit &#20540;&#30340;&#35215;&#21063;&#32780;&#24471;&#20358;&#30340;
      &#27604;&#22914;
      &#20197;&#29983;&#25104;&#35215;&#21063;&#29234;&#23450;&#32681;
      &#28982;&#24460;&#32317;&#32080;&#19968;&#19979;&#25152;&#30332;&#29694;&#30340;&#27599;&#19968;&#21015;&#30340;&#35215;&#24459;
      &#23601;&#21487;&#20197;&#24471;&#21040;&#23565;&#19979;&#38754;&#30340;&#31639;&#27861;&#30340;&#26377;&#25928;&#24615;&#30340;&#22196;&#26684;&#35657;&#26126;
    * &#27880;&#24847;
      &#20841;&#20491;&#26041;&#21521;&#30340;&#36939;&#31639;&#36837;&#28982;&#19981;&#21516;
      &#36996;&#26159;&#35201;&#20197;&#29983;&#25104;&#26041;&#24335;&#29234;&#26680;&#24515;&#20358;&#29702;&#35299;&#36889;&#19968;&#40670;
      &#21482;&#35201;&#25226;&#29983;&#25104;&#36942;&#31243;&#20013;
      &#27599;&#27425;&#22312;&#20570;&#23436;&#23565;&#31281;&#24460;
      &#25152;&#28155;&#21152;&#30340; &#19968;&#20018;&#21069;&#32180; 1 &#30475;&#25104;&#26159;&#19968;&#20491;&#25972;&#39636;
      &#23601;&#33021;&#29702;&#35299;&#20102;
      &#21487;&#20197;&#25226;&#27599;&#27425;&#30340; &#19968;&#20018;&#21069;&#32180; 1 &#30475;&#25104;&#26159;&#19968;&#26681;&#26829;&#23376;
      &#19968;&#26681;&#26829;&#23376; &#19968;&#26681;&#26829;&#23376; &#22320; &#20358;&#35264;&#23519;&#25152;&#29983;&#25104;&#30340;&#21015;&#34920; &#23601;&#34892;&#20102;
      &#21487;&#20197;&#30332;&#29694;
      &#26829;&#23376; &#20854;&#23526;&#23601;&#26159; &#33258;&#28982;&#32232;&#30908;&#26178;
      &#36880; bit &#35264;&#23519;&#21015;&#34920;&#26178;&#30340; &#25509;&#36899; bit &#20540;
      &#37027;&#40636;&#23601;&#33021;&#29702;&#35299;&#21040;
      &#29234;&#20160;&#40636; number-&gt;gamber &#27604; gamber-&gt;number &#23481;&#26131;&#35336;&#31639;&#20102;
    * &#21478;&#22806;&#36996;&#35201;&#27880;&#24847;
      &#24478;&#26368;&#39640;&#20301;&#21521;&#26368;&#20302;&#20301;&#21435;&#35336;&#31639;
      &#26159;&#29234;&#20102;&#36880;&#27493;&#30906;&#23450;&#25976;&#22312;&#24207;&#38364;&#20418;&#20013;&#30340;&#20301;&#32622;
<span class="org-level-3">*** number-&gt;gamber</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">number-&gt;gamber</span>
      <span class="cicada-nymph-comment">&lt;&lt; number -- gamber &gt;&gt;</span>
      dup <span class="cicada-nymph-number">1</span> bit-right
      bit-xor
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** gamber-&gt;number</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">gamber-&gt;number,loop</span>
      <span class="cicada-nymph-comment">&lt;&lt; gamber, number, cursor -- number &gt;&gt;</span>
      dup negative? <span class="cicada-nymph-syntax-key-word">if</span>
        drop
        swap drop
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:number</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:gamber</span>
      <span class="cicada-nymph-fetch-local-variable-1">:gamber</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> get-bit
      <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add1 get-bit
      xor <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> set-bit <span class="cicada-nymph-save-local-variable-1">&gt;:number</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-1">:gamber</span>
      <span class="cicada-nymph-fetch-local-variable-1">:number</span>
      <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> sub1
      <span class="cicada-nymph-end">loop</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">gamber-&gt;number</span>
      <span class="cicada-nymph-comment">&lt;&lt; gamber -- number &gt;&gt;</span>
      dup find-highest-set-bit
      dup negative? <span class="cicada-nymph-syntax-key-word">if</span>
        drop
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-number">0</span> over set-bit
      swap sub1
      <span class="cicada-nymph-title">gamber-&gt;number</span>,loop
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,gamber</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0000</span> number-&gt;gamber .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0001</span> number-&gt;gamber .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0010</span> number-&gt;gamber .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0011</span> number-&gt;gamber .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0100</span> number-&gt;gamber .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0101</span> number-&gt;gamber .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0110</span> number-&gt;gamber .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0111</span> number-&gt;gamber .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1000</span> number-&gt;gamber .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1001</span> number-&gt;gamber .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1010</span> number-&gt;gamber .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1011</span> number-&gt;gamber .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1100</span> number-&gt;gamber .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1101</span> number-&gt;gamber .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1110</span> number-&gt;gamber .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1111</span> number-&gt;gamber .#2 .l
      .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0000</span> number-&gt;gamber gamber-&gt;number .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0001</span> number-&gt;gamber gamber-&gt;number .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0010</span> number-&gt;gamber gamber-&gt;number .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0011</span> number-&gt;gamber gamber-&gt;number .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0100</span> number-&gt;gamber gamber-&gt;number .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0101</span> number-&gt;gamber gamber-&gt;number .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0110</span> number-&gt;gamber gamber-&gt;number .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0111</span> number-&gt;gamber gamber-&gt;number .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1000</span> number-&gt;gamber gamber-&gt;number .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1001</span> number-&gt;gamber gamber-&gt;number .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1010</span> number-&gt;gamber gamber-&gt;number .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1011</span> number-&gt;gamber gamber-&gt;number .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1100</span> number-&gt;gamber gamber-&gt;number .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1101</span> number-&gt;gamber gamber-&gt;number .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1110</span> number-&gt;gamber gamber-&gt;number .#2 .l
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1111</span> number-&gt;gamber gamber-&gt;number .#2 .l
      .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
    <span class="cicada-nymph-title">test</span>,gamber
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** base#wild-integer-string           </span><span class="org-level-2"><span class="org-tag">:syntax:</span></span>
<span class="org-level-3">*** syntax,base#wild-integer-string,make-jojo</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,base#wild-integer-string,make-jojo</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length], word[address, length] --
         string[address, length] &gt;&gt;</span>
      <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">instruction</span>,literal
        <span class="cicada-nymph-title">jojo-area</span>,stay
      base#wild-integer-string-&gt;integer
        <span class="cicada-nymph-title">jojo-area</span>,stay
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** more,rule-set,make-jojo</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">more,rule-set,make-jojo</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-syntax-key-word">jo</span> base#wild-integer-string?
      <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,base#wild-integer-string,make-jojo
      <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> add-rule
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-title">more</span>,rule-set,make-jojo
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,syntax,base#wild-integer-string,make-jojo</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-number">0</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">111</span>
      <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">1</span> mul
      <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">1</span> mul add
      <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">1</span> mul add
      . . .l

      <span class="cicada-nymph-number">1</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">111</span>
      <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">1</span> mul
      <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">1</span> mul add
      <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">1</span> mul add
      . . .l

      <span class="cicada-nymph-number">10</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">123</span>
      _1_0__#_1__2_3_
      <span class="cicada-nymph-number">10</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">3</span> mul
      <span class="cicada-nymph-number">10</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">2</span> mul add
      <span class="cicada-nymph-number">10</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">1</span> mul add
      . . .l .

      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1000</span>
      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">_1000_</span>
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">0</span> mul
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">0</span> mul add
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">0</span> mul add
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">3</span> power <span class="cicada-nymph-number">1</span> mul add
      . . .l .

      <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1111_1111</span>
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">1</span> mul
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">1</span> mul add
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">1</span> mul add
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">3</span> power <span class="cicada-nymph-number">1</span> mul add
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">4</span> power <span class="cicada-nymph-number">1</span> mul add
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">5</span> power <span class="cicada-nymph-number">1</span> mul add
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">6</span> power <span class="cicada-nymph-number">1</span> mul add
      <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">7</span> power <span class="cicada-nymph-number">1</span> mul add
      . . .l

      <span class="cicada-nymph-number">16</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">f_f</span>
      <span class="cicada-nymph-number">16</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">15</span> mul
      <span class="cicada-nymph-number">16</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">15</span> mul add
      . . .l

      <span class="cicada-nymph-number">100</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">111</span>
      <span class="cicada-nymph-number">100</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">1</span> mul
      <span class="cicada-nymph-number">100</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">1</span> mul add
      <span class="cicada-nymph-number">100</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">1</span> mul add
      . . .l

      <span class="cicada-nymph-number">64</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">zzz</span>
      <span class="cicada-nymph-number">64</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">35</span> mul
      <span class="cicada-nymph-number">64</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">35</span> mul add
      <span class="cicada-nymph-number">64</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">35</span> mul add
      . . .l

      <span class="cicada-nymph-number">36</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">zzzz</span>
      <span class="cicada-nymph-number">36</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">35</span> mul
      <span class="cicada-nymph-number">36</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">35</span> mul add
      <span class="cicada-nymph-number">36</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">35</span> mul add
      <span class="cicada-nymph-number">36</span> <span class="cicada-nymph-number">3</span> power <span class="cicada-nymph-number">35</span> mul add
      . . .l

      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-title">test</span>,syntax,base#wild-integer-string,make-jojo
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-1">* basic-REPL</span>
<span class="org-level-2">** </span><span class="org-level-2"><span class="bold">*rule-set,basic-REPL*</span></span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-number">1024</span> <span class="cicada-nymph-variable">*jo-size*</span> mul
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*size,rule-set,basic-REPL*</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

   <span class="cicada-nymph-comment">&lt;&lt; for cursor &gt;&gt;</span>
   <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-allocate">allocate-memory</span> drop

   <span class="cicada-nymph-variable">*size,rule-set,basic-REPL*</span>
   <span class="cicada-nymph-allocate">allocate-memory</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

   <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span>
   <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> <span class="cicada-nymph-variable">*jo-size*</span> sub
   save
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** eval-word</span>
   * to protect exception-jo from be called from basic-REPL
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">eval-word</span>
     <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- unknown &gt;&gt;</span>
     dup2 find-syntax <span class="cicada-nymph-syntax-key-word">if</span>
       apply
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     dup2
     <span class="cicada-nymph-title">name-hash-table</span>,find-jo <span class="cicada-nymph-syntax-key-word">if</span>
       dup exception-jo? <span class="cicada-nymph-syntax-key-word">if</span>
         drop
         <span class="cicada-nymph-string">"* (eval-word) can not execute exception directly : "</span> .s
         .s .l
         <span class="cicada-nymph-end">end</span>
       <span class="cicada-nymph-syntax-key-word">then</span>
       <span class="cicada-nymph-comment">&lt;&lt; function &amp; primitive-function &amp; variable &gt;&gt;</span>
       xx|swap|x drop2
       apply
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">else</span>
     <span class="cicada-nymph-string">"* (eval-word) meets undefined word : "</span> .s
     .s .l
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** !bye,basic-REPL</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-exception">!bye,basic-REPL</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-syntax-key-word">exception-reset-stack</span>
     drop-syntax-stack
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-exception">define-exception</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** syntax,bye,basic-REPL</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,bye,basic-REPL</span>
     <span class="cicada-nymph-comment">&lt;&lt; word:bye -- &gt;&gt;</span>
     drop2
     <span class="cicada-nymph-exception">!bye,basic-REPL</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** basic-REPL                         </span><span class="org-level-2"><span class="org-tag">:redefine:</span></span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">basic-REPL,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; unknown -- unknown &gt;&gt;</span>
     read-word-for-REPL
     eval-word
     <span class="cicada-nymph-end">loop</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">basic-REPL</span>
     <span class="cicada-nymph-comment">&lt;&lt; unknown -- unknown &gt;&gt;</span>
     prepare-for
       <span class="cicada-nymph-exception">!bye,basic-REPL</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> push-syntax-stack
     <span class="cicada-nymph-title">basic-REPL</span>,loop
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   basic-REPL
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-number">0</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">111</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">1</span> mul
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">1</span> mul add
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">1</span> mul add
   . .

   <span class="cicada-nymph-number">1</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">111</span>
   <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">1</span> mul
   <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">1</span> mul add
   <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">1</span> mul add
   . .

   <span class="cicada-nymph-number">10</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">123</span>
   _1_0__#_1__2_3_
   <span class="cicada-nymph-number">10</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">3</span> mul
   <span class="cicada-nymph-number">10</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">2</span> mul add
   <span class="cicada-nymph-number">10</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">1</span> mul add
   . . .

   <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1000</span>
   <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">_1000_</span>
   <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">0</span> mul
   <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">0</span> mul add
   <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">0</span> mul add
   <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">3</span> power <span class="cicada-nymph-number">1</span> mul add
   . . .

   <span class="cicada-nymph-number">2</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1111_1111</span>
   <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">1</span> mul
   <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">1</span> mul add
   <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">1</span> mul add
   <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">3</span> power <span class="cicada-nymph-number">1</span> mul add
   <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">4</span> power <span class="cicada-nymph-number">1</span> mul add
   <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">5</span> power <span class="cicada-nymph-number">1</span> mul add
   <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">6</span> power <span class="cicada-nymph-number">1</span> mul add
   <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">7</span> power <span class="cicada-nymph-number">1</span> mul add
   . .

   <span class="cicada-nymph-number">16</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">f_f</span>
   <span class="cicada-nymph-number">16</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">15</span> mul
   <span class="cicada-nymph-number">16</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">15</span> mul add
   . .

   <span class="cicada-nymph-number">100</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">111</span>
   <span class="cicada-nymph-number">100</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">1</span> mul
   <span class="cicada-nymph-number">100</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">1</span> mul add
   <span class="cicada-nymph-number">100</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">1</span> mul add
   . .

   <span class="cicada-nymph-number">64</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">zzz</span>
   <span class="cicada-nymph-number">64</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">35</span> mul
   <span class="cicada-nymph-number">64</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">35</span> mul add
   <span class="cicada-nymph-number">64</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">35</span> mul add
   . .

   <span class="cicada-nymph-number">36</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">zzzz</span>
   <span class="cicada-nymph-number">36</span> <span class="cicada-nymph-number">0</span> power <span class="cicada-nymph-number">35</span> mul
   <span class="cicada-nymph-number">36</span> <span class="cicada-nymph-number">1</span> power <span class="cicada-nymph-number">35</span> mul add
   <span class="cicada-nymph-number">36</span> <span class="cicada-nymph-number">2</span> power <span class="cicada-nymph-number">35</span> mul add
   <span class="cicada-nymph-number">36</span> <span class="cicada-nymph-number">3</span> power <span class="cicada-nymph-number">35</span> mul add
   . .
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* more syntax for REPL</span>
<span class="org-level-2">** jo                                 </span><span class="org-level-2"><span class="org-tag">:syntax:</span></span>
<span class="org-level-3">*** syntax,jo,basic-REPL</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,jo,basic-REPL</span>
      <span class="cicada-nymph-comment">&lt;&lt; word:jo -- &gt;&gt;</span>
      drop2
      read-word-for-REPL
      <span class="cicada-nymph-save-local-variable-2">&gt;::word</span>
      <span class="cicada-nymph-fetch-local-variable-2">::word</span> <span class="cicada-nymph-title">name-hash-table</span>,find-jo <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-string">"* (syntax,jo,basic-REPL) meet undefined word after jo : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::word</span> .s .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** init,rule-set,basic-REPL</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">init,rule-set,basic-REPL</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-syntax-key-word">jo</span> integer-string?
      <span class="cicada-nymph-syntax-key-word">jo</span> string-&gt;integer
      <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule

      <span class="cicada-nymph-square-brackets">[</span><span class="cicada-nymph-string">"bye"</span> string-equal? <span class="cicada-nymph-end">end</span><span class="cicada-nymph-square-brackets">]</span>
      <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,bye,basic-REPL
      <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule

      <span class="cicada-nymph-square-brackets">[</span><span class="cicada-nymph-string">"jo"</span> string-equal? <span class="cicada-nymph-end">end</span><span class="cicada-nymph-square-brackets">]</span>
      <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,jo,basic-REPL
      <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule

      <span class="cicada-nymph-syntax-key-word">jo</span> base#wild-integer-string? <span class="cicada-nymph-syntax-key-word">jo</span> base#wild-integer-string-&gt;integer <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-title">init</span>,rule-set,basic-REPL
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** if &amp; else &amp; then                   </span><span class="org-level-2"><span class="org-tag">:syntax:</span></span>
<span class="org-level-3">*** </span><span class="org-todo">note</span><span class="org-level-3"> ending jo</span>
    * you do not need to use ending jo
      in code blocks formed by if else then
      because in a REPL
      things are different from function body
      and there is no such thing as
      the end of a function body in the REPL
<span class="org-level-3">*** </span><span class="org-todo">note</span><span class="org-level-3"> executing (end) in REPL</span>
    * when executing (end) in REPL
      nothing will happen
      this is because (eval-word) calls (end)
      and the jojo (eval-word) is pop out of return-stack
      just like meet (end) in the function-body of (eval-word)
<span class="org-level-3">*** syntax,if,basic-REPL,meet-true</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,if,basic-REPL,meet-true,else</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      read-word-for-REPL
      <span class="cicada-nymph-string">"then"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-end">loop</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,if,basic-REPL,meet-true</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      read-word-for-REPL
      dup2 <span class="cicada-nymph-string">"then"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
        drop2
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup2 <span class="cicada-nymph-string">"else"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
        drop2
        <span class="cicada-nymph-title">syntax</span>,if,basic-REPL,meet-true,else
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      eval-word
      <span class="cicada-nymph-end">loop</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** syntax,if,basic-REPL,meet-false</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,if,basic-REPL,meet-false,else</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      read-word-for-REPL
      dup2 <span class="cicada-nymph-string">"then"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
        drop2
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      eval-word
      <span class="cicada-nymph-end">loop</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,if,basic-REPL,meet-false</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      read-word-for-REPL
      dup2 <span class="cicada-nymph-string">"then"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
        drop2
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      dup2 <span class="cicada-nymph-string">"else"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
        drop2
        <span class="cicada-nymph-title">syntax</span>,if,basic-REPL,meet-false,else
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      drop2
      <span class="cicada-nymph-end">loop</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** syntax,if,basic-REPL</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,if,basic-REPL</span>
      <span class="cicada-nymph-comment">&lt;&lt; bool, word:if -- &gt;&gt;</span>
      drop2 <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-title">syntax</span>,if,basic-REPL,meet-true
      <span class="cicada-nymph-syntax-key-word">else</span>
        <span class="cicada-nymph-title">syntax</span>,if,basic-REPL,meet-false
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** add-rule to </span><span class="org-level-3"><span class="bold">*rule-set,basic-REPL*</span></span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-syntax-key-word">jo</span> word:if? <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,if,basic-REPL <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    one? <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-number">111</span> . .l
    <span class="cicada-nymph-syntax-key-word">then</span>

    one? <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-number">111</span> . .l
    <span class="cicada-nymph-syntax-key-word">else</span>
      <span class="cicada-nymph-number">666</span> . .l
    <span class="cicada-nymph-syntax-key-word">then</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** </span><span class="org-level-2"><span class="bold">*circular-string-area*</span></span>
<span class="org-level-3">*** </span><span class="org-todo">note</span>
    * no length in the area anymore
      [not like the string-area]
    * and ending each string here with a 0
<span class="org-level-3">*** allocate-memory</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-number">1024</span> <span class="cicada-nymph-number">1024</span> mul
    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*circular-string-area,size*</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>


    <span class="cicada-nymph-variable">*circular-string-area,size*</span> <span class="cicada-nymph-allocate">allocate-memory</span>
    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*circular-string-area*</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

    <span class="cicada-nymph-variable">*circular-string-area*</span>
    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*circular-string-area,current-free-address*</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** double-quote                       </span><span class="org-level-2"><span class="org-tag">:syntax:</span></span>
<span class="org-level-3">*** circular-string-area,stay</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">circular-string-area,stay</span>
      <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- &gt;&gt;</span>
      dup <span class="cicada-nymph-variable">*circular-string-area,current-free-address*</span> add
      <span class="cicada-nymph-variable">*circular-string-area,size*</span> <span class="cicada-nymph-variable">*circular-string-area*</span> add
      greater-or-equal? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-variable">*circular-string-area*</span>
        <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*circular-string-area,current-free-address*</span> save
      <span class="cicada-nymph-syntax-key-word">then</span>
      tuck
      <span class="cicada-nymph-variable">*circular-string-area,current-free-address*</span>
      string-&gt;buffer!
      <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*circular-string-area,current-free-address*</span>
      add-save
      <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-variable">*circular-string-area,current-free-address*</span>
      save-byte
      <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*circular-string-area,current-free-address*</span>
      add-save
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** syntax,double-quote,basic-REPL</span>
    * in ASCII encode double-quote is 34
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,double-quote,basic-REPL,loop</span>
      <span class="cicada-nymph-comment">&lt;&lt; cursor -- cursor &gt;&gt;</span>
      read-byte
      dup <span class="cicada-nymph-number">34</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
        drop
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      over save-byte
      add1
      <span class="cicada-nymph-end">loop</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,double-quote,basic-REPL</span>
      <span class="cicada-nymph-comment">&lt;&lt; word:double-quote -- string[address, length] &gt;&gt;</span>
      drop2
      <span class="cicada-nymph-number">1024</span> <span class="cicada-nymph-number">2</span> mul <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
      <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
      <span class="cicada-nymph-title">syntax</span>,double-quote,basic-REPL,loop
      <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
      <span class="cicada-nymph-variable">*circular-string-area,current-free-address*</span> <span class="cicada-nymph-save-local-variable-1">&gt;:address</span>
      <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
      <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> sub dup <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
      <span class="cicada-nymph-title">circular-string-area</span>,stay
      <span class="cicada-nymph-fetch-local-variable-1">:address</span>
      <span class="cicada-nymph-fetch-local-variable-1">:length</span>
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** add-rule to </span><span class="org-level-3"><span class="bold">*rule-set,basic-REPL*</span></span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-syntax-key-word">jo</span> word:double-quote? <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,double-quote,basic-REPL <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    one? <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-string">"111"</span> .s .l
    <span class="cicada-nymph-syntax-key-word">then</span>

    one? <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-string">"111"</span> .s .l
    <span class="cicada-nymph-syntax-key-word">else</span>
      <span class="cicada-nymph-string">"___"</span> .s .l
    <span class="cicada-nymph-syntax-key-word">then</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** address                            </span><span class="org-level-2"><span class="org-tag">:syntax:</span></span>
<span class="org-level-3">*** syntax,address,basic-REPL</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-number">0</span>
    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*syntax,address,basic-REPL,stack-balancer*</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,address,basic-REPL</span>
      <span class="cicada-nymph-comment">&lt;&lt; word:address -- address &gt;&gt;</span>
      drop2
      read-word-for-REPL
      <span class="cicada-nymph-save-local-variable-2">&gt;::word</span>
      <span class="cicada-nymph-fetch-local-variable-2">::word</span> <span class="cicada-nymph-title">name-hash-table</span>,find-jo <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-syntax-key-word">else</span>
        <span class="cicada-nymph-string">"* (syntax,address,basic-REPL) meet undefined word : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::word</span> .s .l
        <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*syntax,address,basic-REPL,stack-balancer*</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-save-local-variable-1">&gt;:jo</span>
      <span class="cicada-nymph-fetch-local-variable-1">:jo</span> variable-jo? <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-syntax-key-word">else</span>
        <span class="cicada-nymph-string">"* (syntax,address,basic-REPL) meet a not variable-jo : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::word</span> .s .l
        <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*syntax,address,basic-REPL,stack-balancer*</span>
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-fetch-local-variable-1">:jo</span> <span class="cicada-nymph-variable">*jo-size*</span> add
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** add-rule to </span><span class="org-level-3"><span class="bold">*rule-set,basic-REPL*</span></span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-syntax-key-word">jo</span> word:address?
    <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,address,basic-REPL
    <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-number">666</span>
    <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*syntax,address,basic-REPL,stack-balancer*</span> save
    <span class="cicada-nymph-variable">*syntax,address,basic-REPL,stack-balancer*</span>

    <span class="cicada-nymph-syntax-key-word">address</span> kkk
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-2">** &lt;title&gt;                            </span><span class="org-level-2"><span class="org-tag">:syntax:</span></span>
<span class="org-level-3">*** </span><span class="org-todo">note</span>
    * &lt;title&gt; in <span class="bold">*rule-set,make-jojo*</span>
      &lt;title&gt; name
      save a jo into <span class="bold">*jojo-area*</span>
    * &lt;title&gt; in <span class="bold">*rule-set,basic-REPL*</span>
      &lt;title&gt; name
      execute a jo
<span class="org-level-3">*** syntax,&lt;title&gt;,basic-REPL</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,&lt;title&gt;,basic-REPL</span>
      <span class="cicada-nymph-comment">&lt;&lt; &lt;title&gt;[address, length] -- unknown &gt;&gt;</span>
      <span class="cicada-nymph-save-local-variable-2">&gt;::title</span>
      <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
      <span class="cicada-nymph-fetch-local-variable-2">::title</span> <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> string-&gt;buffer!
      <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-2">::title</span> swap drop <span class="cicada-nymph-save-local-variable-2">&gt;::title</span>

      read-word-for-REPL <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>
      <span class="cicada-nymph-fetch-local-variable-2">::title</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span>
      <span class="cicada-nymph-title">name-hash-table</span>,find-jo,with-title <span class="cicada-nymph-syntax-key-word">if</span>
        apply
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-string">"* (syntax,&lt;title&gt;,basic-REPL) meet undefined"</span> .s .l
      <span class="cicada-nymph-string">"  title : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::title</span> .s .l
      <span class="cicada-nymph-string">"  name  : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::name</span> .s .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** add-rule to </span><span class="org-level-3"><span class="bold">*rule-set,basic-REPL*</span></span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-syntax-key-word">jo</span> &lt;word&gt;?
    <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,&lt;title&gt;,basic-REPL
    <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;test-title&gt; test-name</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
      <span class="cicada-nymph-string">"TEST"</span> .s .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
    <span class="cicada-nymph-XdataX">&lt;test-title&gt;</span> test-name
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-1">* stack-REPL</span>
<span class="org-level-2">** </span><span class="org-todo">note</span>
   * print argument-stack in every loop
<span class="org-level-2">** print-argument-stack</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">print-argument-stack,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; address, counter -- &gt;&gt;</span>
     dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     sub1 swap
       dup fetch .
     <span class="cicada-nymph-variable">*jo-size*</span> add
     swap
     <span class="cicada-nymph-end">loop</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">print-argument-stack</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     snapshot-the-stack-pointer
     <span class="cicada-nymph-variable">*the-stack-pointer-snapshot*</span>
     <span class="cicada-nymph-variable">*the-stack*</span> greater-or-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-variable">*the-stack*</span>   <span class="cicada-nymph-comment">&lt;&lt; address as return value &gt;&gt;</span>
       <span class="cicada-nymph-variable">*the-stack-pointer-snapshot*</span> <span class="cicada-nymph-variable">*the-stack*</span> sub
       <span class="cicada-nymph-variable">*jo-size*</span> div <span class="cicada-nymph-comment">&lt;&lt; counter as return value &gt;&gt;</span>
       <span class="cicada-nymph-title">print-argument-stack</span>,loop
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-string">"below the stack "</span> .s
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** print-argument-stack,pretty</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">print-argument-stack,pretty</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     snapshot-the-stack-pointer
     .l
     <span class="cicada-nymph-string">"  * "</span> .s
        <span class="cicada-nymph-variable">*the-stack-pointer-snapshot*</span>
        <span class="cicada-nymph-variable">*the-stack*</span> sub
        <span class="cicada-nymph-comment">&lt;&lt; ad hoc for the BUG of div &gt;&gt;</span>
        dup negative? <span class="cicada-nymph-syntax-key-word">if</span>
          negate
          <span class="cicada-nymph-variable">*jo-size*</span> div
          negate
        <span class="cicada-nymph-syntax-key-word">else</span>
          <span class="cicada-nymph-variable">*jo-size*</span> div
        <span class="cicada-nymph-syntax-key-word">then</span>
        .i
     <span class="cicada-nymph-string">" * "</span> .s
     <span class="cicada-nymph-string">" -- "</span> .s
       print-argument-stack
     <span class="cicada-nymph-string">"--"</span> .s
     .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** stack-REPL</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">stack-REPL,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; unknown -- unknown &gt;&gt;</span>
     read-word-for-REPL
     eval-word
     <span class="cicada-nymph-title">print-argument-stack</span>,pretty
     <span class="cicada-nymph-end">loop</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">stack-REPL</span>
     <span class="cicada-nymph-comment">&lt;&lt; unknown -- unknown &gt;&gt;</span>
     prepare-for
       <span class="cicada-nymph-exception">!bye,basic-REPL</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> push-syntax-stack
     <span class="cicada-nymph-title">stack-REPL</span>,loop
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">     #+end_src
</span><span class="org-level-2">** reset </span><span class="org-level-2"><span class="bold">*lost-exception-REPL*</span></span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-syntax-key-word">jo</span> stack-REPL <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*lost-exception-REPL*</span> save
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">function-with-lost-exception</span>
     <span class="cicada-nymph-exception">!undo-make-jojo</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
   function-with-lost-exception
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* rule-set</span>
<span class="org-level-2">** </span><span class="org-done">test</span><span class="org-level-2"> endianness of n-fetch &amp; n-save</span>
   * big-endian is used
     in memory
     <span class="org-table">| value-1 |</span>
     <span class="org-table">| value-2 |</span>
     <span class="org-table">| value-3 |</span>
     on stack
     &lt;&lt; value-1, value-2, value-3 &gt;&gt;
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-number">3</span> <span class="cicada-nymph-variable">*jo-size*</span> mul <span class="cicada-nymph-allocate">allocate-memory</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*t*</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

   <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">3</span> <span class="cicada-nymph-variable">*t*</span> <span class="cicada-nymph-number">3</span> n-save

   <span class="cicada-nymph-comment">&lt;&lt; re-occur when fetching through &gt;&gt;</span>
   <span class="cicada-nymph-variable">*t*</span> fetch .
   <span class="cicada-nymph-variable">*t*</span> <span class="cicada-nymph-variable">*jo-size*</span> add fetch .
   <span class="cicada-nymph-variable">*t*</span> <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">2</span> mul add fetch .

   <span class="cicada-nymph-variable">*t*</span> <span class="cicada-nymph-number">3</span> n-fetch
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** list-rule</span>
   * &#26368;&#24460;&#23531;&#21040;&#35215;&#21063;&#38598;&#21512;&#35023;&#30340; &#34987;&#26368;&#20808;&#25171;&#21360;&#20986;&#20358;
   * &#19979;&#38754;&#30340;&#25171;&#21360;&#26041;&#24335; &#30475;&#20284;&#26377;&#20123;&#19981;&#31777;&#28500;
     &#26159;&#22240;&#29234; &#25105;&#36996;&#27794;&#26377; integer-&gt;string &#36889;&#27171;&#30340;&#20989;&#25976;
     [&#22240;&#29234; &#27794;&#26377;&#23565;&#23383;&#31526;&#20018;&#30340;&#21205;&#24907;&#20839;&#23384;&#31649;&#29702;]
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">list-rule,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; rule-set, cursor, counter -- &gt;&gt;</span>
     xx|over|x equal? <span class="cicada-nymph-syntax-key-word">if</span>
       drop drop2
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-string">"  * "</span> .s
     <span class="cicada-nymph-string">"("</span> .s
     add1 dup .i
     <span class="cicada-nymph-string">")"</span> .s .l
     swap
       dup cursor-&gt;predicate
       <span class="cicada-nymph-string">"    "</span> .s jo-&gt;name-string .s .l
       dup cursor-&gt;function
       <span class="cicada-nymph-string">"    "</span> .s jo-&gt;name-string .s .l
       <span class="cicada-nymph-variable">*jo-size*</span> sub <span class="cicada-nymph-variable">*jo-size*</span> sub
     swap
     <span class="cicada-nymph-end">loop</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">list-rule</span>
     <span class="cicada-nymph-comment">&lt;&lt; rule-set -- &gt;&gt;</span>
     dup <span class="cicada-nymph-title">rule-set</span>,fetch-border
     <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">list-rule</span>,loop
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** sub-rule</span>
   * firstly
     in (sub-rule,loop)
     cursor move from border down to address of rule-set
     secondly
     in (sub-rule,move)
     cursor move from founded place up to border
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">sub-rule,move-one</span>
     <span class="cicada-nymph-comment">&lt;&lt; cursor -- &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-number">2</span> n-fetch
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">2</span> mul sub
     <span class="cicada-nymph-number">2</span> n-save
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">sub-rule,move</span>
     <span class="cicada-nymph-comment">&lt;&lt; rule-set, cursor -- &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:rule-set</span>
     <span class="cicada-nymph-fetch-local-variable-1">:rule-set</span> <span class="cicada-nymph-title">rule-set</span>,fetch-border <span class="cicada-nymph-save-local-variable-1">&gt;:border</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:border</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-fetch-local-variable-1">:border</span> <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">2</span> mul sub
       <span class="cicada-nymph-fetch-local-variable-1">:rule-set</span>
       <span class="cicada-nymph-title">rule-set</span>,save-border
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-title">sub-rule</span>,move-one
     <span class="cicada-nymph-fetch-local-variable-1">:rule-set</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">2</span> mul add
     <span class="cicada-nymph-end">loop</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">sub-rule,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; rule[predicate, function], rule-set, cursor -- &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:rule-set</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::rule</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:rule-set</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-2">::rule</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> cursor-&gt;rule equal2? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-fetch-local-variable-1">:rule-set</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
       <span class="cicada-nymph-title">sub-rule</span>,move
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-2">::rule</span>
     <span class="cicada-nymph-fetch-local-variable-1">:rule-set</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">2</span> mul sub
     <span class="cicada-nymph-end">loop</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">sub-rule</span>
     <span class="cicada-nymph-comment">&lt;&lt; rule[predicate, function], rule-set -- &gt;&gt;</span>
     dup <span class="cicada-nymph-title">rule-set</span>,fetch-border
     <span class="cicada-nymph-title">sub-rule</span>,loop
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> list-rule

   <span class="cicada-nymph-syntax-key-word">jo</span> word:address?
   <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,address,basic-REPL
   <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule
   <span class="cicada-nymph-syntax-key-word">jo</span> word:double-quote?
   <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,double-quote,basic-REPL
   <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule
   <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> list-rule

   <span class="cicada-nymph-syntax-key-word">jo</span> word:address?
   <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,address,basic-REPL
   <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> sub-rule
   <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> list-rule

   <span class="cicada-nymph-syntax-key-word">jo</span> word:double-quote?
   <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,double-quote,basic-REPL
   <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> sub-rule
   <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> list-rule
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* eval-string</span>
<span class="org-level-2">** </span><span class="org-todo">note</span>
   * eval-string is implemented by doing side-effect on reading-stack
     this is because syntax extension system is implemented by reader-macro
   * by implementing eval-string this way
     i can easily change the syntax be used to eval a string
<span class="org-level-2">** eval-string</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">eval-string,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; unknown -- unknown &gt;&gt;</span>
     tos-reading-stack space-string? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     read-word-for-REPL
     eval-word
     <span class="cicada-nymph-end">loop</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">eval-string</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- unknown &gt;&gt;</span>
     push-reading-stack
     <span class="cicada-nymph-title">eval-string</span>,loop
     drop-reading-stack
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-string">"1 2 3 add add . "</span> eval-string <span class="cicada-nymph-comment">&lt;&lt; 6 &gt;&gt;</span>
   <span class="cicada-nymph-string">"1 2 3 add add ."</span> eval-string  <span class="cicada-nymph-comment">&lt;&lt; 6 &gt;&gt;</span>
   <span class="cicada-nymph-string">": k 1 2 3 add add . end ; define-function k"</span> eval-string <span class="cicada-nymph-comment">&lt;&lt; 6 &gt;&gt;</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* define-variable</span>
<span class="org-level-2">** </span><span class="org-todo">note</span><span class="org-level-2"> string allocation</span>
   * string should be allocated to a static area
     instead of dynamic area like <span class="bold">*circular-string-area*</span>
     thus we have
     (syntax,double-quote,define-variable)
<span class="org-level-2">** syntax,double-quote,define-variable</span>
   * in ASCII encode double-quote is 34
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,double-quote,define-variable,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; cursor -- cursor &gt;&gt;</span>
     read-byte
     dup <span class="cicada-nymph-number">34</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
       drop
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     over save-byte
     add1
     <span class="cicada-nymph-end">loop</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,double-quote,define-variable</span>
     <span class="cicada-nymph-comment">&lt;&lt; word:double-quote -- string[address, length] &gt;&gt;</span>
     drop2
     <span class="cicada-nymph-number">1024</span> <span class="cicada-nymph-number">2</span> mul <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
     <span class="cicada-nymph-title">syntax</span>,double-quote,define-variable,loop
     <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> sub
     make-string
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** define-variable</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">define-variable</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>

     <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-head</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::title</span>
     <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-title">string-head</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>
     <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::body</span>

     <span class="cicada-nymph-fetch-local-variable-2">::title</span> <span class="cicada-nymph-string">" "</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span>
     <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> dup <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
     <span class="cicada-nymph-number">3</span> n-string-&gt;buffer! <span class="cicada-nymph-save-local-variable-1">&gt;:len</span>
     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:len</span> <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>
     <span class="cicada-nymph-fetch-local-variable-2">::title</span> &lt;word&gt;? not <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-fetch-local-variable-2">::title</span> <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>
       <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::body</span>
     <span class="cicada-nymph-syntax-key-word">then</span>

     snapshot-the-stack-pointer
     <span class="cicada-nymph-variable">*the-stack-pointer-snapshot*</span> <span class="cicada-nymph-save-local-variable-1">&gt;:old-snapshot</span>

     <span class="cicada-nymph-syntax-key-word">jo</span> word:double-quote?
     <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,double-quote,define-variable
     <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule

     <span class="cicada-nymph-fetch-local-variable-2">::body</span> eval-string

     <span class="cicada-nymph-syntax-key-word">jo</span> word:double-quote?
     <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,double-quote,define-variable
     <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> sub-rule

     snapshot-the-stack-pointer
     <span class="cicada-nymph-variable">*the-stack-pointer-snapshot*</span> <span class="cicada-nymph-save-local-variable-1">&gt;:new-snapshot</span>

     <span class="cicada-nymph-fetch-local-variable-1">:new-snapshot</span> <span class="cicada-nymph-fetch-local-variable-1">:old-snapshot</span> sub

     dup negative? <span class="cicada-nymph-syntax-key-word">if</span>
       negate <span class="cicada-nymph-variable">*jo-size*</span> div
       <span class="cicada-nymph-string">"* (define-variable) fail to define variable : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::name</span> .s .l
       <span class="cicada-nymph-string">"  because after eval the following body"</span> .s .l
       <span class="cicada-nymph-string">"  the stack is "</span> .s .i <span class="cicada-nymph-string">" below what it use to be"</span> .s .l
       <span class="cicada-nymph-fetch-local-variable-2">::body</span> .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
       drop
       <span class="cicada-nymph-string">"* (define-variable) fail to define variable : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::name</span> .s .l
       <span class="cicada-nymph-string">"  because after eval the following body"</span> .s .l
       <span class="cicada-nymph-string">"  the stack is still where it use to be"</span> .s .l
       <span class="cicada-nymph-fetch-local-variable-2">::body</span> .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>

     <span class="cicada-nymph-variable">*jo-size*</span> div <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>

     <span class="cicada-nymph-fetch-local-variable-2">::name</span> make-string <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>

     <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-variable">*link*</span> <span class="cicada-nymph-number">0</span>
     make-link <span class="cicada-nymph-save-local-variable-1">&gt;:link</span>

     <span class="cicada-nymph-fetch-local-variable-1">:link</span> <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*link*</span> save

     <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-variable">*explainer,variable*</span> <span class="cicada-nymph-number">0</span>
     make-jo-head <span class="cicada-nymph-save-local-variable-1">&gt;:jo</span>

     <span class="cicada-nymph-fetch-local-variable-1">:jo</span> <span class="cicada-nymph-fetch-local-variable-1">:link</span> <span class="cicada-nymph-title">link</span>,save-jo

     <span class="cicada-nymph-fetch-local-variable-1">:link</span> <span class="cicada-nymph-title">name-hash-table</span>,save-jo,by-link

     <span class="cicada-nymph-fetch-local-variable-1">:length</span>
     <span class="cicada-nymph-fetch-local-variable-1">:jo</span> <span class="cicada-nymph-title">jo</span>,save-length

     <span class="cicada-nymph-variable">*jojo-area,current-free-address*</span>
     <span class="cicada-nymph-fetch-local-variable-1">:length</span>
     n-save

     <span class="cicada-nymph-fetch-local-variable-1">:length</span> <span class="cicada-nymph-variable">*jo-size*</span> mul
     <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*jojo-area,current-free-address*</span>
     add-save
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*numbers:define-variable*</span>
     <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">3</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable</span>
   <span class="cicada-nymph-variable">*numbers:define-variable*</span> . . . <span class="cicada-nymph-comment">&lt;&lt; 3 2 1 &gt;&gt;</span>
   <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*numbers:define-variable*</span> fetch . <span class="cicada-nymph-comment">&lt;&lt; 1 &gt;&gt;</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*string:define-variable*</span>
     <span class="cicada-nymph-string">"define-variable"</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable</span>
   <span class="cicada-nymph-variable">*string:define-variable*</span> .s <span class="cicada-nymph-comment">&lt;&lt; define-variable &gt;&gt;</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;test-title&gt;</span> <span class="cicada-nymph-variable">*numbers:define-variable*</span>
     <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">3</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable</span>
   <span class="cicada-nymph-XdataX">&lt;test-title&gt;</span> <span class="cicada-nymph-variable">*numbers:define-variable*</span> . . . <span class="cicada-nymph-comment">&lt;&lt; 3 2 1 &gt;&gt;</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;test-title&gt;</span> <span class="cicada-nymph-variable">*string:define-variable*</span>
     <span class="cicada-nymph-string">"define-variable"</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable</span>
   <span class="cicada-nymph-XdataX">&lt;test-title&gt;</span> <span class="cicada-nymph-variable">*string:define-variable*</span> .s <span class="cicada-nymph-comment">&lt;&lt; define-variable &gt;&gt;</span>

   <span class="cicada-nymph-comment">&lt;&lt; error &gt;&gt;</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">kkk</span>
     <span class="cicada-nymph-number">1</span> . <span class="cicada-nymph-number">2</span> . <span class="cicada-nymph-number">3</span> .
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable</span>

   <span class="cicada-nymph-comment">&lt;&lt; error &gt;&gt;</span>
   <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-number">2</span> <span class="cicada-nymph-number">3</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">kkk</span>
     . . .
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* constant of system</span>
<span class="org-level-2">** </span><span class="org-todo">note</span><span class="org-level-2"> </span><span class="org-level-2"><span class="bold">*linux*</span></span>
<span class="org-level-2">** init-syscall-number                </span><span class="org-level-2"><span class="org-tag">:32bit:</span></span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">4</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
     <span class="cicada-nymph-number">5</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,open:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">6</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,close:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">3</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,read:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">4</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,write:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">9</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,link:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">10</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,unlink:</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">39</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,mkdir:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">40</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,rmdir:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">141</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,getdents:</span>   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">220</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,getdents64:</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">106</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,stat:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">1</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,exit:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">43</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,times:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">20</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,getpid:</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">183</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,getcwd:</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">12</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,chdir:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-syntax-key-word">then</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** init-syscall-number                </span><span class="org-level-2"><span class="org-tag">:64bit:</span></span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">8</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
     <span class="cicada-nymph-number">2</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,open:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">3</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,close:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">0</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,read:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">1</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,write:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">86</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,link:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">87</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,unlink:</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">83</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,mkdir:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">84</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,rmdir:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">78</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,getdents:</span>   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">217</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,getdents64:</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">4</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,stat:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">60</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,exit:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">100</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,times:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">39</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,getpid:</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">79</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,getcwd:</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
     <span class="cicada-nymph-number">80</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,chdir:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-syntax-key-word">then</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** error-code-&gt;string</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">error-code-&gt;string</span>
     <span class="cicada-nymph-comment">&lt;&lt; error-code -- string[address, length] &gt;&gt;</span>
     dup <span class="cicada-nymph-number">-1</span>  equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EPERM   &gt;&gt;</span>   <span class="cicada-nymph-string">"Operation not permitted "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-2</span>  equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENOENT  &gt;&gt;</span>   <span class="cicada-nymph-string">"No such file or directory "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-3</span>  equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ESRCH   &gt;&gt;</span>   <span class="cicada-nymph-string">"No such process "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-4</span>  equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EINTR   &gt;&gt;</span>   <span class="cicada-nymph-string">"Interrupted system call "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-5</span>  equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EIO     &gt;&gt;</span>   <span class="cicada-nymph-string">"I/O error "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-6</span>  equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENXIO   &gt;&gt;</span>   <span class="cicada-nymph-string">"No such device or address "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-7</span>  equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; E2BIG   &gt;&gt;</span>   <span class="cicada-nymph-string">"Argument list too long "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-8</span>  equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENOEXEC &gt;&gt;</span>   <span class="cicada-nymph-string">"Exec format error "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-9</span>  equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EBADF   &gt;&gt;</span>   <span class="cicada-nymph-string">"Bad file number "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-10</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ECHILD  &gt;&gt;</span>   <span class="cicada-nymph-string">"No child processes "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-11</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EAGAIN  &gt;&gt;</span>   <span class="cicada-nymph-string">"Try again "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-12</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENOMEM  &gt;&gt;</span>   <span class="cicada-nymph-string">"Out of memory "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-13</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EACCES  &gt;&gt;</span>   <span class="cicada-nymph-string">"Permission denied "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-14</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EFAULT  &gt;&gt;</span>   <span class="cicada-nymph-string">"Bad address "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-15</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENOTBLK &gt;&gt;</span>   <span class="cicada-nymph-string">"Block device required "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-16</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EBUSY   &gt;&gt;</span>   <span class="cicada-nymph-string">"Device or resource busy "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-17</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EEXIST  &gt;&gt;</span>   <span class="cicada-nymph-string">"File exists "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-18</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EXDEV   &gt;&gt;</span>   <span class="cicada-nymph-string">"Cross-device link "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-19</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENODEV  &gt;&gt;</span>   <span class="cicada-nymph-string">"No such device "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-20</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENOTDIR &gt;&gt;</span>   <span class="cicada-nymph-string">"Not a directory "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-21</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EISDIR  &gt;&gt;</span>   <span class="cicada-nymph-string">"Is a directory "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-22</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EINVAL  &gt;&gt;</span>   <span class="cicada-nymph-string">"Invalid argument "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-23</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENFILE  &gt;&gt;</span>   <span class="cicada-nymph-string">"File table overflow "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-24</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EMFILE  &gt;&gt;</span>   <span class="cicada-nymph-string">"Too many open files "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-25</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENOTTY  &gt;&gt;</span>   <span class="cicada-nymph-string">"Not a typewriter "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-26</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ETXTBSY &gt;&gt;</span>   <span class="cicada-nymph-string">"Text file busy "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-27</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EFBIG   &gt;&gt;</span>   <span class="cicada-nymph-string">"File too large "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-28</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENOSPC  &gt;&gt;</span>   <span class="cicada-nymph-string">"No space left on device "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-29</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ESPIPE  &gt;&gt;</span>   <span class="cicada-nymph-string">"Illegal seek "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-30</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EROFS   &gt;&gt;</span>   <span class="cicada-nymph-string">"Read-only file system "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-31</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EMLINK  &gt;&gt;</span>   <span class="cicada-nymph-string">"Too many links "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-32</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EPIPE   &gt;&gt;</span>   <span class="cicada-nymph-string">"Broken pipe "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-33</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EDOM    &gt;&gt;</span>   <span class="cicada-nymph-string">"Math argument out of domain of func "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">-34</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ERANGE  &gt;&gt;</span>   <span class="cicada-nymph-string">"Math result not representable "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-string">"unknow error-code : "</span> .s .i .l
     <span class="cicada-nymph-string">"* (error-code-&gt;string) fail"</span> <span class="cicada-nymph-comment">&lt;&lt; to balance the argument-stack &gt;&gt;</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** file-type-code-&gt;string</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">file-type-code-&gt;string</span>
     <span class="cicada-nymph-comment">&lt;&lt; file-type-code -- string[address, length] &gt;&gt;</span>
     dup <span class="cicada-nymph-number">1</span>  equal?  <span class="cicada-nymph-comment">&lt;&lt; DT_FIFO  &gt;&gt;</span>  <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"named pipe i.e. FIFO"</span>  <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">2</span>  equal?  <span class="cicada-nymph-comment">&lt;&lt; DT_CHR   &gt;&gt;</span>  <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"character device"</span>      <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">4</span>  equal?  <span class="cicada-nymph-comment">&lt;&lt; DT_DIR   &gt;&gt;</span>  <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"directory"</span>             <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">6</span>  equal?  <span class="cicada-nymph-comment">&lt;&lt; DT_BLK   &gt;&gt;</span>  <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"block device"</span>          <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">8</span>  equal?  <span class="cicada-nymph-comment">&lt;&lt; DT_REG   &gt;&gt;</span>  <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"regular file"</span>          <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">10</span> equal?  <span class="cicada-nymph-comment">&lt;&lt; DT_LNK   &gt;&gt;</span>  <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"symbolic link"</span>         <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">12</span> equal?  <span class="cicada-nymph-comment">&lt;&lt; DT_SOCK  &gt;&gt;</span>  <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"UNIX domain socket"</span>    <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     drop
     <span class="cicada-nymph-string">"unknow file type"</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* link</span>
<span class="org-level-2">** list-by-jo-predicate</span>
   * &#26368;&#24460;&#23531;&#21040;&#29664;&#20856;&#35023;&#30340; &#34987;&#26368;&#20808;&#25171;&#21360;&#20986;&#20358;
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;link&gt; list-by-jo-predicate,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; jo-predicate, counter, link -- &gt;&gt;</span>
     dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
       drop
       drop
       drop
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     dup link-&gt;jo
     x|over|xxx apply false? <span class="cicada-nymph-syntax-key-word">if</span>
       link-&gt;next-link
       <span class="cicada-nymph-end">loop</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     swap
       <span class="cicada-nymph-string">"  "</span> .s
       add1 dup .i <span class="cicada-nymph-string">". "</span> .s
     swap
     dup link-&gt;jo jo-&gt;name-string
     dup2 space-string? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-string">"  unnamed"</span> .s .l
     <span class="cicada-nymph-syntax-key-word">else</span>
       .s .l
     <span class="cicada-nymph-syntax-key-word">then</span>
     link-&gt;next-link
     <span class="cicada-nymph-end">loop</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;link&gt; list-by-jo-predicate</span>
     <span class="cicada-nymph-comment">&lt;&lt; link, jo-predicate -- &gt;&gt;</span>
     swap
     <span class="cicada-nymph-number">0</span>
     swap
     <span class="cicada-nymph-XdataX">&lt;link&gt;</span> <span class="cicada-nymph-title">list-by-jo-predicate</span>,loop
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-variable">*link*</span>
     <span class="cicada-nymph-syntax-key-word">jo</span> primitive-function-jo?
     <span class="cicada-nymph-XdataX">&lt;link&gt;</span> list-by-jo-predicate
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
   test
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* port</span>
<span class="org-level-2">** </span><span class="org-todo">note</span>
<span class="org-level-3">*** syscall with string arguments</span>
    * for syscall the arguments in stack look like
      &lt;&lt; ..., arg3, arg2, arg1 &gt;&gt;
      so
      for read(port, buffer, size)
      we need
      &lt;&lt; size, buffer, port &gt;&gt;
      but the interface (&lt;port&gt; read) in cicada-nymph is
      &lt;&lt; buffer, size, port &gt;&gt;
      thus we need a swap here
      and
      we should be careful
      for other interface functions in cicada-nymph
<span class="org-level-3">*** linux header</span>
    * 8 base number :
      O_ACCMODE          0003
      O_RDONLY             00
      O_WRONLY             01
      O_RDWR               02
      O_CREAT            0100  Not fcntl
      O_EXCL             0200  Not fcntl
      O_NOCTTY           0400  Not fcntl
      O_TRUNC           01000  Not fcntl
      O_APPEND          02000
      O_NONBLOCK        04000
      O_NDELAY     O_NONBLOCK
      O_SYNC         04010000
      O_FSYNC          O_SYNC
      O_ASYNC          020000
      O_LARGEFILE     0100000
      O_DIRECTORY     0200000
      O_NOFOLLOW      0400000
      O_CLOEXEC      02000000
      O_DIRECT         040000
      O_NOATIME      01000000
      O_PATH        010000000
      O_DSYNC          010000
      O_TMPFILE     020200000
<span class="org-level-3">*** &#38364;&#26044;&#36664;&#20837;&#36664;&#20986;</span>
    * &#25509;&#21475;&#35373;&#35336;&#20998;&#20841;&#20491;&#23652;&#27425;
      1. &#24213;&#23652;&#30340;&#20197; port &#29234;&#22522;&#30990;&#30340;&#25509;&#21475;
         &#36889;&#35023;&#25033;&#35442;&#22914;&#20309;&#35373;&#35336;&#36996;&#19981;&#30906;&#23450;
         &#21487;&#33021;&#26371;&#27169;&#20223;&#25805;&#20316;&#31995;&#32113;&#25152;&#25552;&#20379;&#30340;&#25509;&#21475;
      2. &#39640;&#23652;&#30340;&#20197; path &#29234;&#22522;&#30990;&#30340;&#25509;&#21475;
         &#36889;&#35023;&#23559;&#25277;&#35937;&#25481; port &#36889;&#20491;&#27010;&#24565;
         &#20063;&#23601;&#26159;&#27599;&#27425;&#31777;&#21934;&#30340;&#35712;&#23531;&#37117;&#20276;&#38568;&#20841;&#20491;&#23565; port &#30340;&#25805;&#20316;
         &#36889;&#27171;&#25509;&#21475;&#23601;&#24456;&#31777;&#21934; &#20294;&#26159;&#36895;&#24230;&#21487;&#33021;&#26371;&#38750;&#24120;&#24930;
<span class="org-level-3">*** interface</span>
    * open to read
    * create and update to write
      <span class="org-table">|--------+-----------------------|</span>
      <span class="org-table">| create | fail if already exist |</span>
      <span class="org-table">| update | fail if nor exist     |</span>
      <span class="org-table">|--------+-----------------------|</span>
    * one should always know if a file exist or not
      when open it as output-port
      predicates are provided to help you to do so
<span class="org-level-2">** open</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;port&gt; open</span>
     <span class="cicada-nymph-comment">&lt;&lt; path[address, length]
        -- port, true
        -- error-code, false &gt;&gt;</span>
     string-&gt;syscall-string
     <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
     <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-comment">&lt;&lt;
     O_RDONLY
     &gt;&gt;</span>
     <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
     <span class="cicada-nymph-constant">:syscall-number,open:</span>
     <span class="cicada-nymph-number">2</span> syscall
     dup
     negative? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-bool">true</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** create</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;port&gt; create</span>
     <span class="cicada-nymph-comment">&lt;&lt; path[address, length]
        -- port, true
        -- error-code, false &gt;&gt;</span>
     string-&gt;syscall-string
     <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
     <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">644</span> <span class="cicada-nymph-comment">&lt;&lt;
     2#110100100
     &gt;&gt;</span>
     <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1102</span> <span class="cicada-nymph-comment">&lt;&lt;
     O_RDWR   0002
     O_CREAT  0100
     O_TRUNC  1000
     &gt;&gt;</span>
     <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
     <span class="cicada-nymph-constant">:syscall-number,open:</span>
     <span class="cicada-nymph-number">3</span> syscall
     dup
     negative? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-bool">true</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** update</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;port&gt; update</span>
     <span class="cicada-nymph-comment">&lt;&lt; path[address, length]
        -- port, true
        -- error-code, false &gt;&gt;</span>
     string-&gt;syscall-string
     <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
     <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">644</span> <span class="cicada-nymph-comment">&lt;&lt;
     110100100b
     &gt;&gt;</span>
     <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1002</span> <span class="cicada-nymph-comment">&lt;&lt;
     O_RDWR   0002
     O_TRUNC  1000
     &gt;&gt;</span>
     <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
     <span class="cicada-nymph-constant">:syscall-number,open:</span>
     <span class="cicada-nymph-number">3</span> syscall
     dup
     negative? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-bool">true</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** close</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;port&gt; close</span>
     <span class="cicada-nymph-comment">&lt;&lt; port
        -- true
        -- error-code, false &gt;&gt;</span>
     <span class="cicada-nymph-constant">:syscall-number,close:</span>
     <span class="cicada-nymph-number">1</span> syscall
     dup
     negative? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     drop <span class="cicada-nymph-bool">true</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"kkk~"</span> <span class="cicada-nymph-XdataX">&lt;port&gt;</span> create <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-XdataX">&lt;port&gt;</span> close <span class="cicada-nymph-syntax-key-word">if</span>
         <span class="cicada-nymph-end">end</span>
       <span class="cicada-nymph-syntax-key-word">then</span> error-code-&gt;string .s .l <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span> error-code-&gt;string .s .l <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
   test

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"kkk~"</span> <span class="cicada-nymph-XdataX">&lt;port&gt;</span> update <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-XdataX">&lt;port&gt;</span> close <span class="cicada-nymph-syntax-key-word">if</span>
         <span class="cicada-nymph-end">end</span>
       <span class="cicada-nymph-syntax-key-word">then</span> error-code-&gt;string .s .l <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span> error-code-&gt;string .s .l <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
   test
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** read</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;port&gt; read</span>
     <span class="cicada-nymph-comment">&lt;&lt; buffer, max-size, port
        -- counter, true
        -- error-code, false &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>
     swap
     <span class="cicada-nymph-fetch-local-variable-1">:port</span>
     <span class="cicada-nymph-constant">:syscall-number,read:</span>
     <span class="cicada-nymph-number">3</span> syscall
     dup
     negative? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-bool">true</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** write</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;port&gt; write</span>
     <span class="cicada-nymph-comment">&lt;&lt; buffer, max-size, port
        -- counter, true
        -- error-code, false &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>
     swap
     <span class="cicada-nymph-fetch-local-variable-1">:port</span>
     <span class="cicada-nymph-constant">:syscall-number,write:</span>
     <span class="cicada-nymph-number">3</span> syscall
     dup
     negative? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-bool">true</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-number">64</span> <span class="cicada-nymph-allocate">allocate-local-memory</span>
     dup
     <span class="cicada-nymph-string">"kkk~"</span> <span class="cicada-nymph-XdataX">&lt;port&gt;</span> open <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-number">64</span> swap <span class="cicada-nymph-XdataX">&lt;port&gt;</span> read <span class="cicada-nymph-syntax-key-word">if</span>
         .s .l
         <span class="cicada-nymph-end">end</span>
       <span class="cicada-nymph-syntax-key-word">then</span> error-code-&gt;string .s .l <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span> error-code-&gt;string .s .l <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
   test
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* file</span>
<span class="org-level-2">** </span><span class="org-todo">note</span><span class="org-level-2"> file-tree</span>
<span class="org-level-3">*** interface</span>
    * file-tree
      two types of nodes
      1. file
      2. directory
      a leaf must be a file
    * the following interface is provided
      * they use path as an argument
      * they print error message on error
        instead of return error info
        or rise exception
      * the concept of port is
        completely removed from the interface
      --------------------------------
      * file
        1. create
        2. write
        3. read
        4. remove
      * directory
        1. create
        2. remove
        3. empty?
        4. list-file
        5. list-directory
        6. find-file
        7. find-directory
<span class="org-level-3">*** &#37679;&#35492;&#34389;&#29702;</span>
    * &#20841;&#31278;&#39080;&#26684;
      IO &#30456;&#38364;&#30340;&#20989;&#25976;&#22312;&#20986;&#37679;&#26178;
      1. &#31435;&#21363;&#22577;&#37679;
      2. &#36820;&#22238;&#20986;&#37679;&#20449;&#24687;
    * &#31532;&#19968;&#31278;&#24456;&#31777;&#21934;
      &#23427;&#20551;&#35373;&#20102;&#25152;&#26377;&#30340;&#37679;&#35492;&#37117;&#26159;&#19981;&#21487;&#24573;&#30053;&#30340;
<span class="org-level-3">*** &#20803;&#25976;&#25818;</span>
    * &#35370;&#21839;&#31649;&#29702;
      1. &#35504;&#26377;&#27402;&#35370;&#21839;&#36889;&#20491;&#25991;&#20214;
      2. &#20182;&#30340;&#27402;&#21033;&#26159;&#20160;&#40636;
    * &#25991;&#20214;&#39006;&#22411;
      [linux &#27794;&#26377;]
    * &#25991;&#20214;&#22823;&#23567;
    * &#25991;&#20214;&#20351;&#29992;&#35387;&#37323;
      [linux &#27794;&#26377;]
<span class="org-level-2">** create</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;file&gt; create</span>
     <span class="cicada-nymph-comment">&lt;&lt; path[address, length] -- &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::path</span>
     <span class="cicada-nymph-fetch-local-variable-2">::path</span>
     string-&gt;syscall-string
     <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
     <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">644</span> <span class="cicada-nymph-comment">&lt;&lt;
     2#110100100
     &gt;&gt;</span>
     <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0200</span>
     <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0100</span> bit-or <span class="cicada-nymph-comment">&lt;&lt;
     O_EXCL   0200
     O_CREAT  0100
     &gt;&gt;</span>
     <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
     <span class="cicada-nymph-constant">:syscall-number,open:</span>
     <span class="cicada-nymph-number">3</span> syscall
     dup
     negative? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"* (&lt;file&gt; create) fail to open port for the following path :"</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-XdataX">&lt;port&gt;</span> close <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-string">"* (&lt;file&gt; create) fail to close port for the following path :"</span> .s .l
     <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
     <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** write</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;file&gt; write</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length], path[address, length] -- &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::path</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>
     <span class="cicada-nymph-fetch-local-variable-2">::path</span>
     string-&gt;syscall-string
     <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
     <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">644</span> <span class="cicada-nymph-comment">&lt;&lt;
     2#110100100
     &gt;&gt;</span>
     <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1002</span> <span class="cicada-nymph-comment">&lt;&lt;
     O_RDWR   0002
     O_TRUNC  1000
     &gt;&gt;</span>
     <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
     <span class="cicada-nymph-constant">:syscall-number,open:</span>
     <span class="cicada-nymph-number">3</span> syscall
     dup
     negative? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"* (&lt;file&gt; write) fail to open port for the following path :"</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>
     <span class="cicada-nymph-fetch-local-variable-2">::string</span> swap
     <span class="cicada-nymph-fetch-local-variable-1">:port</span>
     <span class="cicada-nymph-constant">:syscall-number,write:</span>
     <span class="cicada-nymph-number">3</span> syscall
     dup
     negative? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"* (&lt;file&gt; write) fail to write port for the following path :"</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:counter</span> <span class="cicada-nymph-comment">&lt;&lt; bytes been written &gt;&gt;</span>
     <span class="cicada-nymph-fetch-local-variable-1">:port</span>
     <span class="cicada-nymph-XdataX">&lt;port&gt;</span> close <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-string">"* (&lt;file&gt; write) fail to close port for the following path : "</span> .s .l
     <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
     <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** read</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;file&gt; read</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, max-length], path[address, length] -- counter &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::path</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>
     <span class="cicada-nymph-fetch-local-variable-2">::path</span>
     string-&gt;syscall-string
     <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
     <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-comment">&lt;&lt;
     O_RDONLY
     &gt;&gt;</span>
     <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
     <span class="cicada-nymph-constant">:syscall-number,open:</span>
     <span class="cicada-nymph-number">2</span> syscall
     dup
     negative? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"* (&lt;file&gt; read) fail to open port for the following path :"</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
       <span class="cicada-nymph-number">0</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>
     <span class="cicada-nymph-fetch-local-variable-2">::string</span> swap
     <span class="cicada-nymph-fetch-local-variable-1">:port</span>
     <span class="cicada-nymph-constant">:syscall-number,read:</span>
     <span class="cicada-nymph-number">3</span> syscall
     dup
     negative? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"* (&lt;file&gt; read) fail to read port for the following path :"</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
       <span class="cicada-nymph-number">0</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:counter</span> <span class="cicada-nymph-comment">&lt;&lt; bytes been readed &gt;&gt;</span>
     <span class="cicada-nymph-fetch-local-variable-1">:port</span>
     <span class="cicada-nymph-XdataX">&lt;port&gt;</span> close <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-fetch-local-variable-1">:counter</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-string">"* (&lt;file&gt; read) fail to close port for the following path : "</span> .s .l
     <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
     <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
     <span class="cicada-nymph-number">0</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** remove</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;file&gt; remove</span>
     <span class="cicada-nymph-comment">&lt;&lt; path[address, length] -- &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::path</span>
     <span class="cicada-nymph-fetch-local-variable-2">::path</span>
     string-&gt;syscall-string
     <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
     <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
     <span class="cicada-nymph-constant">:syscall-number,unlink:</span>
     <span class="cicada-nymph-number">1</span> syscall
     dup
     negative? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"* (&lt;file&gt; remove) fail for the following path :"</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     drop
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"kkk~"</span> <span class="cicada-nymph-XdataX">&lt;file&gt;</span> create
     <span class="cicada-nymph-string">"core"</span> <span class="cicada-nymph-XdataX">&lt;file&gt;</span> create
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
   test

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"kkk~"</span> <span class="cicada-nymph-XdataX">&lt;file&gt;</span> create
     <span class="cicada-nymph-string">"kkk took my baby away !!!"</span> <span class="cicada-nymph-string">"kkk~"</span> <span class="cicada-nymph-XdataX">&lt;file&gt;</span> write
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
   test

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"............................"</span> <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>
     <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-string">"kkk~"</span> <span class="cicada-nymph-XdataX">&lt;file&gt;</span> read .i .l
     <span class="cicada-nymph-fetch-local-variable-2">::string</span> .s
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
   test

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"kkk~"</span> <span class="cicada-nymph-XdataX">&lt;file&gt;</span> remove
     <span class="cicada-nymph-string">"play"</span> <span class="cicada-nymph-XdataX">&lt;file&gt;</span> remove
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
   test
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* directory</span>
<span class="org-level-2">** create</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;directory&gt; create</span>
     <span class="cicada-nymph-comment">&lt;&lt; path[address, length] -- &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::path</span>
     <span class="cicada-nymph-fetch-local-variable-2">::path</span>
     string-&gt;syscall-string
     <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
     <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">755</span> <span class="cicada-nymph-comment">&lt;&lt;
     2#111101101
     &gt;&gt;</span>
     <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
     <span class="cicada-nymph-constant">:syscall-number,mkdir:</span>
     <span class="cicada-nymph-number">2</span> syscall
     dup
     negative? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"* (&lt;directory&gt; create) fail for the following path :"</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     drop
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** remove</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;directory&gt; remove</span>
     <span class="cicada-nymph-comment">&lt;&lt; path[address, length] -- &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::path</span>
     <span class="cicada-nymph-fetch-local-variable-2">::path</span>
     string-&gt;syscall-string
     <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
     <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
     <span class="cicada-nymph-constant">:syscall-number,rmdir:</span>
     <span class="cicada-nymph-number">1</span> syscall
     dup
     negative? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"* (&lt;directory&gt; remove) fail for the following path :"</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     drop
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-string">"play"</span> <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> create
   <span class="cicada-nymph-string">"play"</span> <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> remove
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** getdents64 structure</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+getdents64,d_ino+</span>        <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+getdents64,d_off+</span>        <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+getdents64,d_reclen+</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+getdents64,d_type+</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+getdents64,d_name+</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+getdents64,end+</span>          <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">init,getdents64</span>
     <span class="cicada-nymph-comment">&lt;&lt; offset -- &gt;&gt;</span>
     <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">4</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_ino+</span>    save    <span class="cicada-nymph-number">8</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_off+</span>    save    <span class="cicada-nymph-number">8</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_reclen+</span> save    <span class="cicada-nymph-number">2</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_type+</span>   save    <span class="cicada-nymph-number">1</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_name+</span>   save    <span class="cicada-nymph-number">256</span> add
           <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,end+</span>      save
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">8</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_ino+</span>    save    <span class="cicada-nymph-number">8</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_off+</span>    save    <span class="cicada-nymph-number">8</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_reclen+</span> save    <span class="cicada-nymph-number">2</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_type+</span>   save    <span class="cicada-nymph-number">1</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_name+</span>   save    <span class="cicada-nymph-number">256</span> add
           <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,end+</span>      save
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">init</span>,getdents64
   <span class="cicada-nymph-constant">+getdents64,end+</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+getdents64,length+</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,getdents64,print</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"+getdents64,d_ino+ : "</span>    .s <span class="cicada-nymph-constant">+getdents64,d_ino+</span>     fetch . .l
     <span class="cicada-nymph-string">"+getdents64,d_off+ : "</span>    .s <span class="cicada-nymph-constant">+getdents64,d_off+</span>     fetch . .l
     <span class="cicada-nymph-string">"+getdents64,d_reclen+ : "</span> .s <span class="cicada-nymph-constant">+getdents64,d_reclen+</span>  fetch-two-bytes . .l
     <span class="cicada-nymph-string">"+getdents64,d_type+ : "</span>   .s
     <span class="cicada-nymph-constant">+getdents64,d_type+</span>
     fetch-byte file-type-code-&gt;string .s .l
     <span class="cicada-nymph-string">"+getdents64,d_name+ : "</span>   .s
     <span class="cicada-nymph-constant">+getdents64,d_name+</span>
     dup <span class="cicada-nymph-number">256</span>
     <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">string</span>,find-char
     drop  <span class="cicada-nymph-comment">&lt;&lt; drop 0 &gt;&gt;</span>
     over sub .s .l
     .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,getdents64,loop,structure</span>
     <span class="cicada-nymph-comment">&lt;&lt; end, cursor -- &gt;&gt;</span>
     dup2 less-or-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-title">init</span>,getdents64
     <span class="cicada-nymph-title">test</span>,getdents64,print
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-constant">+getdents64,d_reclen+</span> fetch-two-bytes add
     <span class="cicada-nymph-end">loop</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,getdents64,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; port -- &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>
     <span class="cicada-nymph-number">1024</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:getdents64-structure-list</span>
     <span class="cicada-nymph-number">1024</span>
     <span class="cicada-nymph-fetch-local-variable-1">:getdents64-structure-list</span>
     <span class="cicada-nymph-fetch-local-variable-1">:port</span>
     <span class="cicada-nymph-constant">:syscall-number,getdents64:</span>
     <span class="cicada-nymph-number">3</span> syscall
     <span class="cicada-nymph-string">"* syscall returns : "</span> .s dup .i .l
     dup negative? <span class="cicada-nymph-syntax-key-word">if</span>
       error-code-&gt;string .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
       drop
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-1">:getdents64-structure-list</span> add
     <span class="cicada-nymph-fetch-local-variable-1">:getdents64-structure-list</span>
     <span class="cicada-nymph-title">test</span>,getdents64,loop,structure
     <span class="cicada-nymph-fetch-local-variable-1">:port</span>
     <span class="cicada-nymph-end">loop</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,getdents64</span>
     <span class="cicada-nymph-comment">&lt;&lt; path[address, length] -- &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::path</span>
     <span class="cicada-nymph-fetch-local-variable-2">::path</span> <span class="cicada-nymph-XdataX">&lt;port&gt;</span> open <span class="cicada-nymph-syntax-key-word">if</span>
     <span class="cicada-nymph-syntax-key-word">else</span>
       <span class="cicada-nymph-string">"* (test,getdents64) fail to open : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>
     <span class="cicada-nymph-fetch-local-variable-1">:port</span> <span class="cicada-nymph-title">test</span>,getdents64,loop
     <span class="cicada-nymph-fetch-local-variable-1">:port</span> <span class="cicada-nymph-XdataX">&lt;port&gt;</span> close <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-string">"* (test,getdents64) fail to close : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
     <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-string">"play"</span> <span class="cicada-nymph-title">test</span>,getdents64
   <span class="cicada-nymph-string">"play/kkk"</span> <span class="cicada-nymph-title">test</span>,getdents64
   <span class="cicada-nymph-string">"."</span> <span class="cicada-nymph-title">test</span>,getdents64
   <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-title">test</span>,getdents64
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** empty?</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;directory&gt; empty?</span>
     <span class="cicada-nymph-comment">&lt;&lt; path[address, length] -- bool &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::path</span>
     <span class="cicada-nymph-fetch-local-variable-2">::path</span> <span class="cicada-nymph-XdataX">&lt;port&gt;</span> open <span class="cicada-nymph-syntax-key-word">if</span>
     <span class="cicada-nymph-syntax-key-word">else</span>
       <span class="cicada-nymph-string">"* (&lt;directory&gt; empty?) fail to open : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>
     <span class="cicada-nymph-number">128</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:getdents64-structure-list</span>
     <span class="cicada-nymph-number">128</span>
     <span class="cicada-nymph-fetch-local-variable-1">:getdents64-structure-list</span>
     <span class="cicada-nymph-fetch-local-variable-1">:port</span>
     <span class="cicada-nymph-constant">:syscall-number,getdents64:</span>
     <span class="cicada-nymph-number">3</span> syscall
     <span class="cicada-nymph-number">48</span> equal? <span class="cicada-nymph-comment">&lt;&lt; this call to equal? returns the needed bool &gt;&gt;</span>
     <span class="cicada-nymph-fetch-local-variable-1">:port</span> <span class="cicada-nymph-XdataX">&lt;port&gt;</span> close <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-string">"* (&lt;directory&gt; empty?) fail to close : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
     <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
     <span class="cicada-nymph-bool">false</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-string">"play"</span> <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> empty? . .l
   <span class="cicada-nymph-string">"play/kkk"</span> <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> empty? . .l
   <span class="cicada-nymph-string">"play/aaa"</span> <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> empty? . .l
   <span class="cicada-nymph-string">"."</span> <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> empty? . .l
   <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> empty? . .l
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** map</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;directory&gt; map,loop,execute</span>
     <span class="cicada-nymph-comment">&lt;&lt; end, cursor, function -- &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:function</span>
     dup2 less-or-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:end</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-title">init</span>,getdents64
     <span class="cicada-nymph-fetch-local-variable-1">:function</span> apply
     <span class="cicada-nymph-fetch-local-variable-1">:end</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-constant">+getdents64,d_reclen+</span> fetch-two-bytes add
     <span class="cicada-nymph-fetch-local-variable-1">:function</span>
     <span class="cicada-nymph-end">loop</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;directory&gt; map,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; port, function -- &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:function</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>
     <span class="cicada-nymph-number">1024</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:getdents64-structure-list</span>
     <span class="cicada-nymph-number">1024</span>
     <span class="cicada-nymph-fetch-local-variable-1">:getdents64-structure-list</span>
     <span class="cicada-nymph-fetch-local-variable-1">:port</span>
     <span class="cicada-nymph-constant">:syscall-number,getdents64:</span>
     <span class="cicada-nymph-number">3</span> syscall
     dup negative? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"* (&lt;directory&gt; map,loop) syscall fail"</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
       drop
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-1">:getdents64-structure-list</span> add
     <span class="cicada-nymph-fetch-local-variable-1">:getdents64-structure-list</span>
     <span class="cicada-nymph-fetch-local-variable-1">:function</span>
     <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> <span class="cicada-nymph-title">map</span>,loop,execute
     <span class="cicada-nymph-fetch-local-variable-1">:port</span>
     <span class="cicada-nymph-fetch-local-variable-1">:function</span>
     <span class="cicada-nymph-end">loop</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;directory&gt; map</span>
     <span class="cicada-nymph-comment">&lt;&lt; directory-path[address, length],
        function
        -- true
        -- false &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:function</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::directory-path</span>
     <span class="cicada-nymph-fetch-local-variable-2">::directory-path</span> <span class="cicada-nymph-XdataX">&lt;port&gt;</span> open <span class="cicada-nymph-syntax-key-word">if</span>
     <span class="cicada-nymph-syntax-key-word">else</span>
       <span class="cicada-nymph-string">"* (&lt;directory&gt; map) fail to open : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::directory-path</span> .s .l
       <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>
     <span class="cicada-nymph-fetch-local-variable-1">:port</span> <span class="cicada-nymph-fetch-local-variable-1">:function</span> <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> <span class="cicada-nymph-title">map</span>,loop
     <span class="cicada-nymph-fetch-local-variable-1">:port</span> <span class="cicada-nymph-XdataX">&lt;port&gt;</span> close <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-string">"* (&lt;directory&gt; map) fail to close : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::directory-path</span> .s .l
     <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,function</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-constant">+getdents64,d_type+</span> fetch-byte
     <span class="cicada-nymph-number">8</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"  "</span> .s
       <span class="cicada-nymph-constant">+getdents64,d_name+</span>
       dup <span class="cicada-nymph-number">256</span>
       <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">string</span>,find-char
       drop  <span class="cicada-nymph-comment">&lt;&lt; drop 0 &gt;&gt;</span>
       over sub .s .l
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-string">"play"</span> <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">test</span>,function <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> map
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** list-file</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;directory&gt; list-file</span>
     <span class="cicada-nymph-comment">&lt;&lt; directory-path[address, length] -- &gt;&gt;</span>
     <span class="cicada-nymph-square-brackets">[</span> <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
       <span class="cicada-nymph-constant">+getdents64,d_type+</span> fetch-byte
       <span class="cicada-nymph-number">8</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
         <span class="cicada-nymph-string">"  "</span> .s
         <span class="cicada-nymph-constant">+getdents64,d_name+</span>
         dup <span class="cicada-nymph-number">256</span>
         <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">string</span>,find-char
         drop  <span class="cicada-nymph-comment">&lt;&lt; drop 0 &gt;&gt;</span>
         over sub .s .l
       <span class="cicada-nymph-syntax-key-word">then</span>
       <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-square-brackets">]</span>
     <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> map
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** list-directory</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;directory&gt; list-directory</span>
     <span class="cicada-nymph-comment">&lt;&lt; directory-path[address, length] -- &gt;&gt;</span>
     <span class="cicada-nymph-square-brackets">[</span> <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
       <span class="cicada-nymph-constant">+getdents64,d_type+</span> fetch-byte
       <span class="cicada-nymph-number">4</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
         <span class="cicada-nymph-constant">+getdents64,d_name+</span>
         dup <span class="cicada-nymph-number">256</span>
         <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">string</span>,find-char
         drop  <span class="cicada-nymph-comment">&lt;&lt; drop 0 &gt;&gt;</span>
         over sub <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>
         <span class="cicada-nymph-string">".."</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
           <span class="cicada-nymph-end">end</span>
         <span class="cicada-nymph-syntax-key-word">then</span>
         <span class="cicada-nymph-string">"."</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
           <span class="cicada-nymph-end">end</span>
         <span class="cicada-nymph-syntax-key-word">then</span>
         <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::name</span> .s .l
         <span class="cicada-nymph-end">end</span>
       <span class="cicada-nymph-syntax-key-word">then</span>
       <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-square-brackets">]</span>
     <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> map
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-string">"play"</span> dup2
   <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> list-file
   <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> list-directory

   <span class="cicada-nymph-string">"play/kkk"</span> dup2
   <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> list-file
   <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> list-directory

   <span class="cicada-nymph-string">"."</span> dup2
   <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> list-file
   <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> list-directory

   <span class="cicada-nymph-string">"/"</span> dup2
   <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> list-file
   <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> list-directory
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** find-file</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;directory&gt; find-file</span>
     <span class="cicada-nymph-comment">&lt;&lt; directory-path[address, length], file-name[address, length] -- bool &gt;&gt;</span>
     xx|swap|xx
     <span class="cicada-nymph-bool">false</span>
     xx|swap|x
     <span class="cicada-nymph-square-brackets">[</span> <span class="cicada-nymph-comment">&lt;&lt; file-name[address, length], bool --
          file-name[address, length], bool &gt;&gt;</span>
       <span class="cicada-nymph-constant">+getdents64,d_type+</span> fetch-byte <span class="cicada-nymph-number">8</span> equal? not <span class="cicada-nymph-syntax-key-word">if</span>
         <span class="cicada-nymph-end">end</span>
       <span class="cicada-nymph-syntax-key-word">then</span>
       <span class="cicada-nymph-save-local-variable-1">&gt;:bool</span>
       <span class="cicada-nymph-save-local-variable-1">&gt;:file-name,lenght</span>
       <span class="cicada-nymph-save-local-variable-1">&gt;:file-name,address</span>
       <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span> <span class="cicada-nymph-constant">+getdents64,d_name+</span> add
       fetch-byte zero? not <span class="cicada-nymph-syntax-key-word">if</span>
         <span class="cicada-nymph-fetch-local-variable-1">:file-name,address</span>
         <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
         <span class="cicada-nymph-fetch-local-variable-1">:bool</span>
         <span class="cicada-nymph-end">end</span>
       <span class="cicada-nymph-syntax-key-word">then</span>
       <span class="cicada-nymph-fetch-local-variable-1">:file-name,address</span> <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
       <span class="cicada-nymph-constant">+getdents64,d_name+</span> <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
       string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
         <span class="cicada-nymph-fetch-local-variable-1">:file-name,address</span>
         <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
         <span class="cicada-nymph-bool">true</span>
         <span class="cicada-nymph-end">end</span>
       <span class="cicada-nymph-syntax-key-word">then</span>
       <span class="cicada-nymph-fetch-local-variable-1">:file-name,address</span>
       <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
       <span class="cicada-nymph-fetch-local-variable-1">:bool</span>
       <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-square-brackets">]</span>
     <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> map
     xx|swap|x drop2
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** find-directory</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;directory&gt; find-directory</span>
     <span class="cicada-nymph-comment">&lt;&lt; directory-path[address, length], file-name[address, length] -- bool &gt;&gt;</span>
     xx|swap|xx
     <span class="cicada-nymph-bool">false</span>
     xx|swap|x
     <span class="cicada-nymph-square-brackets">[</span> <span class="cicada-nymph-comment">&lt;&lt; file-name[address, length], bool --
          file-name[address, length], bool &gt;&gt;</span>
       <span class="cicada-nymph-constant">+getdents64,d_type+</span> fetch-byte <span class="cicada-nymph-number">4</span> equal? not <span class="cicada-nymph-syntax-key-word">if</span>
         <span class="cicada-nymph-end">end</span>
       <span class="cicada-nymph-syntax-key-word">then</span>
       <span class="cicada-nymph-save-local-variable-1">&gt;:bool</span>
       <span class="cicada-nymph-save-local-variable-1">&gt;:file-name,lenght</span>
       <span class="cicada-nymph-save-local-variable-1">&gt;:file-name,address</span>
       <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span> <span class="cicada-nymph-constant">+getdents64,d_name+</span> add
       fetch-byte zero? not <span class="cicada-nymph-syntax-key-word">if</span>
         <span class="cicada-nymph-fetch-local-variable-1">:file-name,address</span>
         <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
         <span class="cicada-nymph-fetch-local-variable-1">:bool</span>
         <span class="cicada-nymph-end">end</span>
       <span class="cicada-nymph-syntax-key-word">then</span>
       <span class="cicada-nymph-fetch-local-variable-1">:file-name,address</span> <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
       <span class="cicada-nymph-constant">+getdents64,d_name+</span> <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
       string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
         <span class="cicada-nymph-fetch-local-variable-1">:file-name,address</span>
         <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
         <span class="cicada-nymph-bool">true</span>
         <span class="cicada-nymph-end">end</span>
       <span class="cicada-nymph-syntax-key-word">then</span>
       <span class="cicada-nymph-fetch-local-variable-1">:file-name,address</span>
       <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
       <span class="cicada-nymph-fetch-local-variable-1">:bool</span>
       <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-square-brackets">]</span>
     <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> map
     xx|swap|x drop2
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"play"</span> <span class="cicada-nymph-string">"cn"</span> <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> find-file .
     <span class="cicada-nymph-string">"play"</span> <span class="cicada-nymph-string">"kkk"</span> <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> find-file .
     <span class="cicada-nymph-string">"play"</span> <span class="cicada-nymph-string">"no"</span> <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> find-file .
     .l
     <span class="cicada-nymph-string">"playlay"</span> <span class="cicada-nymph-string">"no"</span> <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> find-file .
     .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
   test

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"play"</span> <span class="cicada-nymph-string">"cn"</span> <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> find-directory .
     <span class="cicada-nymph-string">"play"</span> <span class="cicada-nymph-string">"kkk"</span> <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> find-directory .
     <span class="cicada-nymph-string">"play"</span> <span class="cicada-nymph-string">"no"</span> <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> find-directory .
     .l
     <span class="cicada-nymph-string">"playlay"</span> <span class="cicada-nymph-string">"no"</span> <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> find-directory .
     .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
   test
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* system environment</span>
<span class="org-level-2">** </span><span class="org-todo">note</span><span class="org-level-2"> </span><span class="org-level-2"><span class="bold">*linux*</span></span>
<span class="org-level-3">*** one directory</span>
    * all files about cicada
      are stored in
      "<span class="italic">/home/&lt;user&gt;/</span>.cicada"
<span class="org-level-3">*** pid</span>
    * pid is the key to all the linux system environment
    * command-line
      /proc/&lt;pid&gt;/cmdline
    * environment-variable-list
      /proc/&lt;pid&gt;/environ
<span class="org-level-2">** [init|get]-pid</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*pid*</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">init-pid</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-constant">:syscall-number,getpid:</span>
     <span class="cicada-nymph-number">0</span> syscall
     <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*pid*</span> save
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">get-pid</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- pid &gt;&gt;</span>
     <span class="cicada-nymph-variable">*pid*</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** [init|get]-command-line</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-memory</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*address,command-line*</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

   <span class="cicada-nymph-number">512</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*length,command-line*</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">init-command-line</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-number">64</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:path-buffer</span>
     <span class="cicada-nymph-fetch-local-variable-1">:path-buffer</span> <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>

     get-pid <span class="cicada-nymph-title">write-number</span>,fill-buffer <span class="cicada-nymph-save-local-variable-2">&gt;::pid-string</span>

     <span class="cicada-nymph-string">"/proc/"</span> dup <span class="cicada-nymph-save-local-variable-1">&gt;:add-to-cursor</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> string-&gt;buffer!
     <span class="cicada-nymph-fetch-local-variable-1">:add-to-cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>

     <span class="cicada-nymph-fetch-local-variable-2">::pid-string</span> dup <span class="cicada-nymph-save-local-variable-1">&gt;:add-to-cursor</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> string-&gt;buffer!
     <span class="cicada-nymph-fetch-local-variable-1">:add-to-cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>

     <span class="cicada-nymph-string">"/cmdline"</span> dup <span class="cicada-nymph-save-local-variable-1">&gt;:add-to-cursor</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> string-&gt;buffer!
     <span class="cicada-nymph-fetch-local-variable-1">:add-to-cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>

     <span class="cicada-nymph-fetch-local-variable-1">:path-buffer</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:path-buffer</span> sub dup2 <span class="cicada-nymph-save-local-variable-2">&gt;::path</span>
     <span class="cicada-nymph-XdataX">&lt;port&gt;</span> open <span class="cicada-nymph-syntax-key-word">if</span>
     <span class="cicada-nymph-syntax-key-word">else</span>
       <span class="cicada-nymph-string">"* (init-command-line) fail to open : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>

     <span class="cicada-nymph-variable">*address,command-line*</span>
     <span class="cicada-nymph-variable">*length,command-line*</span>
     <span class="cicada-nymph-fetch-local-variable-1">:port</span>
     <span class="cicada-nymph-XdataX">&lt;port&gt;</span> read <span class="cicada-nymph-syntax-key-word">if</span>
     <span class="cicada-nymph-syntax-key-word">else</span>
       <span class="cicada-nymph-string">"* (init-command-line) fail to read : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*length,command-line*</span> save
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">get-command-line</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- string[address, length] &gt;&gt;</span>
     <span class="cicada-nymph-variable">*address,command-line*</span> <span class="cicada-nymph-variable">*length,command-line*</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** [init|get]-environment-variable-list</span>
   * the size of /proc/&lt;pid&gt;/environ is limited to 4k
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-number">1024</span> <span class="cicada-nymph-number">4</span> mul <span class="cicada-nymph-allocate">allocate-memory</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*address,environment-variable-list*</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

   <span class="cicada-nymph-number">1024</span> <span class="cicada-nymph-number">4</span> mul
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*length,environment-variable-list*</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">init-environment-variable-list</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-number">64</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:path-buffer</span>
     <span class="cicada-nymph-fetch-local-variable-1">:path-buffer</span> <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>

     get-pid <span class="cicada-nymph-title">write-number</span>,fill-buffer <span class="cicada-nymph-save-local-variable-2">&gt;::pid-string</span>

     <span class="cicada-nymph-string">"/proc/"</span> dup <span class="cicada-nymph-save-local-variable-1">&gt;:add-to-cursor</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> string-&gt;buffer!
     <span class="cicada-nymph-fetch-local-variable-1">:add-to-cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>

     <span class="cicada-nymph-fetch-local-variable-2">::pid-string</span> dup <span class="cicada-nymph-save-local-variable-1">&gt;:add-to-cursor</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> string-&gt;buffer!
     <span class="cicada-nymph-fetch-local-variable-1">:add-to-cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>

     <span class="cicada-nymph-string">"/environ"</span> dup <span class="cicada-nymph-save-local-variable-1">&gt;:add-to-cursor</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> string-&gt;buffer!
     <span class="cicada-nymph-fetch-local-variable-1">:add-to-cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>

     <span class="cicada-nymph-fetch-local-variable-1">:path-buffer</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:path-buffer</span> sub dup2 <span class="cicada-nymph-save-local-variable-2">&gt;::path</span>
     <span class="cicada-nymph-XdataX">&lt;port&gt;</span> open <span class="cicada-nymph-syntax-key-word">if</span>
     <span class="cicada-nymph-syntax-key-word">else</span>
       <span class="cicada-nymph-string">"* (init-environment-variable-list) fail to open : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>

     <span class="cicada-nymph-variable">*address,environment-variable-list*</span>
     <span class="cicada-nymph-variable">*length,environment-variable-list*</span>
     <span class="cicada-nymph-fetch-local-variable-1">:port</span>
     <span class="cicada-nymph-XdataX">&lt;port&gt;</span> read <span class="cicada-nymph-syntax-key-word">if</span>
     <span class="cicada-nymph-syntax-key-word">else</span>
       <span class="cicada-nymph-string">"* (init-environment-variable-list) fail to read : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*length,environment-variable-list*</span> save
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">get-environment-variable-list</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- string[address, length] &gt;&gt;</span>
     <span class="cicada-nymph-variable">*address,environment-variable-list*</span>
     <span class="cicada-nymph-variable">*length,environment-variable-list*</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** find-environment-variable</span>
   * the string used to find an environment-variable
     can not contain "="
     no error handling on this
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">find-environment-variable,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length], cursor
        -- string[address, length], true
        -- false &gt;&gt;</span>
     dup
     get-environment-variable-list add
     greater-than? <span class="cicada-nymph-syntax-key-word">if</span>
       drop drop2
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:address</span>
     <span class="cicada-nymph-fetch-local-variable-1">:address</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
     compare-buffer not <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-fetch-local-variable-1">:address</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
       <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-number">0</span> cursor-&gt;next-matching-byte add1
       <span class="cicada-nymph-end">loop</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span> add fetch-byte
     <span class="cicada-nymph-string">"="</span> <span class="cicada-nymph-title">string-head</span>,byte
     equal? not <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-fetch-local-variable-1">:address</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
       <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-number">0</span> cursor-&gt;next-matching-byte add1
       <span class="cicada-nymph-end">loop</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span> add add1 <span class="cicada-nymph-comment">&lt;&lt; over "=" &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:find-address</span>
     <span class="cicada-nymph-fetch-local-variable-1">:find-address</span> <span class="cicada-nymph-number">0</span> cursor-&gt;next-matching-byte
     <span class="cicada-nymph-fetch-local-variable-1">:find-address</span> sub <span class="cicada-nymph-save-local-variable-1">&gt;:find-length</span>
     <span class="cicada-nymph-fetch-local-variable-1">:find-address</span>
     <span class="cicada-nymph-fetch-local-variable-1">:find-length</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">find-environment-variable</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length]
        -- string[address, length], true
        -- false &gt;&gt;</span>
     get-environment-variable-list drop
     <span class="cicada-nymph-title">find-environment-variable</span>,loop
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** initialize system environment</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   init-pid
   init-command-line
   init-environment-variable-list
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-level-2"><span class="bold">*home-directory*</span></span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*home-directory*</span>
     <span class="cicada-nymph-string">"HOME"</span> find-environment-variable
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** &lt;report&gt; environment-variable</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;report&gt; environment-variable,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; environment-variable-list[address, length]-- &gt;&gt;</span>
     dup2 space-string? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>

     <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:address</span>

     <span class="cicada-nymph-fetch-local-variable-1">:address</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span> <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">string</span>,find-char drop add1 <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:address</span> sub <span class="cicada-nymph-save-local-variable-1">&gt;:length-of-one-variable</span>

     <span class="cicada-nymph-fetch-local-variable-1">:address</span>
     <span class="cicada-nymph-fetch-local-variable-1">:length-of-one-variable</span> sub1 .s .l

     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
     <span class="cicada-nymph-fetch-local-variable-1">:length</span> <span class="cicada-nymph-fetch-local-variable-1">:length-of-one-variable</span> sub
     <span class="cicada-nymph-end">loop</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;report&gt; environment-variable</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     get-environment-variable-list
     <span class="cicada-nymph-XdataX">&lt;report&gt;</span> <span class="cicada-nymph-title">environment-variable</span>,loop
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** &lt;report&gt; command-line</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;report&gt; command-line,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; command-line[address, length] -- &gt;&gt;</span>
     dup2 space-string? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     dup2 <span class="cicada-nymph-title">string-head</span>,word .s <span class="cicada-nymph-number">32</span> .b
     <span class="cicada-nymph-title">string-tail</span>,word
     <span class="cicada-nymph-end">loop</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;report&gt; command-line</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     get-command-line
     <span class="cicada-nymph-XdataX">&lt;report&gt;</span> <span class="cicada-nymph-title">command-line</span>,loop
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-XdataX">&lt;report&gt;</span> environment-variable
   <span class="cicada-nymph-XdataX">&lt;report&gt;</span> command-line
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** work-directory</span>
<span class="org-level-3">*** get-work-directory</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-memory</span>
    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*buffer,work-directory*</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">get-work-directory</span>
      <span class="cicada-nymph-comment">&lt;&lt; -- directory[address, length] &gt;&gt;</span>
      <span class="cicada-nymph-number">512</span>
      <span class="cicada-nymph-variable">*buffer,work-directory*</span>
      <span class="cicada-nymph-constant">:syscall-number,getcwd:</span>
      <span class="cicada-nymph-number">2</span> syscall
      dup negative? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-string">"* (get-work-directory) fail"</span> .s .l
        <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      <span class="cicada-nymph-variable">*buffer,work-directory*</span>
      swap
      sub1 <span class="cicada-nymph-comment">&lt;&lt; for the ending zero &gt;&gt;</span>
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** change-work-directory</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph :tangle core.cn
</span>    <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">change-work-directory</span>
      <span class="cicada-nymph-comment">&lt;&lt; directory-path[address, length] -- &gt;&gt;</span>
      <span class="cicada-nymph-save-local-variable-2">&gt;::directory-path</span>
      <span class="cicada-nymph-fetch-local-variable-2">::directory-path</span>
      string-&gt;syscall-string
      <span class="cicada-nymph-constant">:syscall-number,chdir:</span>
      <span class="cicada-nymph-number">1</span> syscall
      dup negative? <span class="cicada-nymph-syntax-key-word">if</span>
        <span class="cicada-nymph-string">"* (change-work-directory) fail"</span> .s .l
        <span class="cicada-nymph-string">"  can not change the work directory into : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::directory-path</span> .s .l
        <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      drop
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-3">*** </span><span class="org-done">test</span>
<span class="org-block-begin-line">    #+begin_src cicada-nymph
</span>    get-work-directory .s
    <span class="cicada-nymph-string">"/home"</span> change-work-directory
    get-work-directory .s
    <span class="cicada-nymph-string">"/////home/xyh////cicada/play"</span> change-work-directory
    get-work-directory .s
    <span class="cicada-nymph-string">"//././/home/xyh/././cicada/./"</span> change-work-directory
    get-work-directory .s
<span class="org-block-end-line">    #+end_src
</span><span class="org-level-1">* path</span>
<span class="org-level-2">** stat structure</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_dev+</span>        <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_ino+</span>        <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_mode+</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_nlink+</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_uid+</span>        <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_gid+</span>        <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_rdev+</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_size+</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_blksize+</span>    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_blocks+</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_atime+</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_atime_nsec+</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_mtime+</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_mtime_nsec+</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_ctime+</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_ctime_nsec+</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,__unused4+</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,__unused5+</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,end+</span>           <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">init,stat</span>
     <span class="cicada-nymph-comment">&lt;&lt; offset -- &gt;&gt;</span>
     <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">4</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_dev+</span>        save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_ino+</span>        save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_mode+</span>       save <span class="cicada-nymph-number">2</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_nlink+</span>      save <span class="cicada-nymph-number">2</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_uid+</span>        save <span class="cicada-nymph-number">2</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_gid+</span>        save <span class="cicada-nymph-number">2</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_rdev+</span>       save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_size+</span>       save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_blksize+</span>    save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_blocks+</span>     save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_atime+</span>      save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_atime_nsec+</span> save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_mtime+</span>      save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_mtime_nsec+</span> save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_ctime+</span>      save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_ctime_nsec+</span> save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,__unused4+</span>     save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,__unused5+</span>     save <span class="cicada-nymph-variable">*jo-size*</span> add
           <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,end+</span>           save
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">8</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_dev+</span>        save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_ino+</span>        save <span class="cicada-nymph-variable">*jo-size*</span> add
       <span class="cicada-nymph-comment">&lt;&lt;
       note the following order changing
       this is linux' bad
       &gt;&gt;</span>
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_nlink+</span>      save <span class="cicada-nymph-number">8</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_mode+</span>       save <span class="cicada-nymph-number">4</span> add

       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_uid+</span>        save <span class="cicada-nymph-number">4</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_gid+</span>        save <span class="cicada-nymph-number">4</span> add
                                             <span class="cicada-nymph-number">4</span> add <span class="cicada-nymph-comment">&lt;&lt; padding &gt;&gt;</span>
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_rdev+</span>       save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_size+</span>       save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_blksize+</span>    save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_blocks+</span>     save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_atime+</span>      save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_atime_nsec+</span> save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_mtime+</span>      save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_mtime_nsec+</span> save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_ctime+</span>      save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_ctime_nsec+</span> save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,__unused4+</span>     save <span class="cicada-nymph-variable">*jo-size*</span> add
       dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,__unused5+</span>     save <span class="cicada-nymph-variable">*jo-size*</span> add
           <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,end+</span>           save
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">init</span>,stat
   <span class="cicada-nymph-constant">+stat,end+</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,length+</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">test,stat</span>
     <span class="cicada-nymph-comment">&lt;&lt; path[address, length] -- &gt;&gt;</span>
     string-&gt;syscall-string
     <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
     <span class="cicada-nymph-constant">+stat,length+</span> <span class="cicada-nymph-allocate">allocate-local-memory</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:stat-structure</span>
     <span class="cicada-nymph-fetch-local-variable-1">:stat-structure</span>
     <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
     <span class="cicada-nymph-constant">:syscall-number,stat:</span>
     <span class="cicada-nymph-number">2</span> syscall
     dup
     negative? <span class="cicada-nymph-syntax-key-word">if</span>
       dup .
       error-code-&gt;string .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     drop
     <span class="cicada-nymph-fetch-local-variable-1">:stat-structure</span> <span class="cicada-nymph-title">init</span>,stat
     <span class="cicada-nymph-string">"+stat,st_dev+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_dev+</span>        fetch . .l
     <span class="cicada-nymph-string">"+stat,st_ino+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_ino+</span>        fetch . .l
     <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">4</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
     <span class="cicada-nymph-string">"+stat,st_mode+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_mode+</span>       fetch-two-bytes  . .l
     <span class="cicada-nymph-string">"+stat,st_nlink+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_nlink+</span>      fetch-two-bytes  . .l
     <span class="cicada-nymph-string">"+stat,st_uid+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_uid+</span>        fetch-two-bytes  . .l
     <span class="cicada-nymph-string">"+stat,st_gid+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_gid+</span>        fetch-two-bytes  . .l
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">8</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
     <span class="cicada-nymph-string">"+stat,st_nlink+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_nlink+</span>      fetch  . .l
     <span class="cicada-nymph-string">"+stat,st_mode+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_mode+</span>       fetch-four-bytes  . .l
     <span class="cicada-nymph-string">"+stat,st_uid+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_uid+</span>        fetch-four-bytes  . .l
     <span class="cicada-nymph-string">"+stat,st_gid+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_gid+</span>        fetch-four-bytes  . .l
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-string">"+stat,st_rdev+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_rdev+</span>       fetch . .l
     <span class="cicada-nymph-string">"+stat,st_size+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_size+</span>       fetch . .l
     <span class="cicada-nymph-string">"+stat,st_blksize+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_blksize+</span>    fetch . .l
     <span class="cicada-nymph-string">"+stat,st_blocks+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_blocks+</span>     fetch . .l
     <span class="cicada-nymph-string">"+stat,st_atime+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_atime+</span>      fetch . .l
     <span class="cicada-nymph-string">"+stat,st_atime_nsec+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_atime_nsec+</span> fetch . .l
     <span class="cicada-nymph-string">"+stat,st_mtime+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_mtime+</span>      fetch . .l
     <span class="cicada-nymph-string">"+stat,st_mtime_nsec+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_mtime_nsec+</span> fetch . .l
     <span class="cicada-nymph-string">"+stat,st_ctime+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_ctime+</span>      fetch . .l
     <span class="cicada-nymph-string">"+stat,st_ctime_nsec+ : "</span> .s <span class="cicada-nymph-constant">+stat,st_ctime_nsec+</span> fetch . .l
     <span class="cicada-nymph-string">"+stat,__unused4+ : "</span> .s <span class="cicada-nymph-constant">+stat,__unused4+</span>     fetch . .l
     <span class="cicada-nymph-string">"+stat,__unused5+ : "</span> .s <span class="cicada-nymph-constant">+stat,__unused5+</span>     fetch . .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-string">"cn"</span> <span class="cicada-nymph-title">test</span>,stat
   <span class="cicada-nymph-string">"no"</span> <span class="cicada-nymph-title">test</span>,stat
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-todo">note</span><span class="org-level-2"> predicate</span>
   * to use predicate to know more about the file-tree
     before calling a function that makes action on the file-tree
<span class="org-level-2">** path,nothing?</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">path,nothing?</span>
     <span class="cicada-nymph-comment">&lt;&lt; path[address, length] -- bool &gt;&gt;</span>
     string-&gt;syscall-string
     <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
     <span class="cicada-nymph-constant">+stat,length+</span> <span class="cicada-nymph-allocate">allocate-local-memory</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:stat-structure</span>
     <span class="cicada-nymph-fetch-local-variable-1">:stat-structure</span>
     <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
     <span class="cicada-nymph-constant">:syscall-number,stat:</span>
     <span class="cicada-nymph-number">2</span> syscall
     <span class="cicada-nymph-number">-2</span> equal?
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** path,file?</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">path,file?</span>
     <span class="cicada-nymph-comment">&lt;&lt; path[address, length] -- bool &gt;&gt;</span>
     string-&gt;syscall-string
     <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
     <span class="cicada-nymph-constant">+stat,length+</span> <span class="cicada-nymph-allocate">allocate-local-memory</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:stat-structure</span>
     <span class="cicada-nymph-fetch-local-variable-1">:stat-structure</span>
     <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
     <span class="cicada-nymph-constant">:syscall-number,stat:</span>
     <span class="cicada-nymph-number">2</span> syscall
     dup
     negative? <span class="cicada-nymph-syntax-key-word">if</span>
       drop
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     drop
     <span class="cicada-nymph-fetch-local-variable-1">:stat-structure</span> <span class="cicada-nymph-title">init</span>,stat
     <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">4</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-constant">+stat,st_mode+</span>
       fetch-two-bytes
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">8</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-constant">+stat,st_mode+</span>
       fetch-four-bytes
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-number">12</span> bit-right
     <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0010</span>
     equal?
     <span class="cicada-nymph-comment">&lt;&lt;
     0170000
     S_IFDIR       0040000 /* Directory.  */
     S_IFCHR       0020000 /* Character device.  */
     S_IFBLK       0060000 /* Block device.  */
     S_IFREG       0100000 /* Regular file.  */
     S_IFIFO       0010000 /* FIFO.  */
     S_IFLNK       0120000 /* Symbolic link.  */
     S_IFSOCK      0140000 /* Socket.  */
     &gt;&gt;</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** path,directory?</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">path,directory?</span>
     <span class="cicada-nymph-comment">&lt;&lt; path[address, length] -- bool &gt;&gt;</span>
     string-&gt;syscall-string
     <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
     <span class="cicada-nymph-constant">+stat,length+</span> <span class="cicada-nymph-allocate">allocate-local-memory</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:stat-structure</span>
     <span class="cicada-nymph-fetch-local-variable-1">:stat-structure</span>
     <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
     <span class="cicada-nymph-constant">:syscall-number,stat:</span>
     <span class="cicada-nymph-number">2</span> syscall
     dup
     negative? <span class="cicada-nymph-syntax-key-word">if</span>
       drop
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     drop
     <span class="cicada-nymph-fetch-local-variable-1">:stat-structure</span> <span class="cicada-nymph-title">init</span>,stat
     <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">4</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-constant">+stat,st_mode+</span>
       fetch-two-bytes
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">8</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-constant">+stat,st_mode+</span>
       fetch-four-bytes
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-number">12</span> bit-right
     <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0004</span>
     equal?
     <span class="cicada-nymph-comment">&lt;&lt;
     0170000
     S_IFDIR       00040000 /* Directory.  */
     S_IFCHR       00020000 /* Character device.  */
     S_IFBLK       00060000 /* Block device.  */
     S_IFREG       00100000 /* Regular file.  */
     S_IFIFO       00010000 /* FIFO.  */
     S_IFLNK       00120000 /* Symbolic link.  */
     S_IFSOCK      00140000 /* Socket.  */
     &gt;&gt;</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-string">"cn"</span> <span class="cicada-nymph-title">path</span>,nothing? . <span class="cicada-nymph-comment">&lt;&lt; 0 &gt;&gt;</span>
   <span class="cicada-nymph-string">"core"</span> <span class="cicada-nymph-title">path</span>,nothing? . <span class="cicada-nymph-comment">&lt;&lt; 0 &gt;&gt;</span>
   <span class="cicada-nymph-string">"ai"</span> <span class="cicada-nymph-title">path</span>,nothing? . <span class="cicada-nymph-comment">&lt;&lt; 1 &gt;&gt;</span>

   <span class="cicada-nymph-string">"cn"</span> <span class="cicada-nymph-title">path</span>,file? . <span class="cicada-nymph-comment">&lt;&lt; 1 &gt;&gt;</span>
   <span class="cicada-nymph-string">"core"</span> <span class="cicada-nymph-title">path</span>,file? . <span class="cicada-nymph-comment">&lt;&lt; 0 &gt;&gt;</span>
   <span class="cicada-nymph-string">"ai"</span> <span class="cicada-nymph-title">path</span>,file? . <span class="cicada-nymph-comment">&lt;&lt; 0 &gt;&gt;</span>

   <span class="cicada-nymph-string">"cn"</span> <span class="cicada-nymph-title">path</span>,directory? . <span class="cicada-nymph-comment">&lt;&lt; 0 &gt;&gt;</span>
   <span class="cicada-nymph-string">"core"</span> <span class="cicada-nymph-title">path</span>,directory? . <span class="cicada-nymph-comment">&lt;&lt; 1 &gt;&gt;</span>
   <span class="cicada-nymph-string">"ai"</span> <span class="cicada-nymph-title">path</span>,directory? . <span class="cicada-nymph-comment">&lt;&lt; 0 &gt;&gt;</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-todo">&#35352;</span><span class="org-level-2"> &#23383;&#31526;&#20018;&#30340;&#35586;&#35422;</span>
   * &#19979;&#38754;&#36889;&#20841;&#20491;&#20989;&#25976;
     &#20854;&#23526;&#26159;&#22312;&#29992;&#36958;&#27512;&#20989;&#25976;&#23526;&#29694;&#27491;&#21063;&#34920;&#36948;&#24335;&#23565;&#23383;&#31526;&#20018;&#30340;&#21305;&#37197;&#25928;&#26524;
   * &#26159;&#21542;&#25033;&#35442;&#35373;&#35336; &#27491;&#21063;&#34920;&#36948;&#24335; &#23376;&#35486;&#35328; ?
     &#36996;&#26159;&#32317;&#26159;&#30452;&#25509;&#20351;&#29992;&#36958;&#27512;&#20989;&#25976; ?
<span class="org-level-2">** </span><span class="org-todo">&#35352;</span><span class="org-level-2"> unix &#36335;&#24465;&#26684;&#24335;</span>
   * "/" &#30456;&#30070;&#26044; &#31354;&#26684;
     &#36899;&#32396;&#30340; "//" &#30456;&#30070;&#26044; &#36899;&#32396;&#30340;&#31354;&#26684;
     &#36889;&#31278;&#31354;&#26684;&#20351;&#29992;&#22312;&#23383;&#31526;&#20018;&#38283;&#38957;&#26178; &#20195;&#34920;&#36889;&#26159;&#19968;&#20491; &#32085;&#23565;&#36335;&#24465;
   * "." &#30456;&#30070;&#26044; &#31354;&#26684;
     &#36899;&#32396;&#30340; ".." &#19981;&#31639; &#36899;&#32396;&#30340;&#31354;&#26684; &#26377;&#21029;&#30340;&#35486;&#32681;
     &#20294;&#26159;&#22312;&#36889;&#31278;&#31354;&#26684;&#20351;&#29992;&#22312;&#26368;&#21069;&#38754;&#30340;&#26178;&#20505; &#27161;&#35468;&#36889;&#20491;
     &#36889;&#31278;&#31354;&#26684;&#20351;&#29992;&#22312;&#23383;&#31526;&#20018;&#38283;&#38957;&#26178; &#20195;&#34920;&#36889;&#26159;&#19968;&#20491; &#30456;&#23565;&#36335;&#24465;
   * &#32780;&#23565;&#26044;&#19979;&#38754;&#30340;&#20841;&#20491;&#20989;&#25976;&#25105;&#31777;&#21934;&#22320;&#35201;&#27714;
     1. relative-path
        &#19981;&#20197; "/" &#38283;&#38957; &#30340;&#23383;&#31526;&#20018;
     2. full-path
        &#20197; "/" &#38283;&#38957; &#30340;&#23383;&#31526;&#20018;
     3. &#20006;&#19988;&#22312;&#36889;&#35023;&#25105;&#20801;&#35377; path &#20839; &#20986;&#29694;&#31354;&#26684;
        &#20445;&#30041;&#23565;&#36889;&#31278;&#36335;&#24465;&#30340;&#34389;&#29702;&#33021;&#21147;
        &#21482;&#19981;&#36942; &#25105;&#19981;&#20351;&#29992;&#36889;&#31278;&#36335;&#24465;&#32780;&#24050;
<span class="org-level-2">** relative-path?</span>
   * in ASCII "/" is 47
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">relative-path?</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- bool &gt;&gt;</span>
     dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-title">string-head</span>,byte
     <span class="cicada-nymph-number">47</span> equal? not
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** full-path?</span>
   * in ASCII "/" is 47
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">full-path?</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- bool &gt;&gt;</span>
     dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-title">string-head</span>,byte
     <span class="cicada-nymph-number">47</span> equal?
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-string">"/home"</span> relative-path? .
   <span class="cicada-nymph-string">"/home"</span> full-path? .
   <span class="cicada-nymph-string">"home"</span> relative-path? .
   <span class="cicada-nymph-string">"home"</span> full-path? .
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* poi</span>
<span class="org-level-2">** </span><span class="org-todo">note</span>
   * poi denotes path-organizer
     it can give a name to a path
     one path one name
   * a path as a string must not contain any space chars
   * a name should only consist of number or letter or "-"
<span class="org-level-2">** </span><span class="org-level-2"><span class="bold">*poi-directory*</span></span>
   * one directory to store the name path record
     "<span class="italic">/home/&lt;user&gt;/</span>.cicada/poi"
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*poi-directory,user,address*</span>
     <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-memory</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*poi-directory*</span>
     <span class="cicada-nymph-variable">*home-directory*</span> <span class="cicada-nymph-string">"/.cicada/poi"</span>
     <span class="cicada-nymph-variable">*poi-directory,user,address*</span>
     <span class="cicada-nymph-number">2</span> n-string-&gt;buffer!
     <span class="cicada-nymph-variable">*poi-directory,user,address*</span> swap
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** find</span>
   * note that
     this function uses <span class="bold">*circular-string-area*</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;poi&gt; find</span>
     <span class="cicada-nymph-comment">&lt;&lt; name[address, length]
        -- path[address, length], true
        -- false &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>
     <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
     <span class="cicada-nymph-variable">*poi-directory*</span> <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-string">"/path"</span>
     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
     <span class="cicada-nymph-number">4</span> n-string-&gt;buffer! <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>

     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
     <span class="cicada-nymph-title">path</span>,file? not <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>

     <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:read-buffer</span>
     <span class="cicada-nymph-fetch-local-variable-1">:read-buffer</span> <span class="cicada-nymph-number">512</span>
     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
     <span class="cicada-nymph-XdataX">&lt;file&gt;</span> read <span class="cicada-nymph-save-local-variable-1">&gt;:read-length</span>

     <span class="cicada-nymph-variable">*circular-string-area,current-free-address*</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:path-address</span>

     <span class="cicada-nymph-fetch-local-variable-1">:read-buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:read-length</span>
     <span class="cicada-nymph-title">circular-string-area</span>,stay

     <span class="cicada-nymph-fetch-local-variable-1">:path-address</span>
     <span class="cicada-nymph-fetch-local-variable-1">:read-length</span>
     <span class="cicada-nymph-bool">true</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** add</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;poi&gt; add</span>
     <span class="cicada-nymph-comment">&lt;&lt; name[address, length], relative-path[address, length] -- &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::relative-path</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>

     <span class="cicada-nymph-fetch-local-variable-2">::relative-path</span> relative-path? not <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"* (&lt;poi&gt; add) the argument must be a relative-path"</span> .s .l
       <span class="cicada-nymph-string">"  but the following is not : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::relative-path</span> .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>

     <span class="cicada-nymph-fetch-local-variable-2">::relative-path</span> <span class="cicada-nymph-title">path</span>,directory? not <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"* (&lt;poi&gt; add) the argument must be a relative-path to a existing directory"</span> .s .l
       <span class="cicada-nymph-string">"  but the following path is not to a directory : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::relative-path</span> .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>

     <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> find <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"* (&lt;poi&gt; add) can not add"</span> .s .l
       <span class="cicada-nymph-string">"  for the following poi already exist : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::name</span> .s .l
       <span class="cicada-nymph-string">"  name is use as the following directory's name : "</span> .s .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>

     <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
     <span class="cicada-nymph-variable">*poi-directory*</span> <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span>
     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
     <span class="cicada-nymph-number">3</span> n-string-&gt;buffer!
     <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
     <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> create

     <span class="cicada-nymph-variable">*poi-directory*</span> <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-string">"/path"</span>
     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
     <span class="cicada-nymph-number">4</span> n-string-&gt;buffer!
     <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
     <span class="cicada-nymph-XdataX">&lt;file&gt;</span> create

     <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:address,full-path</span>
     get-work-directory <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-fetch-local-variable-2">::relative-path</span>
     <span class="cicada-nymph-fetch-local-variable-1">:address,full-path</span>
     <span class="cicada-nymph-number">3</span> n-string-&gt;buffer! <span class="cicada-nymph-save-local-variable-1">&gt;:length,full-path</span>

     <span class="cicada-nymph-fetch-local-variable-1">:address,full-path</span> <span class="cicada-nymph-fetch-local-variable-1">:length,full-path</span>
     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
     <span class="cicada-nymph-XdataX">&lt;file&gt;</span> write
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** sub</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;poi&gt; sub</span>
     <span class="cicada-nymph-comment">&lt;&lt; name[address, length] -- &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>

     <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> find not <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"* (&lt;poi&gt; sub) can not sub"</span> .s .l
       <span class="cicada-nymph-string">"  for the following poi does not exist : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::name</span> .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::named-directory</span>

     <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
     <span class="cicada-nymph-variable">*poi-directory*</span> <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-string">"/path"</span>
     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
     <span class="cicada-nymph-number">4</span> n-string-&gt;buffer! <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>

     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
     <span class="cicada-nymph-XdataX">&lt;file&gt;</span> remove

     <span class="cicada-nymph-variable">*poi-directory*</span> <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span>
     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
     <span class="cicada-nymph-number">3</span> n-string-&gt;buffer!
     <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
     <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> remove
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** up</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;poi&gt; up</span>
     <span class="cicada-nymph-comment">&lt;&lt; name[address, length], relative-path[address, length] -- &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::relative-path</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>

     <span class="cicada-nymph-fetch-local-variable-2">::relative-path</span> relative-path? not <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"* (&lt;poi&gt; up) the argument must be a relative-path"</span> .s .l
       <span class="cicada-nymph-string">"  but the following is not : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::relative-path</span> .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>

     <span class="cicada-nymph-fetch-local-variable-2">::relative-path</span> <span class="cicada-nymph-title">path</span>,directory? not <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"* (&lt;poi&gt; up) the argument must be a relative-path to a existing directory"</span> .s .l
       <span class="cicada-nymph-string">"  but the following directory is not exist : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::relative-path</span> .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>

     <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> find not <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"* (&lt;poi&gt; up) can not up"</span> .s .l
       <span class="cicada-nymph-string">"  for the following poi does not exist : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::name</span> .s .l
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::named-directory</span>

     <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
     <span class="cicada-nymph-variable">*poi-directory*</span> <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-string">"/path"</span>
     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
     <span class="cicada-nymph-number">4</span> n-string-&gt;buffer! <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>

     <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:address,full-path</span>
     get-work-directory <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-fetch-local-variable-2">::relative-path</span>
     <span class="cicada-nymph-fetch-local-variable-1">:address,full-path</span>
     <span class="cicada-nymph-number">3</span> n-string-&gt;buffer! <span class="cicada-nymph-save-local-variable-1">&gt;:length,full-path</span>

     <span class="cicada-nymph-fetch-local-variable-1">:address,full-path</span> <span class="cicada-nymph-fetch-local-variable-1">:length,full-path</span>
     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
     <span class="cicada-nymph-XdataX">&lt;file&gt;</span> write
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** list</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;poi&gt; list</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-variable">*poi-directory*</span>
     <span class="cicada-nymph-square-brackets">[</span> <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
       <span class="cicada-nymph-constant">+getdents64,d_type+</span> fetch-byte
       <span class="cicada-nymph-number">4</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
         <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:path-buffer</span>
         <span class="cicada-nymph-constant">+getdents64,d_name+</span>
         dup <span class="cicada-nymph-number">256</span>
         <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">string</span>,find-char
         drop  <span class="cicada-nymph-comment">&lt;&lt; drop 0 &gt;&gt;</span>
         over sub <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>

         <span class="cicada-nymph-string">".."</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
           <span class="cicada-nymph-end">end</span>
         <span class="cicada-nymph-syntax-key-word">then</span>

         <span class="cicada-nymph-string">"."</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
           <span class="cicada-nymph-end">end</span>
         <span class="cicada-nymph-syntax-key-word">then</span>

         <span class="cicada-nymph-string">"  * "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::name</span> .s .l
         <span class="cicada-nymph-string">"      "</span> .s

         <span class="cicada-nymph-variable">*poi-directory*</span> <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-string">"/path"</span>
         <span class="cicada-nymph-fetch-local-variable-1">:path-buffer</span>
         <span class="cicada-nymph-number">4</span> n-string-&gt;buffer! <span class="cicada-nymph-save-local-variable-1">&gt;:path-length</span>

         <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:reading-buffer</span>
         <span class="cicada-nymph-fetch-local-variable-1">:reading-buffer</span> <span class="cicada-nymph-number">512</span>
         <span class="cicada-nymph-fetch-local-variable-1">:path-buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:path-length</span>
         <span class="cicada-nymph-XdataX">&lt;file&gt;</span> read <span class="cicada-nymph-save-local-variable-1">&gt;:reading-length</span>

         <span class="cicada-nymph-fetch-local-variable-1">:reading-buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:reading-length</span>
         .s .l
       <span class="cicada-nymph-syntax-key-word">then</span>
       <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-square-brackets">]</span>
     <span class="cicada-nymph-XdataX">&lt;directory&gt;</span> map
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** help</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;poi&gt; help</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"* (&lt;poi&gt; help)"</span> .s .l
     <span class="cicada-nymph-string">"  * cn poi add  &lt;new-name&gt; &lt;relative-path-to-existing-directory&gt;"</span> .s .l
     <span class="cicada-nymph-string">"  * cn poi sub  &lt;old-name&gt;"</span> .s .l
     <span class="cicada-nymph-string">"  * cn poi up   &lt;old-name&gt; &lt;relative-path-to-existing-directory&gt;"</span> .s .l
     <span class="cicada-nymph-string">"  * cn poi find &lt;old-name&gt;"</span> .s .l
     <span class="cicada-nymph-string">"  * cn poi list"</span> .s .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="ATTRLIST">+word+</span><span class="org-level-2">?</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+word+?</span>
     <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- bool &gt;&gt;</span>
     dup <span class="cicada-nymph-number">1</span> less-or-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     over fetch-byte
     <span class="cicada-nymph-string">"+"</span> <span class="cicada-nymph-title">string-head</span>,byte equal? not <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-bool">false</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     add sub1 fetch-byte
     <span class="cicada-nymph-string">"+"</span> <span class="cicada-nymph-title">string-head</span>,byte equal?
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="ATTRLIST">+word+</span><span class="org-level-2">-&gt;word</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+word+-&gt;word</span>
     <span class="cicada-nymph-comment">&lt;&lt; +word+[address, length] -- name[address, length] &gt;&gt;</span>
     sub2 swap
     add1 swap
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-string">"test-cicada-play"</span> <span class="cicada-nymph-string">"./play"</span> <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> add
   <span class="cicada-nymph-string">"test-cicada-play"</span> <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> find
   <span class="cicada-nymph-syntax-key-word">if</span> .s .l
   <span class="cicada-nymph-syntax-key-word">else</span> <span class="cicada-nymph-string">"not found"</span> .s .l
   <span class="cicada-nymph-syntax-key-word">then</span>

   <span class="cicada-nymph-string">"test-cicada-play-2"</span> <span class="cicada-nymph-string">"./play-2"</span> <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> add
   <span class="cicada-nymph-string">"test-cicada-play-2"</span> <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> find
   <span class="cicada-nymph-syntax-key-word">if</span> .s .l
   <span class="cicada-nymph-syntax-key-word">else</span> <span class="cicada-nymph-string">"not found"</span> .s .l
   <span class="cicada-nymph-syntax-key-word">then</span>

   <span class="cicada-nymph-string">"test-cicada-play"</span> <span class="cicada-nymph-string">"./contribution"</span> <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> up
   <span class="cicada-nymph-string">"test-cicada-play"</span> <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> find
   <span class="cicada-nymph-syntax-key-word">if</span> .s .l
   <span class="cicada-nymph-syntax-key-word">else</span> <span class="cicada-nymph-string">"not found"</span> .s .l
   <span class="cicada-nymph-syntax-key-word">then</span>

   <span class="cicada-nymph-string">"test-cicada-play"</span> <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> sub
   <span class="cicada-nymph-string">"test-cicada-play"</span> <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> find
   <span class="cicada-nymph-syntax-key-word">if</span> .s .l
   <span class="cicada-nymph-syntax-key-word">else</span> <span class="cicada-nymph-string">"not found"</span> .s .l
   <span class="cicada-nymph-syntax-key-word">then</span>

   <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> list

   <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> help

   <span class="cicada-nymph-string">"+work+"</span> +word+? .
   <span class="cicada-nymph-string">"work"</span> +word+? .
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* path syntax</span>
<span class="org-level-2">** </span><span class="org-todo">note</span>
   * path syntax can be implemented by a new <span class="bold">*rule-set*</span>
     but in the following
     I just simply implemented it
     as a rule in <span class="bold">*rule-set,basic-REPL*</span>
<span class="org-level-2">** </span><span class="org-todo">note</span><span class="org-level-2"> format</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-comment">&lt;&lt;
   the following 4 poi are built in
   +root+
   +home+
   +work+
   +back+
   &gt;&gt;</span>

   <span class="cicada-nymph-wody">path:</span> <span class="cicada-nymph-constant">+root+</span> home xyh cicada core core.cn <span class="cicada-nymph-sentence-reader">;</span>
   <span class="cicada-nymph-wody">path:</span> <span class="cicada-nymph-constant">+home+</span> cicada core core.cn <span class="cicada-nymph-sentence-reader">;</span>
   <span class="cicada-nymph-string">"/home/xyh/cicada/core/core.cn"</span>

   <span class="cicada-nymph-wody">path:</span> <span class="cicada-nymph-constant">+back+</span> cicada core core.cn <span class="cicada-nymph-sentence-reader">;</span>
   <span class="cicada-nymph-string">"../cicada/core/core.cn"</span>

   <span class="cicada-nymph-wody">path:</span> <span class="cicada-nymph-constant">+work+</span> core core.cn <span class="cicada-nymph-sentence-reader">;</span>
   <span class="cicada-nymph-wody">path:</span> core core.cn <span class="cicada-nymph-sentence-reader">;</span>


   <span class="cicada-nymph-wody">path:</span> <span class="cicada-nymph-constant">+library+</span> hi.cn <span class="cicada-nymph-sentence-reader">;</span>
   <span class="cicada-nymph-string">"/home/xyh/cicada/library/hi.cn"</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** !bad-path-syntax-word</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">bad-path-syntax-word,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     read-word-for-REPL
     dup2 <span class="cicada-nymph-string">";"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       .s <span class="cicada-nymph-number">32</span> .b
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     .s <span class="cicada-nymph-number">32</span> .b
     <span class="cicada-nymph-end">loop</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-exception">!bad-path-syntax-word</span>
     <span class="cicada-nymph-comment">&lt;&lt; word -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"* (!bad-path-syntax-word) the following word is of bad syntax : "</span> .s .l
     <span class="cicada-nymph-string">"    "</span> .s .s .l
     <span class="cicada-nymph-syntax-key-word">exception-reset-stack</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"  the rest of the words in path syntax is as following :"</span> .s .l
     <span class="cicada-nymph-string">"    "</span> .s <span class="cicada-nymph-title">bad-path-syntax-word</span>,loop .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-exception">define-exception</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** path-syntax-word-&gt;path</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">path-syntax-word-&gt;path</span>
     <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- path[address, length] &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-2">&gt;::word</span>
     <span class="cicada-nymph-fetch-local-variable-2">::word</span> <span class="cicada-nymph-string">"+root+"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">"/"</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-2">::word</span> <span class="cicada-nymph-string">"+work+"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       get-work-directory
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-2">::word</span> <span class="cicada-nymph-string">"+home+"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-variable">*home-directory*</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-2">::word</span> <span class="cicada-nymph-string">"+back+"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-string">".."</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-2">::word</span> +word+? not <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-fetch-local-variable-2">::word</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-2">::word</span> +word+-&gt;word <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> find <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-2">::word</span>
     <span class="cicada-nymph-exception">!bad-path-syntax-word</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** syntax,path:,basic-REPL</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,path:,basic-REPL,loop</span>
     <span class="cicada-nymph-comment">&lt;&lt; cursor -- cursor &gt;&gt;</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
     read-word-for-REPL <span class="cicada-nymph-save-local-variable-2">&gt;::word</span>

     <span class="cicada-nymph-string">";"</span> <span class="cicada-nymph-fetch-local-variable-2">::word</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>

     <span class="cicada-nymph-fetch-local-variable-2">::word</span> path-syntax-word-&gt;path dup <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
     string-&gt;buffer!

     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span> add
       dup
       <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-title">string-head</span>,byte
       swap
       save-byte
     add1
     <span class="cicada-nymph-end">loop</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,path:,basic-REPL</span>
     <span class="cicada-nymph-comment">&lt;&lt; word:path: -- path[address, length] &gt;&gt;</span>
     drop2

     prepare-for
       <span class="cicada-nymph-exception">!bad-path-syntax-word</span>
       <span class="cicada-nymph-end">end</span>

     <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-title">syntax</span>,path:,basic-REPL,loop <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>

     <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> sub <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>

     <span class="cicada-nymph-variable">*circular-string-area,current-free-address*</span>
     <span class="cicada-nymph-save-local-variable-1">&gt;:address</span>

     <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
     <span class="cicada-nymph-fetch-local-variable-1">:length</span>
     <span class="cicada-nymph-title">circular-string-area</span>,stay

     <span class="cicada-nymph-fetch-local-variable-1">:address</span>
     <span class="cicada-nymph-fetch-local-variable-1">:length</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** more,rule-set,basic-REPL</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">more,rule-set,basic-REPL</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-square-brackets">[</span><span class="cicada-nymph-string">"path:"</span> string-equal? <span class="cicada-nymph-end">end</span><span class="cicada-nymph-square-brackets">]</span>
     <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,path:,basic-REPL
     <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
   <span class="cicada-nymph-title">more</span>,rule-set,basic-REPL
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** </span><span class="org-done">test</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-wody">path:</span> <span class="cicada-nymph-constant">+root+</span> home xyh cicada core core.cn <span class="cicada-nymph-sentence-reader">;</span> .s
   <span class="cicada-nymph-wody">path:</span> <span class="cicada-nymph-constant">+home+</span> cicada core core.cn <span class="cicada-nymph-sentence-reader">;</span> .s

   <span class="cicada-nymph-wody">path:</span> <span class="cicada-nymph-constant">+back+</span> cicada core core.cn <span class="cicada-nymph-sentence-reader">;</span> .s

   <span class="cicada-nymph-wody">path:</span> <span class="cicada-nymph-constant">+work+</span> core core.cn <span class="cicada-nymph-sentence-reader">;</span> .s
   <span class="cicada-nymph-wody">path:</span> core core.cn <span class="cicada-nymph-sentence-reader">;</span> .s

   <span class="cicada-nymph-string">"library"</span> <span class="cicada-nymph-string">"library"</span> <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> add
   <span class="cicada-nymph-wody">path:</span> <span class="cicada-nymph-constant">+library+</span> hi.cn <span class="cicada-nymph-sentence-reader">;</span> .s
   <span class="cicada-nymph-string">"library"</span> <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> sub
   <span class="cicada-nymph-wody">path:</span> <span class="cicada-nymph-constant">+library+</span> hi.cn <span class="cicada-nymph-sentence-reader">;</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* </span><span class="org-todo">&gt;&lt;</span><span class="org-level-1"> undo</span>
<span class="org-level-2">** </span><span class="org-todo">&#35352;</span><span class="org-level-2"> &#25764;&#37559;</span>
   * &#22240;&#29234; name-hash-table &#30340;&#23384;&#22312;
     &#23566;&#33268;&#25105;&#23526;&#29694; undo &#36889;&#20491;&#29305;&#24615;&#30340;&#27231;&#21046;
     &#24517;&#38920;&#26159;&#21435;&#35352;&#37636;&#24046;&#21029; &#32780;&#19981;&#33021;&#26159;&#35352;&#37636;&#27511;&#21490;
   * &#20855;&#39636;&#22320;
     &#22312;&#27599;&#20491; undo point &#20043;&#24460;
     &#25152;&#26377;&#23565; jo &#30340; redefine &#37117;&#38656;&#35201;&#34987;&#35352;&#37636;
     &#22312;&#38656;&#35201;&#36864;&#22238;&#21040;&#36889;&#20491; undo point &#20043;&#26178;
     &#24674;&#24489;&#36889;&#20123;&#34987;&#24478; name-hash-table &#20013;&#36386;&#20986;&#21435;&#30340; jo
   * &#36889;&#27171;
     &#27599;&#19968;&#20491; jo &#34987;&#36386;&#20986; name-hash-table &#26178;
     &#26371;&#23384;&#20837; name jo &#30340;&#23565;&#23376;&#22312; undo-stack &#20013;
   * &#27880;&#24847;
     &#27599;&#19968;&#27425;&#37325;&#26032;&#23450;&#32681;&#37117;&#23565;&#25033;&#19968;&#27425;&#24674;&#24489;
     * &#32570;&#40670;&#26159;
       &#36889;&#27171; &#22312;&#20841;&#20491; undo point &#20043;&#38291; &#23565;&#19968;&#20491; jo &#30340;&#22810;&#27425;&#37325;&#35079;&#23450;&#32681;
       &#23601;&#24118;&#20358;&#20102;&#19968;&#20123;&#27794;&#24517;&#35201;&#30340;&#24674;&#24489;
     * &#20778;&#40670;&#26159;
       &#36889;&#27171;&#23601;&#36991;&#20813;&#20102;&#23565; &#22810;&#27425;&#37325;&#35079;&#23450;&#32681;&#30340; jo &#30340;&#29305;&#27530;&#34389;&#29702;
       &#19981;&#35542;&#26159;&#22312;&#25928;&#29575;&#19978;
       &#36996;&#26159;&#23526;&#29694;&#30340;&#31777;&#28500;&#24615;&#19978;
       &#36889;&#31278;&#23526;&#29694;&#26041;&#24335;&#37117;&#26159;&#26356;&#20778;&#30340;
<span class="org-level-2">** </span><span class="org-todo">note</span><span class="org-level-2"> global states</span>
   * <span class="bold">*jojo-area,current-free-address*</span>
   * <span class="bold">*string-area,current-free-address*</span>
   * <span class="bold">*back-up-area,current-free-address*</span>
   * <span class="bold">*link*</span>
   * name-hash-table
   * syntax-stack
     and rule-set in it
<span class="org-level-2">** </span><span class="org-todo">&gt;&lt;</span><span class="org-level-2"> back-up-area</span>
<span class="org-level-2">** </span><span class="org-todo">&gt;&lt;</span><span class="org-level-2"> undo-stack</span>
<span class="org-level-3">*** mark-undo-point</span>
<span class="org-level-3">*** undo</span>
<span class="org-level-1">* </span><span class="org-todo">&gt;&lt;</span><span class="org-level-1"> load &amp; need</span>
<span class="org-level-2">** </span><span class="org-todo">&#35352;</span><span class="org-level-2"> &#21152;&#36617;</span>
<span class="org-level-3">*** meta-code</span>
    * &#26377;&#38364;&#26044;&#25991;&#20214;&#30340;&#35586;&#35422;&#20358;&#26681;&#25818;&#25991;&#20214;&#30340;&#20839;&#23481;&#20358;&#21028;&#26039;&#23427;&#26159;&#21542;&#29234; code
      &#21482;&#26377;&#24118;&#26377; meta-code &#30340;&#25991;&#20214;&#25165;&#34987;&#35469;&#29234;&#26159; code
<span class="org-level-3">*** loading-stack</span>
    * &#29234;&#20102;&#24674;&#24489; name-hash-table &#21040;&#20043;&#21069;&#30340;&#29376;&#24907;
      &#25105;&#38656;&#35201;&#22312; loading-stack &#20013;&#20445;&#23384;&#39006;&#20284; diff &#30340;&#25976;&#25818;
    * &#29234;&#20102;&#23526;&#29694; (need)
      meta-code &#38656;&#35201;&#34987;&#20570;&#29234;&#23383;&#31526;&#20018;&#32780;&#20445;&#23384;&#22312; loading-stack &#20013;
    * &#19978;&#38754;&#36889;&#20841;&#20491;&#24615;&#29376;
      &#20063;&#21487;&#20197;&#24171;&#21161;&#23526;&#29694;&#35443;&#32048;&#30340; report
<span class="org-level-2">** </span><span class="org-todo">note</span><span class="org-level-2"> loading</span>
<span class="org-level-3">*** no auto load</span>
    * no library code will be auto loaded
      you need to configure path by (poi)
      then load the code you want using path-syntax
<span class="org-level-3">*** loading-stack &amp; unload</span>
    * by a loading-stack
      (load) is able to maintain a list of loaded files
    * values in the loading-stack
      are used to help to remember a variety of global states
      these values are used to implement unload
    * unload is expensive
      1. delete jo of a link
      2. re-hash all link to name-hash-table
<span class="org-level-3">*** terminology</span>
    * meta-code
<span class="org-block-begin-line">      #+begin_src cicada-nymph
</span>      <span class="cicada-nymph-meta-code-begin">:::::::::</span>

      <span class="cicada-nymph-wody">author:</span>   XIE Yuheng <span class="cicada-nymph-sentence-reader">;</span>

      <span class="cicada-nymph-meta-code-end">=========</span>
<span class="org-block-end-line">      #+end_src
</span>    * code
<span class="org-level-2">** </span><span class="org-level-2"><span class="bold">*loading-stack*</span></span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** load</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">load</span>
     <span class="cicada-nymph-comment">&lt;&lt; path[address, length] -- &gt;&gt;</span>

     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** need</span>
   * (need) is as (load-when-not-loaded)
<span class="org-block-begin-line">   #+begin_src cicada-nymph
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">need</span>
     <span class="cicada-nymph-comment">&lt;&lt; library[address, length] -- &gt;&gt;</span>

     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* </span><span class="org-todo">&gt;&lt;</span><span class="org-level-1"> test framework</span>
<span class="org-level-2">** </span><span class="org-todo">&#35352;</span><span class="org-level-2"> &#28204;&#35430;</span>
   * &#28204;&#35430;&#26159;&#34987;&#26781;&#20214;&#22519;&#34892;&#30340;&#20195;&#30908;
   * &#23427;&#20497;&#23450;&#32681;&#19968;&#20123;&#20989;&#25976;&#31359;&#25554;&#22312;&#34987;&#21152;&#36617;&#30340;&#20195;&#30908;&#20043;&#20013;
     &#20006;&#19988;&#26377;&#19968;&#20123;&#38914;&#23652;&#30340;&#20195;&#30908;&#20358;&#22519;&#34892;&#36889;&#20123;&#28204;&#35430;
   * load &#19968;&#20491; code &#30340;&#26178;&#20505; &#21487;&#20197;&#25351;&#26126;&#26159;&#21542;&#24118;&#26377; test
     &#22914;&#26524;&#19981;&#24118;&#26377; test
     &#37027;&#40636;&#19978;&#38754;&#25152;&#23450;&#32681;&#30340;&#20989;&#25976;&#26371;&#34987;&#24573;&#30053; &#20006;&#19988;&#38914;&#23652;&#30340;&#20195;&#30908;&#20063;&#34987;&#24573;&#30053;
   * &#28204;&#35430;&#20570;&#29234;&#20989;&#25976;&#30340;&#29305;&#40670;&#36996;&#22312;&#26044;
     &#23427;&#20497;&#38656;&#35201;&#20197;&#36969;&#21512;&#38321;&#35712;&#30340;&#26684;&#24335;&#25171;&#21360;&#20986;&#22577;&#21578;&#20197;&#35498;&#26126;&#28204;&#35430;&#30340;&#25928;&#26524;
     &#26377;&#19968;&#32068;&#36628;&#21161;&#20989;&#25976;&#24171;&#21161;&#23436;&#25104;&#36889;&#31278;&#25171;&#21360;
   * &#19978;&#38754;&#30340;&#36889;&#20123;&#29305;&#24615;&#32068;&#21512;&#22312;&#19968;&#36215;&#23601;&#24418;&#25104;&#20102;&#28204;&#35430;&#26694;&#26550;
   * &#22312;&#21629;&#20196;&#34892;&#25509;&#21475;&#20013;
     &#26371;&#25552;&#20379;&#33287;&#28204;&#35430;&#26377;&#38364;&#30340;&#35373;&#35336;
<span class="org-level-1">* -----------------------------------</span>
<span class="org-level-1">* report</span>
<span class="org-level-2">** memory</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;report&gt; memory</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"* *un-initialized-memory*"</span> .s .l
     <span class="cicada-nymph-string">"  * size : "</span> .s
          <span class="cicada-nymph-variable">*un-initialized-memory,size*</span>
          . .l
     <span class="cicada-nymph-string">"  * used : "</span> .s
          <span class="cicada-nymph-variable">*un-initialized-memory,current-free-address*</span>
          <span class="cicada-nymph-variable">*un-initialized-memory*</span>
          sub . .l
     <span class="cicada-nymph-string">"  * free : "</span> .s
          <span class="cicada-nymph-variable">*un-initialized-memory,size*</span>
          <span class="cicada-nymph-variable">*un-initialized-memory,current-free-address*</span>
          <span class="cicada-nymph-variable">*un-initialized-memory*</span>
          sub sub . .l
     <span class="cicada-nymph-string">"* *string-area*"</span> .s .l
     <span class="cicada-nymph-string">"  * size : "</span> .s
          <span class="cicada-nymph-variable">*string-area,size*</span>
          . .l
     <span class="cicada-nymph-string">"  * used : "</span> .s
          <span class="cicada-nymph-variable">*string-area,current-free-address*</span>
          <span class="cicada-nymph-variable">*string-area*</span>
          sub . .l
     <span class="cicada-nymph-string">"  * free : "</span> .s
          <span class="cicada-nymph-variable">*string-area,size*</span>
          <span class="cicada-nymph-variable">*string-area,current-free-address*</span>
          <span class="cicada-nymph-variable">*string-area*</span>
          sub sub . .l
     <span class="cicada-nymph-string">"* *jojo-area*"</span> .s .l
     <span class="cicada-nymph-string">"  * size : "</span> .s
          <span class="cicada-nymph-variable">*jojo-area,size*</span> . .l
     <span class="cicada-nymph-string">"  * used : "</span> .s
          <span class="cicada-nymph-variable">*jojo-area,current-free-address*</span>
          <span class="cicada-nymph-variable">*jojo-area*</span>
          sub . .l
     <span class="cicada-nymph-string">"  * free : "</span> .s
          <span class="cicada-nymph-variable">*jojo-area,size*</span>
          <span class="cicada-nymph-variable">*jojo-area,current-free-address*</span>
          <span class="cicada-nymph-variable">*jojo-area*</span>
          sub sub . .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** platform</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;report&gt; platform</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"* platform : "</span> .s
     platform .s
     .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** jo-size</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;report&gt; jo-size</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"* jo-size : "</span> .s
     <span class="cicada-nymph-variable">*jo-size*</span> write-number
     <span class="cicada-nymph-string">" bytes"</span> .s
     .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** machine-word-size</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;report&gt; machine-word-size</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"* machine-word-size : "</span> .s
     <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">8</span> mul write-number
     <span class="cicada-nymph-string">" bits"</span> .s
     .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** syntax</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;report&gt; syntax</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"* *rule-set,make-jojo* :"</span> .s .l
      <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> list-rule
     <span class="cicada-nymph-string">"* *rule-set,basic-REPL* :"</span> .s .l
      <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> list-rule
     <span class="cicada-nymph-string">"* tos-syntax-stack :"</span> .s .l
      tos-syntax-stack list-rule
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** link</span>
   * different types of words in link
     are showed separately
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;report&gt; link</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"* all primitive-function in link :"</span> .s .l
     <span class="cicada-nymph-variable">*link*</span> <span class="cicada-nymph-syntax-key-word">jo</span> primitive-function-jo?
     <span class="cicada-nymph-XdataX">&lt;link&gt;</span> list-by-jo-predicate

     <span class="cicada-nymph-string">"* all function in link :"</span> .s .l
     <span class="cicada-nymph-variable">*link*</span> <span class="cicada-nymph-syntax-key-word">jo</span> function-jo?
     <span class="cicada-nymph-XdataX">&lt;link&gt;</span> list-by-jo-predicate

     <span class="cicada-nymph-string">"* all exception in link :"</span> .s .l
     <span class="cicada-nymph-variable">*link*</span> <span class="cicada-nymph-syntax-key-word">jo</span> exception-jo?
     <span class="cicada-nymph-XdataX">&lt;link&gt;</span> list-by-jo-predicate

     <span class="cicada-nymph-string">"* all variable in link :"</span> .s .l
     <span class="cicada-nymph-variable">*link*</span> <span class="cicada-nymph-syntax-key-word">jo</span> variable-jo?
     <span class="cicada-nymph-XdataX">&lt;link&gt;</span> list-by-jo-predicate
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** system</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;report&gt; system</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-XdataX">&lt;report&gt;</span> platform
     <span class="cicada-nymph-XdataX">&lt;report&gt;</span> machine-word-size
     <span class="cicada-nymph-XdataX">&lt;report&gt;</span> jo-size
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* hi</span>
<span class="org-level-2">** welcome</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">welcome</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"* welcome to cicada-nymph"</span> .s .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** hi</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-number">0</span>
   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*hi,random-base*</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">hi,random</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- random-number &gt;&gt;</span>
     <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-constant">:syscall-number,times:</span>
     <span class="cicada-nymph-number">1</span> syscall
     <span class="cicada-nymph-number">9</span> mod
     <span class="cicada-nymph-comment">&lt;&lt;
      *hi,random-base*
      *hi,random-base* add1 13 mod
      address *hi,random-base* save
     &gt;&gt;</span>
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">hi,say</span>
     <span class="cicada-nymph-comment">&lt;&lt; number -- &gt;&gt;</span>
     dup <span class="cicada-nymph-number">0</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"  cica cica da yaya !!!"</span> .s .l <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">1</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"  hi ^-^"</span> .s .l <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">2</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"  hello :)"</span> .s .l <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">3</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"  hey *^-^*"</span> .s .l <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">4</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"  hiya \^o^/"</span> .s .l <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">5</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"  I wish you a lovely day"</span> .s .l <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">6</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"  I wish you a lovely day { or night :P }"</span> .s .l <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
     dup <span class="cicada-nymph-number">7</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"  o.o"</span> .s .l <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
                     drop <span class="cicada-nymph-string">"  lovely ^3^"</span> .s .l <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">hi</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-title">hi</span>,random
     <span class="cicada-nymph-title">hi</span>,say
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** help</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">help</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"* helpful documentations will be written soon"</span> .s .l
     <span class="cicada-nymph-string">"  please wait ^-^"</span> .s .l
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* command-function</span>
<span class="org-level-2">** unknow-function</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;command-function&gt; unknow-function</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-string">"* (cicada-nymph) unknow command-line-function : "</span> .s
     get-command-line
     <span class="cicada-nymph-title">string-tail</span>,word
     <span class="cicada-nymph-title">string-head</span>,word .s .l
     <span class="cicada-nymph-string">"  good bye ^-^/"</span> .s .l
     <span class="cicada-nymph-end">bye</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** stack-REPL</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;command-function&gt; stack-REPL</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     .l
     welcome hi .l
     <span class="cicada-nymph-XdataX">&lt;report&gt;</span> system .l
     <span class="cicada-nymph-string">"* you are in the (stack-REPL)"</span> .s .l
     <span class="cicada-nymph-string">"  every time after a word is executed"</span> .s .l
     <span class="cicada-nymph-string">"  the argument-stack get printed"</span> .s .l
     <span class="cicada-nymph-title">print-argument-stack</span>,pretty
     <span class="cicada-nymph-syntax-key-word">jo</span> stack-REPL
     <span class="cicada-nymph-end">reset-top-level-REPL</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** basic-REPL</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;command-function&gt; basic-REPL</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     .l
     welcome hi .l
     <span class="cicada-nymph-XdataX">&lt;report&gt;</span> system .l
     <span class="cicada-nymph-string">"* you are in the (basic-REPL)"</span> .s .l
     <span class="cicada-nymph-string">"  this REPL does not print any thing automaticly"</span> .s .l
     <span class="cicada-nymph-syntax-key-word">jo</span> basic-REPL
     <span class="cicada-nymph-end">reset-top-level-REPL</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** poi</span>
   * cn poi add  &lt;name&gt; &lt;relative-path&gt;
   * cn poi sub  &lt;name&gt;
   * cn poi up   &lt;name&gt; &lt;relative-path&gt;
   * cn poi find &lt;name&gt;
   * cn poi list
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;command-function&gt; poi</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     get-command-line
     <span class="cicada-nymph-title">string-tail</span>,word
     <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::command-line</span>

     <span class="cicada-nymph-fetch-local-variable-2">::command-line</span> space-string? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> help
       <span class="cicada-nymph-end">bye</span>
     <span class="cicada-nymph-syntax-key-word">then</span>

     <span class="cicada-nymph-fetch-local-variable-2">::command-line</span> <span class="cicada-nymph-title">string-head</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::sub-function-name</span>
     <span class="cicada-nymph-fetch-local-variable-2">::command-line</span> <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::command-line-arguments</span>

     <span class="cicada-nymph-fetch-local-variable-2">::sub-function-name</span> <span class="cicada-nymph-string">"help"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> help
       <span class="cicada-nymph-end">bye</span>
     <span class="cicada-nymph-syntax-key-word">then</span>

     <span class="cicada-nymph-fetch-local-variable-2">::sub-function-name</span> <span class="cicada-nymph-string">"add"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-fetch-local-variable-2">::command-line-arguments</span> <span class="cicada-nymph-title">string-head</span>,word
       <span class="cicada-nymph-fetch-local-variable-2">::command-line-arguments</span> <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-title">string-head</span>,word
       <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> add
       <span class="cicada-nymph-end">bye</span>
     <span class="cicada-nymph-syntax-key-word">then</span>

     <span class="cicada-nymph-fetch-local-variable-2">::sub-function-name</span> <span class="cicada-nymph-string">"sub"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-fetch-local-variable-2">::command-line-arguments</span> <span class="cicada-nymph-title">string-head</span>,word
       <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> sub
       <span class="cicada-nymph-end">bye</span>
     <span class="cicada-nymph-syntax-key-word">then</span>

     <span class="cicada-nymph-fetch-local-variable-2">::sub-function-name</span> <span class="cicada-nymph-string">"up"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-fetch-local-variable-2">::command-line-arguments</span> <span class="cicada-nymph-title">string-head</span>,word
       <span class="cicada-nymph-fetch-local-variable-2">::command-line-arguments</span> <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-title">string-head</span>,word
       <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> up
       <span class="cicada-nymph-end">bye</span>
     <span class="cicada-nymph-syntax-key-word">then</span>

     <span class="cicada-nymph-fetch-local-variable-2">::sub-function-name</span> <span class="cicada-nymph-string">"find"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-fetch-local-variable-2">::command-line-arguments</span> <span class="cicada-nymph-title">string-head</span>,word
       <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> find <span class="cicada-nymph-syntax-key-word">if</span>
         .s .l
       <span class="cicada-nymph-syntax-key-word">else</span>
         <span class="cicada-nymph-string">"no found"</span> .s .l
       <span class="cicada-nymph-syntax-key-word">then</span>
       <span class="cicada-nymph-end">bye</span>
     <span class="cicada-nymph-syntax-key-word">then</span>

     <span class="cicada-nymph-fetch-local-variable-2">::sub-function-name</span> <span class="cicada-nymph-string">"list"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-XdataX">&lt;poi&gt;</span> list
       <span class="cicada-nymph-end">bye</span>
     <span class="cicada-nymph-syntax-key-word">then</span>

     <span class="cicada-nymph-string">"* (poi) meets argument that (poi) can not understand"</span> .s .l
     <span class="cicada-nymph-string">"  it is the following command-line that is confusing (poi) :"</span> .s .l
     <span class="cicada-nymph-string">"    "</span> .s <span class="cicada-nymph-XdataX">&lt;report&gt;</span> command-line .l
     <span class="cicada-nymph-string">"  to get some help info  you can type :"</span> .s .l
     <span class="cicada-nymph-string">"    cn poi help"</span> .s .l
     <span class="cicada-nymph-string">"  good bye ^-^/"</span> .s .l
     <span class="cicada-nymph-end">bye</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-2">** no-function</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;command-function&gt; no-function</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     <span class="cicada-nymph-XdataX">&lt;command-function&gt;</span> stack-REPL
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* command</span>
<span class="org-level-2">** dispatch</span>
<span class="org-block-begin-line">   #+begin_src cicada-nymph :tangle core.cn
</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">&lt;command&gt; dispatch</span>
     <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
     get-command-line
     <span class="cicada-nymph-title">string-tail</span>,word
     dup2 space-string? <span class="cicada-nymph-syntax-key-word">if</span>
       drop2
       <span class="cicada-nymph-XdataX">&lt;command-function&gt;</span> no-function
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-title">string-head</span>,word
     <span class="cicada-nymph-save-local-variable-2">&gt;::1st-word</span>
     <span class="cicada-nymph-fetch-local-variable-2">::1st-word</span> <span class="cicada-nymph-string">"basic-REPL"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-XdataX">&lt;command-function&gt;</span> basic-REPL
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-2">::1st-word</span> <span class="cicada-nymph-string">"stack-REPL"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-XdataX">&lt;command-function&gt;</span> stack-REPL
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-fetch-local-variable-2">::1st-word</span> <span class="cicada-nymph-string">"poi"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
       <span class="cicada-nymph-XdataX">&lt;command-function&gt;</span> poi
       <span class="cicada-nymph-end">end</span>
     <span class="cicada-nymph-syntax-key-word">then</span>
     <span class="cicada-nymph-XdataX">&lt;command-function&gt;</span> unknow-function
     <span class="cicada-nymph-end">end</span>
   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="org-block-end-line">   #+end_src
</span><span class="org-level-1">* the-story-begin</span>
<span class="org-block-begin-line">  #+begin_src cicada-nymph :tangle core.cn
</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">the-story-begin</span>
    <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
    <span class="cicada-nymph-XdataX">&lt;command&gt;</span> dispatch
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

  the-story-begin
<span class="org-block-end-line">  #+end_src
</span><span class="org-level-1">* ===================================</span>
<span class="org-level-1">* </span><span class="org-done">test</span><span class="org-level-1"> report</span>
<span class="org-block-begin-line">  #+begin_src cicada-nymph
</span>  <span class="cicada-nymph-XdataX">&lt;report&gt;</span> memory
  <span class="cicada-nymph-XdataX">&lt;report&gt;</span> syntax
  <span class="cicada-nymph-XdataX">&lt;report&gt;</span> link
<span class="org-block-end-line">  #+end_src
</span><span class="org-level-1">* ===================================</span>
</pre>
  </body>
</html>
