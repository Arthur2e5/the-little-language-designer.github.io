---
---
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
  <head>
    <title>core.cn</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <style type="text/css">
    <!--
      body {
        color: #f8f8f0;
        background-color: #1b1d1e;
      }
      .cicada-nymph-allocate {
        /* cicada-nymph-allocate-face */
        color: #AE7C3B;
        font-weight: bold;
      }
      .cicada-nymph-bool {
        /* cicada-nymph-bool-face */
        color: #fd971f;
        font-weight: bold;
      }
      .cicada-nymph-comment {
        /* cicada-nymph-comment-face */
        color: #FF8888;
      }
      .cicada-nymph-constant {
        /* cicada-nymph-constant-face */
        color: #fd971f;
        font-weight: bold;
      }
      .cicada-nymph-define-exception {
        /* cicada-nymph-define-exception-face */
        color: #1ef15f;
        font-weight: bold;
      }
      .cicada-nymph-define-function {
        /* cicada-nymph-define-function-face */
        color: #ae81ff;
        font-weight: bold;
      }
      .cicada-nymph-define-variable {
        /* cicada-nymph-define-variable-face */
        color: #a1ab3a;
        font-weight: bold;
      }
      .cicada-nymph-end {
        /* cicada-nymph-end-face */
        color: #00ffff;
        font-weight: bold;
      }
      .cicada-nymph-exception {
        /* cicada-nymph-exception-face */
        color: #00ffff;
        font-weight: bold;
      }
      .cicada-nymph-fetch-local-variable-1 {
        /* cicada-nymph-fetch-local-variable-1-face */
        color: #83EA83;
        font-weight: bold;
      }
      .cicada-nymph-fetch-local-variable-2 {
        /* cicada-nymph-fetch-local-variable-2-face */
        color: #5CDD5C;
        font-weight: bold;
      }
      .cicada-nymph-function-to-define {
        /* cicada-nymph-function-to-define-face */
        color: #ef5939;
        font-weight: bold;
      }
      .cicada-nymph-number {
        /* cicada-nymph-number-face */
        color: #fd971f;
        font-weight: bold;
      }
      .cicada-nymph-number-light {
        /* cicada-nymph-number-light-face */
        color: #ffff00;
      }
      .cicada-nymph-save-local-variable-1 {
        /* cicada-nymph-save-local-variable-1-face */
        color: #FF4C4C;
        font-weight: bold;
      }
      .cicada-nymph-save-local-variable-2 {
        /* cicada-nymph-save-local-variable-2-face */
        color: #dc322f;
        font-weight: bold;
      }
      .cicada-nymph-sentence-reader {
        /* cicada-nymph-sentence-reader-face */
        color: #ffff00;
        font-weight: bold;
      }
      .cicada-nymph-square-brackets {
        /* cicada-nymph-square-brackets-face */
        color: #93a8c6;
      }
      .cicada-nymph-string {
        /* cicada-nymph-string-face */
        color: #e6db74;
      }
      .cicada-nymph-syntax-key-word {
        /* cicada-nymph-syntax-key-word-face */
        color: #f92672;
        font-weight: bold;
      }
      .cicada-nymph-title {
        /* cicada-nymph-title-face */
        color: #ffffff;
        font-weight: bold;
      }
      .cicada-nymph-variable {
        /* cicada-nymph-variable-face */
        color: #fd971f;
        font-weight: bold;
      }

      a {
        color: inherit;
        background-color: inherit;
        font: inherit;
        text-decoration: inherit;
      }
      a:hover {
        text-decoration: underline;
      }
    -->
    </style>
{% include in-org-head.html %}
  </head>
  <body>
<pre>
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">.l</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-number">10</span> write-byte
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">.i</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  write-integer
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">.b</span>
  <span class="cicada-nymph-comment">&lt;&lt; byte -- &gt;&gt;</span>
  write-byte
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">word:if?</span>
  <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- bool &gt;&gt;</span>
  <span class="cicada-nymph-string">"if"</span> string-equal?
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">word:else?</span>
  <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- bool &gt;&gt;</span>
  <span class="cicada-nymph-string">"else"</span> string-equal?
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">word:then?</span>
  <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- bool &gt;&gt;</span>
  <span class="cicada-nymph-string">"then"</span> string-equal?
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,if,make-jojo</span>
  &lt;&lt; string<span class="cicada-nymph-square-brackets">[</span>address, length<span class="cicada-nymph-square-brackets">]</span>, word:if --
     address, string<span class="cicada-nymph-square-brackets">[</span>address, length<span class="cicada-nymph-square-brackets">]</span> &gt;&gt;
  drop2
  <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">instruction</span>,false?branch
    <span class="cicada-nymph-title">save-into</span>,jo-area
  <span class="cicada-nymph-variable">*current-free-address,jo-area*</span> xx|swap|x
  <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">save-into</span>,jo-area
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,else,make-jojo</span>
  <span class="cicada-nymph-comment">&lt;&lt; address, string[address, length], word:else --
     address, string[address, length] &gt;&gt;</span>
  drop2
  <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">instruction</span>,branch
     <span class="cicada-nymph-title">save-into</span>,jo-area
  x|swap|xx
  <span class="cicada-nymph-variable">*current-free-address,jo-area*</span> xxx|swap|x
  <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">save-into</span>,jo-area
  <span class="cicada-nymph-comment">&lt;&lt; address, string[address, length], address &gt;&gt;</span>
  <span class="cicada-nymph-variable">*current-free-address,jo-area*</span>
  over sub <span class="cicada-nymph-variable">*jo-size*</span> div
  swap save
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,then,make-jojo</span>
  <span class="cicada-nymph-comment">&lt;&lt; address, string[address, length], word:then --
     string[address, length] &gt;&gt;</span>
  drop2
  x|swap|xx
  <span class="cicada-nymph-variable">*current-free-address,jo-area*</span>
  over sub <span class="cicada-nymph-variable">*jo-size*</span> div
  swap save
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">more,rule-set,make-jojo</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-syntax-key-word">jo</span> word:if?   <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,if,make-jojo    <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> add-rule
  <span class="cicada-nymph-syntax-key-word">jo</span> word:else? <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,else,make-jojo  <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> add-rule
  <span class="cicada-nymph-syntax-key-word">jo</span> word:then? <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,then,make-jojo  <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> add-rule
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-title">more</span>,rule-set,make-jojo

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">word:prepare-for?</span>
  <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- bool &gt;&gt;</span>
  <span class="cicada-nymph-string">"prepare-for"</span> string-equal?
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,prepare-for,make-jojo</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length], word:prepare-for --
     string[address, length] &gt;&gt;</span>
  drop2
  <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">instruction</span>,prepare-for
    <span class="cicada-nymph-title">save-into</span>,jo-area
  <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">instruction</span>,exception-head
    <span class="cicada-nymph-title">save-into</span>,jo-area
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">word:exception-reset-stack?</span>
  <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- bool &gt;&gt;</span>
  <span class="cicada-nymph-string">"exception-reset-stack"</span> string-equal?
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,exception-reset-stack,make-jojo</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length], word:exception-reset-stack --
     string[address, length] &gt;&gt;</span>
  drop2
  <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">instruction</span>,exception-reset-stack
    <span class="cicada-nymph-title">save-into</span>,jo-area
  current-defining-word <span class="cicada-nymph-title">find-jo</span>,through-jo-link
  drop
    <span class="cicada-nymph-title">save-into</span>,jo-area
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">more,rule-set,make-jojo</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-syntax-key-word">jo</span> word:prepare-for?
  <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,prepare-for,make-jojo
  <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> add-rule
  <span class="cicada-nymph-syntax-key-word">jo</span> word:exception-reset-stack?
  <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,exception-reset-stack,make-jojo
  <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> add-rule
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-title">more</span>,rule-set,make-jojo

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">allocate-memory</span>
  <span class="cicada-nymph-comment">&lt;&lt; size -- address &gt;&gt;</span>
  dup <span class="cicada-nymph-variable">*current-free-address,un-initialized-memory*</span> clear-memory
  <span class="cicada-nymph-variable">*current-free-address,un-initialized-memory*</span> swap <span class="cicada-nymph-comment">&lt;&lt; address as return value &gt;&gt;</span>
  <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*current-free-address,un-initialized-memory*</span> add-save
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-number">100333</span>
<span class="cicada-nymph-comment">&lt;&lt; drop 13 &gt;&gt;</span>
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*name-hash-table,size*</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">5</span> mul
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*name-hash-table,unit*</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-variable">*name-hash-table,size*</span>
<span class="cicada-nymph-variable">*name-hash-table,unit*</span> mul
<span class="cicada-nymph-allocate">allocate-memory</span>
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*name-hash-table*</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-number">0</span>
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*name-hash-table,counter*</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-&gt;address</span>
  <span class="cicada-nymph-comment">&lt;&lt; name -- address &gt;&gt;</span>
  <span class="cicada-nymph-variable">*name-hash-table,unit*</span> mul
  <span class="cicada-nymph-variable">*name-hash-table*</span> add
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,used?</span>
  <span class="cicada-nymph-comment">&lt;&lt; name -- bool &gt;&gt;</span>
  name-&gt;address
  fetch zero? false?
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,used-as-title?</span>
  <span class="cicada-nymph-comment">&lt;&lt; name -- bool &gt;&gt;</span>
  name-&gt;address
  <span class="cicada-nymph-variable">*jo-size*</span> add
  fetch zero? not
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,used-as-nymph-jo?</span>
  <span class="cicada-nymph-comment">&lt;&lt; name -- bool &gt;&gt;</span>
  name-&gt;address
  <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">4</span> mul add
  fetch zero? not
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,fetch-string</span>
  <span class="cicada-nymph-comment">&lt;&lt; name -- string[address, length] &gt;&gt;</span>
  name-&gt;address
  fetch
  address-&gt;name-string
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,fetch-title-index</span>
  <span class="cicada-nymph-comment">&lt;&lt; name -- title-index &gt;&gt;</span>
  name-&gt;address
  <span class="cicada-nymph-variable">*jo-size*</span> add
  fetch
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,fetch-orbit-length</span>
  <span class="cicada-nymph-comment">&lt;&lt; name -- orbit-length &gt;&gt;</span>
  name-&gt;address
  <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">2</span> mul add
  fetch
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,fetch-orbiton</span>
  <span class="cicada-nymph-comment">&lt;&lt; name -- orbiton &gt;&gt;</span>
  name-&gt;address
  <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">3</span> mul add
  fetch
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,fetch-nymph-jo</span>
  <span class="cicada-nymph-comment">&lt;&lt; name -- nymph-jo &gt;&gt;</span>
  name-&gt;address
  <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">4</span> mul add
  fetch
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,save-string</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length], name -- &gt;&gt;</span>
  <span class="cicada-nymph-variable">*current-free-address,name-string-area*</span>
  xx|swap|xx
  <span class="cicada-nymph-title">save-into</span>,name-string-area
  swap
  name-&gt;address
  save
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,save-title-index</span>
  <span class="cicada-nymph-comment">&lt;&lt; title-index, name -- &gt;&gt;</span>
  name-&gt;address
  <span class="cicada-nymph-variable">*jo-size*</span> add
  save
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,save-orbit-length</span>
  <span class="cicada-nymph-comment">&lt;&lt; orbit-length, name -- &gt;&gt;</span>
  name-&gt;address
  <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">2</span> mul add
  save
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,save-orbiton</span>
  <span class="cicada-nymph-comment">&lt;&lt; orbiton, name -- &gt;&gt;</span>
  name-&gt;address
  <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">3</span> mul add
  save
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,save-nymph-jo</span>
  <span class="cicada-nymph-comment">&lt;&lt; nymph-jo, name -- &gt;&gt;</span>
  name-&gt;address
  <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">4</span> mul add
  save
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name,no-collision?</span>
  <span class="cicada-nymph-comment">&lt;&lt; name -- bool &gt;&gt;</span>
  dup <span class="cicada-nymph-title">name</span>,fetch-orbiton
  equal?
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,hash</span>
  <span class="cicada-nymph-comment">&lt;&lt; number, counter -- index &gt;&gt;</span>
  add <span class="cicada-nymph-variable">*name-hash-table,size*</span> mod
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-number">16</span>
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*max-carry-position*</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">string-&gt;finite-carry-sum,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; carry-sum, string[address, length], counter -- carry-sum &gt;&gt;</span>
  over zero? <span class="cicada-nymph-syntax-key-word">if</span>
    drop drop2
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-variable">*max-carry-position*</span> greater-than? <span class="cicada-nymph-syntax-key-word">if</span>
    drop <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-comment">&lt;&lt; re-start from 0 &gt;&gt;</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  xx|over|x
  <span class="cicada-nymph-title">string-head</span>,char over
  <span class="cicada-nymph-number">2</span> swap power
  mul
  x|swap|xxxx add xxx|swap|x
  add1 xx|swap|x
  <span class="cicada-nymph-title">string-tail</span>,char x|swap|xx
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">string-&gt;finite-carry-sum</span>,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">string-&gt;finite-carry-sum</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- carry-sum &gt;&gt;</span>
  <span class="cicada-nymph-number">0</span> xx|swap|x <span class="cicada-nymph-comment">&lt;&lt; carry-sum &gt;&gt;</span>
  <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-comment">&lt;&lt; counter &gt;&gt;</span>
  <span class="cicada-nymph-title">string-&gt;finite-carry-sum</span>,loop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,search,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length], number, counter
     -- name, true
     -- name, false &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:counter</span> <span class="cicada-nymph-save-local-variable-1">&gt;:number</span> <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>
  <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-fetch-local-variable-1">:counter</span> <span class="cicada-nymph-title">name-hash-table</span>,hash
  <span class="cicada-nymph-save-local-variable-1">&gt;:name</span>
  <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">name-hash-table</span>,hash
  <span class="cicada-nymph-save-local-variable-1">&gt;:orbit</span>
  <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-title">name</span>,used? false? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-title">name</span>,fetch-string
  <span class="cicada-nymph-fetch-local-variable-2">::string</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-bool">true</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-title">name</span>,fetch-orbit-length
  <span class="cicada-nymph-fetch-local-variable-1">:counter</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-2">::string</span>
  <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-fetch-local-variable-1">:counter</span> add1
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">name-hash-table</span>,search,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,search</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length]
     -- name, true
     -- name, false &gt;&gt;</span>
  dup2 string-&gt;finite-carry-sum
  <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">name-hash-table</span>,search,loop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,insert,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length], number, counter
     -- name, true
     -- name, false &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:counter</span> <span class="cicada-nymph-save-local-variable-1">&gt;:number</span> <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>
  <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-fetch-local-variable-1">:counter</span> <span class="cicada-nymph-title">name-hash-table</span>,hash
  <span class="cicada-nymph-save-local-variable-1">&gt;:name</span>
  <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">name-hash-table</span>,hash
  <span class="cicada-nymph-save-local-variable-1">&gt;:orbit</span>
  <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-title">name</span>,used? false? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-fetch-local-variable-1">:name</span>
    <span class="cicada-nymph-title">name</span>,save-string
    <span class="cicada-nymph-fetch-local-variable-1">:orbit</span> <span class="cicada-nymph-fetch-local-variable-1">:name</span>
    <span class="cicada-nymph-title">name</span>,save-orbiton
    <span class="cicada-nymph-fetch-local-variable-1">:counter</span> <span class="cicada-nymph-fetch-local-variable-1">:orbit</span>
    <span class="cicada-nymph-title">name</span>,save-orbit-length
    <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*name-hash-table,counter*</span> add-save
    <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-bool">true</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-title">name</span>,fetch-string
  <span class="cicada-nymph-fetch-local-variable-2">::string</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-bool">true</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:counter</span> <span class="cicada-nymph-variable">*name-hash-table,size*</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-2">::string</span>
  <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-fetch-local-variable-1">:counter</span> add1
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">name-hash-table</span>,insert,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,insert</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length]
     -- name, true
     -- name, false &gt;&gt;</span>
  dup2 string-&gt;finite-carry-sum
  <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">name-hash-table</span>,insert,loop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">string-&gt;name</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- name &gt;&gt;</span>
  <span class="cicada-nymph-title">name-hash-table</span>,insert
  false? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"* (string-&gt;name) *name-hash-table* is full!"</span> .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-&gt;string</span>
  <span class="cicada-nymph-comment">&lt;&lt; name -- string[address, length]] &gt;&gt;</span>
  <span class="cicada-nymph-title">name</span>,fetch-string
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,report,orbit</span>
  <span class="cicada-nymph-comment">&lt;&lt; name, counter -- &gt;&gt;</span>
  over <span class="cicada-nymph-title">name</span>,fetch-orbit-length
  over less-than? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  over <span class="cicada-nymph-title">name</span>,fetch-string string-&gt;finite-carry-sum
  over <span class="cicada-nymph-title">name-hash-table</span>,hash
  dup <span class="cicada-nymph-title">name</span>,fetch-orbiton
  <span class="cicada-nymph-comment">&lt;&lt; name, counter, new-name, orbiton &gt;&gt;</span>
  x|over|xxx <span class="cicada-nymph-title">name</span>,fetch-string string-&gt;finite-carry-sum
  <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">name-hash-table</span>,hash
  equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"  {"</span> .s
    dup write-number
    <span class="cicada-nymph-string">"} "</span> .s
    <span class="cicada-nymph-title">name</span>,fetch-string .s
    .l
  <span class="cicada-nymph-syntax-key-word">else</span>
    drop
  <span class="cicada-nymph-syntax-key-word">then</span>
  add1 <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">name-hash-table</span>,report,orbit
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,report,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; name -- &gt;&gt;</span>
  dup <span class="cicada-nymph-variable">*name-hash-table,size*</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
    drop
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-title">name</span>,used? <span class="cicada-nymph-syntax-key-word">if</span>
  dup <span class="cicada-nymph-title">name</span>,no-collision? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-comment">&lt;&lt; * {index} string # orbit-lenght &gt;&gt;</span>
    <span class="cicada-nymph-string">"* {"</span> .s
    dup write-number
    <span class="cicada-nymph-string">"} "</span> .s
    dup <span class="cicada-nymph-title">name</span>,fetch-string .s
    <span class="cicada-nymph-string">" # "</span> .s
    dup <span class="cicada-nymph-title">name</span>,fetch-orbit-length
    write-number
    .l
    dup <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-title">name-hash-table</span>,report,orbit
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  add1 <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">name-hash-table</span>,report,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">name-hash-table,report</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">name-hash-table</span>,report,loop
  <span class="cicada-nymph-string">"* totally : "</span> .s
  <span class="cicada-nymph-variable">*name-hash-table,counter*</span> write-number
  .l
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">word:name?</span>
  <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- bool &gt;&gt;</span>
  <span class="cicada-nymph-string">"name"</span> string-equal?
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,name,make-jojo</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length], word[address, length] --
     string[address, length] &gt;&gt;</span>
  drop2
  <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">instruction</span>,literal
    <span class="cicada-nymph-title">save-into</span>,jo-area
  dup2
  <span class="cicada-nymph-title">string-head</span>,word
  string-&gt;name
    <span class="cicada-nymph-title">save-into</span>,jo-area
  <span class="cicada-nymph-title">string-tail</span>,word
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">more,rule-set,make-jojo</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-syntax-key-word">jo</span> word:name?
  <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,name,make-jojo
  <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> add-rule
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-title">more</span>,rule-set,make-jojo

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">jo,save-into,name-hash-table</span>
  <span class="cicada-nymph-comment">&lt;&lt; jo -- &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:jo</span>
  <span class="cicada-nymph-fetch-local-variable-1">:jo</span> jo-&gt;name string-&gt;name <span class="cicada-nymph-save-local-variable-1">&gt;:name</span>
  <span class="cicada-nymph-fetch-local-variable-1">:jo</span> <span class="cicada-nymph-fetch-local-variable-1">:name</span> <span class="cicada-nymph-title">name</span>,save-nymph-jo
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">find-jo</span>
  <span class="cicada-nymph-comment">&lt;&lt; word[address, length]
     -- jo, true
     -- false &gt;&gt;</span>
  <span class="cicada-nymph-title">name-hash-table</span>,search <span class="cicada-nymph-syntax-key-word">if</span>
  <span class="cicada-nymph-syntax-key-word">else</span>
    drop
    <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-title">name</span>,used-as-nymph-jo? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-title">name</span>,fetch-nymph-jo
    <span class="cicada-nymph-bool">true</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  drop
  <span class="cicada-nymph-bool">false</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">make-jojo,dispatch-syntax-word</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length], word[address, length] --
     string[address, length] &gt;&gt;</span>
  dup2 find-syntax <span class="cicada-nymph-syntax-key-word">if</span>
    execute-jo
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup2 find-jo <span class="cicada-nymph-syntax-key-word">if</span>
    xx|swap|x drop2
    <span class="cicada-nymph-title">save-into</span>,jo-area
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-string">"* (make-jojo) meets undefined word : "</span> .s .s .l
  <span class="cicada-nymph-exception">!undo-make-jojo</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">make-jojo,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- &gt;&gt;</span>
  dup2 space-string? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup2
  <span class="cicada-nymph-title">string-tail</span>,word
  xx|swap|xx
  <span class="cicada-nymph-title">string-head</span>,word
  <span class="cicada-nymph-title">make-jojo</span>,dispatch-syntax-word
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">make-jojo</span>,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">make-jojo</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- &gt;&gt;</span>
  <span class="cicada-nymph-title">local-variable-table</span>,clear
  <span class="cicada-nymph-variable">*rule-set,make-jojo*</span>
  push-syntax-stack
  <span class="cicada-nymph-title">make-jojo</span>,loop
  drop-syntax-stack
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">init,name-hash-table,nymph-jo,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; jo -- &gt;&gt;</span>
  dup jo-&gt;name
  <span class="cicada-nymph-title">name-hash-table</span>,search <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-title">name</span>,used-as-nymph-jo? <span class="cicada-nymph-syntax-key-word">if</span>
      dup <span class="cicada-nymph-title">last-jo</span>,jotionary? <span class="cicada-nymph-syntax-key-word">if</span>
        drop
        <span class="cicada-nymph-end">end</span>
      <span class="cicada-nymph-syntax-key-word">then</span>
      jo-&gt;pre-jo
      <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">init</span>,name-hash-table,nymph-jo,loop
    <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-syntax-key-word">else</span>
    drop
  <span class="cicada-nymph-syntax-key-word">then</span>

  dup <span class="cicada-nymph-title">jo</span>,save-into,name-hash-table

  dup <span class="cicada-nymph-title">last-jo</span>,jotionary? <span class="cicada-nymph-syntax-key-word">if</span>
    drop
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  jo-&gt;pre-jo
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">init</span>,name-hash-table,nymph-jo,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">init,name-hash-table,nymph-jo</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-variable">*first-jo-in-jotionary*</span>
  <span class="cicada-nymph-title">init</span>,name-hash-table,nymph-jo,loop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">define-variable,with-tos</span>
  <span class="cicada-nymph-comment">&lt;&lt; variable, string[address, length] -- &gt;&gt;</span>
  <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-title">save-into</span>,jo-area

  <span class="cicada-nymph-variable">*current-free-address,name-string-area*</span>
    <span class="cicada-nymph-title">save-into</span>,jo-area
  dup2 <span class="cicada-nymph-title">string-head</span>,word
    <span class="cicada-nymph-title">save-into</span>,name-string-area

  <span class="cicada-nymph-variable">*first-jo-in-jotionary*</span>
  jo-&gt;link
    <span class="cicada-nymph-title">save-into</span>,jo-area

  <span class="cicada-nymph-variable">*current-free-address,jo-area*</span>
  dup <span class="cicada-nymph-title">jo</span>,save-into,name-hash-table
  <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*first-jo-in-jotionary*</span> save

  <span class="cicada-nymph-variable">*explainer,variable*</span>
    <span class="cicada-nymph-title">save-into</span>,jo-area

  drop2
  <span class="cicada-nymph-title">save-into</span>,jo-area
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">define-exception</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- &gt;&gt;</span>
  <span class="cicada-nymph-variable">*current-free-address,name-string-area*</span> xx|swap|x
  <span class="cicada-nymph-variable">*current-free-address,jo-area*</span> xx|swap|x
  <span class="cicada-nymph-variable">*first-jo-in-jotionary*</span> xx|swap|x
  <span class="cicada-nymph-comment">&lt;&lt; *current-free-address,name-string-area*
     *current-free-address,jo-area*
     *first-jo-in-jotionary*
     string[address, length] &gt;&gt;</span>
  prepare-for
    <span class="cicada-nymph-exception">!undo-make-jojo</span>
    <span class="cicada-nymph-end">end</span>

  <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">save-into</span>,jo-area

  <span class="cicada-nymph-variable">*current-free-address,name-string-area*</span>
    <span class="cicada-nymph-title">save-into</span>,jo-area
  dup2 <span class="cicada-nymph-title">string-head</span>,word
    <span class="cicada-nymph-title">save-into</span>,name-string-area

  <span class="cicada-nymph-variable">*first-jo-in-jotionary*</span>
  jo-&gt;link
    <span class="cicada-nymph-title">save-into</span>,jo-area

  <span class="cicada-nymph-variable">*current-free-address,jo-area*</span>
  dup <span class="cicada-nymph-title">jo</span>,save-into,name-hash-table
  <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*first-jo-in-jotionary*</span> save

  <span class="cicada-nymph-variable">*explainer,exception*</span>
    <span class="cicada-nymph-title">save-into</span>,jo-area

  dup2
  <span class="cicada-nymph-title">string-tail</span>,word
  make-jojo

  drop2
  drop
  drop
  drop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">define-function</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- &gt;&gt;</span>
  <span class="cicada-nymph-variable">*current-free-address,name-string-area*</span> xx|swap|x
  <span class="cicada-nymph-variable">*current-free-address,jo-area*</span> xx|swap|x
  <span class="cicada-nymph-variable">*first-jo-in-jotionary*</span> xx|swap|x
  <span class="cicada-nymph-comment">&lt;&lt; *current-free-address,name-string-area*
     *current-free-address,jo-area*
     *first-jo-in-jotionary*
     string[address, length] &gt;&gt;</span>
  prepare-for
    <span class="cicada-nymph-exception">!undo-make-jojo</span>
    <span class="cicada-nymph-end">end</span>

  <span class="cicada-nymph-variable">*current-free-address,name-string-area*</span>
    <span class="cicada-nymph-title">save-into</span>,jo-area
  dup2 <span class="cicada-nymph-title">string-head</span>,word
    <span class="cicada-nymph-title">save-into</span>,name-string-area

  <span class="cicada-nymph-variable">*first-jo-in-jotionary*</span>
  jo-&gt;link
    <span class="cicada-nymph-title">save-into</span>,jo-area

  <span class="cicada-nymph-variable">*current-free-address,jo-area*</span>
  dup <span class="cicada-nymph-title">jo</span>,save-into,name-hash-table
  <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*first-jo-in-jotionary*</span> save

  <span class="cicada-nymph-variable">*explainer,function*</span>
    <span class="cicada-nymph-title">save-into</span>,jo-area

  dup2
  <span class="cicada-nymph-title">string-tail</span>,word
  make-jojo

  drop2
  drop
  drop
  drop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-title">init</span>,name-hash-table,nymph-jo

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">remove-char!,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; cursor, length, char -- cursor &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:char</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
  <span class="cicada-nymph-fetch-local-variable-1">:length</span> zero? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> fetch-byte <span class="cicada-nymph-fetch-local-variable-1">:char</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add1 <span class="cicada-nymph-fetch-local-variable-1">:length</span> sub1
    <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
    string-&gt;buffer!
    <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
    <span class="cicada-nymph-fetch-local-variable-1">:length</span> sub1
    <span class="cicada-nymph-fetch-local-variable-1">:char</span>
  <span class="cicada-nymph-syntax-key-word">else</span>
    <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add1
    <span class="cicada-nymph-fetch-local-variable-1">:length</span> sub1
    <span class="cicada-nymph-fetch-local-variable-1">:char</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">remove-char!</span>,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">remove-char!</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length], char -- string[address, length] &gt;&gt;</span>
  x|over|xx <span class="cicada-nymph-save-local-variable-1">&gt;:address</span>
  <span class="cicada-nymph-title">remove-char!</span>,loop <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
  <span class="cicada-nymph-fetch-local-variable-1">:address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:address</span> sub
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">latin-char?</span>
  <span class="cicada-nymph-comment">&lt;&lt; char -- bool &gt;&gt;</span>
  dup <span class="cicada-nymph-string">"A"</span> <span class="cicada-nymph-title">string-head</span>,char less-than? <span class="cicada-nymph-syntax-key-word">false?branch</span> <span class="cicada-nymph-number">4</span>
    drop <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  dup <span class="cicada-nymph-string">"Z"</span> <span class="cicada-nymph-title">string-head</span>,char less-or-equal? <span class="cicada-nymph-syntax-key-word">false?branch</span> <span class="cicada-nymph-number">4</span>
    drop <span class="cicada-nymph-bool">true</span>
    <span class="cicada-nymph-end">end</span>
  dup <span class="cicada-nymph-string">"a"</span> <span class="cicada-nymph-title">string-head</span>,char less-than? <span class="cicada-nymph-syntax-key-word">false?branch</span> <span class="cicada-nymph-number">4</span>
    drop <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  dup <span class="cicada-nymph-string">"z"</span> <span class="cicada-nymph-title">string-head</span>,char less-or-equal? <span class="cicada-nymph-syntax-key-word">false?branch</span> <span class="cicada-nymph-number">4</span>
    drop <span class="cicada-nymph-bool">true</span>
    <span class="cicada-nymph-end">end</span>
  drop <span class="cicada-nymph-bool">false</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">latin-char-&gt;number</span>
  <span class="cicada-nymph-comment">&lt;&lt; latin-char -- number &gt;&gt;</span>
  dup <span class="cicada-nymph-string">"A"</span> <span class="cicada-nymph-title">string-head</span>,char less-than? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"* (latin-char-&gt;number) the argument must be a latin-char"</span> .s .l
    <span class="cicada-nymph-string">"  but the following char is less-than 'A' : "</span> .s
    .i .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-string">"Z"</span> <span class="cicada-nymph-title">string-head</span>,char less-or-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"A"</span> <span class="cicada-nymph-title">string-head</span>,char
    sub
    <span class="cicada-nymph-number">10</span> add
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-string">"a"</span> <span class="cicada-nymph-title">string-head</span>,char less-than? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"* (latin-char-&gt;number) the argument must be a latin-char"</span> .s .l
    <span class="cicada-nymph-string">"  but the following char is less-than 'a' but greater-then 'Z' : "</span> .s
    .i .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-string">"z"</span> <span class="cicada-nymph-title">string-head</span>,char less-or-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"a"</span> <span class="cicada-nymph-title">string-head</span>,char
    sub
    <span class="cicada-nymph-number">10</span> add
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-string">"* (latin-char-&gt;number) the argument must be a latin-char"</span> .s .l
  <span class="cicada-nymph-string">"  but the following char is greater-then 'z' : "</span> .s
  .i .l
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">number-&gt;latin-char</span>
  <span class="cicada-nymph-comment">&lt;&lt; number -- latin-char &gt;&gt;</span>
  <span class="cicada-nymph-number">10</span> sub
  <span class="cicada-nymph-string">"a"</span> <span class="cicada-nymph-title">string-head</span>,char
  add
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">wild-digit-string?</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- bool &gt;&gt;</span>
  dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2 <span class="cicada-nymph-bool">true</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  over fetch-byte
  dup digit-char?
  swap latin-char?
  or <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-title">string-tail</span>,char
    <span class="cicada-nymph-end">&lt;&gt;</span> wild-digit-string?
  <span class="cicada-nymph-syntax-key-word">then</span>
  drop2
  <span class="cicada-nymph-bool">false</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">wild-integer-string?</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- bool &gt;&gt;</span>
  dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2 <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup2 <span class="cicada-nymph-title">string-head</span>,char
  <span class="cicada-nymph-string">"-"</span> <span class="cicada-nymph-title">string-head</span>,char
  equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-title">string-tail</span>,char
    wild-digit-string?
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  wild-digit-string?
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">base#wild-integer-string?</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- bool &gt;&gt;</span>
  <span class="cicada-nymph-number">128</span> <span class="cicada-nymph-allocate">allocate-local-memory</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:string-address</span>
  tuck
  <span class="cicada-nymph-fetch-local-variable-1">:string-address</span>
  string-&gt;buffer!
  <span class="cicada-nymph-fetch-local-variable-1">:string-address</span> swap
  <span class="cicada-nymph-string">"_"</span> <span class="cicada-nymph-title">string-head</span>,char
  remove-char!
  <span class="cicada-nymph-save-local-variable-1">&gt;:new-string-length</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:new-string-address</span>
  <span class="cicada-nymph-comment">&lt;&lt; dup2 .s .l 0 end &gt;&gt;</span>
  <span class="cicada-nymph-fetch-local-variable-1">:new-string-address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:new-string-length</span>
  <span class="cicada-nymph-string">"#"</span> <span class="cicada-nymph-title">string-head</span>,char
  <span class="cicada-nymph-title">string</span>,find-char <span class="cicada-nymph-syntax-key-word">if</span>
  <span class="cicada-nymph-syntax-key-word">else</span>
    <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:address-of-#</span>
  <span class="cicada-nymph-fetch-local-variable-1">:new-string-address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:address-of-#</span> <span class="cicada-nymph-fetch-local-variable-1">:new-string-address</span> sub
  <span class="cicada-nymph-save-local-variable-2">&gt;::base-string</span>
  <span class="cicada-nymph-fetch-local-variable-1">:address-of-#</span> add1
  <span class="cicada-nymph-fetch-local-variable-1">:address-of-#</span> <span class="cicada-nymph-fetch-local-variable-1">:new-string-address</span> sub add1
  <span class="cicada-nymph-fetch-local-variable-1">:new-string-length</span> swap sub
  <span class="cicada-nymph-save-local-variable-2">&gt;::wild-integer-string</span>
  <span class="cicada-nymph-fetch-local-variable-2">::base-string</span> digit-string?
  <span class="cicada-nymph-fetch-local-variable-2">::base-string</span> empty-string? not
  and <span class="cicada-nymph-syntax-key-word">if</span>
  <span class="cicada-nymph-syntax-key-word">else</span>
    <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-2">::wild-integer-string</span> wild-integer-string?
  <span class="cicada-nymph-fetch-local-variable-2">::wild-integer-string</span> empty-string? not
  and <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-bool">true</span>
  <span class="cicada-nymph-syntax-key-word">else</span>
    <span class="cicada-nymph-bool">false</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">base#wild-integer-string-&gt;base-string</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- string[address, length] &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:length</span>
  <span class="cicada-nymph-string">"#"</span> <span class="cicada-nymph-title">string-head</span>,char
  <span class="cicada-nymph-title">string</span>,find-char <span class="cicada-nymph-syntax-key-word">if</span>
  <span class="cicada-nymph-syntax-key-word">else</span>
    <span class="cicada-nymph-string">"* (base#wild-integer-string-&gt;base-string)"</span> .s .l
    <span class="cicada-nymph-string">"  the argument must be a base#wild-integer-string"</span> .s .l
    <span class="cicada-nymph-string">"  but the following string does not even have a '#' in it :"</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s
    <span class="cicada-nymph-fetch-local-variable-1">:address</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span> .s .l
    <span class="cicada-nymph-comment">&lt;&lt; to balance the argument-stack or not ??? &gt;&gt;</span>
    <span class="cicada-nymph-comment">&lt;&lt; :address :length &gt;&gt;</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:address-of-#</span>
  <span class="cicada-nymph-fetch-local-variable-1">:address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:address-of-#</span> <span class="cicada-nymph-fetch-local-variable-1">:address</span> sub
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">base#wild-integer-string-&gt;wild-integer-string</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- string[address, length] &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:length</span>
  <span class="cicada-nymph-string">"#"</span> <span class="cicada-nymph-title">string-head</span>,char
  <span class="cicada-nymph-title">string</span>,find-char <span class="cicada-nymph-syntax-key-word">if</span>
  <span class="cicada-nymph-syntax-key-word">else</span>
    <span class="cicada-nymph-string">"* (base#wild-integer-string-&gt;wild-integer-string)"</span> .s .l
    <span class="cicada-nymph-string">"  the argument must be a base#wild-integer-string"</span> .s .l
    <span class="cicada-nymph-string">"  but the following string does not even have a '#' in it :"</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s
    <span class="cicada-nymph-fetch-local-variable-1">:address</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span> .s .l
    <span class="cicada-nymph-comment">&lt;&lt; to balance the argument-stack or not ??? &gt;&gt;</span>
    <span class="cicada-nymph-comment">&lt;&lt; :address :length &gt;&gt;</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:address-of-#</span>
  <span class="cicada-nymph-fetch-local-variable-1">:address-of-#</span> add1
  <span class="cicada-nymph-fetch-local-variable-1">:address-of-#</span> <span class="cicada-nymph-fetch-local-variable-1">:address</span> sub add1
  <span class="cicada-nymph-fetch-local-variable-1">:length</span> swap sub
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">wild-integer-string-&gt;integer,with-base,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length], base, sum, counter -- integer &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:counter</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:sum</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:base</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:length</span> zero? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:sum</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:address</span> fetch-byte <span class="cicada-nymph-save-local-variable-1">&gt;:char</span>
  <span class="cicada-nymph-fetch-local-variable-1">:char</span> digit-char? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:char</span> digit-char-&gt;number
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:char</span> latin-char? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:char</span> latin-char-&gt;number
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:base</span> <span class="cicada-nymph-fetch-local-variable-1">:counter</span> power
  mul
  <span class="cicada-nymph-fetch-local-variable-1">:sum</span> add
  <span class="cicada-nymph-save-local-variable-1">&gt;:sum</span>
  <span class="cicada-nymph-fetch-local-variable-1">:address</span> add1
  <span class="cicada-nymph-fetch-local-variable-1">:length</span> sub1
  <span class="cicada-nymph-fetch-local-variable-1">:base</span>
  <span class="cicada-nymph-fetch-local-variable-1">:sum</span>
  <span class="cicada-nymph-fetch-local-variable-1">:counter</span> add1
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">wild-integer-string-&gt;integer</span>,with-base,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">wild-integer-string-&gt;integer,with-base</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length], base -- integer &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:base</span>
  dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2
    <span class="cicada-nymph-number">0</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup2 <span class="cicada-nymph-title">string-head</span>,char
  <span class="cicada-nymph-string">"-"</span> <span class="cicada-nymph-title">string-head</span>,char
  equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-title">string-tail</span>,char
    <span class="cicada-nymph-number">-1</span> <span class="cicada-nymph-save-local-variable-1">&gt;:sign</span>
  <span class="cicada-nymph-syntax-key-word">else</span>
    <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-save-local-variable-1">&gt;:sign</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>
  <span class="cicada-nymph-fetch-local-variable-2">::string</span> string-reverse!
  <span class="cicada-nymph-fetch-local-variable-1">:base</span>
  <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">wild-integer-string-&gt;integer</span>,with-base,loop
  <span class="cicada-nymph-fetch-local-variable-1">:sign</span> mul
  <span class="cicada-nymph-fetch-local-variable-2">::string</span> string-reverse!
  drop2
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">base#wild-integer-string-&gt;integer</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- integer &gt;&gt;</span>
  <span class="cicada-nymph-number">128</span> <span class="cicada-nymph-allocate">allocate-local-memory</span>
    <span class="cicada-nymph-save-local-variable-1">&gt;:address</span>
  tuck <span class="cicada-nymph-fetch-local-variable-1">:address</span> string-&gt;buffer!
    <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
  <span class="cicada-nymph-fetch-local-variable-1">:address</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
  <span class="cicada-nymph-string">"_"</span> <span class="cicada-nymph-title">string-head</span>,char remove-char!
    <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>
  <span class="cicada-nymph-fetch-local-variable-2">::string</span>
  base#wild-integer-string-&gt;base-string
    <span class="cicada-nymph-save-local-variable-2">&gt;::base-string</span>
  <span class="cicada-nymph-fetch-local-variable-2">::string</span>
  base#wild-integer-string-&gt;wild-integer-string
    <span class="cicada-nymph-save-local-variable-2">&gt;::wild-integer-string</span>
  <span class="cicada-nymph-fetch-local-variable-2">::base-string</span>
  digit-string-&gt;number
    <span class="cicada-nymph-save-local-variable-1">&gt;:base</span>
  <span class="cicada-nymph-fetch-local-variable-2">::wild-integer-string</span>
  <span class="cicada-nymph-fetch-local-variable-1">:base</span>
  <span class="cicada-nymph-title">wild-integer-string-&gt;integer</span>,with-base
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">.#,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; number, base, cursor -- cursor &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:base</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:number</span>
  <span class="cicada-nymph-fetch-local-variable-1">:number</span> zero? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:number</span>
  <span class="cicada-nymph-fetch-local-variable-1">:base</span>
  divmod <span class="cicada-nymph-save-local-variable-1">&gt;:mod</span> <span class="cicada-nymph-save-local-variable-1">&gt;:div</span>
  <span class="cicada-nymph-fetch-local-variable-1">:mod</span> <span class="cicada-nymph-number">10</span> less-than? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:mod</span> number-&gt;digit-char
  <span class="cicada-nymph-syntax-key-word">else</span>
    <span class="cicada-nymph-fetch-local-variable-1">:mod</span> number-&gt;latin-char
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
  save-byte
  <span class="cicada-nymph-fetch-local-variable-1">:div</span>
  <span class="cicada-nymph-fetch-local-variable-1">:base</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add1
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">.#</span>,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">.#</span>
  <span class="cicada-nymph-comment">&lt;&lt; integer, base -- &gt;&gt;</span>
  over zero? <span class="cicada-nymph-syntax-key-word">if</span>
    drop .i
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">36</span> greater-than?
  over <span class="cicada-nymph-number">2</span> less-than?
  or <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"* (.#) the base "</span> .s .i <span class="cicada-nymph-string">" is not valid to write a number"</span> .s .l
    <span class="cicada-nymph-string">"  a base should in between 2 and 36 includingly"</span> .s .l
    <span class="cicada-nymph-string">"  the integer to be written is "</span> .s .i .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup .i
  <span class="cicada-nymph-string">"#"</span> .s
  over negative? <span class="cicada-nymph-syntax-key-word">if</span>
    swap negate swap
    <span class="cicada-nymph-string">"-"</span> .s
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-number">128</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
  <span class="cicada-nymph-title">.#</span>,loop <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> sub
  string-reverse! .s
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">.#2</span>  <span class="cicada-nymph-number">2</span>  .# <span class="cicada-nymph-string">" "</span> .s <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">.#8</span>  <span class="cicada-nymph-number">8</span>  .# <span class="cicada-nymph-string">" "</span> .s <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">.#16</span> <span class="cicada-nymph-number">16</span> .# <span class="cicada-nymph-string">" "</span> .s <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">number-&gt;gamber</span>
  <span class="cicada-nymph-comment">&lt;&lt; number -- gamber &gt;&gt;</span>
  dup <span class="cicada-nymph-number">1</span> bit-right
  bit-xor
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">gamber-&gt;number,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; gamber, number, cursor -- number &gt;&gt;</span>
  dup negative? <span class="cicada-nymph-syntax-key-word">if</span>
    drop
    swap drop
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:number</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:gamber</span>
  <span class="cicada-nymph-fetch-local-variable-1">:gamber</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> get-bit
  <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add1 get-bit
  xor <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:number</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> set-bit <span class="cicada-nymph-save-local-variable-1">&gt;:number</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:gamber</span>
  <span class="cicada-nymph-fetch-local-variable-1">:number</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> sub1
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">gamber-&gt;number</span>,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">gamber-&gt;number</span>
  <span class="cicada-nymph-comment">&lt;&lt; gamber -- number &gt;&gt;</span>
  dup find-highest-set-bit
  dup negative? <span class="cicada-nymph-syntax-key-word">if</span>
    drop
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-number">0</span> over set-bit
  swap sub1
  <span class="cicada-nymph-title">gamber-&gt;number</span>,loop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,base#wild-integer-string,make-jojo</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length], word[address, length] --
     string[address, length] &gt;&gt;</span>
  <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">instruction</span>,literal
    <span class="cicada-nymph-title">save-into</span>,jo-area
  base#wild-integer-string-&gt;integer
    <span class="cicada-nymph-title">save-into</span>,jo-area
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">more,rule-set,make-jojo</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-syntax-key-word">jo</span> base#wild-integer-string?
  <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,base#wild-integer-string,make-jojo
  <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> add-rule
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-title">more</span>,rule-set,make-jojo

<span class="cicada-nymph-number">1024</span> <span class="cicada-nymph-variable">*jo-size*</span> mul
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*size,rule-set,basic-REPL*</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-comment">&lt;&lt; for cursor &gt;&gt;</span>
<span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-allocate">allocate-memory</span> drop

<span class="cicada-nymph-variable">*size,rule-set,basic-REPL*</span>
<span class="cicada-nymph-allocate">allocate-memory</span>
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-variable">*rule-set,basic-REPL*</span>
<span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> <span class="cicada-nymph-variable">*jo-size*</span> sub
save

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">execute-word</span>
  <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- unknown &gt;&gt;</span>
  dup2
  <span class="cicada-nymph-title">find-jo</span>,through-jo-link <span class="cicada-nymph-syntax-key-word">if</span>
    dup exception-jo? <span class="cicada-nymph-syntax-key-word">if</span>
      drop
      <span class="cicada-nymph-string">"* (execute-word) can not execute exception directly : "</span> .s
      .s .l
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-syntax-key-word">then</span>
    <span class="cicada-nymph-comment">&lt;&lt; function &amp; primitive-function &amp; variable &gt;&gt;</span>
    xx|swap|x drop2
    execute-jo
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">else</span>
  <span class="cicada-nymph-string">"* (execute-word) meets undefined word : "</span> .s
  .s .l
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">word:bye?</span>
  <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- bool &gt;&gt;</span>
  <span class="cicada-nymph-string">"bye"</span> string-equal?
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-exception">!bye,basic-REPL</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-syntax-key-word">exception-reset-stack</span>
  drop-syntax-stack
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-exception">define-exception</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,bye,basic-REPL</span>
  <span class="cicada-nymph-comment">&lt;&lt; word:bye -- &gt;&gt;</span>
  drop2
  <span class="cicada-nymph-exception">!bye,basic-REPL</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">basic-REPL,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; unknown -- unknown &gt;&gt;</span>
  read-word-for-REPL
  dup2 find-syntax <span class="cicada-nymph-syntax-key-word">if</span>
    execute-jo
  <span class="cicada-nymph-syntax-key-word">else</span>
    execute-word
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">basic-REPL</span>,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">basic-REPL</span>
  <span class="cicada-nymph-comment">&lt;&lt; unknown -- unknown &gt;&gt;</span>
  prepare-for
    <span class="cicada-nymph-exception">!bye,basic-REPL</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> push-syntax-stack
  <span class="cicada-nymph-title">basic-REPL</span>,loop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

basic-REPL

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">word:jo?</span>
  <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- bool &gt;&gt;</span>
  <span class="cicada-nymph-string">"jo"</span> string-equal?
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,jo,basic-REPL</span>
  <span class="cicada-nymph-comment">&lt;&lt; word:jo -- &gt;&gt;</span>
  drop2
  read-word-for-REPL
  <span class="cicada-nymph-save-local-variable-2">&gt;::word</span>
  <span class="cicada-nymph-comment">&lt;&lt; ::word find-jo if &gt;&gt;</span>
  <span class="cicada-nymph-fetch-local-variable-2">::word</span> <span class="cicada-nymph-title">find-jo</span>,through-jo-link <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-string">"* (syntax,jo,basic-REPL) meet undefined word after jo : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::word</span> .s .l
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">init,rule-set,basic-REPL</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-syntax-key-word">jo</span> integer-string? <span class="cicada-nymph-syntax-key-word">jo</span> string-&gt;integer       <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule
  <span class="cicada-nymph-syntax-key-word">jo</span> word:bye?       <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,bye,basic-REPL <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule
  <span class="cicada-nymph-syntax-key-word">jo</span> word:jo?        <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,jo,basic-REPL  <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule
  <span class="cicada-nymph-syntax-key-word">jo</span> base#wild-integer-string? <span class="cicada-nymph-syntax-key-word">jo</span> base#wild-integer-string-&gt;integer <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-title">init</span>,rule-set,basic-REPL

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,if,basic-REPL,meet-true,else</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  read-word-for-REPL
  <span class="cicada-nymph-string">"then"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">syntax</span>,if,basic-REPL,meet-true,else
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,if,basic-REPL,meet-true</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  read-word-for-REPL
  dup2 <span class="cicada-nymph-string">"then"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup2 <span class="cicada-nymph-string">"else"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2
    <span class="cicada-nymph-title">syntax</span>,if,basic-REPL,meet-true,else
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup2 find-syntax <span class="cicada-nymph-syntax-key-word">if</span>
    execute-jo
  <span class="cicada-nymph-syntax-key-word">else</span>
    execute-word
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">syntax</span>,if,basic-REPL,meet-true
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,if,basic-REPL,meet-false,else</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  read-word-for-REPL
  dup2 <span class="cicada-nymph-string">"then"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup2 find-syntax <span class="cicada-nymph-syntax-key-word">if</span>
    execute-jo
  <span class="cicada-nymph-syntax-key-word">else</span>
    execute-word
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">syntax</span>,if,basic-REPL,meet-false,else
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,if,basic-REPL,meet-false</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  read-word-for-REPL
  dup2 <span class="cicada-nymph-string">"then"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup2 <span class="cicada-nymph-string">"else"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2
    <span class="cicada-nymph-title">syntax</span>,if,basic-REPL,meet-false,else
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  drop2
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">syntax</span>,if,basic-REPL,meet-false
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,if,basic-REPL</span>
  <span class="cicada-nymph-comment">&lt;&lt; bool, word:if -- &gt;&gt;</span>
  drop2 <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-title">syntax</span>,if,basic-REPL,meet-true
  <span class="cicada-nymph-syntax-key-word">else</span>
    <span class="cicada-nymph-title">syntax</span>,if,basic-REPL,meet-false
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-syntax-key-word">jo</span> word:if? <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,if,basic-REPL <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule

<span class="cicada-nymph-number">1024</span> <span class="cicada-nymph-number">1024</span> mul
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*circular-string-area,size*</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>


<span class="cicada-nymph-variable">*circular-string-area,size*</span> <span class="cicada-nymph-allocate">allocate-memory</span>
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*circular-string-area*</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-variable">*circular-string-area*</span>
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*current-free-address,circular-string-area*</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">save-into,circular-string-area</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- &gt;&gt;</span>
  dup <span class="cicada-nymph-variable">*current-free-address,circular-string-area*</span> add
  <span class="cicada-nymph-variable">*circular-string-area,size*</span> <span class="cicada-nymph-variable">*circular-string-area*</span> add
  greater-or-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-variable">*circular-string-area*</span>
    <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*current-free-address,circular-string-area*</span>
    save
  <span class="cicada-nymph-syntax-key-word">then</span>
  tuck
  <span class="cicada-nymph-variable">*current-free-address,circular-string-area*</span>
  string-&gt;buffer!
  <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*current-free-address,circular-string-area*</span>
  add-save
  <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-variable">*current-free-address,circular-string-area*</span>
  save-byte
  <span class="cicada-nymph-number">1</span> <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*current-free-address,circular-string-area*</span>
  add-save
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,double-quote,basic-REPL,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; cursor -- cursor &gt;&gt;</span>
  read-byte
  dup <span class="cicada-nymph-number">34</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
    drop
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  over save-byte
  add1
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">syntax</span>,double-quote,basic-REPL,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,double-quote,basic-REPL</span>
  <span class="cicada-nymph-comment">&lt;&lt; word:double-quote -- string[address, length] &gt;&gt;</span>
  drop2
  <span class="cicada-nymph-number">1024</span> <span class="cicada-nymph-number">2</span> mul <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
  <span class="cicada-nymph-title">syntax</span>,double-quote,basic-REPL,loop
  <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
  <span class="cicada-nymph-variable">*current-free-address,circular-string-area*</span> <span class="cicada-nymph-save-local-variable-1">&gt;:address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> sub dup <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
  <span class="cicada-nymph-title">save-into</span>,circular-string-area
  <span class="cicada-nymph-fetch-local-variable-1">:address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:length</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-syntax-key-word">jo</span> word:double-quote? <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,double-quote,basic-REPL <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule

<span class="cicada-nymph-number">0</span>
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*syntax,address,basic-REPL,stack-balancer*</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,address,basic-REPL</span>
  <span class="cicada-nymph-comment">&lt;&lt; word:address -- address &gt;&gt;</span>
  drop2
  read-word-for-REPL
  <span class="cicada-nymph-save-local-variable-2">&gt;::word</span>
  <span class="cicada-nymph-comment">&lt;&lt; ::word find-jo if &gt;&gt;</span>
  <span class="cicada-nymph-fetch-local-variable-2">::word</span> <span class="cicada-nymph-title">find-jo</span>,through-jo-link <span class="cicada-nymph-syntax-key-word">if</span>
  <span class="cicada-nymph-syntax-key-word">else</span>
    <span class="cicada-nymph-string">"* (syntax,address,basic-REPL) meet undefined word : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::word</span> .s .l
    <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*syntax,address,basic-REPL,stack-balancer*</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:jo</span>
  <span class="cicada-nymph-fetch-local-variable-1">:jo</span> variable-jo? <span class="cicada-nymph-syntax-key-word">if</span>
  <span class="cicada-nymph-syntax-key-word">else</span>
    <span class="cicada-nymph-string">"* (syntax,address,basic-REPL) meet a not variable-jo : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::word</span> .s .l
    <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*syntax,address,basic-REPL,stack-balancer*</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:jo</span> <span class="cicada-nymph-variable">*jo-size*</span> add
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-syntax-key-word">jo</span> word:address?
<span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,address,basic-REPL
<span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">print-argument-stack,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; address, counter -- &gt;&gt;</span>
  dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  sub1 swap
    dup fetch .
  <span class="cicada-nymph-variable">*jo-size*</span> add
  swap
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">print-argument-stack</span>,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">print-argument-stack</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  snapshot-the-stack-pointer
  <span class="cicada-nymph-variable">*the-stack-pointer-snapshot*</span>
  <span class="cicada-nymph-variable">*the-stack*</span> greater-or-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-variable">*the-stack*</span>   <span class="cicada-nymph-comment">&lt;&lt; address as return value &gt;&gt;</span>
    <span class="cicada-nymph-variable">*the-stack-pointer-snapshot*</span> <span class="cicada-nymph-variable">*the-stack*</span> sub
    <span class="cicada-nymph-variable">*jo-size*</span> div <span class="cicada-nymph-comment">&lt;&lt; counter as return value &gt;&gt;</span>
    <span class="cicada-nymph-title">print-argument-stack</span>,loop
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-string">"below the stack "</span> .s
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">print-argument-stack,pretty</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  snapshot-the-stack-pointer
  .l
  <span class="cicada-nymph-string">"  * "</span> .s
     <span class="cicada-nymph-variable">*the-stack-pointer-snapshot*</span>
     <span class="cicada-nymph-variable">*the-stack*</span> sub
     <span class="cicada-nymph-comment">&lt;&lt; ad hoc for the BUG of div &gt;&gt;</span>
     dup negative? <span class="cicada-nymph-syntax-key-word">if</span>
       negate
       <span class="cicada-nymph-variable">*jo-size*</span> div
       negate
     <span class="cicada-nymph-syntax-key-word">else</span>
       <span class="cicada-nymph-variable">*jo-size*</span> div
     <span class="cicada-nymph-syntax-key-word">then</span>
     .i
  <span class="cicada-nymph-string">" * "</span> .s
  <span class="cicada-nymph-string">" -- "</span> .s
    print-argument-stack
  <span class="cicada-nymph-string">"--"</span> .s
  .l
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">stack-REPL,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; unknown -- unknown &gt;&gt;</span>
  read-word-for-REPL
  dup2 find-syntax <span class="cicada-nymph-syntax-key-word">if</span>
    execute-jo
  <span class="cicada-nymph-syntax-key-word">else</span>
    execute-word
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-title">print-argument-stack</span>,pretty
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">stack-REPL</span>,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">stack-REPL</span>
  <span class="cicada-nymph-comment">&lt;&lt; unknown -- unknown &gt;&gt;</span>
  prepare-for
    <span class="cicada-nymph-exception">!bye,basic-REPL</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> push-syntax-stack
  <span class="cicada-nymph-title">stack-REPL</span>,loop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-syntax-key-word">jo</span> stack-REPL
<span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*lost-exception-REPL*</span>
save

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">list-rule,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; rule-set, cursor, counter -- &gt;&gt;</span>
  xx|over|x equal? <span class="cicada-nymph-syntax-key-word">if</span>
    drop drop2
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-string">"  * "</span> .s
  <span class="cicada-nymph-string">"("</span> .s
  add1 dup .i
  <span class="cicada-nymph-string">")"</span> .s .l
  swap
    dup cursor-&gt;predicate
    <span class="cicada-nymph-string">"    "</span> .s jo-&gt;name .s .l
    dup cursor-&gt;function
    <span class="cicada-nymph-string">"    "</span> .s jo-&gt;name .s .l
    <span class="cicada-nymph-variable">*jo-size*</span> sub <span class="cicada-nymph-variable">*jo-size*</span> sub
  swap
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">list-rule</span>,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">list-rule</span>
  <span class="cicada-nymph-comment">&lt;&lt; rule-set -- &gt;&gt;</span>
  dup <span class="cicada-nymph-title">rule-set</span>,fetch-border
  <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">list-rule</span>,loop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">sub-rule,move-one</span>
  <span class="cicada-nymph-comment">&lt;&lt; cursor -- &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-number">2</span> n-fetch
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">2</span> mul sub
  <span class="cicada-nymph-number">2</span> n-save
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">sub-rule,move</span>
  <span class="cicada-nymph-comment">&lt;&lt; rule-set, cursor -- &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:rule-set</span>
  <span class="cicada-nymph-fetch-local-variable-1">:rule-set</span> <span class="cicada-nymph-title">rule-set</span>,fetch-border <span class="cicada-nymph-save-local-variable-1">&gt;:border</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:border</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:border</span> <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">2</span> mul sub
    <span class="cicada-nymph-fetch-local-variable-1">:rule-set</span>
    <span class="cicada-nymph-title">rule-set</span>,save-border
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-title">sub-rule</span>,move-one
  <span class="cicada-nymph-fetch-local-variable-1">:rule-set</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">2</span> mul add
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">sub-rule</span>,move
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">sub-rule,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; rule[predicate, function], rule-set, cursor -- &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:rule-set</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::rule</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:rule-set</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-2">::rule</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> cursor-&gt;rule equal2? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:rule-set</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
    <span class="cicada-nymph-title">sub-rule</span>,move
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-2">::rule</span>
  <span class="cicada-nymph-fetch-local-variable-1">:rule-set</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">2</span> mul sub
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">sub-rule</span>,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">sub-rule</span>
  <span class="cicada-nymph-comment">&lt;&lt; rule[predicate, function], rule-set -- &gt;&gt;</span>
  dup <span class="cicada-nymph-title">rule-set</span>,fetch-border
  <span class="cicada-nymph-title">sub-rule</span>,loop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">eval-string,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; unknown -- unknown &gt;&gt;</span>
  tos-reading-stack space-string? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  read-word-for-REPL
  dup2 find-syntax <span class="cicada-nymph-syntax-key-word">if</span>
    execute-jo
  <span class="cicada-nymph-syntax-key-word">else</span>
    execute-word
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">eval-string</span>,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">eval-string</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- unknown &gt;&gt;</span>
  push-reading-stack
  <span class="cicada-nymph-title">eval-string</span>,loop
  drop-reading-stack
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,double-quote,define-variable,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; cursor -- cursor &gt;&gt;</span>
  read-byte
  dup <span class="cicada-nymph-number">34</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
    drop
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  over save-byte
  add1
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">syntax</span>,double-quote,define-variable,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,double-quote,define-variable</span>
  <span class="cicada-nymph-comment">&lt;&lt; word:double-quote -- string[address, length] &gt;&gt;</span>
  drop2
  <span class="cicada-nymph-number">1024</span> <span class="cicada-nymph-number">2</span> mul <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
  <span class="cicada-nymph-title">syntax</span>,double-quote,define-variable,loop
  <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
  <span class="cicada-nymph-variable">*current-free-address,name-string-area*</span> add2 <span class="cicada-nymph-save-local-variable-1">&gt;:address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> sub dup <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
  <span class="cicada-nymph-title">save-into</span>,name-string-area
  <span class="cicada-nymph-fetch-local-variable-1">:address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:length</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">define-variable</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>
  <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-head</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::variable-name</span>
  <span class="cicada-nymph-fetch-local-variable-2">::string</span> <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::variable-body</span>

  snapshot-the-stack-pointer
  <span class="cicada-nymph-variable">*the-stack-pointer-snapshot*</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:old-snapshot</span>
  <span class="cicada-nymph-syntax-key-word">jo</span> word:double-quote? <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,double-quote,define-variable <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule
  <span class="cicada-nymph-fetch-local-variable-2">::variable-body</span> eval-string
  <span class="cicada-nymph-syntax-key-word">jo</span> word:double-quote? <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,double-quote,define-variable <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> sub-rule

  snapshot-the-stack-pointer
  <span class="cicada-nymph-variable">*the-stack-pointer-snapshot*</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:new-snapshot</span>

  <span class="cicada-nymph-fetch-local-variable-1">:new-snapshot</span> <span class="cicada-nymph-fetch-local-variable-1">:old-snapshot</span> sub

  dup negative? <span class="cicada-nymph-syntax-key-word">if</span>
    negate <span class="cicada-nymph-variable">*jo-size*</span> div
    <span class="cicada-nymph-string">"* (define-variable) fail to define variable : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::variable-name</span> .s .l
    <span class="cicada-nymph-string">"  because after eval the following variable-body"</span> .s .l
    <span class="cicada-nymph-string">"  the stack is "</span> .s .i <span class="cicada-nymph-string">" below what it use to be"</span> .s .l
    <span class="cicada-nymph-fetch-local-variable-2">::variable-body</span> .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
    drop
    <span class="cicada-nymph-string">"* (define-variable) fail to define variable : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::variable-name</span> .s .l
    <span class="cicada-nymph-string">"  because after eval the following variable-body"</span> .s .l
    <span class="cicada-nymph-string">"  the stack is still where it use to be"</span> .s .l
    <span class="cicada-nymph-fetch-local-variable-2">::variable-body</span> .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>

  <span class="cicada-nymph-variable">*jo-size*</span> div <span class="cicada-nymph-save-local-variable-1">&gt;:variable-length</span>

  <span class="cicada-nymph-fetch-local-variable-1">:variable-length</span>
    <span class="cicada-nymph-title">save-into</span>,jo-area

  <span class="cicada-nymph-variable">*current-free-address,name-string-area*</span>
    <span class="cicada-nymph-title">save-into</span>,jo-area
  <span class="cicada-nymph-fetch-local-variable-2">::variable-name</span>
    <span class="cicada-nymph-title">save-into</span>,name-string-area

  <span class="cicada-nymph-variable">*first-jo-in-jotionary*</span>
  jo-&gt;link
    <span class="cicada-nymph-title">save-into</span>,jo-area

  <span class="cicada-nymph-variable">*current-free-address,jo-area*</span>
  dup <span class="cicada-nymph-title">jo</span>,save-into,name-hash-table
  <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*first-jo-in-jotionary*</span> save

  <span class="cicada-nymph-variable">*explainer,variable*</span>
    <span class="cicada-nymph-title">save-into</span>,jo-area

  <span class="cicada-nymph-variable">*current-free-address,jo-area*</span>
  <span class="cicada-nymph-fetch-local-variable-1">:variable-length</span>
  n-save

  <span class="cicada-nymph-fetch-local-variable-1">:variable-length</span> <span class="cicada-nymph-variable">*jo-size*</span> mul
  <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*current-free-address,jo-area*</span>
  add-save

  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">4</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
  <span class="cicada-nymph-number">5</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,open:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">6</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,close:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">3</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,read:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">4</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,write:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">9</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,link:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">10</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,unlink:</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">39</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,mkdir:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">40</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,rmdir:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">141</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,getdents:</span>   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">220</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,getdents64:</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">106</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,stat:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">1</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,exit:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">43</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,times:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">20</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,getpid:</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">183</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,getcwd:</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">12</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,chdir:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-syntax-key-word">then</span>

<span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">8</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
  <span class="cicada-nymph-number">2</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,open:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">3</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,close:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">0</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,read:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">1</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,write:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">86</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,link:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">87</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,unlink:</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">83</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,mkdir:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">84</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,rmdir:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">78</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,getdents:</span>   <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">217</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,getdents64:</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">4</span>   <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,stat:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">60</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,exit:</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">100</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,times:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">39</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,getpid:</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">79</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,getcwd:</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
  <span class="cicada-nymph-number">80</span>  <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">:syscall-number,chdir:</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-syntax-key-word">then</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">error-code-&gt;string</span>
  <span class="cicada-nymph-comment">&lt;&lt; error-code -- string[address, length] &gt;&gt;</span>
  dup <span class="cicada-nymph-number">-1</span>  equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EPERM   &gt;&gt;</span>   <span class="cicada-nymph-string">"Operation not permitted "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-2</span>  equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENOENT  &gt;&gt;</span>   <span class="cicada-nymph-string">"No such file or directory "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-3</span>  equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ESRCH   &gt;&gt;</span>   <span class="cicada-nymph-string">"No such process "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-4</span>  equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EINTR   &gt;&gt;</span>   <span class="cicada-nymph-string">"Interrupted system call "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-5</span>  equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EIO     &gt;&gt;</span>   <span class="cicada-nymph-string">"I/O error "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-6</span>  equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENXIO   &gt;&gt;</span>   <span class="cicada-nymph-string">"No such device or address "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-7</span>  equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; E2BIG   &gt;&gt;</span>   <span class="cicada-nymph-string">"Argument list too long "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-8</span>  equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENOEXEC &gt;&gt;</span>   <span class="cicada-nymph-string">"Exec format error "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-9</span>  equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EBADF   &gt;&gt;</span>   <span class="cicada-nymph-string">"Bad file number "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-10</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ECHILD  &gt;&gt;</span>   <span class="cicada-nymph-string">"No child processes "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-11</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EAGAIN  &gt;&gt;</span>   <span class="cicada-nymph-string">"Try again "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-12</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENOMEM  &gt;&gt;</span>   <span class="cicada-nymph-string">"Out of memory "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-13</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EACCES  &gt;&gt;</span>   <span class="cicada-nymph-string">"Permission denied "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-14</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EFAULT  &gt;&gt;</span>   <span class="cicada-nymph-string">"Bad address "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-15</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENOTBLK &gt;&gt;</span>   <span class="cicada-nymph-string">"Block device required "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-16</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EBUSY   &gt;&gt;</span>   <span class="cicada-nymph-string">"Device or resource busy "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-17</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EEXIST  &gt;&gt;</span>   <span class="cicada-nymph-string">"File exists "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-18</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EXDEV   &gt;&gt;</span>   <span class="cicada-nymph-string">"Cross-device link "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-19</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENODEV  &gt;&gt;</span>   <span class="cicada-nymph-string">"No such device "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-20</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENOTDIR &gt;&gt;</span>   <span class="cicada-nymph-string">"Not a directory "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-21</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EISDIR  &gt;&gt;</span>   <span class="cicada-nymph-string">"Is a directory "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-22</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EINVAL  &gt;&gt;</span>   <span class="cicada-nymph-string">"Invalid argument "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-23</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENFILE  &gt;&gt;</span>   <span class="cicada-nymph-string">"File table overflow "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-24</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EMFILE  &gt;&gt;</span>   <span class="cicada-nymph-string">"Too many open files "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-25</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENOTTY  &gt;&gt;</span>   <span class="cicada-nymph-string">"Not a typewriter "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-26</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ETXTBSY &gt;&gt;</span>   <span class="cicada-nymph-string">"Text file busy "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-27</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EFBIG   &gt;&gt;</span>   <span class="cicada-nymph-string">"File too large "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-28</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ENOSPC  &gt;&gt;</span>   <span class="cicada-nymph-string">"No space left on device "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-29</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ESPIPE  &gt;&gt;</span>   <span class="cicada-nymph-string">"Illegal seek "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-30</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EROFS   &gt;&gt;</span>   <span class="cicada-nymph-string">"Read-only file system "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-31</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EMLINK  &gt;&gt;</span>   <span class="cicada-nymph-string">"Too many links "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-32</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EPIPE   &gt;&gt;</span>   <span class="cicada-nymph-string">"Broken pipe "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-33</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; EDOM    &gt;&gt;</span>   <span class="cicada-nymph-string">"Math argument out of domain of func "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">-34</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop  <span class="cicada-nymph-comment">&lt;&lt; ERANGE  &gt;&gt;</span>   <span class="cicada-nymph-string">"Math result not representable "</span> <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-string">"unknow error-code : "</span> .s .i .l
  <span class="cicada-nymph-string">"* (error-code-&gt;string) fail"</span> <span class="cicada-nymph-comment">&lt;&lt; to balance the argument-stack &gt;&gt;</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">file-type-code-&gt;string</span>
  <span class="cicada-nymph-comment">&lt;&lt; file-type-code -- string[address, length] &gt;&gt;</span>
  dup <span class="cicada-nymph-number">1</span>  equal?  <span class="cicada-nymph-comment">&lt;&lt; DT_FIFO  &gt;&gt;</span>  <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"named pipe i.e. FIFO"</span>  <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">2</span>  equal?  <span class="cicada-nymph-comment">&lt;&lt; DT_CHR   &gt;&gt;</span>  <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"character device"</span>      <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">4</span>  equal?  <span class="cicada-nymph-comment">&lt;&lt; DT_DIR   &gt;&gt;</span>  <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"directory"</span>             <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">6</span>  equal?  <span class="cicada-nymph-comment">&lt;&lt; DT_BLK   &gt;&gt;</span>  <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"block device"</span>          <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">8</span>  equal?  <span class="cicada-nymph-comment">&lt;&lt; DT_REG   &gt;&gt;</span>  <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"regular file"</span>          <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">10</span> equal?  <span class="cicada-nymph-comment">&lt;&lt; DT_LNK   &gt;&gt;</span>  <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"symbolic link"</span>         <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">12</span> equal?  <span class="cicada-nymph-comment">&lt;&lt; DT_SOCK  &gt;&gt;</span>  <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"UNIX domain socket"</span>    <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  drop
  <span class="cicada-nymph-string">"unknow file type"</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">jotionary,list-by-jo-predicate,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; jo-predicate, counter, jo -- total &gt;&gt;</span>
  dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
    drop
    swap drop
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup x|over|xxx execute-jo false? <span class="cicada-nymph-syntax-key-word">if</span>
    jo-&gt;pre-jo
    <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">jotionary</span>,list-by-jo-predicate,loop
  <span class="cicada-nymph-syntax-key-word">then</span>
  swap
    <span class="cicada-nymph-string">"  "</span> .s
    add1 dup .i <span class="cicada-nymph-string">". "</span> .s
  swap
  dup jo-&gt;name
  dup2 space-string? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2
    <span class="cicada-nymph-string">"  unnamed"</span> .s .l
  <span class="cicada-nymph-syntax-key-word">else</span>
    .s .l
  <span class="cicada-nymph-syntax-key-word">then</span>
  jo-&gt;pre-jo
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">jotionary</span>,list-by-jo-predicate,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">jotionary,list-by-jo-predicate</span>
  <span class="cicada-nymph-comment">&lt;&lt; jo-predicate -- total &gt;&gt;</span>
  <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-variable">*first-jo-in-jotionary*</span>
  <span class="cicada-nymph-title">jotionary</span>,list-by-jo-predicate,loop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">jotionary,report</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-string">"* all primitive-function in jotionary :"</span> .s .l
  <span class="cicada-nymph-syntax-key-word">jo</span> primitive-function-jo?
  <span class="cicada-nymph-title">jotionary</span>,list-by-jo-predicate
  <span class="cicada-nymph-string">"* all function in jotionary :"</span> .s .l
  <span class="cicada-nymph-syntax-key-word">jo</span> function-jo?
  <span class="cicada-nymph-title">jotionary</span>,list-by-jo-predicate add
  <span class="cicada-nymph-string">"* all exception in jotionary :"</span> .s .l
  <span class="cicada-nymph-syntax-key-word">jo</span> exception-jo?
  <span class="cicada-nymph-title">jotionary</span>,list-by-jo-predicate add
  <span class="cicada-nymph-string">"* all variable in jotionary :"</span> .s .l
  <span class="cicada-nymph-syntax-key-word">jo</span> variable-jo?
  <span class="cicada-nymph-title">jotionary</span>,list-by-jo-predicate add
  <span class="cicada-nymph-string">"* totally : "</span> .s
  .i .l
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">n-string-&gt;buffer!,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; string-1[address, length],
     ...
     string-2[address, length],
     buffer, n, cursor
     -- length &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:n</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
  <span class="cicada-nymph-fetch-local-variable-1">:n</span> zero? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
    <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> sub
    string-reverse!
    swap drop
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2
    <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
    <span class="cicada-nymph-fetch-local-variable-1">:n</span> sub1
    <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
    <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">n-string-&gt;buffer!</span>,loop
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup2 add sub1 fetch-byte <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> save-byte
  sub1
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
  <span class="cicada-nymph-fetch-local-variable-1">:n</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add1
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">n-string-&gt;buffer!</span>,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">n-string-&gt;buffer!</span>
  <span class="cicada-nymph-comment">&lt;&lt; string-1[address, length],
     ...
     string-2[address, length],
     buffer, n
     -- length &gt;&gt;</span>
  over <span class="cicada-nymph-title">n-string-&gt;buffer!</span>,loop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">input-port,open</span>
  <span class="cicada-nymph-comment">&lt;&lt; path[address, length]
     -- port, true
     -- error-code, false &gt;&gt;</span>
  string-&gt;syscall-string
  <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
  <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-comment">&lt;&lt;
  O_RDONLY
  &gt;&gt;</span>
  <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
  <span class="cicada-nymph-constant">:syscall-number,open:</span>
  <span class="cicada-nymph-number">2</span> syscall
  dup
  negative? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-bool">true</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">output-port,creat</span>
  <span class="cicada-nymph-comment">&lt;&lt; path[address, length]
     -- port, true
     -- error-code, false &gt;&gt;</span>
  string-&gt;syscall-string
  <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
  <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">644</span> <span class="cicada-nymph-comment">&lt;&lt;
  2#110100100
  &gt;&gt;</span>
  <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1102</span> <span class="cicada-nymph-comment">&lt;&lt;
  O_RDWR   0002
  O_CREAT  0100
  O_TRUNC  1000
  &gt;&gt;</span>
  <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
  <span class="cicada-nymph-constant">:syscall-number,open:</span>
  <span class="cicada-nymph-number">3</span> syscall
  dup
  negative? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-bool">true</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">output-port,update</span>
  <span class="cicada-nymph-comment">&lt;&lt; path[address, length]
     -- port, true
     -- error-code, false &gt;&gt;</span>
  string-&gt;syscall-string
  <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
  <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">644</span> <span class="cicada-nymph-comment">&lt;&lt;
  110100100b
  &gt;&gt;</span>
  <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1002</span> <span class="cicada-nymph-comment">&lt;&lt;
  O_RDWR   0002
  O_TRUNC  1000
  &gt;&gt;</span>
  <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
  <span class="cicada-nymph-constant">:syscall-number,open:</span>
  <span class="cicada-nymph-number">3</span> syscall
  dup
  negative? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-bool">true</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">port,close</span>
  <span class="cicada-nymph-comment">&lt;&lt; port
     -- true
     -- error-code, false &gt;&gt;</span>
  <span class="cicada-nymph-constant">:syscall-number,close:</span>
  <span class="cicada-nymph-number">1</span> syscall
  dup
  negative? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  drop <span class="cicada-nymph-bool">true</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">port,read</span>
  <span class="cicada-nymph-comment">&lt;&lt; buffer, max-size, port
     -- counter, true
     -- error-code, false &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>
  swap
  <span class="cicada-nymph-fetch-local-variable-1">:port</span>
  <span class="cicada-nymph-constant">:syscall-number,read:</span>
  <span class="cicada-nymph-number">3</span> syscall
  dup
  negative? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-bool">true</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">port,write</span>
  <span class="cicada-nymph-comment">&lt;&lt; buffer, max-size, port
     -- counter, true
     -- error-code, false &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>
  swap
  <span class="cicada-nymph-fetch-local-variable-1">:port</span>
  <span class="cicada-nymph-constant">:syscall-number,write:</span>
  <span class="cicada-nymph-number">3</span> syscall
  dup
  negative? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-bool">true</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">file,creat</span>
  <span class="cicada-nymph-comment">&lt;&lt; path[address, length] -- &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::path</span>
  <span class="cicada-nymph-fetch-local-variable-2">::path</span>
  string-&gt;syscall-string
  <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
  <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">644</span> <span class="cicada-nymph-comment">&lt;&lt;
  2#110100100
  &gt;&gt;</span>
  <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0200</span>
  <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0100</span> bit-or <span class="cicada-nymph-comment">&lt;&lt;
  O_EXCL   0200
  O_CREAT  0100
  &gt;&gt;</span>
  <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
  <span class="cicada-nymph-constant">:syscall-number,open:</span>
  <span class="cicada-nymph-number">3</span> syscall
  dup
  negative? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"* (file,creat) fail to open port for the following path :"</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-title">port</span>,close <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-string">"* (file,creat) fail to close port for the following path :"</span> .s .l
  <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
  <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">file,write</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length], path[address, length] -- &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::path</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>
  <span class="cicada-nymph-fetch-local-variable-2">::path</span>
  string-&gt;syscall-string
  <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
  <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">644</span> <span class="cicada-nymph-comment">&lt;&lt;
  2#110100100
  &gt;&gt;</span>
  <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">1002</span> <span class="cicada-nymph-comment">&lt;&lt;
  O_RDWR   0002
  O_TRUNC  1000
  &gt;&gt;</span>
  <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
  <span class="cicada-nymph-constant">:syscall-number,open:</span>
  <span class="cicada-nymph-number">3</span> syscall
  dup
  negative? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"* (file,write) fail to open port for the following path :"</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>
  <span class="cicada-nymph-fetch-local-variable-2">::string</span> swap
  <span class="cicada-nymph-fetch-local-variable-1">:port</span>
  <span class="cicada-nymph-constant">:syscall-number,write:</span>
  <span class="cicada-nymph-number">3</span> syscall
  dup
  negative? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"* (file,write) fail to write port for the following path :"</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:counter</span> <span class="cicada-nymph-comment">&lt;&lt; bytes been written &gt;&gt;</span>
  <span class="cicada-nymph-fetch-local-variable-1">:port</span>
  <span class="cicada-nymph-title">port</span>,close <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-string">"* (file,write) fail to close port for the following path : "</span> .s .l
  <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
  <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">file,read</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, max-length], path[address, length] -- counter &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::path</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::string</span>
  <span class="cicada-nymph-fetch-local-variable-2">::path</span>
  string-&gt;syscall-string
  <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
  <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-comment">&lt;&lt;
  O_RDONLY
  &gt;&gt;</span>
  <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
  <span class="cicada-nymph-constant">:syscall-number,open:</span>
  <span class="cicada-nymph-number">2</span> syscall
  dup
  negative? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"* (file,read) fail to open port for the following path :"</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
    <span class="cicada-nymph-number">0</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>
  <span class="cicada-nymph-fetch-local-variable-2">::string</span> swap
  <span class="cicada-nymph-fetch-local-variable-1">:port</span>
  <span class="cicada-nymph-constant">:syscall-number,read:</span>
  <span class="cicada-nymph-number">3</span> syscall
  dup
  negative? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"* (file,read) fail to read port for the following path :"</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
    <span class="cicada-nymph-number">0</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:counter</span> <span class="cicada-nymph-comment">&lt;&lt; bytes been readed &gt;&gt;</span>
  <span class="cicada-nymph-fetch-local-variable-1">:port</span>
  <span class="cicada-nymph-title">port</span>,close <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:counter</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-string">"* (file,read) fail to close port for the following path : "</span> .s .l
  <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
  <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
  <span class="cicada-nymph-number">0</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">file,remove</span>
  <span class="cicada-nymph-comment">&lt;&lt; path[address, length] -- &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::path</span>
  <span class="cicada-nymph-fetch-local-variable-2">::path</span>
  string-&gt;syscall-string
  <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
  <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
  <span class="cicada-nymph-constant">:syscall-number,unlink:</span>
  <span class="cicada-nymph-number">1</span> syscall
  dup
  negative? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"* (file,remove) fail for the following path :"</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  drop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">directory,creat</span>
  <span class="cicada-nymph-comment">&lt;&lt; path[address, length] -- &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::path</span>
  <span class="cicada-nymph-fetch-local-variable-2">::path</span>
  string-&gt;syscall-string
  <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
  <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">755</span> <span class="cicada-nymph-comment">&lt;&lt;
  2#111101101
  &gt;&gt;</span>
  <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
  <span class="cicada-nymph-constant">:syscall-number,mkdir:</span>
  <span class="cicada-nymph-number">2</span> syscall
  dup
  negative? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"* (directory,creat) fail for the following path :"</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  drop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">directory,remove</span>
  <span class="cicada-nymph-comment">&lt;&lt; path[address, length] -- &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::path</span>
  <span class="cicada-nymph-fetch-local-variable-2">::path</span>
  string-&gt;syscall-string
  <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
  <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
  <span class="cicada-nymph-constant">:syscall-number,rmdir:</span>
  <span class="cicada-nymph-number">1</span> syscall
  dup
  negative? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"* (directory,remove) fail for the following path :"</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  drop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+getdents64,d_ino+</span>        <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+getdents64,d_off+</span>        <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+getdents64,d_reclen+</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+getdents64,d_type+</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+getdents64,d_name+</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+getdents64,end+</span>          <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">init,getdents64</span>
  <span class="cicada-nymph-comment">&lt;&lt; offset -- &gt;&gt;</span>
  <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">4</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_ino+</span>       save <span class="cicada-nymph-number">8</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_off+</span>       save <span class="cicada-nymph-number">8</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_reclen+</span>    save <span class="cicada-nymph-number">2</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_type+</span>      save <span class="cicada-nymph-number">1</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_name+</span>      save <span class="cicada-nymph-number">256</span> add
        <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,end+</span>           save
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">8</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_ino+</span>       save <span class="cicada-nymph-number">8</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_off+</span>       save <span class="cicada-nymph-number">8</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_reclen+</span>    save <span class="cicada-nymph-number">2</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_type+</span>      save <span class="cicada-nymph-number">1</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,d_name+</span>      save <span class="cicada-nymph-number">256</span> add
        <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+getdents64,end+</span>           save
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">init</span>,getdents64
<span class="cicada-nymph-constant">+getdents64,end+</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+getdents64,length+</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">empty-directory?</span>
  <span class="cicada-nymph-comment">&lt;&lt; path[address, length] -- bool &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::path</span>
  <span class="cicada-nymph-fetch-local-variable-2">::path</span> <span class="cicada-nymph-title">input-port</span>,open <span class="cicada-nymph-syntax-key-word">if</span>
  <span class="cicada-nymph-syntax-key-word">else</span>
    <span class="cicada-nymph-string">"* (empty-directory?) fail to open : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
    <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>
  <span class="cicada-nymph-number">128</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:getdents64-structure-list</span>
  <span class="cicada-nymph-number">128</span>
  <span class="cicada-nymph-fetch-local-variable-1">:getdents64-structure-list</span>
  <span class="cicada-nymph-fetch-local-variable-1">:port</span>
  <span class="cicada-nymph-constant">:syscall-number,getdents64:</span>
  <span class="cicada-nymph-number">3</span> syscall
  <span class="cicada-nymph-number">48</span> equal? <span class="cicada-nymph-comment">&lt;&lt; this call to equal? returns the needed bool &gt;&gt;</span>
  <span class="cicada-nymph-fetch-local-variable-1">:port</span> <span class="cicada-nymph-title">port</span>,close <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-string">"* (empty-directory?) fail to close : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
  <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
  <span class="cicada-nymph-bool">false</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">directory,map,loop,execute</span>
  <span class="cicada-nymph-comment">&lt;&lt; end, cursor, function -- &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:function</span>
  dup2 less-or-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:end</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-title">init</span>,getdents64
  <span class="cicada-nymph-fetch-local-variable-1">:function</span> execute-jo
  <span class="cicada-nymph-fetch-local-variable-1">:end</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-constant">+getdents64,d_reclen+</span> fetch-two-bytes add
  <span class="cicada-nymph-fetch-local-variable-1">:function</span>
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">directory</span>,map,loop,execute
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">directory,map,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; port, function -- &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:function</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>
  <span class="cicada-nymph-number">1024</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:getdents64-structure-list</span>
  <span class="cicada-nymph-number">1024</span>
  <span class="cicada-nymph-fetch-local-variable-1">:getdents64-structure-list</span>
  <span class="cicada-nymph-fetch-local-variable-1">:port</span>
  <span class="cicada-nymph-constant">:syscall-number,getdents64:</span>
  <span class="cicada-nymph-number">3</span> syscall
  dup negative? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"* (directory,map,loop) syscall fail"</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
    drop
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:getdents64-structure-list</span> add
  <span class="cicada-nymph-fetch-local-variable-1">:getdents64-structure-list</span>
  <span class="cicada-nymph-fetch-local-variable-1">:function</span>
  <span class="cicada-nymph-title">directory</span>,map,loop,execute
  <span class="cicada-nymph-fetch-local-variable-1">:port</span>
  <span class="cicada-nymph-fetch-local-variable-1">:function</span>
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">directory</span>,map,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">directory,map</span>
  <span class="cicada-nymph-comment">&lt;&lt; directory-path[address, length],
     function
     -- true
     -- false &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:function</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::directory-path</span>
  <span class="cicada-nymph-fetch-local-variable-2">::directory-path</span> <span class="cicada-nymph-title">input-port</span>,open <span class="cicada-nymph-syntax-key-word">if</span>
  <span class="cicada-nymph-syntax-key-word">else</span>
    <span class="cicada-nymph-string">"* (directory,map) fail to open : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::directory-path</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>
  <span class="cicada-nymph-fetch-local-variable-1">:port</span> <span class="cicada-nymph-fetch-local-variable-1">:function</span> <span class="cicada-nymph-title">directory</span>,map,loop
  <span class="cicada-nymph-fetch-local-variable-1">:port</span> <span class="cicada-nymph-title">port</span>,close <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-string">"* (directory,map) fail to close : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::directory-path</span> .s .l
  <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">directory,list-file,lister</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-constant">+getdents64,d_type+</span> fetch-byte
  <span class="cicada-nymph-number">8</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"  "</span> .s
    <span class="cicada-nymph-constant">+getdents64,d_name+</span>
    dup <span class="cicada-nymph-number">256</span>
    <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">string</span>,find-char
    drop  <span class="cicada-nymph-comment">&lt;&lt; drop 0 &gt;&gt;</span>
    over sub .s .l
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">directory,list-file</span>
  <span class="cicada-nymph-comment">&lt;&lt; directory-path[address, length] -- &gt;&gt;</span>
  <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">directory</span>,list-file,lister
  <span class="cicada-nymph-title">directory</span>,map
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">directory,list-directory,lister</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-constant">+getdents64,d_type+</span> fetch-byte
  <span class="cicada-nymph-number">4</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-constant">+getdents64,d_name+</span>
    dup <span class="cicada-nymph-number">256</span>
    <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">string</span>,find-char
    drop  <span class="cicada-nymph-comment">&lt;&lt; drop 0 &gt;&gt;</span>
    over sub <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>
    <span class="cicada-nymph-string">".."</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-syntax-key-word">then</span>
    <span class="cicada-nymph-string">"."</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-syntax-key-word">then</span>
    <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::name</span> .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">directory,list-directory</span>
  <span class="cicada-nymph-comment">&lt;&lt; directory-path[address, length] -- &gt;&gt;</span>
  <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">directory</span>,list-directory,lister
  <span class="cicada-nymph-title">directory</span>,map
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">directory,find-file,finder</span>
  <span class="cicada-nymph-comment">&lt;&lt; file-name[address, length], bool --
     file-name[address, length], bool &gt;&gt;</span>
  <span class="cicada-nymph-constant">+getdents64,d_type+</span> fetch-byte <span class="cicada-nymph-number">8</span> equal? not <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:bool</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:file-name,lenght</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:file-name,address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span> <span class="cicada-nymph-constant">+getdents64,d_name+</span> add
  fetch-byte zero? not <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:file-name,address</span>
    <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
    <span class="cicada-nymph-fetch-local-variable-1">:bool</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:file-name,address</span> <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
  <span class="cicada-nymph-constant">+getdents64,d_name+</span> <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
  string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:file-name,address</span>
    <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
    <span class="cicada-nymph-bool">true</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:file-name,address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
  <span class="cicada-nymph-fetch-local-variable-1">:bool</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">directory,find-file</span>
  <span class="cicada-nymph-comment">&lt;&lt; directory-path[address, length], file-name[address, length] -- bool &gt;&gt;</span>
  xx|swap|xx
  <span class="cicada-nymph-bool">false</span>
  xx|swap|x
  <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">directory</span>,find-file,finder
  <span class="cicada-nymph-title">directory</span>,map
  xx|swap|x drop2
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">directory,find-directory,finder</span>
  <span class="cicada-nymph-comment">&lt;&lt; file-name[address, length], bool --
     file-name[address, length], bool &gt;&gt;</span>
  <span class="cicada-nymph-constant">+getdents64,d_type+</span> fetch-byte <span class="cicada-nymph-number">4</span> equal? not <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:bool</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:file-name,lenght</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:file-name,address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span> <span class="cicada-nymph-constant">+getdents64,d_name+</span> add
  fetch-byte zero? not <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:file-name,address</span>
    <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
    <span class="cicada-nymph-fetch-local-variable-1">:bool</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:file-name,address</span> <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
  <span class="cicada-nymph-constant">+getdents64,d_name+</span> <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
  string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:file-name,address</span>
    <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
    <span class="cicada-nymph-bool">true</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:file-name,address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:file-name,lenght</span>
  <span class="cicada-nymph-fetch-local-variable-1">:bool</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">directory,find-directory</span>
  <span class="cicada-nymph-comment">&lt;&lt; directory-path[address, length], file-name[address, length] -- bool &gt;&gt;</span>
  xx|swap|xx
  <span class="cicada-nymph-bool">false</span>
  xx|swap|x
  <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">directory</span>,find-directory,finder
  <span class="cicada-nymph-title">directory</span>,map
  xx|swap|x drop2
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*pid*</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">init-pid</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-constant">:syscall-number,getpid:</span>
  <span class="cicada-nymph-number">0</span> syscall
  <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*pid*</span> save
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">get-pid</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- pid &gt;&gt;</span>
  <span class="cicada-nymph-variable">*pid*</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-memory</span>
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*address,command-line*</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-number">512</span>
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*length,command-line*</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">init-command-line</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-number">64</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:path-buffer</span>
  <span class="cicada-nymph-fetch-local-variable-1">:path-buffer</span> <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>

  get-pid <span class="cicada-nymph-title">write-number</span>,fill-buffer <span class="cicada-nymph-save-local-variable-2">&gt;::pid-string</span>

  <span class="cicada-nymph-string">"/proc/"</span> dup <span class="cicada-nymph-save-local-variable-1">&gt;:add-to-cursor</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> string-&gt;buffer!
  <span class="cicada-nymph-fetch-local-variable-1">:add-to-cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>

  <span class="cicada-nymph-fetch-local-variable-2">::pid-string</span> dup <span class="cicada-nymph-save-local-variable-1">&gt;:add-to-cursor</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> string-&gt;buffer!
  <span class="cicada-nymph-fetch-local-variable-1">:add-to-cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>

  <span class="cicada-nymph-string">"/cmdline"</span> dup <span class="cicada-nymph-save-local-variable-1">&gt;:add-to-cursor</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> string-&gt;buffer!
  <span class="cicada-nymph-fetch-local-variable-1">:add-to-cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>

  <span class="cicada-nymph-fetch-local-variable-1">:path-buffer</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:path-buffer</span> sub dup2 <span class="cicada-nymph-save-local-variable-2">&gt;::path</span>
  <span class="cicada-nymph-title">input-port</span>,open <span class="cicada-nymph-syntax-key-word">if</span>
  <span class="cicada-nymph-syntax-key-word">else</span>
    <span class="cicada-nymph-string">"* (init-command-line) fail to open : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>

  <span class="cicada-nymph-variable">*address,command-line*</span>
  <span class="cicada-nymph-variable">*length,command-line*</span>
  <span class="cicada-nymph-fetch-local-variable-1">:port</span>
  <span class="cicada-nymph-title">port</span>,read <span class="cicada-nymph-syntax-key-word">if</span>
  <span class="cicada-nymph-syntax-key-word">else</span>
    <span class="cicada-nymph-string">"* (init-command-line) fail to read : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*length,command-line*</span> save
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">get-command-line</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- string[address, length] &gt;&gt;</span>
  <span class="cicada-nymph-variable">*address,command-line*</span> <span class="cicada-nymph-variable">*length,command-line*</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-number">1024</span> <span class="cicada-nymph-number">4</span> mul <span class="cicada-nymph-allocate">allocate-memory</span>
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*address,environment-variable-list*</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-number">1024</span> <span class="cicada-nymph-number">4</span> mul
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*length,environment-variable-list*</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">init-environment-variable-list</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-number">64</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:path-buffer</span>
  <span class="cicada-nymph-fetch-local-variable-1">:path-buffer</span> <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>

  get-pid <span class="cicada-nymph-title">write-number</span>,fill-buffer <span class="cicada-nymph-save-local-variable-2">&gt;::pid-string</span>

  <span class="cicada-nymph-string">"/proc/"</span> dup <span class="cicada-nymph-save-local-variable-1">&gt;:add-to-cursor</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> string-&gt;buffer!
  <span class="cicada-nymph-fetch-local-variable-1">:add-to-cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>

  <span class="cicada-nymph-fetch-local-variable-2">::pid-string</span> dup <span class="cicada-nymph-save-local-variable-1">&gt;:add-to-cursor</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> string-&gt;buffer!
  <span class="cicada-nymph-fetch-local-variable-1">:add-to-cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>

  <span class="cicada-nymph-string">"/environ"</span> dup <span class="cicada-nymph-save-local-variable-1">&gt;:add-to-cursor</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> string-&gt;buffer!
  <span class="cicada-nymph-fetch-local-variable-1">:add-to-cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> add <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>

  <span class="cicada-nymph-fetch-local-variable-1">:path-buffer</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:path-buffer</span> sub dup2 <span class="cicada-nymph-save-local-variable-2">&gt;::path</span>
  <span class="cicada-nymph-title">input-port</span>,open <span class="cicada-nymph-syntax-key-word">if</span>
  <span class="cicada-nymph-syntax-key-word">else</span>
    <span class="cicada-nymph-string">"* (init-environment-variable-list) fail to open : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:port</span>

  <span class="cicada-nymph-variable">*address,environment-variable-list*</span>
  <span class="cicada-nymph-variable">*length,environment-variable-list*</span>
  <span class="cicada-nymph-fetch-local-variable-1">:port</span>
  <span class="cicada-nymph-title">port</span>,read <span class="cicada-nymph-syntax-key-word">if</span>
  <span class="cicada-nymph-syntax-key-word">else</span>
    <span class="cicada-nymph-string">"* (init-environment-variable-list) fail to read : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::path</span> .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-variable">*length,environment-variable-list*</span> save
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">get-environment-variable-list</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- string[address, length] &gt;&gt;</span>
  <span class="cicada-nymph-variable">*address,environment-variable-list*</span>
  <span class="cicada-nymph-variable">*length,environment-variable-list*</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">find-environment-variable,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length], cursor
     -- string[address, length], true
     -- false &gt;&gt;</span>
  dup
  get-environment-variable-list add
  greater-than? <span class="cicada-nymph-syntax-key-word">if</span>
    drop drop2
    <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:address</span> <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
  compare-buffer not <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:address</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
    <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-number">0</span> cursor-&gt;next-matching-byte add1
    <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">find-environment-variable</span>,loop
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span> add fetch-byte
  <span class="cicada-nymph-string">"="</span> <span class="cicada-nymph-title">string-head</span>,char
  equal? not <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:address</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
    <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-number">0</span> cursor-&gt;next-matching-byte add1
    <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">find-environment-variable</span>,loop
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span> add add1 <span class="cicada-nymph-comment">&lt;&lt; over "=" &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:find-address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:find-address</span> <span class="cicada-nymph-number">0</span> cursor-&gt;next-matching-byte
  <span class="cicada-nymph-fetch-local-variable-1">:find-address</span> sub <span class="cicada-nymph-save-local-variable-1">&gt;:find-length</span>
  <span class="cicada-nymph-fetch-local-variable-1">:find-address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:find-length</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">find-environment-variable</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length]
     -- string[address, length], true
     -- false &gt;&gt;</span>
  get-environment-variable-list drop
  <span class="cicada-nymph-title">find-environment-variable</span>,loop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

init-pid
init-command-line
init-environment-variable-list

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*home-directory*</span>
  <span class="cicada-nymph-string">"HOME"</span> find-environment-variable
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">report-environment-variable,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; environment-variable-list[address, length]-- &gt;&gt;</span>
  dup2 space-string? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>

  <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:address</span>

  <span class="cicada-nymph-fetch-local-variable-1">:address</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span> <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">string</span>,find-char drop add1 <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:address</span> sub <span class="cicada-nymph-save-local-variable-1">&gt;:length-of-one-variable</span>

  <span class="cicada-nymph-fetch-local-variable-1">:address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:length-of-one-variable</span> sub1 .s .l

  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
  <span class="cicada-nymph-fetch-local-variable-1">:length</span> <span class="cicada-nymph-fetch-local-variable-1">:length-of-one-variable</span> sub
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">report-environment-variable</span>,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">report-environment-variable</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  get-environment-variable-list
  <span class="cicada-nymph-title">report-environment-variable</span>,loop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">report-command-line,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; command-line[address, length] -- &gt;&gt;</span>
  dup2 space-string? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  dup2 <span class="cicada-nymph-title">string-head</span>,word .s <span class="cicada-nymph-number">32</span> .b
  <span class="cicada-nymph-title">string-tail</span>,word
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">report-command-line</span>,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">report-command-line</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  get-command-line
  <span class="cicada-nymph-title">report-command-line</span>,loop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-memory</span>
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*buffer,work-directory*</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">get-work-directory</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- directory[address, length] &gt;&gt;</span>
  <span class="cicada-nymph-number">512</span>
  <span class="cicada-nymph-variable">*buffer,work-directory*</span>
  <span class="cicada-nymph-constant">:syscall-number,getcwd:</span>
  <span class="cicada-nymph-number">2</span> syscall
  dup negative? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"* (get-work-directory) fail"</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-variable">*buffer,work-directory*</span>
  swap
  sub1 <span class="cicada-nymph-comment">&lt;&lt; for the ending zero &gt;&gt;</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">change-work-directory</span>
  <span class="cicada-nymph-comment">&lt;&lt; directory-path[address, length] -- &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::directory-path</span>
  <span class="cicada-nymph-fetch-local-variable-2">::directory-path</span>
  string-&gt;syscall-string
  <span class="cicada-nymph-constant">:syscall-number,chdir:</span>
  <span class="cicada-nymph-number">1</span> syscall
  dup negative? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"* (change-work-directory) fail"</span> .s .l
    <span class="cicada-nymph-string">"  can not change the work directory into : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::directory-path</span> .s .l
    <span class="cicada-nymph-string">"  "</span> .s error-code-&gt;string .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  drop
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_dev+</span>        <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_ino+</span>        <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_mode+</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_nlink+</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_uid+</span>        <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_gid+</span>        <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_rdev+</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_size+</span>       <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_blksize+</span>    <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_blocks+</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_atime+</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_atime_nsec+</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_mtime+</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_mtime_nsec+</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_ctime+</span>      <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,st_ctime_nsec+</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,__unused4+</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,__unused5+</span>     <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>
<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,end+</span>           <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">init,stat</span>
  <span class="cicada-nymph-comment">&lt;&lt; offset -- &gt;&gt;</span>
  <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">4</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_dev+</span>        save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_ino+</span>        save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_mode+</span>       save <span class="cicada-nymph-number">2</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_nlink+</span>      save <span class="cicada-nymph-number">2</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_uid+</span>        save <span class="cicada-nymph-number">2</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_gid+</span>        save <span class="cicada-nymph-number">2</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_rdev+</span>       save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_size+</span>       save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_blksize+</span>    save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_blocks+</span>     save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_atime+</span>      save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_atime_nsec+</span> save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_mtime+</span>      save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_mtime_nsec+</span> save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_ctime+</span>      save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_ctime_nsec+</span> save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,__unused4+</span>     save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,__unused5+</span>     save <span class="cicada-nymph-variable">*jo-size*</span> add
        <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,end+</span>           save
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">8</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_dev+</span>        save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_ino+</span>        save <span class="cicada-nymph-variable">*jo-size*</span> add
    <span class="cicada-nymph-comment">&lt;&lt;
    note the following order changing
    this is linux' bad
    &gt;&gt;</span>
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_nlink+</span>      save <span class="cicada-nymph-number">8</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_mode+</span>       save <span class="cicada-nymph-number">4</span> add

    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_uid+</span>        save <span class="cicada-nymph-number">4</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_gid+</span>        save <span class="cicada-nymph-number">4</span> add
                                          <span class="cicada-nymph-number">4</span> add <span class="cicada-nymph-comment">&lt;&lt; padding &gt;&gt;</span>
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_rdev+</span>       save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_size+</span>       save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_blksize+</span>    save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_blocks+</span>     save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_atime+</span>      save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_atime_nsec+</span> save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_mtime+</span>      save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_mtime_nsec+</span> save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_ctime+</span>      save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,st_ctime_nsec+</span> save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,__unused4+</span>     save <span class="cicada-nymph-variable">*jo-size*</span> add
    dup <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,__unused5+</span>     save <span class="cicada-nymph-variable">*jo-size*</span> add
        <span class="cicada-nymph-syntax-key-word">address</span> <span class="cicada-nymph-constant">+stat,end+</span>           save
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">init</span>,stat
<span class="cicada-nymph-constant">+stat,end+</span> <span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+stat,length+</span> <span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">path,nothing?</span>
  <span class="cicada-nymph-comment">&lt;&lt; path[address, length] -- bool &gt;&gt;</span>
  string-&gt;syscall-string
  <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
  <span class="cicada-nymph-constant">+stat,length+</span> <span class="cicada-nymph-allocate">allocate-local-memory</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:stat-structure</span>
  <span class="cicada-nymph-fetch-local-variable-1">:stat-structure</span>
  <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
  <span class="cicada-nymph-constant">:syscall-number,stat:</span>
  <span class="cicada-nymph-number">2</span> syscall
  <span class="cicada-nymph-number">-2</span> equal?
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">path,file?</span>
  <span class="cicada-nymph-comment">&lt;&lt; path[address, length] -- bool &gt;&gt;</span>
  string-&gt;syscall-string
  <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
  <span class="cicada-nymph-constant">+stat,length+</span> <span class="cicada-nymph-allocate">allocate-local-memory</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:stat-structure</span>
  <span class="cicada-nymph-fetch-local-variable-1">:stat-structure</span>
  <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
  <span class="cicada-nymph-constant">:syscall-number,stat:</span>
  <span class="cicada-nymph-number">2</span> syscall
  dup
  negative? <span class="cicada-nymph-syntax-key-word">if</span>
    drop
    <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  drop
  <span class="cicada-nymph-fetch-local-variable-1">:stat-structure</span> <span class="cicada-nymph-title">init</span>,stat
  <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">4</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-constant">+stat,st_mode+</span>
    fetch-two-bytes
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">8</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-constant">+stat,st_mode+</span>
    fetch-four-bytes
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-number">12</span> bit-right
  <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0010</span>
  equal?
  <span class="cicada-nymph-comment">&lt;&lt;
  0170000
  S_IFDIR       0040000 /* Directory.  */
  S_IFCHR       0020000 /* Character device.  */
  S_IFBLK       0060000 /* Block device.  */
  S_IFREG       0100000 /* Regular file.  */
  S_IFIFO       0010000 /* FIFO.  */
  S_IFLNK       0120000 /* Symbolic link.  */
  S_IFSOCK      0140000 /* Socket.  */
  &gt;&gt;</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">path,directory?</span>
  <span class="cicada-nymph-comment">&lt;&lt; path[address, length] -- bool &gt;&gt;</span>
  string-&gt;syscall-string
  <span class="cicada-nymph-save-local-variable-1">&gt;:syscall-path</span>
  <span class="cicada-nymph-constant">+stat,length+</span> <span class="cicada-nymph-allocate">allocate-local-memory</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:stat-structure</span>
  <span class="cicada-nymph-fetch-local-variable-1">:stat-structure</span>
  <span class="cicada-nymph-fetch-local-variable-1">:syscall-path</span>
  <span class="cicada-nymph-constant">:syscall-number,stat:</span>
  <span class="cicada-nymph-number">2</span> syscall
  dup
  negative? <span class="cicada-nymph-syntax-key-word">if</span>
    drop
    <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  drop
  <span class="cicada-nymph-fetch-local-variable-1">:stat-structure</span> <span class="cicada-nymph-title">init</span>,stat
  <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">4</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-constant">+stat,st_mode+</span>
    fetch-two-bytes
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">8</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-constant">+stat,st_mode+</span>
    fetch-four-bytes
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-number">12</span> bit-right
  <span class="cicada-nymph-number">8</span><span class="cicada-nymph-number-light">#</span><span class="cicada-nymph-number">0004</span>
  equal?
  <span class="cicada-nymph-comment">&lt;&lt;
  0170000
  S_IFDIR       00040000 /* Directory.  */
  S_IFCHR       00020000 /* Character device.  */
  S_IFBLK       00060000 /* Block device.  */
  S_IFREG       00100000 /* Regular file.  */
  S_IFIFO       00010000 /* FIFO.  */
  S_IFLNK       00120000 /* Symbolic link.  */
  S_IFSOCK      00140000 /* Socket.  */
  &gt;&gt;</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">relative-path?</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- bool &gt;&gt;</span>
  dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2
    <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-title">string-head</span>,char
  <span class="cicada-nymph-number">47</span> equal? not
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">full-path?</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- bool &gt;&gt;</span>
  dup zero? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2
    <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-title">string-head</span>,char
  <span class="cicada-nymph-number">47</span> equal?
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*poi-directory,user,address*</span>
  <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-memory</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*poi-directory*</span>
  <span class="cicada-nymph-variable">*home-directory*</span> <span class="cicada-nymph-string">"/.cicada/poi"</span>
  <span class="cicada-nymph-variable">*poi-directory,user,address*</span>
  <span class="cicada-nymph-number">2</span> n-string-&gt;buffer!
  <span class="cicada-nymph-variable">*poi-directory,user,address*</span> swap
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">poi,add</span>
  <span class="cicada-nymph-comment">&lt;&lt; name[address, length], relative-path[address, length] -- &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::relative-path</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>

  <span class="cicada-nymph-fetch-local-variable-2">::relative-path</span> relative-path? not <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"* (poi,add) the argument must be a relative-path"</span> .s .l
    <span class="cicada-nymph-string">"  but the following is not : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::relative-path</span> .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>

  <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
  <span class="cicada-nymph-variable">*poi-directory*</span> <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span>
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
  <span class="cicada-nymph-number">3</span> n-string-&gt;buffer!
  <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
  <span class="cicada-nymph-title">directory</span>,creat

  <span class="cicada-nymph-variable">*poi-directory*</span> <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-string">"/path"</span>
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
  <span class="cicada-nymph-number">4</span> n-string-&gt;buffer!
  <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
  <span class="cicada-nymph-title">file</span>,creat

  <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:address,full-path</span>
  get-work-directory <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-fetch-local-variable-2">::relative-path</span>
  <span class="cicada-nymph-fetch-local-variable-1">:address,full-path</span>
  <span class="cicada-nymph-number">3</span> n-string-&gt;buffer! <span class="cicada-nymph-save-local-variable-1">&gt;:length,full-path</span>

  <span class="cicada-nymph-fetch-local-variable-1">:address,full-path</span> <span class="cicada-nymph-fetch-local-variable-1">:length,full-path</span>
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
  <span class="cicada-nymph-title">file</span>,write
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">poi,sub</span>
  <span class="cicada-nymph-comment">&lt;&lt; name[address, length] -- &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>
  <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
  <span class="cicada-nymph-variable">*poi-directory*</span> <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-string">"/path"</span>
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
  <span class="cicada-nymph-number">4</span> n-string-&gt;buffer! <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>

  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
  <span class="cicada-nymph-title">file</span>,remove

  <span class="cicada-nymph-variable">*poi-directory*</span> <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span>
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
  <span class="cicada-nymph-number">3</span> n-string-&gt;buffer!
  <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
  <span class="cicada-nymph-title">directory</span>,remove
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">poi,up</span>
  <span class="cicada-nymph-comment">&lt;&lt; name[address, length], relative-path[address, length] -- &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::relative-path</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>

  <span class="cicada-nymph-fetch-local-variable-2">::relative-path</span> relative-path? not <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"* (poi,up) the argument must be a relative-path"</span> .s .l
    <span class="cicada-nymph-string">"  but the following is not : "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::relative-path</span> .s .l
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>

  <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
  <span class="cicada-nymph-variable">*poi-directory*</span> <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-string">"/path"</span>
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
  <span class="cicada-nymph-number">4</span> n-string-&gt;buffer! <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>

  <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:address,full-path</span>
  get-work-directory <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-fetch-local-variable-2">::relative-path</span>
  <span class="cicada-nymph-fetch-local-variable-1">:address,full-path</span>
  <span class="cicada-nymph-number">3</span> n-string-&gt;buffer! <span class="cicada-nymph-save-local-variable-1">&gt;:length,full-path</span>

  <span class="cicada-nymph-fetch-local-variable-1">:address,full-path</span> <span class="cicada-nymph-fetch-local-variable-1">:length,full-path</span>
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
  <span class="cicada-nymph-title">file</span>,write
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">poi,find</span>
  <span class="cicada-nymph-comment">&lt;&lt; name[address, length]
     -- path[address, length], true
     -- false &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>
  <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
  <span class="cicada-nymph-variable">*poi-directory*</span> <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-string">"/path"</span>
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
  <span class="cicada-nymph-number">4</span> n-string-&gt;buffer! <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>

  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
  <span class="cicada-nymph-title">path</span>,file? not <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>

  <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:read-buffer</span>
  <span class="cicada-nymph-fetch-local-variable-1">:read-buffer</span> <span class="cicada-nymph-number">512</span>
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span>
  <span class="cicada-nymph-title">file</span>,read <span class="cicada-nymph-save-local-variable-1">&gt;:read-length</span>

  <span class="cicada-nymph-variable">*current-free-address,circular-string-area*</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:path-address</span>

  <span class="cicada-nymph-fetch-local-variable-1">:read-buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:read-length</span>
  <span class="cicada-nymph-title">save-into</span>,circular-string-area

  <span class="cicada-nymph-fetch-local-variable-1">:path-address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:read-length</span>
  <span class="cicada-nymph-bool">true</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">poi,list,lister</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-constant">+getdents64,d_type+</span> fetch-byte
  <span class="cicada-nymph-number">4</span> equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:path-buffer</span>
    <span class="cicada-nymph-constant">+getdents64,d_name+</span>
    dup <span class="cicada-nymph-number">256</span>
    <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-title">string</span>,find-char
    drop  <span class="cicada-nymph-comment">&lt;&lt; drop 0 &gt;&gt;</span>
    over sub <span class="cicada-nymph-save-local-variable-2">&gt;::name</span>

    <span class="cicada-nymph-string">".."</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-syntax-key-word">then</span>

    <span class="cicada-nymph-string">"."</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
      <span class="cicada-nymph-end">end</span>
    <span class="cicada-nymph-syntax-key-word">then</span>

    <span class="cicada-nymph-string">"  "</span> .s <span class="cicada-nymph-fetch-local-variable-2">::name</span> .s <span class="cicada-nymph-string">" : "</span> .s

    <span class="cicada-nymph-variable">*poi-directory*</span> <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-fetch-local-variable-2">::name</span> <span class="cicada-nymph-string">"/path"</span>
    <span class="cicada-nymph-fetch-local-variable-1">:path-buffer</span>
    <span class="cicada-nymph-number">4</span> n-string-&gt;buffer! <span class="cicada-nymph-save-local-variable-1">&gt;:path-length</span>

    <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:reading-buffer</span>
    <span class="cicada-nymph-fetch-local-variable-1">:reading-buffer</span> <span class="cicada-nymph-number">512</span>
    <span class="cicada-nymph-fetch-local-variable-1">:path-buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:path-length</span>
    <span class="cicada-nymph-title">file</span>,read <span class="cicada-nymph-save-local-variable-1">&gt;:reading-length</span>

    <span class="cicada-nymph-fetch-local-variable-1">:reading-buffer</span> <span class="cicada-nymph-fetch-local-variable-1">:reading-length</span>
    .s .l
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">poi,list</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-variable">*poi-directory*</span>
  <span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">poi</span>,list,lister
  <span class="cicada-nymph-title">directory</span>,map
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">poi,help</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-string">"* (poi,help) :"</span> .s .l
  <span class="cicada-nymph-string">"  poi"</span> .s .l
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+name+?</span>
  <span class="cicada-nymph-comment">&lt;&lt; string[address, length] -- bool &gt;&gt;</span>
  dup <span class="cicada-nymph-number">1</span> less-or-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2
    <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  over fetch-byte
  <span class="cicada-nymph-string">"+"</span> <span class="cicada-nymph-title">string-head</span>,char equal? not <span class="cicada-nymph-syntax-key-word">if</span>
    drop2
    <span class="cicada-nymph-bool">false</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  add sub1 fetch-byte
  <span class="cicada-nymph-string">"+"</span> <span class="cicada-nymph-title">string-head</span>,char equal?
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">+name+-&gt;name</span>
  <span class="cicada-nymph-comment">&lt;&lt; +name+[address, length] -- name[address, length] &gt;&gt;</span>
  sub2 swap
  add1 swap
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">word:path:?</span>
  <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- bool &gt;&gt;</span>
  <span class="cicada-nymph-string">"path:"</span> string-equal?
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">bad-path-syntax-word,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  read-word-for-REPL
  dup2 <span class="cicada-nymph-string">";"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    .s <span class="cicada-nymph-number">32</span> .b
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  .s <span class="cicada-nymph-number">32</span> .b
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">bad-path-syntax-word</span>,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-exception">!bad-path-syntax-word</span>
  <span class="cicada-nymph-comment">&lt;&lt; word -- &gt;&gt;</span>
  <span class="cicada-nymph-string">"* (!bad-path-syntax-word) the following word is of bad syntax : "</span> .s .l
  <span class="cicada-nymph-string">"    "</span> .s .s .l
  <span class="cicada-nymph-syntax-key-word">exception-reset-stack</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-string">"  the rest of the words in path syntax is as following :"</span> .s .l
  <span class="cicada-nymph-string">"    "</span> .s <span class="cicada-nymph-title">bad-path-syntax-word</span>,loop .l
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-exception">define-exception</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">path-syntax-word-&gt;path</span>
  <span class="cicada-nymph-comment">&lt;&lt; word[address, length] -- path[address, length] &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-2">&gt;::word</span>
  <span class="cicada-nymph-fetch-local-variable-2">::word</span> <span class="cicada-nymph-string">"+root+"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">"/"</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-2">::word</span> <span class="cicada-nymph-string">"+work+"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    get-work-directory
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-2">::word</span> <span class="cicada-nymph-string">"+home+"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-variable">*home-directory*</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-2">::word</span> <span class="cicada-nymph-string">"+back+"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-string">".."</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-2">::word</span> +name+? not <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-2">::word</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-2">::word</span> +name+-&gt;name <span class="cicada-nymph-title">poi</span>,find <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-2">::word</span>
  <span class="cicada-nymph-exception">!bad-path-syntax-word</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,path:,basic-REPL,loop</span>
  <span class="cicada-nymph-comment">&lt;&lt; cursor -- cursor &gt;&gt;</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>
  read-word-for-REPL <span class="cicada-nymph-save-local-variable-2">&gt;::word</span>

  <span class="cicada-nymph-string">";"</span> <span class="cicada-nymph-fetch-local-variable-2">::word</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
    <span class="cicada-nymph-end">end</span>
  <span class="cicada-nymph-syntax-key-word">then</span>

  <span class="cicada-nymph-fetch-local-variable-2">::word</span> path-syntax-word-&gt;path dup <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>
  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span>
  string-&gt;buffer!

  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:length</span> add
    dup
    <span class="cicada-nymph-string">"/"</span> <span class="cicada-nymph-title">string-head</span>,char
    swap
    save-byte
  add1
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">syntax</span>,path:,basic-REPL,loop
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">syntax,path:,basic-REPL</span>
  <span class="cicada-nymph-comment">&lt;&lt; word:path: -- path[address, length] &gt;&gt;</span>
  drop2

  prepare-for
    <span class="cicada-nymph-exception">!bad-path-syntax-word</span>
    <span class="cicada-nymph-end">end</span>

  <span class="cicada-nymph-number">512</span> <span class="cicada-nymph-allocate">allocate-local-memory</span> <span class="cicada-nymph-save-local-variable-1">&gt;:buffer</span>
  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> <span class="cicada-nymph-title">syntax</span>,path:,basic-REPL,loop <span class="cicada-nymph-save-local-variable-1">&gt;:cursor</span>

  <span class="cicada-nymph-fetch-local-variable-1">:cursor</span> <span class="cicada-nymph-fetch-local-variable-1">:buffer</span> sub <span class="cicada-nymph-save-local-variable-1">&gt;:length</span>

  <span class="cicada-nymph-variable">*current-free-address,circular-string-area*</span>
  <span class="cicada-nymph-save-local-variable-1">&gt;:address</span>

  <span class="cicada-nymph-fetch-local-variable-1">:buffer</span>
  <span class="cicada-nymph-fetch-local-variable-1">:length</span>
  <span class="cicada-nymph-title">save-into</span>,circular-string-area

  <span class="cicada-nymph-fetch-local-variable-1">:address</span>
  <span class="cicada-nymph-fetch-local-variable-1">:length</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-syntax-key-word">jo</span> word:path:?
<span class="cicada-nymph-syntax-key-word">jo</span> <span class="cicada-nymph-title">syntax</span>,path:,basic-REPL
<span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> add-rule

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">report-memory</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-string">"* *un-initialized-memory*"</span> .s .l
  <span class="cicada-nymph-string">"  * size : "</span> .s
       <span class="cicada-nymph-variable">*size,un-initialized-memory*</span>
       . .l
  <span class="cicada-nymph-string">"  * used : "</span> .s
       <span class="cicada-nymph-variable">*current-free-address,un-initialized-memory*</span>
       <span class="cicada-nymph-variable">*un-initialized-memory*</span>
       sub . .l
  <span class="cicada-nymph-string">"  * free : "</span> .s
       <span class="cicada-nymph-variable">*size,un-initialized-memory*</span>
       <span class="cicada-nymph-variable">*current-free-address,un-initialized-memory*</span>
       <span class="cicada-nymph-variable">*un-initialized-memory*</span>
       sub sub . .l
  <span class="cicada-nymph-string">"* *name-string-area*"</span> .s .l
  <span class="cicada-nymph-string">"  * size : "</span> .s
       <span class="cicada-nymph-variable">*size,name-string-area*</span>
       . .l
  <span class="cicada-nymph-string">"  * used : "</span> .s
       <span class="cicada-nymph-variable">*current-free-address,name-string-area*</span>
       <span class="cicada-nymph-variable">*name-string-area*</span>
       sub . .l
  <span class="cicada-nymph-string">"  * free : "</span> .s
       <span class="cicada-nymph-variable">*size,name-string-area*</span>
       <span class="cicada-nymph-variable">*current-free-address,name-string-area*</span>
       <span class="cicada-nymph-variable">*name-string-area*</span>
       sub sub . .l
  <span class="cicada-nymph-string">"* *jo-area*"</span> .s .l
  <span class="cicada-nymph-string">"  * size : "</span> .s
       <span class="cicada-nymph-variable">*size,jo-area*</span> . .l
  <span class="cicada-nymph-string">"  * used : "</span> .s
       <span class="cicada-nymph-variable">*current-free-address,jo-area*</span>
       <span class="cicada-nymph-variable">*jo-area*</span>
       sub . .l
  <span class="cicada-nymph-string">"  * free : "</span> .s
       <span class="cicada-nymph-variable">*size,jo-area*</span>
       <span class="cicada-nymph-variable">*current-free-address,jo-area*</span>
       <span class="cicada-nymph-variable">*jo-area*</span>
       sub sub . .l
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">report-platform</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-string">"* platform : "</span> .s
  platform .s
  .l
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">report-jo-size</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-string">"* jo-size : "</span> .s
  <span class="cicada-nymph-variable">*jo-size*</span> write-number
  <span class="cicada-nymph-string">" bytes"</span> .s
  .l
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">report-machine-word-size</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-string">"* machine-word-size : "</span> .s
  <span class="cicada-nymph-variable">*jo-size*</span> <span class="cicada-nymph-number">8</span> mul write-number
  <span class="cicada-nymph-string">" bits"</span> .s
  .l
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">report-syntax</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-string">"* *rule-set,make-jojo* :"</span> .s .l
   <span class="cicada-nymph-variable">*rule-set,make-jojo*</span> list-rule
  <span class="cicada-nymph-string">"* *rule-set,basic-REPL* :"</span> .s .l
   <span class="cicada-nymph-variable">*rule-set,basic-REPL*</span> list-rule
  <span class="cicada-nymph-string">"* tos-syntax-stack :"</span> .s .l
   tos-syntax-stack list-rule
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">initial-report</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-string">"* initial-report : "</span> .s .l
  <span class="cicada-nymph-string">"  "</span> .s report-platform
  <span class="cicada-nymph-string">"  "</span> .s report-machine-word-size
  <span class="cicada-nymph-string">"  "</span> .s report-jo-size
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">welcome</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-string">"* welcome to cicada-nymph"</span> .s .l
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-number">0</span>
<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-variable">*hi,random-base*</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-variable">define-variable,with-tos</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">hi,random</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- random-number &gt;&gt;</span>
  <span class="cicada-nymph-number">0</span> <span class="cicada-nymph-constant">:syscall-number,times:</span>
  <span class="cicada-nymph-number">1</span> syscall
  <span class="cicada-nymph-number">9</span> mod
  <span class="cicada-nymph-comment">&lt;&lt;
   *hi,random-base*
   *hi,random-base* add1 13 mod
   address *hi,random-base* save
  &gt;&gt;</span>
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">hi,say</span>
  <span class="cicada-nymph-comment">&lt;&lt; number -- &gt;&gt;</span>
  dup <span class="cicada-nymph-number">0</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"  cica cica da yaya !!!"</span> .s .l <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">1</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"  hi ^-^"</span> .s .l <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">2</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"  hello :)"</span> .s .l <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">3</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"  hey *^-^*"</span> .s .l <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">4</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"  hiya \^o^/"</span> .s .l <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">5</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"  I wish you a lovely day"</span> .s .l <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">6</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"  I wish you a lovely day { or night :P }"</span> .s .l <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
  dup <span class="cicada-nymph-number">7</span> equal? <span class="cicada-nymph-syntax-key-word">if</span> drop <span class="cicada-nymph-string">"  o.o"</span> .s .l <span class="cicada-nymph-end">end</span> <span class="cicada-nymph-syntax-key-word">then</span>
                  drop <span class="cicada-nymph-string">"  lovely ^3^"</span> .s .l <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">hi</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-title">hi</span>,random
  <span class="cicada-nymph-title">hi</span>,say
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">help</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-string">"* helpful documentations will be written soon"</span> .s .l
  <span class="cicada-nymph-string">"  please wait ^-^"</span> .s .l
  <span class="cicada-nymph-end">end</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">command-line,unknow-function</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-string">"* (cicada-nymph) unknow command-line-function : "</span> .s
  get-command-line
  <span class="cicada-nymph-title">string-tail</span>,word
  <span class="cicada-nymph-title">string-head</span>,word .s .l
  <span class="cicada-nymph-string">"  good bye ^-^/"</span> .s .l
  <span class="cicada-nymph-end">bye</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">command-line,stack-REPL</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  welcome
  hi
  initial-report
  <span class="cicada-nymph-string">"* you are in the (stack-REPL)"</span> .s .l
  <span class="cicada-nymph-string">"  every time after a word is executed"</span> .s .l
  <span class="cicada-nymph-string">"  the argument-stack get printed"</span> .s .l
  <span class="cicada-nymph-title">print-argument-stack</span>,pretty
  <span class="cicada-nymph-syntax-key-word">jo</span> stack-REPL
  <span class="cicada-nymph-end">reset-top-level-REPL</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">command-line,basic-REPL</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  welcome
  hi
  initial-report
  <span class="cicada-nymph-string">"* you are in the (basic-REPL)"</span> .s .l
  <span class="cicada-nymph-string">"  this REPL does not print any thing automaticly"</span> .s .l
  <span class="cicada-nymph-syntax-key-word">jo</span> basic-REPL
  <span class="cicada-nymph-end">reset-top-level-REPL</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">command-line,poi</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  get-command-line
  <span class="cicada-nymph-title">string-tail</span>,word
  <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::command-line</span>
  <span class="cicada-nymph-fetch-local-variable-2">::command-line</span> space-string? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-title">poi</span>,help
    <span class="cicada-nymph-end">bye</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-2">::command-line</span> <span class="cicada-nymph-title">string-head</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::sub-function-name</span>
  <span class="cicada-nymph-fetch-local-variable-2">::command-line</span> <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-save-local-variable-2">&gt;::command-line-arguments</span>
  <span class="cicada-nymph-fetch-local-variable-2">::sub-function-name</span> <span class="cicada-nymph-string">"add"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-2">::command-line-arguments</span> <span class="cicada-nymph-title">string-head</span>,word
    <span class="cicada-nymph-fetch-local-variable-2">::command-line-arguments</span> <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-title">string-head</span>,word
    <span class="cicada-nymph-title">poi</span>,add
    <span class="cicada-nymph-end">bye</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-2">::sub-function-name</span> <span class="cicada-nymph-string">"sub"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-2">::command-line-arguments</span> <span class="cicada-nymph-title">string-head</span>,word
    <span class="cicada-nymph-title">poi</span>,sub
    <span class="cicada-nymph-end">bye</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-2">::sub-function-name</span> <span class="cicada-nymph-string">"up"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-2">::command-line-arguments</span> <span class="cicada-nymph-title">string-head</span>,word
    <span class="cicada-nymph-fetch-local-variable-2">::command-line-arguments</span> <span class="cicada-nymph-title">string-tail</span>,word <span class="cicada-nymph-title">string-head</span>,word
    <span class="cicada-nymph-title">poi</span>,up
    <span class="cicada-nymph-end">bye</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-2">::sub-function-name</span> <span class="cicada-nymph-string">"find"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-fetch-local-variable-2">::command-line-arguments</span> <span class="cicada-nymph-title">string-head</span>,word
    <span class="cicada-nymph-title">poi</span>,find <span class="cicada-nymph-syntax-key-word">if</span>
      .s .l
    <span class="cicada-nymph-syntax-key-word">else</span>
      <span class="cicada-nymph-string">"no found"</span> .s .l
    <span class="cicada-nymph-syntax-key-word">then</span>
    <span class="cicada-nymph-end">bye</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-2">::sub-function-name</span> <span class="cicada-nymph-string">"list"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-title">poi</span>,list
    <span class="cicada-nymph-end">bye</span>
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-string">"* (poi) meets argument that (poi) can not understand"</span> .s .l
  <span class="cicada-nymph-string">"  it is the following command-line that is confusing (poi) :"</span> .s .l
  <span class="cicada-nymph-string">"    "</span> .s report-command-line .l
  <span class="cicada-nymph-string">"  you can type  cn poi  to get some help info"</span> .s .l
  <span class="cicada-nymph-string">"  good bye ^-^/"</span> .s .l
  <span class="cicada-nymph-end">bye</span>
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">command-line,no-function</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">command-line</span>,stack-REPL
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">command-line-dispatcher</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  get-command-line
  <span class="cicada-nymph-title">string-tail</span>,word
  dup2 space-string? <span class="cicada-nymph-syntax-key-word">if</span>
    drop2
    <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">command-line</span>,no-function
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-title">string-head</span>,word
  <span class="cicada-nymph-save-local-variable-2">&gt;::1st-word</span>
  <span class="cicada-nymph-fetch-local-variable-2">::1st-word</span> <span class="cicada-nymph-string">"basic-REPL"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">command-line</span>,basic-REPL
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-2">::1st-word</span> <span class="cicada-nymph-string">"stack-REPL"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">command-line</span>,stack-REPL
  <span class="cicada-nymph-syntax-key-word">then</span>
  <span class="cicada-nymph-fetch-local-variable-2">::1st-word</span> <span class="cicada-nymph-string">"poi"</span> string-equal? <span class="cicada-nymph-syntax-key-word">if</span>
    <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">command-line</span>,poi
  <span class="cicada-nymph-syntax-key-word">then</span>
    <span class="cicada-nymph-end">&lt;&gt;</span> <span class="cicada-nymph-title">command-line</span>,unknow-function
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

<span class="cicada-nymph-sentence-reader">:</span> <span class="cicada-nymph-function-to-define">the-story-begin</span>
  <span class="cicada-nymph-comment">&lt;&lt; -- &gt;&gt;</span>
  <span class="cicada-nymph-end">&lt;&gt;</span> command-line-dispatcher
<span class="cicada-nymph-sentence-reader">;</span> <span class="cicada-nymph-define-function">define-function</span>

the-story-begin
</pre>
  </body>
</html>
